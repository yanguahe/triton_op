++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=6
++ HIP_VISIBLE_DEVICES=6
++ run_triton_op
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py -n 10,1 -c 4097 -b 32
[aiter INFO] 2025-09-30 08:32:47.693 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:32:49.071 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.47922803446798 us/iter from cuda.Event
[W930 08:32:49.831826448 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:32:49.240 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {523, 9, 515, 12}
[aiter INFO] 2025-09-30 08:32:49.240 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999869
[aiter INFO] 2025-09-30 08:32:49.240 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.91900000000004
[aiter INFO] 2025-09-30 08:32:49.240 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.159999999999854
[aiter INFO] 2025-09-30 08:32:49.240 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.439000000000021
[aiter INFO] 2025-09-30 08:32:49.260 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            491.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          2,893.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,445.8              0.0         CPU        95954
[avg us/iter]                                                                                        NaN   NaN           34.5             34.2         NaN          NaN
[aiter INFO] 2025-09-30 08:32:49.303 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    34.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.039 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.66759285596336 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.097 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-30 08:32:50.097 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.92000000000007
[aiter INFO] 2025-09-30 08:32:50.097 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.68
[aiter INFO] 2025-09-30 08:32:50.097 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.07899999999998
[aiter INFO] 2025-09-30 08:32:50.098 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.71899999999994
[aiter INFO] 2025-09-30 08:32:50.098 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.75900000000001
[aiter INFO] 2025-09-30 08:32:50.110 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          8,146.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.9         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.141 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.33603961367418 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.177 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:32:50.177 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.599000000000018
[aiter INFO] 2025-09-30 08:32:50.189 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            667.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.197 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    91.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.199 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:32:50.263 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.18937630641577 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 47, 16, 20, 53, 26, 60, 31}
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.519000000000005
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.198999999999955
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.759999999999991
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999969
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.278999999999996
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.999000000000024
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:32:50.314 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.43900000000002
[aiter INFO] 2025-09-30 08:32:50.333 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            461.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,695.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,341.6              0.0         CPU        95954
[avg us/iter]                                                                                        NaN   NaN           43.4             43.3         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.333 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.438 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 197.04903986784493 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.494 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 08:32:50.494 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.12
[aiter INFO] 2025-09-30 08:32:50.506 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         10,001.8        CUDA            8
[avg us/iter]                       NaN   NaN            0.0            100.0         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.533 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.12179201103673 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.569 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:32:50.569 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-30 08:32:50.581 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            667.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.582 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   106.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.583 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:32:50.651 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.14701015760403 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 16, 273, 658, 20, 280, 665, 27, 669, 31, 676, 38, 42, 49, 53, 60, 361, 240, 368, 247}
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.47900000000001
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.75999999999976
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.39899999999943
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.39999999999998
[aiter INFO] 2025-09-30 08:32:50.701 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999796
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.078999999999951
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.599999999999454
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.718999999999994
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999983
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.7589999999999
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.999000000000024
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000065
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.43899999999985
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.439000000000306
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999833
[aiter INFO] 2025-09-30 08:32:50.702 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000287
[aiter INFO] 2025-09-30 08:32:50.721 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            533.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          3,775.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,750.7              0.0         CPU        95954
[avg us/iter]                                                                                        NaN   NaN           47.5             47.3         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.721 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    47.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.823 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 256.4619711720118 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.886 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 63}
[aiter INFO] 2025-09-30 08:32:50.886 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.07899999999998
[aiter INFO] 2025-09-30 08:32:50.887 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.23900000000003
[aiter INFO] 2025-09-30 08:32:50.899 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         16,069.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0            162.3         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.928 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.64022790205361 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:50.964 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:32:50.964 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000007
[aiter INFO] 2025-09-30 08:32:50.976 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            976.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-30 08:32:50.977 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   172.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:50.980 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:32:51.160 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 142.6123855727734 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:51.210 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {896, 9, 16, 20, 27, 31, 38, 42, 427, 49, 434, 1076, 53, 1083, 60, 64, 71, 460, 467, 889}
[aiter INFO] 2025-09-30 08:32:51.210 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.07900000000001
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.47900000000004
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.95900000000006
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.718999999999937
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.92000000000007
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.59900000000016
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.078999999999951
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.07899999999972
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.59899999999993
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000669
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999983
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.278999999999996
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.47900000000027
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-30 08:32:51.211 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.199000000000524
[aiter INFO] 2025-09-30 08:32:51.230 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            532.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          4,480.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,524.4              0.0         CPU        95954
[avg us/iter]                                                                                        NaN   NaN           55.2             55.1         NaN          NaN
[aiter INFO] 2025-09-30 08:32:51.231 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    55.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:51.334 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 243.30898942333636 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {101, 1290, 44, 77, 12, 25, 63}
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.15899999999988
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.95900000000074
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.76
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.07999999999993
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.64000000000001
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.279
[aiter INFO] 2025-09-30 08:32:51.396 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.279
[aiter INFO] 2025-09-30 08:32:51.408 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         13,861.7        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            147.5         NaN          NaN
[aiter INFO] 2025-09-30 08:32:51.435 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.64302979571985 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:32:51.471 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {412, 405, 6}
[aiter INFO] 2025-09-30 08:32:51.471 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.159000000000106
[aiter INFO] 2025-09-30 08:32:51.471 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.03899999999976
[aiter INFO] 2025-09-30 08:32:51.471 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.87899999999999
[aiter INFO] 2025-09-30 08:32:51.483 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            957.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-30 08:32:51.484 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   157.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:32:51.489 - MainProcess:95954 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4097          32   (10, 1)        128          16  torch.bfloat16     1    False         34.2             0           91.5               0
1      4097          32   (10, 1)        128        1024  torch.bfloat16     1    False         43.3             0          106.7               0
2      4097          32   (10, 1)        128          16  torch.bfloat16     2    False         47.3             0          172.1               0
3      4097          32   (10, 1)        128        1024  torch.bfloat16     2    False         55.1             0          157.2               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023635073739569634

Top differences:
Position (np.int64(7), np.int64(2), np.int64(74)): arr1 = -0.036133, arr2 = -0.036377, Diff = 0.000244
Position (np.int64(28), np.int64(1), np.int64(94)): arr1 = -0.033447, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(28), np.int64(9), np.int64(94)): arr1 = -0.032715, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(24), np.int64(0), np.int64(73)): arr1 = 0.034180, arr2 = 0.034424, Diff = 0.000244
Position (np.int64(26), np.int64(9), np.int64(10)): arr1 = -0.037354, arr2 = -0.037109, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 20169 (49.24%)
[1.0e-06, 1.0e-05): 1892 (4.62%)
[1.0e-05, 1.0e-04): 18191 (44.41%)
[1.0e-04, 1.0e-03): 708 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016786570195108652

Top differences:
Position (np.int64(19), np.int64(1), np.int64(38)): arr1 = 0.019775, arr2 = 0.018066, Diff = 0.001709
Position (np.int64(4), np.int64(4), np.int64(52)): arr1 = -0.015747, arr2 = -0.014099, Diff = 0.001648
Position (np.int64(14), np.int64(6), np.int64(100)): arr1 = 0.011902, arr2 = 0.010376, Diff = 0.001526
Position (np.int64(22), np.int64(6), np.int64(21)): arr1 = -0.018677, arr2 = -0.017212, Diff = 0.001465
Position (np.int64(5), np.int64(0), np.int64(107)): arr1 = -0.033203, arr2 = -0.031738, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1729 (4.22%)
[1.0e-06, 1.0e-05): 94 (0.23%)
[1.0e-05, 1.0e-04): 6233 (15.22%)
[1.0e-04, 1.0e-03): 32534 (79.43%)
[1.0e-03, 1.0e-02): 370 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=73b66f44991e1fe8a214a45e17cc72b0
triton_output_md5=96fc62ecdf22432462a57c312e5f0333
diff.abs.max=0.000244140625
max_diff_thr=0.00023646252520848066

Top differences:
Position (np.int64(12), np.int64(5), np.int64(29)): arr1 = -0.032715, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(12), np.int64(4), np.int64(115)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(9), np.int64(0), np.int64(76)): arr1 = -0.036377, arr2 = -0.036133, Diff = 0.000244
Position (np.int64(2), np.int64(9), np.int64(96)): arr1 = 0.019409, arr2 = 0.019287, Diff = 0.000122
Position (np.int64(31), np.int64(3), np.int64(18)): arr1 = -0.017090, arr2 = -0.016968, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20070 (49.00%)
[1.0e-06, 1.0e-05): 1805 (4.41%)
[1.0e-05, 1.0e-04): 18389 (44.90%)
[1.0e-04, 1.0e-03): 696 (1.70%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0020599365234375
max_diff_thr=0.002055889694020152

Top differences:
Position (np.int64(12), np.int64(1), np.int64(62)): arr1 = 0.004028, arr2 = 0.001968, Diff = 0.002060
Position (np.int64(12), np.int64(0), np.int64(62)): arr1 = -0.001572, arr2 = -0.003479, Diff = 0.001907
Position (np.int64(12), np.int64(1), np.int64(11)): arr1 = -0.000336, arr2 = -0.002228, Diff = 0.001892
Position (np.int64(12), np.int64(5), np.int64(62)): arr1 = -0.003372, arr2 = -0.005096, Diff = 0.001724
Position (np.int64(12), np.int64(3), np.int64(62)): arr1 = 0.001236, arr2 = -0.000448, Diff = 0.001684

Threshold statistics:
[0.0e+00, 1.0e-06): 1767 (4.31%)
[1.0e-06, 1.0e-05): 109 (0.27%)
[1.0e-05, 1.0e-04): 6131 (14.97%)
[1.0e-04, 1.0e-03): 32552 (79.47%)
[1.0e-03, 1.0e-02): 401 (0.98%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c0988f64840ad017a8ff26e6316886a6
triton_output_md5=5e4a1e96df3422b409ec92ea33041b61
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(0), np.int64(7), np.int64(94)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(23), np.int64(4), np.int64(15)): arr1 = -0.033691, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(0), np.int64(4), np.int64(94)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(19), np.int64(8), np.int64(37)): arr1 = 0.042480, arr2 = 0.042725, Diff = 0.000244
Position (np.int64(40), np.int64(8), np.int64(101)): arr1 = 0.032227, arr2 = 0.031982, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40908 (49.94%)
[1.0e-06, 1.0e-05): 3504 (4.28%)
[1.0e-05, 1.0e-04): 36061 (44.02%)
[1.0e-04, 1.0e-03): 1447 (1.77%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00164794921875
max_diff_thr=0.0016327024204656482

Top differences:
Position (np.int64(16), np.int64(0), np.int64(113)): arr1 = 0.010986, arr2 = 0.009338, Diff = 0.001648
Position (np.int64(18), np.int64(4), np.int64(51)): arr1 = -0.024414, arr2 = -0.022827, Diff = 0.001587
Position (np.int64(7), np.int64(2), np.int64(37)): arr1 = 0.019409, arr2 = 0.017822, Diff = 0.001587
Position (np.int64(3), np.int64(3), np.int64(93)): arr1 = -0.029419, arr2 = -0.027832, Diff = 0.001587
Position (np.int64(17), np.int64(8), np.int64(113)): arr1 = 0.018433, arr2 = 0.016846, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3408 (4.16%)
[1.0e-06, 1.0e-05): 230 (0.28%)
[1.0e-05, 1.0e-04): 12470 (15.22%)
[1.0e-04, 1.0e-03): 65036 (79.39%)
[1.0e-03, 1.0e-02): 776 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=96fbc89f3ada20eec411959c6fa7f5d7
triton_output_md5=629832afd4694d384a0c691971cbe6e7
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(50), np.int64(7), np.int64(27)): arr1 = -0.034424, arr2 = -0.034180, Diff = 0.000244
Position (np.int64(3), np.int64(8), np.int64(2)): arr1 = -0.038574, arr2 = -0.038330, Diff = 0.000244
Position (np.int64(21), np.int64(1), np.int64(118)): arr1 = 0.031982, arr2 = 0.031738, Diff = 0.000244
Position (np.int64(47), np.int64(7), np.int64(100)): arr1 = 0.032959, arr2 = 0.032715, Diff = 0.000244
Position (np.int64(20), np.int64(8), np.int64(118)): arr1 = 0.031738, arr2 = 0.031494, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40989 (50.04%)
[1.0e-06, 1.0e-05): 3561 (4.35%)
[1.0e-05, 1.0e-04): 35950 (43.88%)
[1.0e-04, 1.0e-03): 1420 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016780534060671926

Top differences:
Position (np.int64(55), np.int64(8), np.int64(74)): arr1 = -0.026367, arr2 = -0.024658, Diff = 0.001709
Position (np.int64(24), np.int64(1), np.int64(65)): arr1 = -0.024414, arr2 = -0.022705, Diff = 0.001709
Position (np.int64(20), np.int64(5), np.int64(118)): arr1 = 0.037598, arr2 = 0.035889, Diff = 0.001709
Position (np.int64(8), np.int64(0), np.int64(30)): arr1 = 0.020142, arr2 = 0.018433, Diff = 0.001709
Position (np.int64(42), np.int64(4), np.int64(54)): arr1 = 0.007172, arr2 = 0.005554, Diff = 0.001617

Threshold statistics:
[0.0e+00, 1.0e-06): 3379 (4.12%)
[1.0e-06, 1.0e-05): 234 (0.29%)
[1.0e-05, 1.0e-04): 12502 (15.26%)
[1.0e-04, 1.0e-03): 64995 (79.34%)
[1.0e-03, 1.0e-02): 810 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ca5e601c1e92147b9f7bc9ddc99f5a9d
triton_output_md5=17b79f5a0346c1a072c1d10346a7fb88
++ python ./test_pa_mtp.py -n 10,1 -c 4096 -b 32
[aiter INFO] 2025-09-30 08:33:02.842 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:04.228 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.96638565252323 us/iter from cuda.Event
[W930 08:33:04.988507604 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:33:04.396 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 512, 12, 9}
[aiter INFO] 2025-09-30 08:33:04.396 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.51899999999932
[aiter INFO] 2025-09-30 08:33:04.396 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-30 08:33:04.396 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-30 08:33:04.396 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.87900000000002
[aiter INFO] 2025-09-30 08:33:04.417 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            430.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          2,865.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,357.3              0.0         CPU        96038
[avg us/iter]                                                                                        NaN   NaN           33.6             33.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:04.460 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:05.196 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 184.5254259239329 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.254 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12, 38}
[aiter INFO] 2025-09-30 08:33:05.254 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.63900000000001
[aiter INFO] 2025-09-30 08:33:05.254 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.87900000000002
[aiter INFO] 2025-09-30 08:33:05.254 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.80000000000001
[aiter INFO] 2025-09-30 08:33:05.266 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          8,281.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.5         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.297 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.931673148480975 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.333 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:05.333 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.318999999999988
[aiter INFO] 2025-09-30 08:33:05.345 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            533.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.354 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    89.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:05.355 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:05.419 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 126.86146463793102 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.469 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 47, 16, 20, 25, 31}
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.559
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.960000000000036
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000074
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999969
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.43900000000002
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 08:33:05.470 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.198999999999955
[aiter INFO] 2025-09-30 08:33:05.489 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            413.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,651.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,198.3              0.0         CPU        96038
[avg us/iter]                                                                                        NaN   NaN           42.0             41.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.489 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:05.591 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 196.83832623580895 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.648 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 08:33:05.648 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.71899999999997
[aiter INFO] 2025-09-30 08:33:05.660 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          9,962.1        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             99.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.686 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.32300999288512 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.722 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 447}
[aiter INFO] 2025-09-30 08:33:05.722 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.359000000000009
[aiter INFO] 2025-09-30 08:33:05.723 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000000124
[aiter INFO] 2025-09-30 08:33:05.734 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            528.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.735 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   104.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:05.737 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:05.804 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 131.1577021485508 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 559, 16, 49, 20, 566, 27, 31}
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.99899999999997
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.07899999999995
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.399999999999636
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.56
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.998999999999796
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-30 08:33:05.854 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.63900000000001
[aiter INFO] 2025-09-30 08:33:05.873 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            464.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,967.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,625.2              0.0         CPU        96038
[avg us/iter]                                                                                        NaN   NaN           46.3             46.2         NaN          NaN
[aiter INFO] 2025-09-30 08:33:05.874 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:05.975 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 256.5582264768015 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:06.038 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 63}
[aiter INFO] 2025-09-30 08:33:06.038 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.879
[aiter INFO] 2025-09-30 08:33:06.038 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.59899999999993
[aiter INFO] 2025-09-30 08:33:06.051 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         15,886.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0            160.5         NaN          NaN
[aiter INFO] 2025-09-30 08:33:06.079 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.216445443063684 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:06.116 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:06.116 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000017
[aiter INFO] 2025-09-30 08:33:06.128 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            733.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              7.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:06.129 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   167.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:06.131 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:06.311 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.45598011205692 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:06.361 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.119000000000028
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.63900000000001
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.120000000000005
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.07899999999995
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.0390000000001
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 08:33:06.362 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.03899999999999
[aiter INFO] 2025-09-30 08:33:06.380 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            462.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,652.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,339.3              0.0         CPU        96038
[avg us/iter]                                                                                        NaN   NaN           53.4             53.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:06.381 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    53.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:06.484 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 244.04288090691708 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {355, 101, 12, 79, 50, 25, 63}
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.279
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.80000000000007
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.83999999999997
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.279
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.51999999999998
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.47900000000004
[aiter INFO] 2025-09-30 08:33:06.545 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.68000000000006
[aiter INFO] 2025-09-30 08:33:06.557 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         13,813.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            146.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:06.584 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.40180198302363 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:06.620 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {321, 6, 328, 13, 307, 314, 636}
[aiter INFO] 2025-09-30 08:33:06.620 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000287
[aiter INFO] 2025-09-30 08:33:06.620 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999988
[aiter INFO] 2025-09-30 08:33:06.620 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000251
[aiter INFO] 2025-09-30 08:33:06.620 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-09-30 08:33:06.621 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-09-30 08:33:06.621 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000251
[aiter INFO] 2025-09-30 08:33:06.621 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.998999999999796
[aiter INFO] 2025-09-30 08:33:06.633 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0            686.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:06.633 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   154.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:06.638 - MainProcess:96038 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4096          32   (10, 1)        128          16  torch.bfloat16     1    False         33.3             0           89.8               0
1      4096          32   (10, 1)        128        1024  torch.bfloat16     1    False         41.9             0          105.0               0
2      4096          32   (10, 1)        128          16  torch.bfloat16     2    False         46.2             0          167.8               0
3      4096          32   (10, 1)        128        1024  torch.bfloat16     2    False         53.3             0          154.3               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(9), np.int64(7), np.int64(31)): arr1 = -0.034180, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(6), np.int64(1), np.int64(58)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(26), np.int64(7), np.int64(10)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(1), np.int64(3), np.int64(125)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(20), np.int64(4), np.int64(57)): arr1 = -0.025024, arr2 = -0.024902, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20178 (49.26%)
[1.0e-06, 1.0e-05): 1828 (4.46%)
[1.0e-05, 1.0e-04): 18266 (44.59%)
[1.0e-04, 1.0e-03): 688 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016756433760747313

Top differences:
Position (np.int64(26), np.int64(0), np.int64(11)): arr1 = 0.021606, arr2 = 0.019897, Diff = 0.001709
Position (np.int64(17), np.int64(7), np.int64(49)): arr1 = 0.019653, arr2 = 0.018066, Diff = 0.001587
Position (np.int64(22), np.int64(6), np.int64(21)): arr1 = -0.017090, arr2 = -0.015564, Diff = 0.001526
Position (np.int64(8), np.int64(3), np.int64(127)): arr1 = -0.021851, arr2 = -0.020386, Diff = 0.001465
Position (np.int64(7), np.int64(3), np.int64(5)): arr1 = -0.018433, arr2 = -0.016968, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1696 (4.14%)
[1.0e-06, 1.0e-05): 113 (0.28%)
[1.0e-05, 1.0e-04): 6210 (15.16%)
[1.0e-04, 1.0e-03): 32557 (79.48%)
[1.0e-03, 1.0e-02): 384 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=cf23783b9603b895d73ef9f4a887816a
triton_output_md5=85221cace1ff8ba029915e0f61e751ab
diff.abs.max=0.000244140625
max_diff_thr=0.0002362949016969651

Top differences:
Position (np.int64(19), np.int64(6), np.int64(88)): arr1 = 0.036133, arr2 = 0.036377, Diff = 0.000244
Position (np.int64(23), np.int64(9), np.int64(29)): arr1 = -0.035156, arr2 = -0.034912, Diff = 0.000244
Position (np.int64(19), np.int64(4), np.int64(88)): arr1 = 0.033447, arr2 = 0.033203, Diff = 0.000244
Position (np.int64(15), np.int64(1), np.int64(36)): arr1 = 0.018677, arr2 = 0.018555, Diff = 0.000122
Position (np.int64(12), np.int64(0), np.int64(122)): arr1 = 0.023682, arr2 = 0.023560, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20257 (49.46%)
[1.0e-06, 1.0e-05): 1795 (4.38%)
[1.0e-05, 1.0e-04): 18142 (44.29%)
[1.0e-04, 1.0e-03): 766 (1.87%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0017242431640625
max_diff_thr=0.0017146151512861252

Top differences:
Position (np.int64(23), np.int64(7), np.int64(62)): arr1 = -0.003891, arr2 = -0.005615, Diff = 0.001724
Position (np.int64(28), np.int64(3), np.int64(38)): arr1 = -0.024170, arr2 = -0.022461, Diff = 0.001709
Position (np.int64(23), np.int64(1), np.int64(62)): arr1 = -0.006012, arr2 = -0.007599, Diff = 0.001587
Position (np.int64(31), np.int64(1), np.int64(74)): arr1 = -0.016724, arr2 = -0.015259, Diff = 0.001465
Position (np.int64(11), np.int64(7), np.int64(22)): arr1 = 0.020264, arr2 = 0.018799, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1677 (4.09%)
[1.0e-06, 1.0e-05): 131 (0.32%)
[1.0e-05, 1.0e-04): 6166 (15.05%)
[1.0e-04, 1.0e-03): 32598 (79.58%)
[1.0e-03, 1.0e-02): 388 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=91b862ace779651965ed36c5ba840fa9
triton_output_md5=60992cf605526e8d260c50bff8b3271f
diff.abs.max=0.000244140625
max_diff_thr=0.00023596035316586494

Top differences:
Position (np.int64(4), np.int64(2), np.int64(84)): arr1 = 0.034424, arr2 = 0.034668, Diff = 0.000244
Position (np.int64(4), np.int64(7), np.int64(84)): arr1 = 0.037109, arr2 = 0.036865, Diff = 0.000244
Position (np.int64(5), np.int64(7), np.int64(84)): arr1 = 0.034912, arr2 = 0.034668, Diff = 0.000244
Position (np.int64(45), np.int64(8), np.int64(47)): arr1 = -0.016724, arr2 = -0.016602, Diff = 0.000122
Position (np.int64(22), np.int64(5), np.int64(75)): arr1 = -0.016724, arr2 = -0.016846, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 40561 (49.51%)
[1.0e-06, 1.0e-05): 3629 (4.43%)
[1.0e-05, 1.0e-04): 36310 (44.32%)
[1.0e-04, 1.0e-03): 1420 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001678466796875
max_diff_thr=0.0016665151342749596

Top differences:
Position (np.int64(18), np.int64(3), np.int64(14)): arr1 = -0.008850, arr2 = -0.007172, Diff = 0.001678
Position (np.int64(12), np.int64(3), np.int64(10)): arr1 = 0.013184, arr2 = 0.011536, Diff = 0.001648
Position (np.int64(30), np.int64(3), np.int64(104)): arr1 = -0.027466, arr2 = -0.025879, Diff = 0.001587
Position (np.int64(36), np.int64(0), np.int64(27)): arr1 = 0.017944, arr2 = 0.016357, Diff = 0.001587
Position (np.int64(46), np.int64(6), np.int64(51)): arr1 = 0.020630, arr2 = 0.019043, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3415 (4.17%)
[1.0e-06, 1.0e-05): 260 (0.32%)
[1.0e-05, 1.0e-04): 12468 (15.22%)
[1.0e-04, 1.0e-03): 65006 (79.35%)
[1.0e-03, 1.0e-02): 771 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d412707e95f9a8d11cf559305eb64f4d
triton_output_md5=6d75d28db073b542190dcf004fa7e7d9
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(23), np.int64(3), np.int64(77)): arr1 = -0.035400, arr2 = -0.035645, Diff = 0.000244
Position (np.int64(23), np.int64(5), np.int64(77)): arr1 = -0.033691, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(6), np.int64(6), np.int64(91)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(42), np.int64(0), np.int64(2)): arr1 = 0.032471, arr2 = 0.032715, Diff = 0.000244
Position (np.int64(6), np.int64(2), np.int64(91)): arr1 = -0.035400, arr2 = -0.035156, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 41104 (50.18%)
[1.0e-06, 1.0e-05): 3472 (4.24%)
[1.0e-05, 1.0e-04): 35721 (43.60%)
[1.0e-04, 1.0e-03): 1623 (1.98%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.001790403388440609

Top differences:
Position (np.int64(2), np.int64(9), np.int64(70)): arr1 = 0.024536, arr2 = 0.022705, Diff = 0.001831
Position (np.int64(49), np.int64(7), np.int64(109)): arr1 = 0.015869, arr2 = 0.014221, Diff = 0.001648
Position (np.int64(36), np.int64(2), np.int64(69)): arr1 = -0.015991, arr2 = -0.014343, Diff = 0.001648
Position (np.int64(49), np.int64(7), np.int64(59)): arr1 = -0.018433, arr2 = -0.016846, Diff = 0.001587
Position (np.int64(4), np.int64(5), np.int64(35)): arr1 = -0.026855, arr2 = -0.025269, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3462 (4.23%)
[1.0e-06, 1.0e-05): 220 (0.27%)
[1.0e-05, 1.0e-04): 12354 (15.08%)
[1.0e-04, 1.0e-03): 65087 (79.45%)
[1.0e-03, 1.0e-02): 797 (0.97%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6dbdc6ac345b91b2038e229189a89124
triton_output_md5=f7888bfd05db0b5f4a611f0bb3d744e3
++ python ./test_pa_mtp.py -n 8,1 -c 4097 -b 32
[aiter INFO] 2025-09-30 08:33:18.194 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:19.549 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.69746535544348 us/iter from cuda.Event
[W930 08:33:19.308644701 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:33:19.717 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-30 08:33:19.717 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.718999999999994
[aiter INFO] 2025-09-30 08:33:19.717 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-30 08:33:19.738 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            496.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,881.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,377.6              0.0         CPU        96122
[avg us/iter]                                                                                        NaN   NaN           33.8             33.8         NaN          NaN
[aiter INFO] 2025-09-30 08:33:19.779 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:20.558 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.73330741943698 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:20.617 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12, 38}
[aiter INFO] 2025-09-30 08:33:20.617 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.719
[aiter INFO] 2025-09-30 08:33:20.617 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.15899999999999
[aiter INFO] 2025-09-30 08:33:20.617 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.19900000000001
[aiter INFO] 2025-09-30 08:33:20.617 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.519
[aiter INFO] 2025-09-30 08:33:20.630 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          8,218.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.7         NaN          NaN
[aiter INFO] 2025-09-30 08:33:20.661 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.09803934085487 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:20.698 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 258, 6}
[aiter INFO] 2025-09-30 08:33:20.698 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999742
[aiter INFO] 2025-09-30 08:33:20.698 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-30 08:33:20.698 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-30 08:33:20.710 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            677.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:20.718 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    91.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:20.720 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:20.784 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 126.37627744438626 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 196, 9, 42, 203, 845, 15, 48, 850, 20, 25, 31}
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.63899999999967
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.15899999999999
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.92000000000007
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.638999999999214
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-30 08:33:20.835 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.438999999999965
[aiter INFO] 2025-09-30 08:33:20.836 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-30 08:33:20.836 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.958999999999946
[aiter INFO] 2025-09-30 08:33:20.854 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            451.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,651.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,329.3              0.0         CPU        96122
[avg us/iter]                                                                                        NaN   NaN           43.3             43.2         NaN          NaN
[aiter INFO] 2025-09-30 08:33:20.855 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:20.958 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.44584108815334 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 129, 38, 103, 168, 714, 12, 77, 207, 51, 116, 90, 701}
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.91899999999998
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.83899999999994
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.80000000000001
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.24000000000001
[aiter INFO] 2025-09-30 08:33:21.015 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.83899999999994
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.59999999999945
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.15899999999999
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.39999999999998
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.0
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.43899999999996
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.31899999999996
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.43899999999996
[aiter INFO] 2025-09-30 08:33:21.016 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.27900000000045
[aiter INFO] 2025-09-30 08:33:21.028 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 88.0            0.0          8,726.6        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             99.2         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.055 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.380821740273205 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.091 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:21.092 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-30 08:33:21.104 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            690.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.104 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   106.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:21.106 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:21.173 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 130.5252079031255 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.223 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 08:33:21.223 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.838999999999942
[aiter INFO] 2025-09-30 08:33:21.223 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.63900000000001
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.599000000000046
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.680000000000064
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.87900000000002
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.278999999999996
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.799000000000035
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.678999999999974
[aiter INFO] 2025-09-30 08:33:21.224 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.519000000000005
[aiter INFO] 2025-09-30 08:33:21.242 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            550.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,919.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,670.5              0.0         CPU        96122
[avg us/iter]                                                                                        NaN   NaN           46.7             46.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.243 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:21.344 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 253.75382144852438 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.408 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {50, 12, 101, 63}
[aiter INFO] 2025-09-30 08:33:21.409 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.72000000000003
[aiter INFO] 2025-09-30 08:33:21.409 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.479
[aiter INFO] 2025-09-30 08:33:21.409 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.99900000000002
[aiter INFO] 2025-09-30 08:33:21.409 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.11900000000003
[aiter INFO] 2025-09-30 08:33:21.421 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         15,275.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0            157.5         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.449 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.00022764135115 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.487 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:21.487 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-30 08:33:21.499 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            687.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.500 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   164.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:21.502 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:21.716 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.03456387425413 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {416, 38, 423, 713, 42, 9, 460, 911, 720, 49, 16, 467, 20, 53, 918, 27, 60, 31}
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.27900000000045
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.678999999999974
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000706
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.5590000000002
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.438999999999965
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.59899999999999
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.71900000000005
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.59900000000016
[aiter INFO] 2025-09-30 08:33:21.767 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.679000000000087
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.678999999999974
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.59900000000016
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.759000000000015
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.999000000000024
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.71900000000096
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.800000000000068
[aiter INFO] 2025-09-30 08:33:21.768 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.84000000000003
[aiter INFO] 2025-09-30 08:33:21.787 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            524.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          4,479.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,455.2              0.0         CPU        96122
[avg us/iter]                                                                                        NaN   NaN           54.6             54.4         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.788 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    54.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:21.891 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 240.99058399696162 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:21.953 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {101, 12, 50, 87, 120, 25, 63}
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.55899999999997
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.24000000000004
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.3599999999999
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.07999999999993
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.6400000000001
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.31899999999996
[aiter INFO] 2025-09-30 08:33:21.954 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.75900000000001
[aiter INFO] 2025-09-30 08:33:21.966 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         13,804.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            146.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:21.993 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.79743559732296 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:22.029 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:22.030 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.719999999999999
[aiter INFO] 2025-09-30 08:33:22.042 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            687.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:33:22.043 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   153.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:22.047 - MainProcess:96122 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4097          32    (8, 1)        128          16  torch.bfloat16     1    False         33.8             0           91.6               0
1      4097          32    (8, 1)        128        1024  torch.bfloat16     1    False         43.2             0          106.1               0
2      4097          32    (8, 1)        128          16  torch.bfloat16     2    False         46.6             0          164.4               0
3      4097          32    (8, 1)        128        1024  torch.bfloat16     2    False         54.4             0          153.7               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023635073739569634

Top differences:
Position (np.int64(26), np.int64(7), np.int64(10)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(6), np.int64(4), np.int64(52)): arr1 = -0.037598, arr2 = -0.037842, Diff = 0.000244
Position (np.int64(13), np.int64(6), np.int64(114)): arr1 = -0.018799, arr2 = -0.018921, Diff = 0.000122
Position (np.int64(1), np.int64(5), np.int64(28)): arr1 = 0.016235, arr2 = 0.016357, Diff = 0.000122
Position (np.int64(7), np.int64(7), np.int64(20)): arr1 = 0.015991, arr2 = 0.016113, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16163 (49.33%)
[1.0e-06, 1.0e-05): 1424 (4.35%)
[1.0e-05, 1.0e-04): 14644 (44.69%)
[1.0e-04, 1.0e-03): 537 (1.64%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017507848097011447

Top differences:
Position (np.int64(27), np.int64(1), np.int64(79)): arr1 = 0.012756, arr2 = 0.010986, Diff = 0.001770
Position (np.int64(15), np.int64(3), np.int64(25)): arr1 = -0.025757, arr2 = -0.024170, Diff = 0.001587
Position (np.int64(15), np.int64(6), np.int64(25)): arr1 = -0.017944, arr2 = -0.016479, Diff = 0.001465
Position (np.int64(18), np.int64(5), np.int64(34)): arr1 = 0.027588, arr2 = 0.026123, Diff = 0.001465
Position (np.int64(15), np.int64(6), np.int64(51)): arr1 = 0.014709, arr2 = 0.013245, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1352 (4.13%)
[1.0e-06, 1.0e-05): 94 (0.29%)
[1.0e-05, 1.0e-04): 4967 (15.16%)
[1.0e-04, 1.0e-03): 26072 (79.57%)
[1.0e-03, 1.0e-02): 283 (0.86%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ac9b5dbd82d01264b608e7430b2ec861
triton_output_md5=bbec247b21820cd8339cb8aa2f82a30c
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(12), np.int64(3), np.int64(29)): arr1 = -0.036865, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(20), np.int64(7), np.int64(10)): arr1 = -0.031494, arr2 = -0.031250, Diff = 0.000244
Position (np.int64(24), np.int64(2), np.int64(26)): arr1 = -0.016724, arr2 = -0.016602, Diff = 0.000122
Position (np.int64(25), np.int64(5), np.int64(57)): arr1 = -0.018921, arr2 = -0.019043, Diff = 0.000122
Position (np.int64(15), np.int64(4), np.int64(127)): arr1 = -0.019897, arr2 = -0.020020, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16010 (48.86%)
[1.0e-06, 1.0e-05): 1511 (4.61%)
[1.0e-05, 1.0e-04): 14695 (44.85%)
[1.0e-04, 1.0e-03): 552 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016818837029859424

Top differences:
Position (np.int64(5), np.int64(2), np.int64(105)): arr1 = 0.026855, arr2 = 0.025146, Diff = 0.001709
Position (np.int64(30), np.int64(6), np.int64(117)): arr1 = 0.017822, arr2 = 0.016113, Diff = 0.001709
Position (np.int64(12), np.int64(6), np.int64(62)): arr1 = -0.008118, arr2 = -0.009705, Diff = 0.001587
Position (np.int64(12), np.int64(3), np.int64(115)): arr1 = -0.032715, arr2 = -0.031128, Diff = 0.001587
Position (np.int64(14), np.int64(5), np.int64(36)): arr1 = 0.020996, arr2 = 0.019409, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1384 (4.22%)
[1.0e-06, 1.0e-05): 87 (0.27%)
[1.0e-05, 1.0e-04): 5203 (15.88%)
[1.0e-04, 1.0e-03): 25750 (78.58%)
[1.0e-03, 1.0e-02): 344 (1.05%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=61bdd4040fe41f0a2ddb07a6b9dc8159
triton_output_md5=2d51d15c88a4ef0571d3cc525c6c56b5
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(39), np.int64(1), np.int64(67)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(7), np.int64(7), np.int64(62)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(18), np.int64(0), np.int64(37)): arr1 = 0.038086, arr2 = 0.037842, Diff = 0.000244
Position (np.int64(41), np.int64(2), np.int64(101)): arr1 = 0.033691, arr2 = 0.033936, Diff = 0.000244
Position (np.int64(1), np.int64(0), np.int64(94)): arr1 = -0.036865, arr2 = -0.036621, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 32764 (49.99%)
[1.0e-06, 1.0e-05): 2908 (4.44%)
[1.0e-05, 1.0e-04): 28795 (43.94%)
[1.0e-04, 1.0e-03): 1069 (1.63%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017774617299437523

Top differences:
Position (np.int64(37), np.int64(7), np.int64(32)): arr1 = -0.031982, arr2 = -0.030151, Diff = 0.001831
Position (np.int64(19), np.int64(5), np.int64(51)): arr1 = -0.027710, arr2 = -0.026001, Diff = 0.001709
Position (np.int64(32), np.int64(4), np.int64(77)): arr1 = -0.012573, arr2 = -0.010986, Diff = 0.001587
Position (np.int64(33), np.int64(6), np.int64(77)): arr1 = -0.012756, arr2 = -0.011169, Diff = 0.001587
Position (np.int64(41), np.int64(3), np.int64(114)): arr1 = -0.015991, arr2 = -0.014465, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 2752 (4.20%)
[1.0e-06, 1.0e-05): 205 (0.31%)
[1.0e-05, 1.0e-04): 10002 (15.26%)
[1.0e-04, 1.0e-03): 51960 (79.28%)
[1.0e-03, 1.0e-02): 617 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=134b0b94d6dffd74a9e804c73f66d4be
triton_output_md5=8f09931fd37aab7881b457ede4d35bc5
diff.abs.max=0.000244140625
max_diff_thr=0.00023657440033275634

Top differences:
Position (np.int64(24), np.int64(5), np.int64(86)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(2), np.int64(1), np.int64(2)): arr1 = -0.036865, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(46), np.int64(2), np.int64(100)): arr1 = 0.031738, arr2 = 0.031982, Diff = 0.000244
Position (np.int64(13), np.int64(5), np.int64(4)): arr1 = 0.033203, arr2 = 0.033447, Diff = 0.000244
Position (np.int64(58), np.int64(1), np.int64(107)): arr1 = 0.013123, arr2 = 0.013000, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 32671 (49.85%)
[1.0e-06, 1.0e-05): 2811 (4.29%)
[1.0e-05, 1.0e-04): 28916 (44.12%)
[1.0e-04, 1.0e-03): 1138 (1.74%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001683501643128693

Top differences:
Position (np.int64(22), np.int64(2), np.int64(112)): arr1 = 0.016846, arr2 = 0.015137, Diff = 0.001709
Position (np.int64(16), np.int64(1), np.int64(25)): arr1 = -0.022217, arr2 = -0.020630, Diff = 0.001587
Position (np.int64(50), np.int64(4), np.int64(27)): arr1 = -0.033203, arr2 = -0.031738, Diff = 0.001465
Position (np.int64(37), np.int64(3), np.int64(117)): arr1 = 0.018066, arr2 = 0.016602, Diff = 0.001465
Position (np.int64(46), np.int64(0), np.int64(113)): arr1 = -0.018799, arr2 = -0.017334, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 2734 (4.17%)
[1.0e-06, 1.0e-05): 177 (0.27%)
[1.0e-05, 1.0e-04): 10005 (15.27%)
[1.0e-04, 1.0e-03): 51999 (79.34%)
[1.0e-03, 1.0e-02): 621 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=3f2a5b785b3af13a680fc4f303382503
triton_output_md5=340f6a9f1368e714a1ec41833c224210
++ python ./test_pa_mtp.py -n 8,1 -c 4096 -b 32
[aiter INFO] 2025-09-30 08:33:33.406 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:34.790 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.02971300571272 us/iter from cuda.Event
[W930 08:33:34.550604353 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:33:34.958 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-30 08:33:34.958 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.63900000000001
[aiter INFO] 2025-09-30 08:33:34.958 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.478999999999985
[aiter INFO] 2025-09-30 08:33:34.979 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,872.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,304.0              0.0         CPU        96206
[avg us/iter]                                                                                        NaN   NaN           33.0             33.0         NaN          NaN
[aiter INFO] 2025-09-30 08:33:35.021 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.04 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:35.778 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.63593113422394 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:35.836 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38}
[aiter INFO] 2025-09-30 08:33:35.836 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.63900000000001
[aiter INFO] 2025-09-30 08:33:35.836 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.83999999999997
[aiter INFO] 2025-09-30 08:33:35.837 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.59900000000005
[aiter INFO] 2025-09-30 08:33:35.849 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          8,259.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:35.880 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.444564590359676 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:35.916 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {643, 349, 6}
[aiter INFO] 2025-09-30 08:33:35.916 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5590000000001965
[aiter INFO] 2025-09-30 08:33:35.916 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5590000000001965
[aiter INFO] 2025-09-30 08:33:35.916 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000004
[aiter INFO] 2025-09-30 08:33:35.928 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            516.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:35.937 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    89.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:35.938 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:36.002 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 126.95847510701358 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 47, 16, 20, 53, 724, 729, 25, 58, 31}
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000069
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.83900000000003
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.15899999999999
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000028
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 08:33:36.056 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.599000000000046
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.72000000000003
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.71900000000005
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-30 08:33:36.057 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.238999999999976
[aiter INFO] 2025-09-30 08:33:36.075 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            403.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,555.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,179.1              0.0         CPU        96206
[avg us/iter]                                                                                        NaN   NaN           41.8             41.7         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.076 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:36.181 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.95356418354675 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 454, 714, 12, 77, 493, 51, 1078, 25, 90, 701}
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.84000000000003
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.19900000000001
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.95899999999983
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.9989999999998
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.87900000000002
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.99900000000002
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.35900000000038
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.67899999999997
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.04000000000087
[aiter INFO] 2025-09-30 08:33:36.238 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.75999999999999
[aiter INFO] 2025-09-30 08:33:36.239 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.75999999999999
[aiter INFO] 2025-09-30 08:33:36.239 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.96000000000004
[aiter INFO] 2025-09-30 08:33:36.251 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 89.0            0.0          8,788.3        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             98.7         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.278 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.22557432020065 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.315 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {342, 6}
[aiter INFO] 2025-09-30 08:33:36.315 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.59900000000016
[aiter INFO] 2025-09-30 08:33:36.315 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-30 08:33:36.327 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            521.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.328 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   104.01 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:36.329 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:36.396 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 130.53076249538083 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 25, 31}
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.11900000000003
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.55899999999997
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.718999999999994
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-30 08:33:36.450 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.23900000000003
[aiter INFO] 2025-09-30 08:33:36.469 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            456.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,962.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,567.9              0.0         CPU        96206
[avg us/iter]                                                                                        NaN   NaN           45.7             45.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.469 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    45.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:36.574 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 252.59416882354435 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.636 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {44, 12, 63}
[aiter INFO] 2025-09-30 08:33:36.636 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.08000000000004
[aiter INFO] 2025-09-30 08:33:36.636 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.04000000000002
[aiter INFO] 2025-09-30 08:33:36.636 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.71900000000005
[aiter INFO] 2025-09-30 08:33:36.648 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         15,284.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0            156.0         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.677 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.46557445101219 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.830 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 27, 6}
[aiter INFO] 2025-09-30 08:33:36.830 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-30 08:33:36.830 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.799000000000035
[aiter INFO] 2025-09-30 08:33:36.830 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 08:33:36.842 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            524.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.843 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   161.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:36.846 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-09-30 08:33:36.912 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.63178242787276 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:36.962 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 08:33:36.962 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.598999999999933
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.43900000000002
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.599000000000046
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.51999999999998
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.83899999999994
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-09-30 08:33:36.963 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.999000000000024
[aiter INFO] 2025-09-30 08:33:36.982 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            448.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,592.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,259.9              0.0         CPU        96206
[avg us/iter]                                                                                        NaN   NaN           52.6             52.5         NaN          NaN
[aiter INFO] 2025-09-30 08:33:36.983 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    52.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:37.086 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 245.7592866503366 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:37.147 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1313, 134, 12, 77, 47, 114, 1302, 25, 508, 63}
[aiter INFO] 2025-09-30 08:33:37.147 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.6790000000001
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.19900000000007
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.68
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.08000000000004
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.91999999999996
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.20000000000005
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.9989999999998
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.91900000000004
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.0
[aiter INFO] 2025-09-30 08:33:37.148 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.83899999999994
[aiter INFO] 2025-09-30 08:33:37.160 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 91.0            0.0         13,337.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            146.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:37.187 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.09962399082609 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:37.223 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {202, 62, 6}
[aiter INFO] 2025-09-30 08:33:37.223 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.718999999999824
[aiter INFO] 2025-09-30 08:33:37.223 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.718999999999937
[aiter INFO] 2025-09-30 08:33:37.223 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-30 08:33:37.235 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            518.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:37.236 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   151.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:37.240 - MainProcess:96206 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4096          32    (8, 1)        128          16  torch.bfloat16     1    False         33.0             0           89.5               0
1      4096          32    (8, 1)        128        1024  torch.bfloat16     1    False         41.7             0          104.0               0
2      4096          32    (8, 1)        128          16  torch.bfloat16     2    False         45.6             0          161.3               0
3      4096          32    (8, 1)        128        1024  torch.bfloat16     2    False         52.5             0          151.9               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023651844821870327

Top differences:
Position (np.int64(6), np.int64(5), np.int64(58)): arr1 = -0.038330, arr2 = -0.038086, Diff = 0.000244
Position (np.int64(1), np.int64(5), np.int64(125)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(6), np.int64(4), np.int64(52)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(27), np.int64(2), np.int64(87)): arr1 = -0.037354, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(30), np.int64(5), np.int64(43)): arr1 = -0.023682, arr2 = -0.023804, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16107 (49.15%)
[1.0e-06, 1.0e-05): 1524 (4.65%)
[1.0e-05, 1.0e-04): 14577 (44.49%)
[1.0e-04, 1.0e-03): 560 (1.71%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0015869140625
max_diff_thr=0.0015596880111843348

Top differences:
Position (np.int64(15), np.int64(6), np.int64(25)): arr1 = -0.019043, arr2 = -0.017456, Diff = 0.001587
Position (np.int64(18), np.int64(6), np.int64(9)): arr1 = 0.027466, arr2 = 0.025879, Diff = 0.001587
Position (np.int64(6), np.int64(7), np.int64(91)): arr1 = 0.008667, arr2 = 0.007111, Diff = 0.001556
Position (np.int64(7), np.int64(1), np.int64(124)): arr1 = -0.018066, arr2 = -0.016602, Diff = 0.001465
Position (np.int64(30), np.int64(1), np.int64(50)): arr1 = -0.015869, arr2 = -0.014404, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1416 (4.32%)
[1.0e-06, 1.0e-05): 96 (0.29%)
[1.0e-05, 1.0e-04): 5021 (15.32%)
[1.0e-04, 1.0e-03): 25946 (79.18%)
[1.0e-03, 1.0e-02): 289 (0.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=dea07ba715eb1600a8998f80ae5d16df
triton_output_md5=c5fe7fbb6c4fc1c979dd556d0dee6527
diff.abs.max=0.000244140625
max_diff_thr=0.00023640661675017327

Top differences:
Position (np.int64(9), np.int64(5), np.int64(62)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(22), np.int64(3), np.int64(17)): arr1 = 0.032959, arr2 = 0.033203, Diff = 0.000244
Position (np.int64(7), np.int64(3), np.int64(43)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(6), np.int64(3), np.int64(85)): arr1 = -0.035400, arr2 = -0.035156, Diff = 0.000244
Position (np.int64(19), np.int64(4), np.int64(88)): arr1 = 0.034180, arr2 = 0.034424, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 16268 (49.65%)
[1.0e-06, 1.0e-05): 1394 (4.25%)
[1.0e-05, 1.0e-04): 14505 (44.27%)
[1.0e-04, 1.0e-03): 601 (1.83%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017521600238978863

Top differences:
Position (np.int64(18), np.int64(2), np.int64(39)): arr1 = -0.011963, arr2 = -0.010193, Diff = 0.001770
Position (np.int64(4), np.int64(2), np.int64(88)): arr1 = -0.024048, arr2 = -0.022339, Diff = 0.001709
Position (np.int64(23), np.int64(7), np.int64(103)): arr1 = -0.028687, arr2 = -0.026978, Diff = 0.001709
Position (np.int64(23), np.int64(0), np.int64(87)): arr1 = -0.031982, arr2 = -0.030396, Diff = 0.001587
Position (np.int64(24), np.int64(5), np.int64(26)): arr1 = -0.027344, arr2 = -0.025757, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1326 (4.05%)
[1.0e-06, 1.0e-05): 83 (0.25%)
[1.0e-05, 1.0e-04): 5015 (15.30%)
[1.0e-04, 1.0e-03): 26019 (79.40%)
[1.0e-03, 1.0e-02): 325 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4dd8944fedf4ac69f6f49a3ae427f59b
triton_output_md5=da17c9f6e1181f10807bf39507ce942c
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(9), np.int64(2), np.int64(5)): arr1 = 0.031982, arr2 = 0.031738, Diff = 0.000244
Position (np.int64(5), np.int64(3), np.int64(84)): arr1 = 0.038818, arr2 = 0.038574, Diff = 0.000244
Position (np.int64(44), np.int64(2), np.int64(80)): arr1 = 0.017090, arr2 = 0.017212, Diff = 0.000122
Position (np.int64(30), np.int64(2), np.int64(64)): arr1 = 0.025879, arr2 = 0.025757, Diff = 0.000122
Position (np.int64(61), np.int64(6), np.int64(9)): arr1 = -0.026611, arr2 = -0.026733, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 32478 (49.56%)
[1.0e-06, 1.0e-05): 2827 (4.31%)
[1.0e-05, 1.0e-04): 29106 (44.41%)
[1.0e-04, 1.0e-03): 1125 (1.72%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001682085799984634

Top differences:
Position (np.int64(33), np.int64(6), np.int64(77)): arr1 = -0.020630, arr2 = -0.018921, Diff = 0.001709
Position (np.int64(32), np.int64(4), np.int64(77)): arr1 = -0.017700, arr2 = -0.015991, Diff = 0.001709
Position (np.int64(6), np.int64(7), np.int64(19)): arr1 = -0.014160, arr2 = -0.012512, Diff = 0.001648
Position (np.int64(30), np.int64(0), np.int64(37)): arr1 = 0.012207, arr2 = 0.010681, Diff = 0.001526
Position (np.int64(52), np.int64(6), np.int64(49)): arr1 = 0.012024, arr2 = 0.010498, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 2820 (4.30%)
[1.0e-06, 1.0e-05): 166 (0.25%)
[1.0e-05, 1.0e-04): 9949 (15.18%)
[1.0e-04, 1.0e-03): 51944 (79.26%)
[1.0e-03, 1.0e-02): 657 (1.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f701d93281da24624484b553fd6bf948
triton_output_md5=5ebd3d60d4a7d61b4875d5f5cf1d4922
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(6), np.int64(2), np.int64(91)): arr1 = -0.035889, arr2 = -0.035645, Diff = 0.000244
Position (np.int64(14), np.int64(1), np.int64(64)): arr1 = -0.035889, arr2 = -0.036133, Diff = 0.000244
Position (np.int64(33), np.int64(0), np.int64(108)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(51), np.int64(1), np.int64(2)): arr1 = -0.037598, arr2 = -0.037354, Diff = 0.000244
Position (np.int64(23), np.int64(6), np.int64(77)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 32914 (50.22%)
[1.0e-06, 1.0e-05): 2794 (4.26%)
[1.0e-05, 1.0e-04): 28619 (43.67%)
[1.0e-04, 1.0e-03): 1209 (1.84%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017906171269714832

Top differences:
Position (np.int64(3), np.int64(5), np.int64(70)): arr1 = 0.024414, arr2 = 0.022583, Diff = 0.001831
Position (np.int64(37), np.int64(7), np.int64(27)): arr1 = 0.019897, arr2 = 0.018188, Diff = 0.001709
Position (np.int64(36), np.int64(0), np.int64(90)): arr1 = -0.017212, arr2 = -0.015625, Diff = 0.001587
Position (np.int64(50), np.int64(3), np.int64(93)): arr1 = -0.027344, arr2 = -0.025757, Diff = 0.001587
Position (np.int64(39), np.int64(6), np.int64(73)): arr1 = 0.022339, arr2 = 0.020752, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 2790 (4.26%)
[1.0e-06, 1.0e-05): 186 (0.28%)
[1.0e-05, 1.0e-04): 9762 (14.90%)
[1.0e-04, 1.0e-03): 52170 (79.61%)
[1.0e-03, 1.0e-02): 628 (0.96%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6effcd048ee3af2b9726b02e6e1a9bfc
triton_output_md5=2416f7425de48e2ce08333680ead1bb3
++ python ./test_pa_mtp.py -n 10,1 -c 4097 -b 32 --trans_v
[aiter INFO] 2025-09-30 08:33:48.596 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:33:49.981 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.05859403799076 us/iter from cuda.Event
[W930 08:33:50.741577034 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:33:50.150 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-30 08:33:50.150 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.678999999999974
[aiter INFO] 2025-09-30 08:33:50.150 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.478999999999985
[aiter INFO] 2025-09-30 08:33:50.170 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            497.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,914.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,412.4              0.0         CPU        96290
[avg us/iter]                                                                                        NaN   NaN           34.1             34.1         NaN          NaN
[aiter INFO] 2025-09-30 08:33:50.213 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    34.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:51.490 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 180.31590011450325 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:51.548 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12, 38}
[aiter INFO] 2025-09-30 08:33:51.548 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.92000000000002
[aiter INFO] 2025-09-30 08:33:51.548 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.15899999999999
[aiter INFO] 2025-09-30 08:33:51.548 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.31899999999999
[aiter INFO] 2025-09-30 08:33:51.548 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.15899999999993
[aiter INFO] 2025-09-30 08:33:51.561 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          8,226.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.8         NaN          NaN
[aiter INFO] 2025-09-30 08:33:51.591 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.45763360952387 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:51.627 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:51.627 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-30 08:33:51.639 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            664.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:51.648 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    91.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:51.649 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:33:51.713 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 126.58302943305213 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:51.763 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 48, 16, 20, 25, 31}
[aiter INFO] 2025-09-30 08:33:51.763 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.31899999999996
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.43900000000008
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.758999999999958
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.278999999999996
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:33:51.764 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.71900000000005
[aiter INFO] 2025-09-30 08:33:51.782 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            466.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,736.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,341.9              0.0         CPU        96290
[avg us/iter]                                                                                        NaN   NaN           43.4             43.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:51.783 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:52.352 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 173.75549496990618 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 103, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.99900000000002
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.84000000000003
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.35900000000004
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.04000000000002
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.27999999999997
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.91899999999998
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.11900000000003
[aiter INFO] 2025-09-30 08:33:52.408 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.279
[aiter INFO] 2025-09-30 08:33:52.420 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 93.0            0.0          7,382.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             79.4         NaN          NaN
[aiter INFO] 2025-09-30 08:33:52.447 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.76298012709854 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {293, 6, 13, 20, 279, 27}
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000342
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.920000000000016
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.358999999999924
[aiter INFO] 2025-09-30 08:33:52.483 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000044
[aiter INFO] 2025-09-30 08:33:52.495 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 95.0            0.0            631.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-30 08:33:52.496 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    86.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:52.497 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:33:52.565 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.37908925160323 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {37, 9, 42, 14, 49, 20, 53, 25, 60, 31}
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999983
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.63900000000001
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.0
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.839
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.71900000000005
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000065
[aiter INFO] 2025-09-30 08:33:52.616 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.358999999999924
[aiter INFO] 2025-09-30 08:33:52.635 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            563.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,981.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,742.7              0.0         CPU        96290
[avg us/iter]                                                                                        NaN   NaN           47.4             47.3         NaN          NaN
[aiter INFO] 2025-09-30 08:33:52.635 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    47.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:53.551 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 292.679891432866 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:53.741 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1000, 82, 12}
[aiter INFO] 2025-09-30 08:33:53.741 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.1190000000006
[aiter INFO] 2025-09-30 08:33:53.741 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.99900000000002
[aiter INFO] 2025-09-30 08:33:53.741 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.44
[aiter INFO] 2025-09-30 08:33:53.754 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         19,639.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0            200.4         NaN          NaN
[aiter INFO] 2025-09-30 08:33:53.783 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.36418820637287 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:53.820 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:33:53.820 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-09-30 08:33:53.831 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            976.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-30 08:33:53.833 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   210.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:53.835 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:33:53.901 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.62980245245566 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 361, 42, 9, 460, 368, 49, 16, 467, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.8390000000000555
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.31899999999996
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.719999999999914
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.79899999999998
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.280000000000655
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.9190000000007785
[aiter INFO] 2025-09-30 08:33:53.952 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.399
[aiter INFO] 2025-09-30 08:33:53.953 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.278999999999996
[aiter INFO] 2025-09-30 08:33:53.953 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-30 08:33:53.953 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.758999999999901
[aiter INFO] 2025-09-30 08:33:53.953 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.478999999999985
[aiter INFO] 2025-09-30 08:33:53.971 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            548.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          4,633.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,523.3              0.0         CPU        96290
[avg us/iter]                                                                                        NaN   NaN           55.2             55.1         NaN          NaN
[aiter INFO] 2025-09-30 08:33:53.972 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    55.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:54.771 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 225.07211905304746 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {89, 38, 102, 1305, 76, 140, 268, 12, 56, 25, 574, 127}
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.19999999999993
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.19900000000007
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.99900000000002
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.96000000000095
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.79899999999998
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.47900000000004
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.91899999999987
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.039
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.39999999999998
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.76
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.8800000000001
[aiter INFO] 2025-09-30 08:33:54.832 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.03999999999996
[aiter INFO] 2025-09-30 08:33:54.844 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 89.0            0.0         11,700.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            131.5         NaN          NaN
[aiter INFO] 2025-09-30 08:33:54.871 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.4540791272527 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:33:54.907 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 6}
[aiter INFO] 2025-09-30 08:33:54.907 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-09-30 08:33:54.907 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.87899999999999
[aiter INFO] 2025-09-30 08:33:54.919 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            966.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-30 08:33:54.920 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   141.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:33:54.924 - MainProcess:96290 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4097          32   (10, 1)        128          16  torch.bfloat16     1     True         34.1             0           91.5               0
1      4097          32   (10, 1)        128        1024  torch.bfloat16     1     True         43.3             0           86.0               0
2      4097          32   (10, 1)        128          16  torch.bfloat16     2     True         47.3             0          210.2               0
3      4097          32   (10, 1)        128        1024  torch.bfloat16     2     True         55.1             0          141.2               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023635073739569634

Top differences:
Position (np.int64(7), np.int64(2), np.int64(74)): arr1 = -0.036133, arr2 = -0.036377, Diff = 0.000244
Position (np.int64(28), np.int64(1), np.int64(94)): arr1 = -0.033447, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(28), np.int64(9), np.int64(94)): arr1 = -0.032715, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(24), np.int64(0), np.int64(73)): arr1 = 0.034180, arr2 = 0.034424, Diff = 0.000244
Position (np.int64(26), np.int64(9), np.int64(10)): arr1 = -0.037354, arr2 = -0.037109, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 20169 (49.24%)
[1.0e-06, 1.0e-05): 1892 (4.62%)
[1.0e-05, 1.0e-04): 18191 (44.41%)
[1.0e-04, 1.0e-03): 708 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016786570195108652

Top differences:
Position (np.int64(19), np.int64(1), np.int64(38)): arr1 = 0.019775, arr2 = 0.018066, Diff = 0.001709
Position (np.int64(4), np.int64(4), np.int64(52)): arr1 = -0.015747, arr2 = -0.014099, Diff = 0.001648
Position (np.int64(14), np.int64(6), np.int64(100)): arr1 = 0.011902, arr2 = 0.010376, Diff = 0.001526
Position (np.int64(22), np.int64(6), np.int64(21)): arr1 = -0.018677, arr2 = -0.017212, Diff = 0.001465
Position (np.int64(5), np.int64(0), np.int64(107)): arr1 = -0.033203, arr2 = -0.031738, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1729 (4.22%)
[1.0e-06, 1.0e-05): 94 (0.23%)
[1.0e-05, 1.0e-04): 6233 (15.22%)
[1.0e-04, 1.0e-03): 32534 (79.43%)
[1.0e-03, 1.0e-02): 370 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=73b66f44991e1fe8a214a45e17cc72b0
triton_output_md5=96fc62ecdf22432462a57c312e5f0333
diff.abs.max=0.000244140625
max_diff_thr=0.00023646252520848066

Top differences:
Position (np.int64(12), np.int64(5), np.int64(29)): arr1 = -0.032715, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(12), np.int64(4), np.int64(115)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(9), np.int64(0), np.int64(76)): arr1 = -0.036377, arr2 = -0.036133, Diff = 0.000244
Position (np.int64(2), np.int64(9), np.int64(96)): arr1 = 0.019409, arr2 = 0.019287, Diff = 0.000122
Position (np.int64(31), np.int64(3), np.int64(18)): arr1 = -0.017090, arr2 = -0.016968, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20070 (49.00%)
[1.0e-06, 1.0e-05): 1805 (4.41%)
[1.0e-05, 1.0e-04): 18389 (44.90%)
[1.0e-04, 1.0e-03): 696 (1.70%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.0020599365234375
max_diff_thr=0.002055889694020152

Top differences:
Position (np.int64(12), np.int64(1), np.int64(62)): arr1 = 0.004028, arr2 = 0.001968, Diff = 0.002060
Position (np.int64(12), np.int64(0), np.int64(62)): arr1 = -0.001572, arr2 = -0.003479, Diff = 0.001907
Position (np.int64(12), np.int64(1), np.int64(11)): arr1 = -0.000336, arr2 = -0.002228, Diff = 0.001892
Position (np.int64(12), np.int64(5), np.int64(62)): arr1 = -0.003372, arr2 = -0.005096, Diff = 0.001724
Position (np.int64(12), np.int64(3), np.int64(62)): arr1 = 0.001236, arr2 = -0.000448, Diff = 0.001684

Threshold statistics:
[0.0e+00, 1.0e-06): 1767 (4.31%)
[1.0e-06, 1.0e-05): 109 (0.27%)
[1.0e-05, 1.0e-04): 6131 (14.97%)
[1.0e-04, 1.0e-03): 32552 (79.47%)
[1.0e-03, 1.0e-02): 401 (0.98%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c0988f64840ad017a8ff26e6316886a6
triton_output_md5=5e4a1e96df3422b409ec92ea33041b61
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(0), np.int64(7), np.int64(94)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(23), np.int64(4), np.int64(15)): arr1 = -0.033691, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(0), np.int64(4), np.int64(94)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(19), np.int64(8), np.int64(37)): arr1 = 0.042480, arr2 = 0.042725, Diff = 0.000244
Position (np.int64(40), np.int64(8), np.int64(101)): arr1 = 0.032227, arr2 = 0.031982, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40908 (49.94%)
[1.0e-06, 1.0e-05): 3504 (4.28%)
[1.0e-05, 1.0e-04): 36061 (44.02%)
[1.0e-04, 1.0e-03): 1447 (1.77%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.00164794921875
max_diff_thr=0.0016327024204656482

Top differences:
Position (np.int64(16), np.int64(0), np.int64(113)): arr1 = 0.010986, arr2 = 0.009338, Diff = 0.001648
Position (np.int64(18), np.int64(4), np.int64(51)): arr1 = -0.024414, arr2 = -0.022827, Diff = 0.001587
Position (np.int64(7), np.int64(2), np.int64(37)): arr1 = 0.019409, arr2 = 0.017822, Diff = 0.001587
Position (np.int64(3), np.int64(3), np.int64(93)): arr1 = -0.029419, arr2 = -0.027832, Diff = 0.001587
Position (np.int64(17), np.int64(8), np.int64(113)): arr1 = 0.018433, arr2 = 0.016846, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3408 (4.16%)
[1.0e-06, 1.0e-05): 230 (0.28%)
[1.0e-05, 1.0e-04): 12470 (15.22%)
[1.0e-04, 1.0e-03): 65036 (79.39%)
[1.0e-03, 1.0e-02): 776 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=96fbc89f3ada20eec411959c6fa7f5d7
triton_output_md5=629832afd4694d384a0c691971cbe6e7
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(50), np.int64(7), np.int64(27)): arr1 = -0.034424, arr2 = -0.034180, Diff = 0.000244
Position (np.int64(3), np.int64(8), np.int64(2)): arr1 = -0.038574, arr2 = -0.038330, Diff = 0.000244
Position (np.int64(21), np.int64(1), np.int64(118)): arr1 = 0.031982, arr2 = 0.031738, Diff = 0.000244
Position (np.int64(47), np.int64(7), np.int64(100)): arr1 = 0.032959, arr2 = 0.032715, Diff = 0.000244
Position (np.int64(20), np.int64(8), np.int64(118)): arr1 = 0.031738, arr2 = 0.031494, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40989 (50.04%)
[1.0e-06, 1.0e-05): 3561 (4.35%)
[1.0e-05, 1.0e-04): 35950 (43.88%)
[1.0e-04, 1.0e-03): 1420 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016780534060671926

Top differences:
Position (np.int64(55), np.int64(8), np.int64(74)): arr1 = -0.026367, arr2 = -0.024658, Diff = 0.001709
Position (np.int64(24), np.int64(1), np.int64(65)): arr1 = -0.024414, arr2 = -0.022705, Diff = 0.001709
Position (np.int64(20), np.int64(5), np.int64(118)): arr1 = 0.037598, arr2 = 0.035889, Diff = 0.001709
Position (np.int64(8), np.int64(0), np.int64(30)): arr1 = 0.020142, arr2 = 0.018433, Diff = 0.001709
Position (np.int64(42), np.int64(4), np.int64(54)): arr1 = 0.007172, arr2 = 0.005554, Diff = 0.001617

Threshold statistics:
[0.0e+00, 1.0e-06): 3379 (4.12%)
[1.0e-06, 1.0e-05): 234 (0.29%)
[1.0e-05, 1.0e-04): 12502 (15.26%)
[1.0e-04, 1.0e-03): 64995 (79.34%)
[1.0e-03, 1.0e-02): 810 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ca5e601c1e92147b9f7bc9ddc99f5a9d
triton_output_md5=17b79f5a0346c1a072c1d10346a7fb88
++ python ./test_pa_mtp.py -n 10,1 -c 4096 -b 32 --trans_v
[aiter INFO] 2025-09-30 08:34:06.344 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:07.706 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.29588093615995 us/iter from cuda.Event
[W930 08:34:07.467418314 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 427, 12, 526, 435, 534}
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.87900000000002
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.39900000000034
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.4389999999999645
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.83899999999994
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239999999999782
[aiter INFO] 2025-09-30 08:34:07.877 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.2390000000004875
[aiter INFO] 2025-09-30 08:34:07.898 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            423.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          2,852.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,404.0              0.0         CPU        96410
[avg us/iter]                                                                                        NaN   NaN           34.0             33.4         NaN          NaN
[aiter INFO] 2025-09-30 08:34:07.939 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.42 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:09.266 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 183.341247315454 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:09.326 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38}
[aiter INFO] 2025-09-30 08:34:09.326 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.11900000000003
[aiter INFO] 2025-09-30 08:34:09.326 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.12
[aiter INFO] 2025-09-30 08:34:09.326 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.47900000000004
[aiter INFO] 2025-09-30 08:34:09.339 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          8,312.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.8         NaN          NaN
[aiter INFO] 2025-09-30 08:34:09.370 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.450891016438455 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:09.408 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:09.408 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 08:34:09.420 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            567.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:09.428 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    90.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:09.430 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:09.494 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.03133643499694 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:09.545 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {322, 482, 37, 489, 42, 9, 537, 47, 16, 20, 25, 317, 542, 31}
[aiter INFO] 2025-09-30 08:34:09.545 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-30 08:34:09.545 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.95899999999983
[aiter INFO] 2025-09-30 08:34:09.545 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000037
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.47899999999993
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.71999999999997
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.83899999999994
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.11900000000003
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.960000000000036
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-30 08:34:09.546 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.238999999999976
[aiter INFO] 2025-09-30 08:34:09.565 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            398.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          3,559.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,224.2              0.0         CPU        96410
[avg us/iter]                                                                                        NaN   NaN           42.2             42.1         NaN          NaN
[aiter INFO] 2025-09-30 08:34:09.565 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    42.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:10.141 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 177.33449511008686 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.279
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.519
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.399
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.47900000000004
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.68000000000006
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.71999999999997
[aiter INFO] 2025-09-30 08:34:10.201 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.84000000000003
[aiter INFO] 2025-09-30 08:34:10.214 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0          7,430.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             79.0         NaN          NaN
[aiter INFO] 2025-09-30 08:34:10.241 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.96061378333828 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:10.278 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {139, 6}
[aiter INFO] 2025-09-30 08:34:10.278 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.078999999999951
[aiter INFO] 2025-09-30 08:34:10.278 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 08:34:10.290 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            560.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:10.291 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    84.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:10.293 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:10.361 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.79888181403132 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {933, 38, 9, 42, 940, 14, 49, 20, 53, 25, 60, 31}
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.2390000000014
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.399
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.319000000000074
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999141
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.600000000000023
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.07900000000001
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.71899999999994
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999994
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 08:34:10.413 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.278999999999996
[aiter INFO] 2025-09-30 08:34:10.432 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            456.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,913.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,610.2              0.0         CPU        96410
[avg us/iter]                                                                                        NaN   NaN           46.1             46.0         NaN          NaN
[aiter INFO] 2025-09-30 08:34:10.433 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:11.350 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 293.3064073619276 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:11.572 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 08:34:11.573 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 201.87900000000002
[aiter INFO] 2025-09-30 08:34:11.585 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         19,713.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0            197.1         NaN          NaN
[aiter INFO] 2025-09-30 08:34:11.616 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.608494918240176 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:11.653 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:11.653 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.479000000000013
[aiter INFO] 2025-09-30 08:34:11.665 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            755.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              7.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:11.667 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   204.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:11.669 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:11.736 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.9339409063358 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 390, 383, 9, 42, 16, 49, 20, 27, 31}
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.639000000000124
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.43899999999985
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.44
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.15899999999999
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.839
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:34:11.787 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.999000000000024
[aiter INFO] 2025-09-30 08:34:11.806 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            462.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,681.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,369.6              0.0         CPU        96410
[avg us/iter]                                                                                        NaN   NaN           53.7             53.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:11.807 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    53.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:12.612 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 228.55250537395477 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 76, 12, 52, 116, 89, 25}
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.399
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.159
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.279
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.95999999999992
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.91999999999985
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.95999999999992
[aiter INFO] 2025-09-30 08:34:12.676 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.8
[aiter INFO] 2025-09-30 08:34:12.689 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         12,307.5        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            130.9         NaN          NaN
[aiter INFO] 2025-09-30 08:34:12.716 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.15110904775044 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:12.754 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 615}
[aiter INFO] 2025-09-30 08:34:12.754 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000001
[aiter INFO] 2025-09-30 08:34:12.754 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999796
[aiter INFO] 2025-09-30 08:34:12.766 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            751.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:12.767 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   138.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:12.772 - MainProcess:96410 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4096          32   (10, 1)        128          16  torch.bfloat16     1     True         33.4             0           90.5               0
1      4096          32   (10, 1)        128        1024  torch.bfloat16     1     True         42.1             0           84.7               0
2      4096          32   (10, 1)        128          16  torch.bfloat16     2     True         46.0             0          204.7               0
3      4096          32   (10, 1)        128        1024  torch.bfloat16     2     True         53.6             0          138.5               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(9), np.int64(7), np.int64(31)): arr1 = -0.034180, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(6), np.int64(1), np.int64(58)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(26), np.int64(7), np.int64(10)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(1), np.int64(3), np.int64(125)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(20), np.int64(4), np.int64(57)): arr1 = -0.025024, arr2 = -0.024902, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20178 (49.26%)
[1.0e-06, 1.0e-05): 1828 (4.46%)
[1.0e-05, 1.0e-04): 18266 (44.59%)
[1.0e-04, 1.0e-03): 688 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016756433760747313

Top differences:
Position (np.int64(26), np.int64(0), np.int64(11)): arr1 = 0.021606, arr2 = 0.019897, Diff = 0.001709
Position (np.int64(17), np.int64(7), np.int64(49)): arr1 = 0.019653, arr2 = 0.018066, Diff = 0.001587
Position (np.int64(22), np.int64(6), np.int64(21)): arr1 = -0.017090, arr2 = -0.015564, Diff = 0.001526
Position (np.int64(8), np.int64(3), np.int64(127)): arr1 = -0.021851, arr2 = -0.020386, Diff = 0.001465
Position (np.int64(7), np.int64(3), np.int64(5)): arr1 = -0.018433, arr2 = -0.016968, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1696 (4.14%)
[1.0e-06, 1.0e-05): 113 (0.28%)
[1.0e-05, 1.0e-04): 6210 (15.16%)
[1.0e-04, 1.0e-03): 32557 (79.48%)
[1.0e-03, 1.0e-02): 384 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=cf23783b9603b895d73ef9f4a887816a
triton_output_md5=85221cace1ff8ba029915e0f61e751ab
diff.abs.max=0.000244140625
max_diff_thr=0.0002362949016969651

Top differences:
Position (np.int64(19), np.int64(6), np.int64(88)): arr1 = 0.036133, arr2 = 0.036377, Diff = 0.000244
Position (np.int64(23), np.int64(9), np.int64(29)): arr1 = -0.035156, arr2 = -0.034912, Diff = 0.000244
Position (np.int64(19), np.int64(4), np.int64(88)): arr1 = 0.033447, arr2 = 0.033203, Diff = 0.000244
Position (np.int64(15), np.int64(1), np.int64(36)): arr1 = 0.018677, arr2 = 0.018555, Diff = 0.000122
Position (np.int64(12), np.int64(0), np.int64(122)): arr1 = 0.023682, arr2 = 0.023560, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20257 (49.46%)
[1.0e-06, 1.0e-05): 1795 (4.38%)
[1.0e-05, 1.0e-04): 18142 (44.29%)
[1.0e-04, 1.0e-03): 766 (1.87%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.0017242431640625
max_diff_thr=0.0017146151512861252

Top differences:
Position (np.int64(23), np.int64(7), np.int64(62)): arr1 = -0.003891, arr2 = -0.005615, Diff = 0.001724
Position (np.int64(28), np.int64(3), np.int64(38)): arr1 = -0.024170, arr2 = -0.022461, Diff = 0.001709
Position (np.int64(23), np.int64(1), np.int64(62)): arr1 = -0.006012, arr2 = -0.007599, Diff = 0.001587
Position (np.int64(31), np.int64(1), np.int64(74)): arr1 = -0.016724, arr2 = -0.015259, Diff = 0.001465
Position (np.int64(11), np.int64(7), np.int64(22)): arr1 = 0.020264, arr2 = 0.018799, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1677 (4.09%)
[1.0e-06, 1.0e-05): 131 (0.32%)
[1.0e-05, 1.0e-04): 6166 (15.05%)
[1.0e-04, 1.0e-03): 32598 (79.58%)
[1.0e-03, 1.0e-02): 388 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=91b862ace779651965ed36c5ba840fa9
triton_output_md5=60992cf605526e8d260c50bff8b3271f
diff.abs.max=0.000244140625
max_diff_thr=0.00023596035316586494

Top differences:
Position (np.int64(4), np.int64(2), np.int64(84)): arr1 = 0.034424, arr2 = 0.034668, Diff = 0.000244
Position (np.int64(4), np.int64(7), np.int64(84)): arr1 = 0.037109, arr2 = 0.036865, Diff = 0.000244
Position (np.int64(5), np.int64(7), np.int64(84)): arr1 = 0.034912, arr2 = 0.034668, Diff = 0.000244
Position (np.int64(45), np.int64(8), np.int64(47)): arr1 = -0.016724, arr2 = -0.016602, Diff = 0.000122
Position (np.int64(22), np.int64(5), np.int64(75)): arr1 = -0.016724, arr2 = -0.016846, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 40561 (49.51%)
[1.0e-06, 1.0e-05): 3629 (4.43%)
[1.0e-05, 1.0e-04): 36310 (44.32%)
[1.0e-04, 1.0e-03): 1420 (1.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.001678466796875
max_diff_thr=0.0016665151342749596

Top differences:
Position (np.int64(18), np.int64(3), np.int64(14)): arr1 = -0.008850, arr2 = -0.007172, Diff = 0.001678
Position (np.int64(12), np.int64(3), np.int64(10)): arr1 = 0.013184, arr2 = 0.011536, Diff = 0.001648
Position (np.int64(30), np.int64(3), np.int64(104)): arr1 = -0.027466, arr2 = -0.025879, Diff = 0.001587
Position (np.int64(36), np.int64(0), np.int64(27)): arr1 = 0.017944, arr2 = 0.016357, Diff = 0.001587
Position (np.int64(46), np.int64(6), np.int64(51)): arr1 = 0.020630, arr2 = 0.019043, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3415 (4.17%)
[1.0e-06, 1.0e-05): 260 (0.32%)
[1.0e-05, 1.0e-04): 12468 (15.22%)
[1.0e-04, 1.0e-03): 65006 (79.35%)
[1.0e-03, 1.0e-02): 771 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d412707e95f9a8d11cf559305eb64f4d
triton_output_md5=6d75d28db073b542190dcf004fa7e7d9
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(23), np.int64(3), np.int64(77)): arr1 = -0.035400, arr2 = -0.035645, Diff = 0.000244
Position (np.int64(23), np.int64(5), np.int64(77)): arr1 = -0.033691, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(6), np.int64(6), np.int64(91)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(42), np.int64(0), np.int64(2)): arr1 = 0.032471, arr2 = 0.032715, Diff = 0.000244
Position (np.int64(6), np.int64(2), np.int64(91)): arr1 = -0.035400, arr2 = -0.035156, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 41104 (50.18%)
[1.0e-06, 1.0e-05): 3472 (4.24%)
[1.0e-05, 1.0e-04): 35721 (43.60%)
[1.0e-04, 1.0e-03): 1623 (1.98%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.001790403388440609

Top differences:
Position (np.int64(2), np.int64(9), np.int64(70)): arr1 = 0.024536, arr2 = 0.022705, Diff = 0.001831
Position (np.int64(49), np.int64(7), np.int64(109)): arr1 = 0.015869, arr2 = 0.014221, Diff = 0.001648
Position (np.int64(36), np.int64(2), np.int64(69)): arr1 = -0.015991, arr2 = -0.014343, Diff = 0.001648
Position (np.int64(49), np.int64(7), np.int64(59)): arr1 = -0.018433, arr2 = -0.016846, Diff = 0.001587
Position (np.int64(4), np.int64(5), np.int64(35)): arr1 = -0.026855, arr2 = -0.025269, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3462 (4.23%)
[1.0e-06, 1.0e-05): 220 (0.27%)
[1.0e-05, 1.0e-04): 12354 (15.08%)
[1.0e-04, 1.0e-03): 65087 (79.45%)
[1.0e-03, 1.0e-02): 797 (0.97%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6dbdc6ac345b91b2038e229189a89124
triton_output_md5=f7888bfd05db0b5f4a611f0bb3d744e3
++ python ./test_pa_mtp.py -n 8,1 -c 4097 -b 32 --trans_v
[aiter INFO] 2025-09-30 08:34:24.292 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:25.648 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.42419811994722 us/iter from cuda.Event
[W930 08:34:25.409364967 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:34:25.819 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 08:34:25.819 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.43900000000008
[aiter INFO] 2025-09-30 08:34:25.819 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-30 08:34:25.840 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            495.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,900.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,396.8              0.0         CPU        96530
[avg us/iter]                                                                                        NaN   NaN           34.0             34.0         NaN          NaN
[aiter INFO] 2025-09-30 08:34:25.882 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:27.210 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 180.90558450410862 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:27.271 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12, 38}
[aiter INFO] 2025-09-30 08:34:27.271 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.11899999999997
[aiter INFO] 2025-09-30 08:34:27.271 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.08000000000004
[aiter INFO] 2025-09-30 08:34:27.271 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.24000000000001
[aiter INFO] 2025-09-30 08:34:27.271 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.67900000000003
[aiter INFO] 2025-09-30 08:34:27.284 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          8,202.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:27.315 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.63546539297198 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:27.353 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {125, 6}
[aiter INFO] 2025-09-30 08:34:27.353 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.358999999999924
[aiter INFO] 2025-09-30 08:34:27.353 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-30 08:34:27.365 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            683.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:34:27.373 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    91.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:27.375 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:27.440 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 127.45192115849788 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 163, 168, 9, 42, 75, 14, 47, 81, 20, 53, 24, 58, 31}
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.919000000000096
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.67899999999986
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.68000000000001
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.99899999999991
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.118999999999915
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.19900000000001
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.91899999999998
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000035
[aiter INFO] 2025-09-30 08:34:27.491 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:34:27.492 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.559999999999945
[aiter INFO] 2025-09-30 08:34:27.510 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            445.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          3,606.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,322.8              0.0         CPU        96530
[avg us/iter]                                                                                        NaN   NaN           43.2             43.1         NaN          NaN
[aiter INFO] 2025-09-30 08:34:27.511 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:28.082 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.795465451656 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 51, 25}
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.59899999999993
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.71900000000005
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.63900000000004
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.95899999999995
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.04000000000008
[aiter INFO] 2025-09-30 08:34:28.140 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.839
[aiter INFO] 2025-09-30 08:34:28.152 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 95.0            0.0          7,537.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             79.3         NaN          NaN
[aiter INFO] 2025-09-30 08:34:28.179 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.80138609964069 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 706, 6, 300, 440}
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.639000000000124
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999614
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999993
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599999999999909
[aiter INFO] 2025-09-30 08:34:28.216 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5590000000001965
[aiter INFO] 2025-09-30 08:34:28.228 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            663.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 08:34:28.229 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    86.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:28.231 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:28.299 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.41117853339358 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:28.350 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 42, 15, 49, 339, 20, 344, 26, 31}
[aiter INFO] 2025-09-30 08:34:28.350 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.678999999999974
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.95999999999998
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.47899999999993
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999896
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.19900000000007
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.59899999999999
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.6790000000000305
[aiter INFO] 2025-09-30 08:34:28.351 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.278999999999996
[aiter INFO] 2025-09-30 08:34:28.369 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            548.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,920.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,669.7              0.0         CPU        96530
[avg us/iter]                                                                                        NaN   NaN           46.7             46.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:28.370 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:29.282 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 293.6239809092909 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:29.501 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 08:34:29.502 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.11999999999998
[aiter INFO] 2025-09-30 08:34:29.514 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         19,900.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0            199.0         NaN          NaN
[aiter INFO] 2025-09-30 08:34:29.544 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.15306918367301 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:29.581 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:29.581 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-30 08:34:29.593 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            681.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-09-30 08:34:29.594 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   205.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:29.597 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:29.663 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.8515643754808 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {258, 38, 1083, 42, 9, 251, 911, 49, 16, 20, 53, 918, 1076, 27, 60, 31}
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999669
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.63900000000001
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000001033
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.15899999999999
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.200000000000045
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.71900000000005
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.638999999999214
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.599000000000046
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.19900000000001
[aiter INFO] 2025-09-30 08:34:29.714 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.63900000000001
[aiter INFO] 2025-09-30 08:34:29.715 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.799000000000888
[aiter INFO] 2025-09-30 08:34:29.715 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.76000000000022
[aiter INFO] 2025-09-30 08:34:29.715 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.718999999999994
[aiter INFO] 2025-09-30 08:34:29.715 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.679000000000087
[aiter INFO] 2025-09-30 08:34:29.715 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.87900000000002
[aiter INFO] 2025-09-30 08:34:29.733 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            529.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          4,532.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,458.6              0.0         CPU        96530
[avg us/iter]                                                                                        NaN   NaN           54.6             54.4         NaN          NaN
[aiter INFO] 2025-09-30 08:34:29.734 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    54.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:30.538 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 227.9152671004286 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:30.601 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {89, 38, 102, 76, 12, 56, 25}
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.43899999999996
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.79999999999995
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.8800000000001
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.48000000000002
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.88
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.399
[aiter INFO] 2025-09-30 08:34:30.602 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.75900000000001
[aiter INFO] 2025-09-30 08:34:30.614 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         12,319.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            131.1         NaN          NaN
[aiter INFO] 2025-09-30 08:34:30.641 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.87624743108702 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:30.678 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {27, 6}
[aiter INFO] 2025-09-30 08:34:30.678 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.31899999999996
[aiter INFO] 2025-09-30 08:34:30.678 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000013
[aiter INFO] 2025-09-30 08:34:30.690 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            672.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-09-30 08:34:30.691 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   137.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:30.696 - MainProcess:96530 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4097          32    (8, 1)        128          16  torch.bfloat16     1     True         34.0             0           91.5               0
1      4097          32    (8, 1)        128        1024  torch.bfloat16     1     True         43.1             0           86.3               0
2      4097          32    (8, 1)        128          16  torch.bfloat16     2     True         46.6             0          205.8               0
3      4097          32    (8, 1)        128        1024  torch.bfloat16     2     True         54.4             0          137.8               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023635073739569634

Top differences:
Position (np.int64(26), np.int64(7), np.int64(10)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(6), np.int64(4), np.int64(52)): arr1 = -0.037598, arr2 = -0.037842, Diff = 0.000244
Position (np.int64(13), np.int64(6), np.int64(114)): arr1 = -0.018799, arr2 = -0.018921, Diff = 0.000122
Position (np.int64(1), np.int64(5), np.int64(28)): arr1 = 0.016235, arr2 = 0.016357, Diff = 0.000122
Position (np.int64(7), np.int64(7), np.int64(20)): arr1 = 0.015991, arr2 = 0.016113, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16163 (49.33%)
[1.0e-06, 1.0e-05): 1424 (4.35%)
[1.0e-05, 1.0e-04): 14644 (44.69%)
[1.0e-04, 1.0e-03): 537 (1.64%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017507848097011447

Top differences:
Position (np.int64(27), np.int64(1), np.int64(79)): arr1 = 0.012756, arr2 = 0.010986, Diff = 0.001770
Position (np.int64(15), np.int64(3), np.int64(25)): arr1 = -0.025757, arr2 = -0.024170, Diff = 0.001587
Position (np.int64(15), np.int64(6), np.int64(25)): arr1 = -0.017944, arr2 = -0.016479, Diff = 0.001465
Position (np.int64(18), np.int64(5), np.int64(34)): arr1 = 0.027588, arr2 = 0.026123, Diff = 0.001465
Position (np.int64(15), np.int64(6), np.int64(51)): arr1 = 0.014709, arr2 = 0.013245, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1352 (4.13%)
[1.0e-06, 1.0e-05): 94 (0.29%)
[1.0e-05, 1.0e-04): 4967 (15.16%)
[1.0e-04, 1.0e-03): 26072 (79.57%)
[1.0e-03, 1.0e-02): 283 (0.86%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ac9b5dbd82d01264b608e7430b2ec861
triton_output_md5=bbec247b21820cd8339cb8aa2f82a30c
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(12), np.int64(3), np.int64(29)): arr1 = -0.036865, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(20), np.int64(7), np.int64(10)): arr1 = -0.031494, arr2 = -0.031250, Diff = 0.000244
Position (np.int64(24), np.int64(2), np.int64(26)): arr1 = -0.016724, arr2 = -0.016602, Diff = 0.000122
Position (np.int64(25), np.int64(5), np.int64(57)): arr1 = -0.018921, arr2 = -0.019043, Diff = 0.000122
Position (np.int64(15), np.int64(4), np.int64(127)): arr1 = -0.019897, arr2 = -0.020020, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16010 (48.86%)
[1.0e-06, 1.0e-05): 1511 (4.61%)
[1.0e-05, 1.0e-04): 14695 (44.85%)
[1.0e-04, 1.0e-03): 552 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016818837029859424

Top differences:
Position (np.int64(5), np.int64(2), np.int64(105)): arr1 = 0.026855, arr2 = 0.025146, Diff = 0.001709
Position (np.int64(30), np.int64(6), np.int64(117)): arr1 = 0.017822, arr2 = 0.016113, Diff = 0.001709
Position (np.int64(12), np.int64(6), np.int64(62)): arr1 = -0.008118, arr2 = -0.009705, Diff = 0.001587
Position (np.int64(12), np.int64(3), np.int64(115)): arr1 = -0.032715, arr2 = -0.031128, Diff = 0.001587
Position (np.int64(14), np.int64(5), np.int64(36)): arr1 = 0.020996, arr2 = 0.019409, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1384 (4.22%)
[1.0e-06, 1.0e-05): 87 (0.27%)
[1.0e-05, 1.0e-04): 5203 (15.88%)
[1.0e-04, 1.0e-03): 25750 (78.58%)
[1.0e-03, 1.0e-02): 344 (1.05%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=61bdd4040fe41f0a2ddb07a6b9dc8159
triton_output_md5=2d51d15c88a4ef0571d3cc525c6c56b5
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(39), np.int64(1), np.int64(67)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(7), np.int64(7), np.int64(62)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(18), np.int64(0), np.int64(37)): arr1 = 0.038086, arr2 = 0.037842, Diff = 0.000244
Position (np.int64(41), np.int64(2), np.int64(101)): arr1 = 0.033691, arr2 = 0.033936, Diff = 0.000244
Position (np.int64(1), np.int64(0), np.int64(94)): arr1 = -0.036865, arr2 = -0.036621, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 32764 (49.99%)
[1.0e-06, 1.0e-05): 2908 (4.44%)
[1.0e-05, 1.0e-04): 28795 (43.94%)
[1.0e-04, 1.0e-03): 1069 (1.63%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017774617299437523

Top differences:
Position (np.int64(37), np.int64(7), np.int64(32)): arr1 = -0.031982, arr2 = -0.030151, Diff = 0.001831
Position (np.int64(19), np.int64(5), np.int64(51)): arr1 = -0.027710, arr2 = -0.026001, Diff = 0.001709
Position (np.int64(32), np.int64(4), np.int64(77)): arr1 = -0.012573, arr2 = -0.010986, Diff = 0.001587
Position (np.int64(33), np.int64(6), np.int64(77)): arr1 = -0.012756, arr2 = -0.011169, Diff = 0.001587
Position (np.int64(41), np.int64(3), np.int64(114)): arr1 = -0.015991, arr2 = -0.014465, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 2752 (4.20%)
[1.0e-06, 1.0e-05): 205 (0.31%)
[1.0e-05, 1.0e-04): 10002 (15.26%)
[1.0e-04, 1.0e-03): 51960 (79.28%)
[1.0e-03, 1.0e-02): 617 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=134b0b94d6dffd74a9e804c73f66d4be
triton_output_md5=8f09931fd37aab7881b457ede4d35bc5
diff.abs.max=0.000244140625
max_diff_thr=0.00023657440033275634

Top differences:
Position (np.int64(24), np.int64(5), np.int64(86)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(2), np.int64(1), np.int64(2)): arr1 = -0.036865, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(46), np.int64(2), np.int64(100)): arr1 = 0.031738, arr2 = 0.031982, Diff = 0.000244
Position (np.int64(13), np.int64(5), np.int64(4)): arr1 = 0.033203, arr2 = 0.033447, Diff = 0.000244
Position (np.int64(58), np.int64(1), np.int64(107)): arr1 = 0.013123, arr2 = 0.013000, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 32671 (49.85%)
[1.0e-06, 1.0e-05): 2811 (4.29%)
[1.0e-05, 1.0e-04): 28916 (44.12%)
[1.0e-04, 1.0e-03): 1138 (1.74%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.001683501643128693

Top differences:
Position (np.int64(22), np.int64(2), np.int64(112)): arr1 = 0.016846, arr2 = 0.015137, Diff = 0.001709
Position (np.int64(16), np.int64(1), np.int64(25)): arr1 = -0.022217, arr2 = -0.020630, Diff = 0.001587
Position (np.int64(50), np.int64(4), np.int64(27)): arr1 = -0.033203, arr2 = -0.031738, Diff = 0.001465
Position (np.int64(37), np.int64(3), np.int64(117)): arr1 = 0.018066, arr2 = 0.016602, Diff = 0.001465
Position (np.int64(46), np.int64(0), np.int64(113)): arr1 = -0.018799, arr2 = -0.017334, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 2734 (4.17%)
[1.0e-06, 1.0e-05): 177 (0.27%)
[1.0e-05, 1.0e-04): 10005 (15.27%)
[1.0e-04, 1.0e-03): 51999 (79.34%)
[1.0e-03, 1.0e-02): 621 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=3f2a5b785b3af13a680fc4f303382503
triton_output_md5=340f6a9f1368e714a1ec41833c224210
++ python ./test_pa_mtp.py -n 8,1 -c 4096 -b 32 --trans_v
[aiter INFO] 2025-09-30 08:34:42.181 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:43.548 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.97149527545022 us/iter from cuda.Event
[W930 08:34:43.307734401 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 08:34:43.717 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 446, 12, 438}
[aiter INFO] 2025-09-30 08:34:43.717 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.360000000000014
[aiter INFO] 2025-09-30 08:34:43.717 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000342
[aiter INFO] 2025-09-30 08:34:43.717 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.439000000000021
[aiter INFO] 2025-09-30 08:34:43.717 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.5600000000004
[aiter INFO] 2025-09-30 08:34:43.738 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          2,860.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,353.7              0.0         CPU        96652
[avg us/iter]                                                                                        NaN   NaN           33.5             33.2         NaN          NaN
[aiter INFO] 2025-09-30 08:34:43.780 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:45.110 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 180.84380251936395 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:45.170 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 51, 12, 38}
[aiter INFO] 2025-09-30 08:34:45.170 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.91899999999998
[aiter INFO] 2025-09-30 08:34:45.170 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.19899999999996
[aiter INFO] 2025-09-30 08:34:45.170 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.279
[aiter INFO] 2025-09-30 08:34:45.170 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.43899999999996
[aiter INFO] 2025-09-30 08:34:45.183 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          8,204.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             84.6         NaN          NaN
[aiter INFO] 2025-09-30 08:34:45.215 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.36137616339297 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:45.252 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:45.252 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-30 08:34:45.264 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            565.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:45.273 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    90.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:45.275 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:45.340 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 126.24400979516528 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:45.394 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 47, 16, 20, 52, 56, 25, 31}
[aiter INFO] 2025-09-30 08:34:45.394 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.360000000000014
[aiter INFO] 2025-09-30 08:34:45.394 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.238999999999976
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.23900000000003
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000074
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.35899999999998
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.278999999999996
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 08:34:45.395 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.999000000000024
[aiter INFO] 2025-09-30 08:34:45.414 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            408.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,612.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,197.4              0.0         CPU        96652
[avg us/iter]                                                                                        NaN   NaN           42.0             41.9         NaN          NaN
[aiter INFO] 2025-09-30 08:34:45.415 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:45.992 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.15942576262032 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 103, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.07900000000006
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.19899999999996
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.71899999999994
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.79999999999998
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.67999999999995
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.519
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.719
[aiter INFO] 2025-09-30 08:34:46.050 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.71899999999994
[aiter INFO] 2025-09-30 08:34:46.063 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 93.0            0.0          7,316.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             78.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:46.090 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.92018818707749 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:46.127 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:46.127 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000004
[aiter INFO] 2025-09-30 08:34:46.140 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            565.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:46.141 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    84.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:46.142 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:46.211 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 131.842841606329 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:46.265 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 742, 9, 42, 16, 49, 735, 379, 20, 372, 27, 31}
[aiter INFO] 2025-09-30 08:34:46.265 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:34:46.265 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 08:34:46.265 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.71900000000005
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.759000000000015
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.759000000000015
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.959
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.19900000000007
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5989999999999895
[aiter INFO] 2025-09-30 08:34:46.266 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.559999999999945
[aiter INFO] 2025-09-30 08:34:46.285 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            443.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,876.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,564.5              0.0         CPU        96652
[avg us/iter]                                                                                        NaN   NaN           45.6             45.5         NaN          NaN
[aiter INFO] 2025-09-30 08:34:46.286 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    45.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:47.204 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 290.0287523718164 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:47.428 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {50, 12}
[aiter INFO] 2025-09-30 08:34:47.428 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.20000000000005
[aiter INFO] 2025-09-30 08:34:47.428 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 196.68
[aiter INFO] 2025-09-30 08:34:47.441 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         19,350.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0            195.5         NaN          NaN
[aiter INFO] 2025-09-30 08:34:47.471 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.43900015005971 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:47.508 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 08:34:47.508 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-30 08:34:47.520 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            570.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:47.521 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   201.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:47.524 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 08:34:47.590 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.7612766558581 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {768, 38, 775, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.199000000000524
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999178
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.120000000000005
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.79899999999998
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999969
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.27900000000005
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.759000000000015
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5989999999999895
[aiter INFO] 2025-09-30 08:34:47.641 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 08:34:47.642 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.63900000000001
[aiter INFO] 2025-09-30 08:34:47.660 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            442.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          4,571.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,287.8              0.0         CPU        96652
[avg us/iter]                                                                                        NaN   NaN           52.9             52.8         NaN          NaN
[aiter INFO] 2025-09-30 08:34:47.661 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    52.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:47.762 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 226.91169322127163 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1313, 38, 76, 12, 89, 60, 127}
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.6790000000001
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.11999999999995
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.32000000000005
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.8
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.59900000000005
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.23899999999992
[aiter INFO] 2025-09-30 08:34:47.823 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.72000000000003
[aiter INFO] 2025-09-30 08:34:47.835 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         12,293.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            130.8         NaN          NaN
[aiter INFO] 2025-09-30 08:34:47.862 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.28496053755874 us/iter from cuda.Event
[aiter INFO] 2025-09-30 08:34:47.899 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {27, 13, 6}
[aiter INFO] 2025-09-30 08:34:47.899 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-30 08:34:47.899 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.438999999999993
[aiter INFO] 2025-09-30 08:34:47.899 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-30 08:34:47.911 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            554.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 08:34:47.912 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   136.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 08:34:47.916 - MainProcess:96652 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:853 - <module>
summary:
   ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0      4096          32    (8, 1)        128          16  torch.bfloat16     1     True         33.2             0           90.2               0
1      4096          32    (8, 1)        128        1024  torch.bfloat16     1     True         41.9             0           84.3               0
2      4096          32    (8, 1)        128          16  torch.bfloat16     2     True         45.5             0          201.2               0
3      4096          32    (8, 1)        128        1024  torch.bfloat16     2     True         52.8             0          136.4               0
diff.abs.max=0.000244140625
max_diff_thr=0.00023651844821870327

Top differences:
Position (np.int64(6), np.int64(5), np.int64(58)): arr1 = -0.038330, arr2 = -0.038086, Diff = 0.000244
Position (np.int64(1), np.int64(5), np.int64(125)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(6), np.int64(4), np.int64(52)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(27), np.int64(2), np.int64(87)): arr1 = -0.037354, arr2 = -0.037109, Diff = 0.000244
Position (np.int64(30), np.int64(5), np.int64(43)): arr1 = -0.023682, arr2 = -0.023804, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 16107 (49.15%)
[1.0e-06, 1.0e-05): 1524 (4.65%)
[1.0e-05, 1.0e-04): 14577 (44.49%)
[1.0e-04, 1.0e-03): 560 (1.71%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.0015869140625
max_diff_thr=0.0015596880111843348

Top differences:
Position (np.int64(15), np.int64(6), np.int64(25)): arr1 = -0.019043, arr2 = -0.017456, Diff = 0.001587
Position (np.int64(18), np.int64(6), np.int64(9)): arr1 = 0.027466, arr2 = 0.025879, Diff = 0.001587
Position (np.int64(6), np.int64(7), np.int64(91)): arr1 = 0.008667, arr2 = 0.007111, Diff = 0.001556
Position (np.int64(7), np.int64(1), np.int64(124)): arr1 = -0.018066, arr2 = -0.016602, Diff = 0.001465
Position (np.int64(30), np.int64(1), np.int64(50)): arr1 = -0.015869, arr2 = -0.014404, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1416 (4.32%)
[1.0e-06, 1.0e-05): 96 (0.29%)
[1.0e-05, 1.0e-04): 5021 (15.32%)
[1.0e-04, 1.0e-03): 25946 (79.18%)
[1.0e-03, 1.0e-02): 289 (0.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=dea07ba715eb1600a8998f80ae5d16df
triton_output_md5=c5fe7fbb6c4fc1c979dd556d0dee6527
diff.abs.max=0.000244140625
max_diff_thr=0.00023640661675017327

Top differences:
Position (np.int64(9), np.int64(5), np.int64(62)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(22), np.int64(3), np.int64(17)): arr1 = 0.032959, arr2 = 0.033203, Diff = 0.000244
Position (np.int64(7), np.int64(3), np.int64(43)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(6), np.int64(3), np.int64(85)): arr1 = -0.035400, arr2 = -0.035156, Diff = 0.000244
Position (np.int64(19), np.int64(4), np.int64(88)): arr1 = 0.034180, arr2 = 0.034424, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 16268 (49.65%)
[1.0e-06, 1.0e-05): 1394 (4.25%)
[1.0e-05, 1.0e-04): 14505 (44.27%)
[1.0e-04, 1.0e-03): 601 (1.83%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017521600238978863

Top differences:
Position (np.int64(18), np.int64(2), np.int64(39)): arr1 = -0.011963, arr2 = -0.010193, Diff = 0.001770
Position (np.int64(4), np.int64(2), np.int64(88)): arr1 = -0.024048, arr2 = -0.022339, Diff = 0.001709
Position (np.int64(23), np.int64(7), np.int64(103)): arr1 = -0.028687, arr2 = -0.026978, Diff = 0.001709
Position (np.int64(23), np.int64(0), np.int64(87)): arr1 = -0.031982, arr2 = -0.030396, Diff = 0.001587
Position (np.int64(24), np.int64(5), np.int64(26)): arr1 = -0.027344, arr2 = -0.025757, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1326 (4.05%)
[1.0e-06, 1.0e-05): 83 (0.25%)
[1.0e-05, 1.0e-04): 5015 (15.30%)
[1.0e-04, 1.0e-03): 26019 (79.40%)
[1.0e-03, 1.0e-02): 325 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4dd8944fedf4ac69f6f49a3ae427f59b
triton_output_md5=da17c9f6e1181f10807bf39507ce942c
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(9), np.int64(2), np.int64(5)): arr1 = 0.031982, arr2 = 0.031738, Diff = 0.000244
Position (np.int64(5), np.int64(3), np.int64(84)): arr1 = 0.038818, arr2 = 0.038574, Diff = 0.000244
Position (np.int64(44), np.int64(2), np.int64(80)): arr1 = 0.017090, arr2 = 0.017212, Diff = 0.000122
Position (np.int64(30), np.int64(2), np.int64(64)): arr1 = 0.025879, arr2 = 0.025757, Diff = 0.000122
Position (np.int64(61), np.int64(6), np.int64(9)): arr1 = -0.026611, arr2 = -0.026733, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 32478 (49.56%)
[1.0e-06, 1.0e-05): 2827 (4.31%)
[1.0e-05, 1.0e-04): 29106 (44.41%)
[1.0e-04, 1.0e-03): 1125 (1.72%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.001682085799984634

Top differences:
Position (np.int64(33), np.int64(6), np.int64(77)): arr1 = -0.020630, arr2 = -0.018921, Diff = 0.001709
Position (np.int64(32), np.int64(4), np.int64(77)): arr1 = -0.017700, arr2 = -0.015991, Diff = 0.001709
Position (np.int64(6), np.int64(7), np.int64(19)): arr1 = -0.014160, arr2 = -0.012512, Diff = 0.001648
Position (np.int64(30), np.int64(0), np.int64(37)): arr1 = 0.012207, arr2 = 0.010681, Diff = 0.001526
Position (np.int64(52), np.int64(6), np.int64(49)): arr1 = 0.012024, arr2 = 0.010498, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 2820 (4.30%)
[1.0e-06, 1.0e-05): 166 (0.25%)
[1.0e-05, 1.0e-04): 9949 (15.18%)
[1.0e-04, 1.0e-03): 51944 (79.26%)
[1.0e-03, 1.0e-02): 657 (1.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f701d93281da24624484b553fd6bf948
triton_output_md5=5ebd3d60d4a7d61b4875d5f5cf1d4922
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(6), np.int64(2), np.int64(91)): arr1 = -0.035889, arr2 = -0.035645, Diff = 0.000244
Position (np.int64(14), np.int64(1), np.int64(64)): arr1 = -0.035889, arr2 = -0.036133, Diff = 0.000244
Position (np.int64(33), np.int64(0), np.int64(108)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(51), np.int64(1), np.int64(2)): arr1 = -0.037598, arr2 = -0.037354, Diff = 0.000244
Position (np.int64(23), np.int64(6), np.int64(77)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 32914 (50.22%)
[1.0e-06, 1.0e-05): 2794 (4.26%)
[1.0e-05, 1.0e-04): 28619 (43.67%)
[1.0e-04, 1.0e-03): 1209 (1.84%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017906171269714832

Top differences:
Position (np.int64(3), np.int64(5), np.int64(70)): arr1 = 0.024414, arr2 = 0.022583, Diff = 0.001831
Position (np.int64(37), np.int64(7), np.int64(27)): arr1 = 0.019897, arr2 = 0.018188, Diff = 0.001709
Position (np.int64(36), np.int64(0), np.int64(90)): arr1 = -0.017212, arr2 = -0.015625, Diff = 0.001587
Position (np.int64(50), np.int64(3), np.int64(93)): arr1 = -0.027344, arr2 = -0.025757, Diff = 0.001587
Position (np.int64(39), np.int64(6), np.int64(73)): arr1 = 0.022339, arr2 = 0.020752, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 2790 (4.26%)
[1.0e-06, 1.0e-05): 186 (0.28%)
[1.0e-05, 1.0e-04): 9762 (14.90%)
[1.0e-04, 1.0e-03): 52170 (79.61%)
[1.0e-03, 1.0e-02): 628 (0.96%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6effcd048ee3af2b9726b02e6e1a9bfc
triton_output_md5=2416f7425de48e2ce08333680ead1bb3
./run_triton.sh: line 271: unexpected EOF while looking for matching `"'
./run_triton.sh: line 290: syntax error: unexpected end of file
