++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=6
++ HIP_VISIBLE_DEVICES=6
++ run_triton_op
++ rm -rf /root/.triton/cache
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py -q 1
[aiter INFO] 2025-09-27 09:25:17.891 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:19.245 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.21146525368833 us/iter from cuda.Event
[W927 09:25:19.004271125 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-27 09:25:19.413 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 405, 407}
[aiter INFO] 2025-09-27 09:25:19.413 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.438999999999965
[aiter INFO] 2025-09-27 09:25:19.413 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.758999999999958
[aiter INFO] 2025-09-27 09:25:19.413 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999687
[aiter INFO] 2025-09-27 09:25:19.413 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.35899999999947
[aiter INFO] 2025-09-27 09:25:19.433 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            475.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,545.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,074.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           20.7             20.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:19.476 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    20.41 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:20.925 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.54096033844617 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:20.977 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:20.977 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.158999999999992
[aiter INFO] 2025-09-27 09:25:20.988 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,393.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.245 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.738455436607396 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:21.279 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:21.279 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-27 09:25:21.291 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            438.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.292 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:21.294 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:21.354 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.6672970859131 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 10, 372, 373}
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.879000000000133
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000069
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.238999999999976
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079999999999984
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519999999999982
[aiter INFO] 2025-09-27 09:25:21.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:25:21.424 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            423.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,059.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,515.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.424 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:21.506 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.49977211314852 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:21.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-27 09:25:21.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.399000000000001
[aiter INFO] 2025-09-27 09:25:21.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-09-27 09:25:21.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,284.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.599 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.6378217743765 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:21.635 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:21.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-27 09:25:21.647 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.648 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:21.649 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:21.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.38493051741382 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:21.814 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 10, 20, 21, 152, 153, 31, 32, 42, 43, 53, 54, 64, 65, 75, 76, 207, 208, 86, 87, 97, 98, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.958999999999833
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.839000000000169
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.119000000000028
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000019
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.91900000000004
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.079000000000065
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.198999999999955
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.360000000000014
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.678999999999974
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:21.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.479000000000042
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.998999999999796
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.159000000000106
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000142
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.67899999999986
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.95900000000006
[aiter INFO] 2025-09-27 09:25:21.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:21.835 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  87.0            0.0            410.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  87.0            0.0          1,304.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,988.8              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.9             19.7         NaN          NaN
[aiter INFO] 2025-09-27 09:25:21.835 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.72 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:22.003 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.63403978206144 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.054 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:22.054 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.079000000000008
[aiter INFO] 2025-09-27 09:25:22.064 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,397.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.090 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.22319810343261 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.238 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:22.239 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-27 09:25:22.251 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            436.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.252 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.34 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:22.254 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:22.313 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.07638596721215 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.364 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1010, 339, 340, 1011}
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.918999999999983
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.078999999999724
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.398999999999887
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.398999999999887
[aiter INFO] 2025-09-27 09:25:22.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-27 09:25:22.383 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            419.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,057.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,507.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.384 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:22.466 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.33741562614347 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.521 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 25, 12}
[aiter INFO] 2025-09-27 09:25:22.521 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000033
[aiter INFO] 2025-09-27 09:25:22.521 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000037
[aiter INFO] 2025-09-27 09:25:22.521 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999997
[aiter INFO] 2025-09-27 09:25:22.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,262.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.559 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.37960393918623 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.595 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:22.595 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-27 09:25:22.606 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.607 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:22.608 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:22.722 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.3049304615153 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 64, 65, 97, 98, 9, 42, 43, 75, 76, 108, 109, 12, 53, 54, 119, 120, 31}
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.6790000000000305
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.63900000000001
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999937
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000133
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.238999999999976
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.718999999999937
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.63900000000001
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-27 09:25:22.772 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.88000000000011
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.478999999999985
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.958999999999946
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:22.773 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.718999999999994
[aiter INFO] 2025-09-27 09:25:22.791 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            435.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          1,393.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,000.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           20.0             19.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:22.792 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
THREADS_PER_WARP=64
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(65), np.int64(1), np.int64(98)): arr1 = 0.550781, arr2 = 0.546875, Diff = 0.003906
Position (np.int64(117), np.int64(0), np.int64(96)): arr1 = -0.613281, arr2 = -0.617188, Diff = 0.003906
Position (np.int64(92), np.int64(4), np.int64(118)): arr1 = 0.578125, arr2 = 0.574219, Diff = 0.003906
Position (np.int64(99), np.int64(3), np.int64(16)): arr1 = 0.535156, arr2 = 0.531250, Diff = 0.003906
Position (np.int64(27), np.int64(1), np.int64(58)): arr1 = -0.574219, arr2 = -0.570312, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 48469 (59.17%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 799 (0.98%)
[1.0e-04, 1.0e-03): 28959 (35.35%)
[1.0e-03, 1.0e-02): 3687 (4.50%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0390625
max_diff_thr=0.03268710523843765

Top differences:
Position (np.int64(31), np.int64(2), np.int64(7)): arr1 = -0.667969, arr2 = -0.628906, Diff = 0.039062
Position (np.int64(76), np.int64(2), np.int64(116)): arr1 = -0.047607, arr2 = -0.083008, Diff = 0.035400
Position (np.int64(7), np.int64(2), np.int64(110)): arr1 = -0.566406, arr2 = -0.531250, Diff = 0.035156
Position (np.int64(98), np.int64(1), np.int64(24)): arr1 = 0.687500, arr2 = 0.652344, Diff = 0.035156
Position (np.int64(15), np.int64(4), np.int64(122)): arr1 = -0.550781, arr2 = -0.515625, Diff = 0.035156

Threshold statistics:
[0.0e+00, 1.0e-06): 3520 (4.30%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 24 (0.03%)
[1.0e-04, 1.0e-03): 5803 (7.08%)
[1.0e-03, 1.0e-02): 54087 (66.02%)
[1.0e-02, 1.0e-01): 18486 (22.57%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d3b89deb1befbea142fad45cbef5926b
triton_output_md5=6667642c9563e562612b193ae2905764
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(8), np.int64(4), np.int64(32)): arr1 = -0.523438, arr2 = -0.527344, Diff = 0.003906
Position (np.int64(23), np.int64(1), np.int64(117)): arr1 = -0.531250, arr2 = -0.535156, Diff = 0.003906
Position (np.int64(0), np.int64(1), np.int64(71)): arr1 = 0.503906, arr2 = 0.507812, Diff = 0.003906
Position (np.int64(4), np.int64(1), np.int64(15)): arr1 = -0.500000, arr2 = -0.503906, Diff = 0.003906
Position (np.int64(6), np.int64(2), np.int64(73)): arr1 = 0.523438, arr2 = 0.519531, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 12098 (59.07%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 189 (0.92%)
[1.0e-04, 1.0e-03): 7260 (35.45%)
[1.0e-03, 1.0e-02): 929 (4.54%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0390625
max_diff_thr=0.03457216918468475

Top differences:
Position (np.int64(12), np.int64(2), np.int64(50)): arr1 = 0.168945, arr2 = 0.129883, Diff = 0.039062
Position (np.int64(12), np.int64(2), np.int64(95)): arr1 = -0.511719, arr2 = -0.472656, Diff = 0.039062
Position (np.int64(12), np.int64(2), np.int64(13)): arr1 = 0.523438, arr2 = 0.488281, Diff = 0.035156
Position (np.int64(29), np.int64(3), np.int64(90)): arr1 = -0.118652, arr2 = -0.088867, Diff = 0.029785
Position (np.int64(6), np.int64(4), np.int64(99)): arr1 = -0.330078, arr2 = -0.300781, Diff = 0.029297

Threshold statistics:
[0.0e+00, 1.0e-06): 853 (4.17%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 3 (0.01%)
[1.0e-04, 1.0e-03): 1470 (7.18%)
[1.0e-03, 1.0e-02): 13534 (66.08%)
[1.0e-02, 1.0e-01): 4620 (22.56%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7590d04bca82e15bfb80da47440beacd
triton_output_md5=d2810def32b10691053a309f8756acdf
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(3), np.int64(4), np.int64(52)): arr1 = 0.273438, arr2 = 0.275391, Diff = 0.001953
Position (np.int64(60), np.int64(3), np.int64(2)): arr1 = -0.271484, arr2 = -0.269531, Diff = 0.001953
Position (np.int64(120), np.int64(0), np.int64(34)): arr1 = 0.326172, arr2 = 0.324219, Diff = 0.001953
Position (np.int64(26), np.int64(2), np.int64(88)): arr1 = -0.277344, arr2 = -0.275391, Diff = 0.001953
Position (np.int64(113), np.int64(3), np.int64(4)): arr1 = 0.251953, arr2 = 0.253906, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 47252 (57.68%)
[1.0e-06, 1.0e-05): 36 (0.04%)
[1.0e-05, 1.0e-04): 2603 (3.18%)
[1.0e-04, 1.0e-03): 31800 (38.82%)
[1.0e-03, 1.0e-02): 229 (0.28%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0224609375
max_diff_thr=0.01909722201526165

Top differences:
Position (np.int64(5), np.int64(2), np.int64(31)): arr1 = 0.271484, arr2 = 0.249023, Diff = 0.022461
Position (np.int64(38), np.int64(3), np.int64(4)): arr1 = -0.146484, arr2 = -0.125000, Diff = 0.021484
Position (np.int64(28), np.int64(4), np.int64(9)): arr1 = -0.298828, arr2 = -0.279297, Diff = 0.019531
Position (np.int64(85), np.int64(2), np.int64(5)): arr1 = -0.209961, arr2 = -0.191406, Diff = 0.018555
Position (np.int64(108), np.int64(3), np.int64(4)): arr1 = 0.195312, arr2 = 0.176758, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 3354 (4.09%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 115 (0.14%)
[1.0e-04, 1.0e-03): 13073 (15.96%)
[1.0e-03, 1.0e-02): 62837 (76.71%)
[1.0e-02, 1.0e-01): 2539 (3.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=975fba86826b797f06dbf2c5444ddfa8
triton_output_md5=e40d95516034703782c175971c58885b
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(29), np.int64(1), np.int64(112)): arr1 = -0.259766, arr2 = -0.257812, Diff = 0.001953
Position (np.int64(10), np.int64(2), np.int64(57)): arr1 = 0.267578, arr2 = 0.265625, Diff = 0.001953
Position (np.int64(0), np.int64(4), np.int64(108)): arr1 = 0.273438, arr2 = 0.271484, Diff = 0.001953
Position (np.int64(7), np.int64(1), np.int64(112)): arr1 = 0.308594, arr2 = 0.310547, Diff = 0.001953
Position (np.int64(9), np.int64(4), np.int64(70)): arr1 = -0.250000, arr2 = -0.251953, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 11751 (57.38%)
[1.0e-06, 1.0e-05): 7 (0.03%)
[1.0e-05, 1.0e-04): 682 (3.33%)
[1.0e-04, 1.0e-03): 7971 (38.92%)
[1.0e-03, 1.0e-02): 69 (0.34%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.01953125
max_diff_thr=0.017142856493592262

Top differences:
Position (np.int64(15), np.int64(0), np.int64(120)): arr1 = -0.246094, arr2 = -0.226562, Diff = 0.019531
Position (np.int64(30), np.int64(1), np.int64(97)): arr1 = -0.304688, arr2 = -0.285156, Diff = 0.019531
Position (np.int64(18), np.int64(2), np.int64(57)): arr1 = -0.129883, arr2 = -0.110840, Diff = 0.019043
Position (np.int64(8), np.int64(1), np.int64(111)): arr1 = -0.218750, arr2 = -0.201172, Diff = 0.017578
Position (np.int64(8), np.int64(3), np.int64(118)): arr1 = -0.087891, arr2 = -0.070312, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 841 (4.11%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 20 (0.10%)
[1.0e-04, 1.0e-03): 3158 (15.42%)
[1.0e-03, 1.0e-02): 15808 (77.19%)
[1.0e-02, 1.0e-01): 652 (3.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0cf87d43748184ac692aa11a1fbd1018
triton_output_md5=ac6f297f044e6acd9b6b91aecc225bbc
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(51), np.int64(4), np.int64(90)): arr1 = 0.250000, arr2 = 0.251953, Diff = 0.001953
Position (np.int64(70), np.int64(0), np.int64(107)): arr1 = -0.255859, arr2 = -0.253906, Diff = 0.001953
Position (np.int64(12), np.int64(0), np.int64(70)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953
Position (np.int64(2), np.int64(0), np.int64(29)): arr1 = 0.253906, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(53), np.int64(2), np.int64(83)): arr1 = -0.251953, arr2 = -0.253906, Diff = 0.001953[aiter INFO] 2025-09-27 09:25:22.959 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.84356467558605 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.008 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:25:23.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.03900000000067
[aiter INFO] 2025-09-27 09:25:23.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.079000000000008
[aiter INFO] 2025-09-27 09:25:23.019 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,367.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.77997036676596 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.078 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {286, 6}
[aiter INFO] 2025-09-27 09:25:23.078 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:23.078 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-27 09:25:23.090 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            432.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.090 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:23.093 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:23.151 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.13069280657437 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.201 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:23.201 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.91900000000004
[aiter INFO] 2025-09-27 09:25:23.201 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-27 09:25:23.220 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,070.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,502.5              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.0             15.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.220 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:23.302 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.04393069106753 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.357 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 90, 1312, 12}
[aiter INFO] 2025-09-27 09:25:23.357 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.31899999999996
[aiter INFO] 2025-09-27 09:25:23.357 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.31899999999996
[aiter INFO] 2025-09-27 09:25:23.357 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000233
[aiter INFO] 2025-09-27 09:25:23.357 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999982
[aiter INFO] 2025-09-27 09:25:23.369 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          1,248.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.395 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.37641579148793 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.431 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-27 09:25:23.431 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.638999999999214
[aiter INFO] 2025-09-27 09:25:23.431 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-27 09:25:23.443 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            292.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.444 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:23.445 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:23.558 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.50770292010638 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 9, 12, 20, 21, 86, 87}
[aiter INFO] 2025-09-27 09:25:23.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999992
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.319000000000017
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.11899999999997
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.91900000000004
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.359000000000037
[aiter INFO] 2025-09-27 09:25:23.717 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999896
[aiter INFO] 2025-09-27 09:25:23.735 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            457.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,460.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,981.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.8             19.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.736 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:23.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.86652515194204 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:23.957 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:25:23.957 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.879000000000815
[aiter INFO] 2025-09-27 09:25:23.957 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119
[aiter INFO] 2025-09-27 09:25:23.967 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,366.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:23.994 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.7019605011043 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.027 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:24.027 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.238999999999976
[aiter INFO] 2025-09-27 09:25:24.039 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            435.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.040 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:24.042 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:24.102 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.57540630704106 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.153 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:24.153 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000018
[aiter INFO] 2025-09-27 09:25:24.153 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-27 09:25:24.171 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,065.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,497.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.0             15.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.172 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    14.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:24.254 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.25183154450785 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 38, 779, 12, 25}
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000378
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999976
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999578
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-09-27 09:25:24.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.399000000000001
[aiter INFO] 2025-09-27 09:25:24.321 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          1,232.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.06276228020687 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.383 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:24.383 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:25:24.395 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.395 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:24.396 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:24.510 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.19916806834759 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 262, 263, 9, 12, 141, 142, 20, 21, 31, 32, 42, 43, 174, 175, 53, 54, 64, 65, 196, 197, 75, 76, 86, 87, 218, 219, 97, 98, 229, 230, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.95900000000006
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.798999999999978
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.839
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999896
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999999
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-27 09:25:24.560 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.95900000000006
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999937
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.95900000000006
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999896
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.878999999999905
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999937
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.959000000000287
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000028
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.680000000000064
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.7589999999999
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.07899999999995
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.03899999999976
[aiter INFO] 2025-09-27 09:25:24.561 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:24.562 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999878
[aiter INFO] 2025-09-27 09:25:24.562 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-27 09:25:24.562 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:25:24.562 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:24.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  83.0            0.0            390.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  83.0            0.0          1,233.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,976.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.8             19.6         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:24.748 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.68792141782176 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.797 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:25:24.797 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.198999999998705
[aiter INFO] 2025-09-27 09:25:24.797 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.399
[aiter INFO] 2025-09-27 09:25:24.807 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,366.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.834 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.62113855764417 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.867 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:24.867 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.198999999999984
[aiter INFO] 2025-09-27 09:25:24.879 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            436.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:24.879 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 46948 (57.31%)
[1.0e-06, 1.0e-05): 81 (0.10%)
[1.0e-05, 1.0e-04): 5118 (6.25%)
[1.0e-04, 1.0e-03): 29762 (36.33%)
[1.0e-03, 1.0e-02): 11 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.01416015625
max_diff_thr=0.012975391931831837

Top differences:
Position (np.int64(8), np.int64(0), np.int64(55)): arr1 = 0.105469, arr2 = 0.091309, Diff = 0.014160
Position (np.int64(18), np.int64(2), np.int64(75)): arr1 = 0.148438, arr2 = 0.134766, Diff = 0.013672
Position (np.int64(93), np.int64(1), np.int64(114)): arr1 = -0.205078, arr2 = -0.191406, Diff = 0.013672
Position (np.int64(10), np.int64(1), np.int64(60)): arr1 = -0.111816, arr2 = -0.098633, Diff = 0.013184
Position (np.int64(40), np.int64(1), np.int64(99)): arr1 = 0.071289, arr2 = 0.058350, Diff = 0.012939

Threshold statistics:
[0.0e+00, 1.0e-06): 3452 (4.21%)
[1.0e-06, 1.0e-05): 5 (0.01%)
[1.0e-05, 1.0e-04): 262 (0.32%)
[1.0e-04, 1.0e-03): 19206 (23.44%)
[1.0e-03, 1.0e-02): 58830 (71.81%)
[1.0e-02, 1.0e-01): 165 (0.20%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8e967b87a02141983a527cda16e7c64b
triton_output_md5=d6d8f6b5ea98c1de582132c8ea5fb240
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(6), np.int64(1), np.int64(122)): arr1 = -0.251953, arr2 = -0.250000, Diff = 0.001953
Position (np.int64(5), np.int64(4), np.int64(35)): arr1 = -0.261719, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(2), np.int64(0), np.int64(87)): arr1 = 0.251953, arr2 = 0.250000, Diff = 0.001953
Position (np.int64(0), np.int64(1), np.int64(73)): arr1 = -0.265625, arr2 = -0.263672, Diff = 0.001953
Position (np.int64(11), np.int64(3), np.int64(101)): arr1 = -0.126953, arr2 = -0.127930, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 11680 (57.03%)
[1.0e-06, 1.0e-05): 22 (0.11%)
[1.0e-05, 1.0e-04): 1286 (6.28%)
[1.0e-04, 1.0e-03): 7488 (36.56%)
[1.0e-03, 1.0e-02): 4 (0.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.012461058795452118

Top differences:
Position (np.int64(24), np.int64(1), np.int64(72)): arr1 = -0.110840, arr2 = -0.097168, Diff = 0.013672
Position (np.int64(25), np.int64(1), np.int64(15)): arr1 = 0.129883, arr2 = 0.117188, Diff = 0.012695
Position (np.int64(19), np.int64(0), np.int64(38)): arr1 = 0.082031, arr2 = 0.069336, Diff = 0.012695
Position (np.int64(22), np.int64(1), np.int64(36)): arr1 = -0.223633, arr2 = -0.210938, Diff = 0.012695
Position (np.int64(18), np.int64(0), np.int64(75)): arr1 = 0.021484, arr2 = 0.033936, Diff = 0.012451

Threshold statistics:
[0.0e+00, 1.0e-06): 862 (4.21%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 61 (0.30%)
[1.0e-04, 1.0e-03): 4730 (23.10%)
[1.0e-03, 1.0e-02): 14792 (72.23%)
[1.0e-02, 1.0e-01): 35 (0.17%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a543475d07e1d0fa37f38665ad61eb25
triton_output_md5=e83e16bf8dc40fc7763010bd2f5d7307
diff.abs.max=0.001953125
max_diff_thr=0.0015552099794149399

Top differences:
Position (np.int64(61), np.int64(0), np.int64(91)): arr1 = -0.259766, arr2 = -0.261719, Diff = 0.001953
Position (np.int64(109), np.int64(1), np.int64(45)): arr1 = 0.279297, arr2 = 0.277344, Diff = 0.001953
Position (np.int64(17), np.int64(1), np.int64(2)): arr1 = 0.257812, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(123), np.int64(0), np.int64(97)): arr1 = -0.279297, arr2 = -0.277344, Diff = 0.001953
Position (np.int64(18), np.int64(4), np.int64(18)): arr1 = -0.172852, arr2 = -0.171875, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 46678 (56.98%)
[1.0e-06, 1.0e-05): 84 (0.10%)
[1.0e-05, 1.0e-04): 5917 (7.22%)
[1.0e-04, 1.0e-03): 29237 (35.69%)
[1.0e-03, 1.0e-02): 4 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.012316154316067696

Top differences:
Position (np.int64(80), np.int64(1), np.int64(61)): arr1 = 0.187500, arr2 = 0.173828, Diff = 0.013672
Position (np.int64(70), np.int64(4), np.int64(4)): arr1 = -0.265625, arr2 = -0.251953, Diff = 0.013672
Position (np.int64(52), np.int64(1), np.int64(50)): arr1 = 0.168945, arr2 = 0.155273, Diff = 0.013672
Position (np.int64(117), np.int64(0), np.int64(51)): arr1 = 0.133789, arr2 = 0.121094, Diff = 0.012695
Position (np.int64(40), np.int64(3), np.int64(87)): arr1 = -0.070801, arr2 = -0.058105, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 3277 (4.00%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 276 (0.34%)
[1.0e-04, 1.0e-03): 20463 (24.98%)
[1.0e-03, 1.0e-02): 57830 (70.59%)
[1.0e-02, 1.0e-01): 72 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=197c601f03170b0e8481105eeecb3c66
triton_output_md5=82efb7e70df028553993ac99f5d4cab7
diff.abs.max=0.001953125
max_diff_thr=0.0015552099794149399

Top differences:
Position (np.int64(18), np.int64(2), np.int64(32)): arr1 = -0.253906, arr2 = -0.255859, Diff = 0.001953
Position (np.int64(25), np.int64(4), np.int64(54)): arr1 = -0.261719, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(20), np.int64(4), np.int64(110)): arr1 = 0.253906, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(23), np.int64(1), np.int64(56)): arr1 = -0.291016, arr2 = -0.292969, Diff = 0.001953
Position (np.int64(4), np.int64(1), np.int64(110)): arr1 = 0.153320, arr2 = 0.152344, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 11764 (57.44%)
[1.0e-06, 1.0e-05): 22 (0.11%)
[1.0e-05, 1.0e-04): 1395 (6.81%)
[1.0e-04, 1.0e-03): 7295 (35.62%)
[1.0e-03, 1.0e-02): 4 (0.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.01220703125
max_diff_thr=0.011201144196093082

Top differences:
Position (np.int64(6), np.int64(4), np.int64(53)): arr1 = 0.113281, arr2 = 0.101074, Diff = 0.012207
Position (np.int64(18), np.int64(0), np.int64(127)): arr1 = 0.112793, arr2 = 0.100586, Diff = 0.012207
Position (np.int64(18), np.int64(0), np.int64(35)): arr1 = -0.175781, arr2 = -0.164062, Diff = 0.011719
Position (np.int64(27), np.int64(2), np.int64(77)): arr1 = 0.081055, arr2 = 0.069336, Diff = 0.011719
Position (np.int64(15), np.int64(2), np.int64(27)): arr1 = 0.095215, arr2 = 0.083496, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 824 (4.02%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 86 (0.42%)
[1.0e-04, 1.0e-03): 5005 (24.44%)
[1.0e-03, 1.0e-02): 14541 (71.00%)
[1.0e-02, 1.0e-01): 24 (0.12%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2323a5ae6d99c6db1222c520d84a829c
triton_output_md5=32bb87448270cd9aa16fc5189f553c5c
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(68), np.int64(4), np.int64(33)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(113), np.int64(2), np.int64(41)): arr1 = 0.153320, arr2 = 0.152344, Diff = 0.000977
Position (np.int64(63), np.int64(3), np.int64(98)): arr1 = -0.131836, arr2 = -0.130859, Diff = 0.000977
Position (np.int64(75), np.int64(4), np.int64(73)): arr1 = 0.171875, arr2 = 0.172852, Diff = 0.000977
Position (np.int64(4), np.int64(2), np.int64(102)): arr1 = -0.180664, arr2 = -0.179688, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 47330 (57.78%)
[1.0e-06, 1.0e-05): 162 (0.20%)
[1.0e-05, 1.0e-04): 8836 (10.79%)
[1.0e-04, 1.0e-03): 25592 (31.24%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.01123046875
max_diff_thr=0.010159010998904705

Top differences:
Position (np.int64(60), np.int64(0), np.int64(34)): arr1 = -0.116699, arr2 = -0.105469, Diff = 0.011230
Position (np.int64(40), np.int64(1), np.int64(111)): arr1 = -0.101562, arr2 = -0.091309, Diff = 0.010254[aiter INFO] 2025-09-27 09:25:24.882 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:24.940 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.50375267184607 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:24.990 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:24.990 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.719000000000051
[aiter INFO] 2025-09-27 09:25:24.990 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-27 09:25:25.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,078.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,509.8              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:25.091 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.71361370015853 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.258 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 415}
[aiter INFO] 2025-09-27 09:25:25.258 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000007
[aiter INFO] 2025-09-27 09:25:25.258 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.358999999999924
[aiter INFO] 2025-09-27 09:25:25.270 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,279.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.297 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.03509897111666 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.334 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:25.334 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-27 09:25:25.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:25.348 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:25.462 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.31085120392318 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 21, 31, 32, 174, 175, 53, 54, 64, 65, 75, 76, 86, 87, 97, 98, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.35900000000001
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.758999999999958
[aiter INFO] 2025-09-27 09:25:25.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.55899999999997
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.279999999999973
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.278999999999996
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999928
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.71900000000005
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.680000000000064
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.919000000000096
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.759000000000015
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.59900000000016
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999969
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.759000000000015
[aiter INFO] 2025-09-27 09:25:25.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:25.532 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            423.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          1,357.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,993.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.9             19.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.532 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:25.701 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.99249484751483 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.751 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:25.751 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119
[aiter INFO] 2025-09-27 09:25:25.761 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,388.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.788 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.71390097861243 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.821 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {209, 6}
[aiter INFO] 2025-09-27 09:25:25.821 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:25.821 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.238999999999976
[aiter INFO] 2025-09-27 09:25:25.832 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            433.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.833 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:25.836 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:25.894 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.53976206555224 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:25.945 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {328, 329, 10, 9}
[aiter INFO] 2025-09-27 09:25:25.945 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.43899999999985
[aiter INFO] 2025-09-27 09:25:25.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:25:25.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-27 09:25:25.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-09-27 09:25:25.964 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,058.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,500.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.0             15.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:25.965 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:26.047 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.3991188613495 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.101 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:26.101 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.63900000000001
[aiter INFO] 2025-09-27 09:25:26.113 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,288.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.140 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.6140793169489 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.175 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:26.175 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.920000000000016
[aiter INFO] 2025-09-27 09:25:26.187 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.188 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:26.189 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:26.303 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.57262369960841 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.352 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 130, 131, 9, 10, 108, 109}
[aiter INFO] 2025-09-27 09:25:26.352 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999992
[aiter INFO] 2025-09-27 09:25:26.352 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:26.352 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.07899999999995
[aiter INFO] 2025-09-27 09:25:26.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.919000000000096
[aiter INFO] 2025-09-27 09:25:26.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.158999999999992
[aiter INFO] 2025-09-27 09:25:26.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:26.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-09-27 09:25:26.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.758999999999787
[aiter INFO] 2025-09-27 09:25:26.371 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            457.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,460.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,981.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.8             19.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.371 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:26.539 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.19168335553442 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 298, 12}
[aiter INFO] 2025-09-27 09:25:26.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.35900000000038
[aiter INFO] 2025-09-27 09:25:26.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.358999999999924
[aiter INFO] 2025-09-27 09:25:26.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.59899999999999
[aiter INFO] 2025-09-27 09:25:26.599 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,340.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.27858394915515 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.658 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {440, 650, 363, 6}
[aiter INFO] 2025-09-27 09:25:26.658 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.598999999999705
[aiter INFO] 2025-09-27 09:25:26.658 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-27 09:25:26.658 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-27 09:25:26.658 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-27 09:25:26.670 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            421.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.671 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(0), np.int64(4), np.int64(83)): arr1 = -0.212891, arr2 = -0.203125, Diff = 0.009766
Position (np.int64(61), np.int64(1), np.int64(29)): arr1 = -0.092773, arr2 = -0.083008, Diff = 0.009766
Position (np.int64(0), np.int64(0), np.int64(83)): arr1 = -0.221680, arr2 = -0.211914, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 3368 (4.11%)
[1.0e-06, 1.0e-05): 5 (0.01%)
[1.0e-05, 1.0e-04): 461 (0.56%)
[1.0e-04, 1.0e-03): 25534 (31.17%)
[1.0e-03, 1.0e-02): 52550 (64.15%)
[1.0e-02, 1.0e-01): 2 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9e47998bc526829f3e91e47b55764f7d
triton_output_md5=a15314d6afde519815075d1d888b44a1
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(24), np.int64(1), np.int64(122)): arr1 = -0.145508, arr2 = -0.146484, Diff = 0.000977
Position (np.int64(15), np.int64(4), np.int64(100)): arr1 = -0.144531, arr2 = -0.145508, Diff = 0.000977
Position (np.int64(1), np.int64(3), np.int64(16)): arr1 = -0.179688, arr2 = -0.180664, Diff = 0.000977
Position (np.int64(20), np.int64(2), np.int64(6)): arr1 = 0.134766, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(2), np.int64(4), np.int64(23)): arr1 = -0.131836, arr2 = -0.132812, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 11907 (58.14%)
[1.0e-06, 1.0e-05): 28 (0.14%)
[1.0e-05, 1.0e-04): 2207 (10.78%)
[1.0e-04, 1.0e-03): 6338 (30.95%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.009765625
max_diff_thr=0.008566797710955143

Top differences:
Position (np.int64(21), np.int64(3), np.int64(19)): arr1 = -0.168945, arr2 = -0.159180, Diff = 0.009766
Position (np.int64(22), np.int64(1), np.int64(119)): arr1 = -0.166992, arr2 = -0.157227, Diff = 0.009766
Position (np.int64(3), np.int64(1), np.int64(33)): arr1 = 0.067871, arr2 = 0.058838, Diff = 0.009033
Position (np.int64(29), np.int64(1), np.int64(7)): arr1 = 0.063477, arr2 = 0.054443, Diff = 0.009033
Position (np.int64(29), np.int64(4), np.int64(2)): arr1 = -0.147461, arr2 = -0.138672, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 852 (4.16%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 105 (0.51%)
[1.0e-04, 1.0e-03): 6461 (31.55%)
[1.0e-03, 1.0e-02): 13061 (63.77%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=de62666f2cd2b0c755d2a68b64913d17
triton_output_md5=6e8de6c483998aaa8ba42652b1dbba60
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(126), np.int64(0), np.int64(106)): arr1 = -0.133789, arr2 = -0.134766, Diff = 0.000977
Position (np.int64(103), np.int64(1), np.int64(87)): arr1 = -0.126953, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(63), np.int64(1), np.int64(49)): arr1 = -0.127930, arr2 = -0.128906, Diff = 0.000977
Position (np.int64(14), np.int64(4), np.int64(103)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(94), np.int64(0), np.int64(35)): arr1 = -0.141602, arr2 = -0.142578, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 46991 (57.36%)
[1.0e-06, 1.0e-05): 154 (0.19%)
[1.0e-05, 1.0e-04): 9981 (12.18%)
[1.0e-04, 1.0e-03): 24794 (30.27%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.009765625
max_diff_thr=0.009107467718422413

Top differences:
Position (np.int64(81), np.int64(0), np.int64(6)): arr1 = 0.082031, arr2 = 0.072266, Diff = 0.009766
Position (np.int64(113), np.int64(0), np.int64(77)): arr1 = 0.135742, arr2 = 0.126953, Diff = 0.008789
Position (np.int64(82), np.int64(2), np.int64(7)): arr1 = 0.179688, arr2 = 0.170898, Diff = 0.008789
Position (np.int64(11), np.int64(4), np.int64(8)): arr1 = -0.080566, arr2 = -0.071777, Diff = 0.008789
Position (np.int64(108), np.int64(2), np.int64(0)): arr1 = 0.139648, arr2 = 0.130859, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 3438 (4.20%)
[1.0e-06, 1.0e-05): 5 (0.01%)
[1.0e-05, 1.0e-04): 577 (0.70%)
[1.0e-04, 1.0e-03): 27450 (33.51%)
[1.0e-03, 1.0e-02): 50450 (61.58%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1570a4974f57e1790b520a3712862361
triton_output_md5=f77775f3b8b6519229d0ed3d3221daba
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(31), np.int64(1), np.int64(4)): arr1 = 0.148438, arr2 = 0.149414, Diff = 0.000977
Position (np.int64(12), np.int64(0), np.int64(19)): arr1 = 0.127930, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(31), np.int64(4), np.int64(18)): arr1 = 0.145508, arr2 = 0.144531, Diff = 0.000977
Position (np.int64(5), np.int64(2), np.int64(11)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(16), np.int64(0), np.int64(24)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 11709 (57.17%)
[1.0e-06, 1.0e-05): 29 (0.14%)
[1.0e-05, 1.0e-04): 2501 (12.21%)
[1.0e-04, 1.0e-03): 6241 (30.47%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0087890625
max_diff_thr=0.00802854634821415

Top differences:
Position (np.int64(12), np.int64(1), np.int64(16)): arr1 = -0.103516, arr2 = -0.094727, Diff = 0.008789
Position (np.int64(7), np.int64(1), np.int64(85)): arr1 = -0.141602, arr2 = -0.132812, Diff = 0.008789
Position (np.int64(31), np.int64(0), np.int64(77)): arr1 = -0.107910, arr2 = -0.099121, Diff = 0.008789
Position (np.int64(26), np.int64(3), np.int64(119)): arr1 = 0.125977, arr2 = 0.117188, Diff = 0.008789
Position (np.int64(2), np.int64(1), np.int64(77)): arr1 = 0.084473, arr2 = 0.076172, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 830 (4.05%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 145 (0.71%)
[1.0e-04, 1.0e-03): 7001 (34.18%)
[1.0e-03, 1.0e-02): 12503 (61.05%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f023444fad80ee42c28f2967867a47da
triton_output_md5=62e15213792ec5c33e4bd2a9a3890887
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(18), np.int64(4), np.int64(49)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(50), np.int64(4), np.int64(102)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(14), np.int64(2), np.int64(96)): arr1 = -0.134766, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(110), np.int64(2), np.int64(75)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(12), np.int64(4), np.int64(97)): arr1 = -0.069336, arr2 = -0.069824, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 47062 (57.45%)
[1.0e-06, 1.0e-05): 325 (0.40%)
[1.0e-05, 1.0e-04): 15966 (19.49%)
[1.0e-04, 1.0e-03): 18567 (22.66%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.006591796875
max_diff_thr=0.006488045211881399

Top differences:
Position (np.int64(18), np.int64(3), np.int64(70)): arr1 = 0.022583, arr2 = 0.015991, Diff = 0.006592
Position (np.int64(99), np.int64(4), np.int64(122)): arr1 = -0.069824, arr2 = -0.063477, Diff = 0.006348
Position (np.int64(89), np.int64(1), np.int64(32)): arr1 = -0.105469, arr2 = -0.099121, Diff = 0.006348
Position (np.int64(78), np.int64(0), np.int64(74)): arr1 = -0.030640, arr2 = -0.024414, Diff = 0.006226
Position (np.int64(116), np.int64(1), np.int64(62)): arr1 = -0.028198, arr2 = -0.021973, Diff = 0.006226

Threshold statistics:
[0.0e+00, 1.0e-06): 3333 (4.07%)
[1.0e-06, 1.0e-05): 12 (0.01%)
[1.0e-05, 1.0e-04): 1099 (1.34%)
[1.0e-04, 1.0e-03): 36724 (44.83%)
[1.0e-03, 1.0e-02): 40752 (49.75%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)[aiter INFO] 2025-09-27 09:25:26.673 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:26.732 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.99085153152447 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:26.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 405, 406}
[aiter INFO] 2025-09-27 09:25:26.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999999
[aiter INFO] 2025-09-27 09:25:26.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-27 09:25:26.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.559000000000196
[aiter INFO] 2025-09-27 09:25:26.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:25:26.800 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,064.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,506.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:26.801 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:26.883 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.58848539968528 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.056 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 12, 610}
[aiter INFO] 2025-09-27 09:25:27.056 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.479000000000042
[aiter INFO] 2025-09-27 09:25:27.056 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999997
[aiter INFO] 2025-09-27 09:25:27.056 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000487
[aiter INFO] 2025-09-27 09:25:27.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,265.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.095 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.824346543243614 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.131 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:27.131 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:25:27.143 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.144 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:27.145 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:27.260 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.39485183623758 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 97, 34, 67, 100, 9, 42, 75, 12, 45, 78, 20, 21, 53, 86, 56, 89, 31}
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.999000000000024
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119000000000142
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999937
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.759000000000015
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.519000000000005
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.038999999999987
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.559000000000026
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.319999999999936
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.319000000000187
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.919000000000096
[aiter INFO] 2025-09-27 09:25:27.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:27.312 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.359000000000037
[aiter INFO] 2025-09-27 09:25:27.330 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            437.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          2,182.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,861.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           28.6             28.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.330 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:27.504 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.94780220135604 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.554 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12, 38, 103}
[aiter INFO] 2025-09-27 09:25:27.554 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.159000000000106
[aiter INFO] 2025-09-27 09:25:27.554 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.91900000000001
[aiter INFO] 2025-09-27 09:25:27.555 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.03899999999999
[aiter INFO] 2025-09-27 09:25:27.555 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.0390000000001
[aiter INFO] 2025-09-27 09:25:27.565 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          4,319.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             44.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.708 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.82354479024906 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.741 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:27.741 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.15900000000002
[aiter INFO] 2025-09-27 09:25:27.753 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            515.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.754 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    49.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:27.756 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:27.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.84432667788893 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:27.867 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:27.867 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.199000000000012
[aiter INFO] 2025-09-27 09:25:27.867 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.759999999999991
[aiter INFO] 2025-09-27 09:25:27.885 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,118.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,549.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:27.886 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.50 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:27.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.5365939889804 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.025 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:28.025 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-09-27 09:25:28.037 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,308.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.063 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.37564377117865 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.099 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:28.099 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-27 09:25:28.111 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            338.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.112 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:28.113 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:28.227 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.07403975961232 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.277 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 23, 31, 34, 42, 45, 53, 56, 64, 67, 75, 78, 97, 867, 100, 870, 119, 122}
[aiter INFO] 2025-09-27 09:25:28.277 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.798999999999978
[aiter INFO] 2025-09-27 09:25:28.277 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:28.277 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.839
[aiter INFO] 2025-09-27 09:25:28.277 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.718999999999994
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.438999999999965
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.278999999999996
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.07899999999995
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.63900000000001
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.958999999999833
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.15899999999965
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999141
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.878999999999905
[aiter INFO] 2025-09-27 09:25:28.278 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:28.297 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            433.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,140.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,845.9              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           28.5             28.3         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.297 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:28.468 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.9469898667666 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.518 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:28.518 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.758999999999986
[aiter INFO] 2025-09-27 09:25:28.528 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,454.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             44.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.555 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.8520992162204 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.713 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:28.713 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5589999999999975
[aiter INFO] 2025-09-27 09:25:28.725 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            513.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.726 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    49.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:28.728 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:28.788 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.42573233111071 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 98, 131, 130, 328, 329, 9, 10, 174, 175}
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.159000000000106
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.958999999999833
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000021
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.95900000000006
[aiter INFO] 2025-09-27 09:25:28.841 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:25:28.860 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            414.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,050.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,530.8              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-27 09:25:28.861 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c33af0a66d414c462a39f089fa1bdab0
triton_output_md5=5183854b87a0d380e0ed40403a267c60
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(5), np.int64(1), np.int64(66)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(6), np.int64(0), np.int64(4)): arr1 = 0.095703, arr2 = 0.096191, Diff = 0.000488
Position (np.int64(25), np.int64(3), np.int64(38)): arr1 = 0.067871, arr2 = 0.068359, Diff = 0.000488
Position (np.int64(11), np.int64(2), np.int64(120)): arr1 = 0.064941, arr2 = 0.064453, Diff = 0.000488
Position (np.int64(20), np.int64(0), np.int64(109)): arr1 = -0.063965, arr2 = -0.064453, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 11688 (57.07%)
[1.0e-06, 1.0e-05): 81 (0.40%)
[1.0e-05, 1.0e-04): 4051 (19.78%)
[1.0e-04, 1.0e-03): 4660 (22.75%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0059051513671875
max_diff_thr=0.005895525682717562

Top differences:
Position (np.int64(31), np.int64(2), np.int64(110)): arr1 = 0.007538, arr2 = 0.001633, Diff = 0.005905
Position (np.int64(31), np.int64(1), np.int64(123)): arr1 = -0.046875, arr2 = -0.041016, Diff = 0.005859
Position (np.int64(19), np.int64(3), np.int64(20)): arr1 = 0.072266, arr2 = 0.066406, Diff = 0.005859
Position (np.int64(12), np.int64(2), np.int64(10)): arr1 = 0.039307, arr2 = 0.033447, Diff = 0.005859
Position (np.int64(12), np.int64(0), np.int64(16)): arr1 = 0.030396, arr2 = 0.024658, Diff = 0.005737

Threshold statistics:
[0.0e+00, 1.0e-06): 902 (4.40%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 297 (1.45%)
[1.0e-04, 1.0e-03): 9294 (45.38%)
[1.0e-03, 1.0e-02): 9982 (48.74%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2486262792d2274a411ebc3b25ec5ea1
triton_output_md5=4af71c3ceae9f10bd1bc70331d4a3e1e
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(106), np.int64(2), np.int64(50)): arr1 = -0.137695, arr2 = -0.138672, Diff = 0.000977
Position (np.int64(64), np.int64(3), np.int64(8)): arr1 = -0.136719, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(89), np.int64(4), np.int64(95)): arr1 = -0.139648, arr2 = -0.138672, Diff = 0.000977
Position (np.int64(37), np.int64(1), np.int64(83)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(9), np.int64(3), np.int64(22)): arr1 = -0.132812, arr2 = -0.133789, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 41881 (51.12%)
[1.0e-06, 1.0e-05): 339 (0.41%)
[1.0e-05, 1.0e-04): 15961 (19.48%)
[1.0e-04, 1.0e-03): 23739 (28.98%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.006487488280981779

Top differences:
Position (np.int64(88), np.int64(2), np.int64(23)): arr1 = -0.060547, arr2 = -0.053711, Diff = 0.006836
Position (np.int64(85), np.int64(3), np.int64(104)): arr1 = 0.040527, arr2 = 0.034180, Diff = 0.006348
Position (np.int64(41), np.int64(1), np.int64(98)): arr1 = -0.091797, arr2 = -0.085449, Diff = 0.006348
Position (np.int64(25), np.int64(1), np.int64(62)): arr1 = 0.014954, arr2 = 0.008606, Diff = 0.006348
Position (np.int64(47), np.int64(0), np.int64(52)): arr1 = 0.050781, arr2 = 0.044434, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 3294 (4.02%)
[1.0e-06, 1.0e-05): 22 (0.03%)
[1.0e-05, 1.0e-04): 1087 (1.33%)
[1.0e-04, 1.0e-03): 37160 (45.36%)
[1.0e-03, 1.0e-02): 40357 (49.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ed316af7544f667145391a08f892faa8
triton_output_md5=b34f91061f3d84e0639bef1271f008e9
diff.abs.max=0.0009765625
max_diff_thr=0.0008658008882775903

Top differences:
Position (np.int64(14), np.int64(4), np.int64(82)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(18), np.int64(2), np.int64(60)): arr1 = -0.138672, arr2 = -0.139648, Diff = 0.000977
Position (np.int64(18), np.int64(3), np.int64(60)): arr1 = -0.140625, arr2 = -0.141602, Diff = 0.000977
Position (np.int64(10), np.int64(2), np.int64(124)): arr1 = 0.126953, arr2 = 0.127930, Diff = 0.000977
Position (np.int64(28), np.int64(3), np.int64(52)): arr1 = -0.098145, arr2 = -0.097656, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 10345 (50.51%)
[1.0e-06, 1.0e-05): 105 (0.51%)
[1.0e-05, 1.0e-04): 4030 (19.68%)
[1.0e-04, 1.0e-03): 6000 (29.30%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0063934326171875
max_diff_thr=0.006377376150339842

Top differences:
Position (np.int64(28), np.int64(0), np.int64(41)): arr1 = -0.003876, arr2 = 0.002518, Diff = 0.006393
Position (np.int64(12), np.int64(1), np.int64(17)): arr1 = 0.067871, arr2 = 0.061523, Diff = 0.006348
Position (np.int64(11), np.int64(2), np.int64(39)): arr1 = -0.031250, arr2 = -0.025391, Diff = 0.005859
Position (np.int64(21), np.int64(0), np.int64(76)): arr1 = 0.095703, arr2 = 0.089844, Diff = 0.005859
Position (np.int64(31), np.int64(0), np.int64(34)): arr1 = -0.057617, arr2 = -0.052002, Diff = 0.005615

Threshold statistics:
[0.0e+00, 1.0e-06): 787 (3.84%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 280 (1.37%)
[1.0e-04, 1.0e-03): 9149 (44.67%)
[1.0e-03, 1.0e-02): 10259 (50.09%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=49e1a491084d55cbd6581d6481176780
triton_output_md5=124ecd9c53ac98e905480da7350984fc
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(7), np.int64(0), np.int64(52)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(29), np.int64(4), np.int64(88)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(100), np.int64(4), np.int64(59)): arr1 = -0.150391, arr2 = -0.149414, Diff = 0.000977
Position (np.int64(53), np.int64(1), np.int64(46)): arr1 = -0.127930, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(101), np.int64(2), np.int64(22)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 41485 (50.64%)
[1.0e-06, 1.0e-05): 309 (0.38%)
[1.0e-05, 1.0e-04): 16522 (20.17%)
[1.0e-04, 1.0e-03): 23604 (28.81%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00634765625
max_diff_thr=0.005922551266849041

Top differences:
Position (np.int64(39), np.int64(3), np.int64(120)): arr1 = -0.101562, arr2 = -0.095215, Diff = 0.006348
Position (np.int64(86), np.int64(1), np.int64(9)): arr1 = 0.078125, arr2 = 0.071777, Diff = 0.006348
Position (np.int64(47), np.int64(1), np.int64(10)): arr1 = -0.054199, arr2 = -0.048096, Diff = 0.006104
Position (np.int64(50), np.int64(0), np.int64(5)): arr1 = 0.035889, arr2 = 0.029907, Diff = 0.005981
Position (np.int64(127), np.int64(0), np.int64(101)): arr1 = -0.033691, arr2 = -0.027710, Diff = 0.005981

Threshold statistics:
[0.0e+00, 1.0e-06): 3293 (4.02%)
[1.0e-06, 1.0e-05): 15 (0.02%)
[1.0e-05, 1.0e-04): 1278 (1.56%)
[1.0e-04, 1.0e-03): 38751 (47.30%)
[1.0e-03, 1.0e-02): 38583 (47.10%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0d4c49eb52482d56a8a8d0d06855980a
triton_output_md5=3c799026970047378dc21202e11531d5
diff.abs.max=0.00048828125
max_diff_thr=0.0004720320866908878

Top differences:
Position (np.int64(28), np.int64(2), np.int64(17)): arr1 = -0.074707, arr2 = -0.075195, Diff = 0.000488
Position (np.int64(29), np.int64(2), np.int64(7)): arr1 = -0.075195, arr2 = -0.074707, Diff = 0.000488
Position (np.int64(6), np.int64(1), np.int64(109)): arr1 = 0.083496, arr2 = 0.083008, Diff = 0.000488[aiter INFO] 2025-09-27 09:25:28.944 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.99639606062729 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.000 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:29.000 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-09-27 09:25:29.012 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,313.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.039 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.75463378222862 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.075 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:29.075 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-27 09:25:29.087 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.088 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.51 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:29.089 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:29.205 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.16118779926018 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.255 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 34, 67, 9, 42, 75, 12, 45, 78, 20, 53, 23, 56, 31}
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.599000000000046
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999994
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.67900000000003
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.399
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.31899999999996
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.479000000000042
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.278999999999996
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-27 09:25:29.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.599000000000046
[aiter INFO] 2025-09-27 09:25:29.275 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            445.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          2,228.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,856.9              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           28.6             28.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.275 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.45 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:29.447 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.54701983220508 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.497 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:29.497 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.119
[aiter INFO] 2025-09-27 09:25:29.507 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,459.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             44.6         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.535 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.551831890155775 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.568 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {377, 6}
[aiter INFO] 2025-09-27 09:25:29.568 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.398999999999887
[aiter INFO] 2025-09-27 09:25:29.568 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-27 09:25:29.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            507.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.581 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    49.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:29.583 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:29.642 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.09385119570364 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.693 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:29.693 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000009
[aiter INFO] 2025-09-27 09:25:29.693 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-27 09:25:29.712 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,110.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,541.9              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.713 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.42 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:29.795 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.74135623001817 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.849 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-09-27 09:25:29.849 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999999905
[aiter INFO] 2025-09-27 09:25:29.850 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-09-27 09:25:29.861 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,293.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.888 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.64339591311936 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:29.923 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:29.923 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-27 09:25:29.935 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:29.936 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:29.937 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:30.052 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.1370296891373 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:30.221 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 9, 42, 13, 46, 20, 23, 31}
[aiter INFO] 2025-09-27 09:25:30.221 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.758999999999958
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.679
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.399
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.279000000000053
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.959000000000003
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-27 09:25:30.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.03899999999999
[aiter INFO] 2025-09-27 09:25:30.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            467.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          2,850.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,428.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           34.3             34.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:30.241 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    34.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:30.415 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 148.99454391238712 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 103, 935, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.47900000000004
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.519000000000005
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.438999999999965
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.15900000000056
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.72
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.71900000000005
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.639999999999986
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.35899999999998
[aiter INFO] 2025-09-27 09:25:30.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.278999999999996
[aiter INFO] 2025-09-27 09:25:30.477 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 92.0            0.0          5,125.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             55.7         NaN          NaN
[aiter INFO] 2025-09-27 09:25:30.640 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.063970159481066 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:30.673 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {489, 6}
[aiter INFO] 2025-09-27 09:25:30.673 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000087
[aiter INFO] 2025-09-27 09:25:30.674 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-27 09:25:30.685 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            617.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:30.686 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    61.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:30.689 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:30.748 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.35165327374298 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:30.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 141, 142}
[aiter INFO] 2025-09-27 09:25:30.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.238999999999976
[aiter INFO] 2025-09-27 09:25:30.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-27 09:25:30.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.07899999999995
[aiter INFO] 2025-09-27 09:25:30.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:25:30.821 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,462.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,908.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.1             19.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:30.821 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:30.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.10297043370728 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:30.961 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-27 09:25:30.962 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.038999999999987
[aiter INFO] 2025-09-27 09:25:30.962 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.399
[aiter INFO] 2025-09-27 09:25:30.974 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,290.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:31.000 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.33050483229137 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:31.037 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:31.037 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999991
[aiter INFO] 2025-09-27 09:25:31.048 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            391.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:31.049 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    27.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(16), np.int64(4), np.int64(41)): arr1 = -0.069824, arr2 = -0.070312, Diff = 0.000488
Position (np.int64(1), np.int64(3), np.int64(60)): arr1 = 0.077637, arr2 = 0.078125, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 10303 (50.31%)
[1.0e-06, 1.0e-05): 99 (0.48%)
[1.0e-05, 1.0e-04): 4071 (19.88%)
[1.0e-04, 1.0e-03): 6007 (29.33%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.005859375
max_diff_thr=0.00544121116399765

Top differences:
Position (np.int64(29), np.int64(0), np.int64(123)): arr1 = 0.138672, arr2 = 0.132812, Diff = 0.005859
Position (np.int64(12), np.int64(4), np.int64(45)): arr1 = 0.062012, arr2 = 0.056396, Diff = 0.005615
Position (np.int64(6), np.int64(1), np.int64(59)): arr1 = -0.037598, arr2 = -0.031982, Diff = 0.005615
Position (np.int64(21), np.int64(2), np.int64(120)): arr1 = 0.008423, arr2 = 0.003006, Diff = 0.005417
Position (np.int64(27), np.int64(2), np.int64(110)): arr1 = -0.079590, arr2 = -0.074219, Diff = 0.005371

Threshold statistics:
[0.0e+00, 1.0e-06): 822 (4.01%)
[1.0e-06, 1.0e-05): 2 (0.01%)
[1.0e-05, 1.0e-04): 305 (1.49%)
[1.0e-04, 1.0e-03): 9742 (47.57%)
[1.0e-03, 1.0e-02): 9609 (46.92%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2198bfaf9e98776b6c679f94364fbb42
triton_output_md5=36b620b57fb7f392b7d567221907f8f1
diff.abs.max=0.00048828125
max_diff_thr=0.00047014575102366507

Top differences:
Position (np.int64(124), np.int64(0), np.int64(62)): arr1 = -0.064453, arr2 = -0.063965, Diff = 0.000488
Position (np.int64(19), np.int64(4), np.int64(42)): arr1 = -0.064941, arr2 = -0.064453, Diff = 0.000488
Position (np.int64(124), np.int64(2), np.int64(113)): arr1 = 0.068848, arr2 = 0.069336, Diff = 0.000488
Position (np.int64(83), np.int64(3), np.int64(67)): arr1 = -0.068848, arr2 = -0.069336, Diff = 0.000488
Position (np.int64(90), np.int64(4), np.int64(6)): arr1 = -0.079590, arr2 = -0.079102, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 40715 (49.70%)
[1.0e-06, 1.0e-05): 615 (0.75%)
[1.0e-05, 1.0e-04): 22384 (27.32%)
[1.0e-04, 1.0e-03): 18206 (22.22%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0048828125
max_diff_thr=0.0046315789222717285

Top differences:
Position (np.int64(3), np.int64(2), np.int64(79)): arr1 = 0.074707, arr2 = 0.069824, Diff = 0.004883
Position (np.int64(13), np.int64(4), np.int64(51)): arr1 = 0.019409, arr2 = 0.014709, Diff = 0.004700
Position (np.int64(92), np.int64(4), np.int64(35)): arr1 = -0.042725, arr2 = -0.038086, Diff = 0.004639
Position (np.int64(79), np.int64(0), np.int64(127)): arr1 = 0.070312, arr2 = 0.065918, Diff = 0.004395
Position (np.int64(1), np.int64(3), np.int64(10)): arr1 = 0.020630, arr2 = 0.016357, Diff = 0.004272

Threshold statistics:
[0.0e+00, 1.0e-06): 3207 (3.91%)
[1.0e-06, 1.0e-05): 33 (0.04%)
[1.0e-05, 1.0e-04): 2126 (2.60%)
[1.0e-04, 1.0e-03): 48113 (58.73%)
[1.0e-03, 1.0e-02): 28441 (34.72%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=30502f8c1055643eaa1a6bc690005491
triton_output_md5=d2b52dd2fecbaa122d92f416f6c276fe
diff.abs.max=0.00048828125
max_diff_thr=0.0004593477351590991

Top differences:
Position (np.int64(31), np.int64(3), np.int64(105)): arr1 = -0.064941, arr2 = -0.064453, Diff = 0.000488
Position (np.int64(29), np.int64(0), np.int64(119)): arr1 = 0.064941, arr2 = 0.064453, Diff = 0.000488
Position (np.int64(18), np.int64(0), np.int64(116)): arr1 = 0.062500, arr2 = 0.062988, Diff = 0.000488
Position (np.int64(17), np.int64(2), np.int64(65)): arr1 = 0.063965, arr2 = 0.063477, Diff = 0.000488
Position (np.int64(25), np.int64(3), np.int64(58)): arr1 = -0.071777, arr2 = -0.071289, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 10284 (50.21%)
[1.0e-06, 1.0e-05): 150 (0.73%)
[1.0e-05, 1.0e-04): 5447 (26.60%)
[1.0e-04, 1.0e-03): 4599 (22.46%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.004638671875
max_diff_thr=0.0044247787445783615

Top differences:
Position (np.int64(6), np.int64(2), np.int64(9)): arr1 = -0.052979, arr2 = -0.048340, Diff = 0.004639
Position (np.int64(6), np.int64(0), np.int64(25)): arr1 = -0.083008, arr2 = -0.078613, Diff = 0.004395
Position (np.int64(10), np.int64(4), np.int64(117)): arr1 = -0.023682, arr2 = -0.019287, Diff = 0.004395
Position (np.int64(14), np.int64(3), np.int64(49)): arr1 = 0.020874, arr2 = 0.016602, Diff = 0.004272
Position (np.int64(21), np.int64(2), np.int64(68)): arr1 = -0.020264, arr2 = -0.016113, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 833 (4.07%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 508 (2.48%)
[1.0e-04, 1.0e-03): 12138 (59.27%)
[1.0e-03, 1.0e-02): 6997 (34.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=06d3c30b0687de324e239f5cc9d81008
triton_output_md5=c98a78d635799e7e8aa1091975c8b89c
diff.abs.max=0.00048828125
max_diff_thr=0.0004698144330177456

Top differences:
Position (np.int64(76), np.int64(1), np.int64(6)): arr1 = -0.067383, arr2 = -0.066895, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(91)): arr1 = -0.065430, arr2 = -0.065918, Diff = 0.000488
Position (np.int64(91), np.int64(0), np.int64(82)): arr1 = -0.064941, arr2 = -0.065430, Diff = 0.000488
Position (np.int64(111), np.int64(4), np.int64(70)): arr1 = -0.068359, arr2 = -0.067871, Diff = 0.000488
Position (np.int64(120), np.int64(0), np.int64(121)): arr1 = -0.063965, arr2 = -0.063477, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 41142 (50.22%)
[1.0e-06, 1.0e-05): 579 (0.71%)
[1.0e-05, 1.0e-04): 22079 (26.95%)
[1.0e-04, 1.0e-03): 18120 (22.12%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0048828125
max_diff_thr=0.004559963475912809

Top differences:
Position (np.int64(12), np.int64(4), np.int64(23)): arr1 = -0.075684, arr2 = -0.070801, Diff = 0.004883
Position (np.int64(112), np.int64(2), np.int64(29)): arr1 = -0.048584, arr2 = -0.043945, Diff = 0.004639
Position (np.int64(68), np.int64(1), np.int64(26)): arr1 = 0.050781, arr2 = 0.046143, Diff = 0.004639
Position (np.int64(121), np.int64(2), np.int64(5)): arr1 = 0.015381, arr2 = 0.019897, Diff = 0.004517
Position (np.int64(58), np.int64(2), np.int64(32)): arr1 = 0.035645, arr2 = 0.031128, Diff = 0.004517

Threshold statistics:
[0.0e+00, 1.0e-06): 3309 (4.04%)
[1.0e-06, 1.0e-05): 35 (0.04%)
[1.0e-05, 1.0e-04): 2149 (2.62%)
[1.0e-04, 1.0e-03): 48433 (59.12%)
[1.0e-03, 1.0e-02): 27994 (34.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=66cd8f4cc7d5c29ebc510a03249cdb07
triton_output_md5=78fc0c9ad5ae73178bbf375eb37f22ac
diff.abs.max=0.00048828125
max_diff_thr=0.0004595588252414018

Top differences:
Position (np.int64(22), np.int64(4), np.int64(20)): arr1 = 0.083008, arr2 = 0.082520, Diff = 0.000488
Position (np.int64(17), np.int64(3), np.int64(127)): arr1 = -0.067383, arr2 = -0.066895, Diff = 0.000488
Position (np.int64(0), np.int64(2), np.int64(65)): arr1 = 0.063965, arr2 = 0.063477, Diff = 0.000488
Position (np.int64(31), np.int64(0), np.int64(11)): arr1 = 0.070801, arr2 = 0.071289, Diff = 0.000488
Position (np.int64(14), np.int64(4), np.int64(18)): arr1 = -0.074707, arr2 = -0.074219, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 10220 (49.90%)
[1.0e-06, 1.0e-05): 149 (0.73%)
[1.0e-05, 1.0e-04): 5566 (27.18%)
[1.0e-04, 1.0e-03): 4545 (22.19%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00537109375[aiter INFO] 2025-09-27 09:25:31.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:31.178 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 217.69899041345803 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {482, 166, 9, 492, 1037, 177, 19, 1051}
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.52000000000044
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.96000000000004
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.79999999999995
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000342
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.87900000000081
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.1590000000001055
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.758999999999958
[aiter INFO] 2025-09-27 09:25:31.233 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.279000000000451
[aiter INFO] 2025-09-27 09:25:31.252 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            608.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0         12,586.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       13,597.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          136.0            136.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:31.252 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   136.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:32.086 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 384.9854852893565 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:32.158 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:32.158 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.15999999999997
[aiter INFO] 2025-09-27 09:25:32.169 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         29,619.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0            296.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:32.448 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.628732574163095 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:32.482 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 615}
[aiter INFO] 2025-09-27 09:25:32.482 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.319000000000017
[aiter INFO] 2025-09-27 09:25:32.482 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.679000000000087
[aiter INFO] 2025-09-27 09:25:32.494 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,209.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:32.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   308.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:32.497 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:32.559 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.12355514800194 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:32.609 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 966, 377, 42, 970, 9, 47, 16, 20, 372, 86, 25, 91, 31}
[aiter INFO] 2025-09-27 09:25:32.609 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-27 09:25:32.609 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.95899999999892
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.4789999999998145
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.438999999999965
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.39899999999997
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.478999999999928
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.91900000000004
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.07900000000018
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.358999999999924
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.479000000000042
[aiter INFO] 2025-09-27 09:25:32.610 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.759000000000015
[aiter INFO] 2025-09-27 09:25:32.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            422.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          3,542.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,234.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           42.3             42.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:32.629 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    42.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:32.720 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.45047529027013 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.23900000000003
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.67900000000003
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.119
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.99900000000002
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.67899999999997
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.56
[aiter INFO] 2025-09-27 09:25:32.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.91999999999996
[aiter INFO] 2025-09-27 09:25:32.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0          7,161.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             76.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:32.948 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.174851064634794 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:32.984 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:32.984 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.559000000000026
[aiter INFO] 2025-09-27 09:25:32.996 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            657.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-27 09:25:32.997 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    82.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:32.998 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:33.126 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 208.60269296877453 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19, 279, 1049, 162, 1059, 292, 293, 175, 304, 1080, 1081, 698, 580, 708, 709, 71, 591, 719, 83}
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.03999999999996
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.43899999999985
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.55899999999929
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.55899999999997
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.47899999999936
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.4789999999998145
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.0
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.558999999999969
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.4789999999998145
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.79899999999907
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.47899999999936
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.32000000000062
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.72000000000025
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000342
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.71900000000005
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.8789999999999
[aiter INFO] 2025-09-27 09:25:33.183 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.519000000000233
[aiter INFO] 2025-09-27 09:25:33.184 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.47899999999936
[aiter INFO] 2025-09-27 09:25:33.184 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999851
[aiter INFO] 2025-09-27 09:25:33.202 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            495.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0         11,264.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       12,911.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          129.1            129.2         NaN          NaN
[aiter INFO] 2025-09-27 09:25:33.202 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   129.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:33.857 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 365.36602926726385 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:33.926 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 37}
[aiter INFO] 2025-09-27 09:25:33.926 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 277.92
[aiter INFO] 2025-09-27 09:25:33.926 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 274.32
[aiter INFO] 2025-09-27 09:25:33.937 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         27,311.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0            275.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:34.132 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.25288128823337 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:34.165 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 671}
[aiter INFO] 2025-09-27 09:25:34.166 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.079000000000008
[aiter INFO] 2025-09-27 09:25:34.166 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000487
[aiter INFO] 2025-09-27 09:25:34.178 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            971.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:34.178 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   285.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:34.181 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:34.242 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 127.75534671722072 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 14, 47, 20, 53, 24, 57, 31}
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.519000000000005
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.91899999999998
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000074
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.759000000000015
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.55899999999997
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000037
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439999999999941
[aiter INFO] 2025-09-27 09:25:34.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.238999999999976
[aiter INFO] 2025-09-27 09:25:34.314 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            413.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          3,577.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,168.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           41.7             41.6         NaN          NaN
[aiter INFO] 2025-09-27 09:25:34.314 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:34.405 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.51857437355682 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 103, 12, 77, 753, 51, 25, 90}
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.07900000000006
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.95999999999998
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.399
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.03899999999999
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.88
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.47999999999956
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.43899999999996
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.99900000000002
[aiter INFO] 2025-09-27 09:25:34.461 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.63900000000001
[aiter INFO] 2025-09-27 09:25:34.473 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 92.0            0.0          6,979.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             75.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:34.500 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.83786130423593 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:34.536 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 223}
[aiter INFO] 2025-09-27 09:25:34.536 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.479000000000013
[aiter INFO] 2025-09-27 09:25:34.536 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999896
[aiter INFO] 2025-09-27 09:25:34.548 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            521.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:25:34.549 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    81.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

max_diff_thr=0.00512104295194149

Top differences:
Position (np.int64(30), np.int64(1), np.int64(110)): arr1 = -0.054199, arr2 = -0.048828, Diff = 0.005371
Position (np.int64(26), np.int64(1), np.int64(10)): arr1 = 0.012207, arr2 = 0.007812, Diff = 0.004395
Position (np.int64(12), np.int64(2), np.int64(5)): arr1 = 0.055420, arr2 = 0.051025, Diff = 0.004395
Position (np.int64(14), np.int64(0), np.int64(108)): arr1 = 0.020630, arr2 = 0.016602, Diff = 0.004028
Position (np.int64(17), np.int64(2), np.int64(62)): arr1 = 0.023926, arr2 = 0.019897, Diff = 0.004028

Threshold statistics:
[0.0e+00, 1.0e-06): 868 (4.24%)
[1.0e-06, 1.0e-05): 12 (0.06%)
[1.0e-05, 1.0e-04): 521 (2.54%)
[1.0e-04, 1.0e-03): 12140 (59.28%)
[1.0e-03, 1.0e-02): 6939 (33.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=28a93ceac7f3876cb9077d7c06902b3a
triton_output_md5=ec8ff288c8ba8b6890d550ab1a2b0d2c
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(17), np.int64(4), np.int64(52)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(36), np.int64(2), np.int64(87)): arr1 = 0.031738, arr2 = 0.031982, Diff = 0.000244
Position (np.int64(11), np.int64(4), np.int64(63)): arr1 = -0.033447, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(19), np.int64(3), np.int64(74)): arr1 = 0.031494, arr2 = 0.031250, Diff = 0.000244
Position (np.int64(80), np.int64(3), np.int64(1)): arr1 = -0.035889, arr2 = -0.036133, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40774 (49.77%)
[1.0e-06, 1.0e-05): 3542 (4.32%)
[1.0e-05, 1.0e-04): 36199 (44.19%)
[1.0e-04, 1.0e-03): 1405 (1.72%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001681479741819203

Top differences:
Position (np.int64(94), np.int64(1), np.int64(48)): arr1 = -0.018066, arr2 = -0.016357, Diff = 0.001709
Position (np.int64(109), np.int64(1), np.int64(109)): arr1 = -0.035645, arr2 = -0.033936, Diff = 0.001709
Position (np.int64(99), np.int64(2), np.int64(90)): arr1 = -0.019287, arr2 = -0.017578, Diff = 0.001709
Position (np.int64(56), np.int64(4), np.int64(5)): arr1 = 0.010925, arr2 = 0.009277, Diff = 0.001648
Position (np.int64(94), np.int64(2), np.int64(98)): arr1 = 0.015259, arr2 = 0.013672, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3480 (4.25%)
[1.0e-06, 1.0e-05): 225 (0.27%)
[1.0e-05, 1.0e-04): 12217 (14.91%)
[1.0e-04, 1.0e-03): 65266 (79.67%)
[1.0e-03, 1.0e-02): 732 (0.89%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=dec5a0bed7f0b7ba15205f555d2db088
triton_output_md5=f09c75200314de7fd20d8c000904b717
diff.abs.max=0.0001220703125
max_diff_thr=0.0001210360715049319

Top differences:
Position (np.int64(9), np.int64(4), np.int64(95)): arr1 = -0.017212, arr2 = -0.017334, Diff = 0.000122
Position (np.int64(3), np.int64(3), np.int64(23)): arr1 = -0.020874, arr2 = -0.020752, Diff = 0.000122
Position (np.int64(10), np.int64(0), np.int64(7)): arr1 = 0.016235, arr2 = 0.016113, Diff = 0.000122
Position (np.int64(19), np.int64(0), np.int64(66)): arr1 = -0.021240, arr2 = -0.021118, Diff = 0.000122
Position (np.int64(29), np.int64(1), np.int64(22)): arr1 = -0.018555, arr2 = -0.018677, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 10139 (49.51%)
[1.0e-06, 1.0e-05): 901 (4.40%)
[1.0e-05, 1.0e-04): 9082 (44.35%)
[1.0e-04, 1.0e-03): 358 (1.75%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001739501953125
max_diff_thr=0.0017279534367844462

Top differences:
Position (np.int64(4), np.int64(1), np.int64(33)): arr1 = -0.008423, arr2 = -0.006683, Diff = 0.001740
Position (np.int64(30), np.int64(1), np.int64(112)): arr1 = -0.019165, arr2 = -0.017456, Diff = 0.001709
Position (np.int64(29), np.int64(2), np.int64(66)): arr1 = -0.020630, arr2 = -0.019043, Diff = 0.001587
Position (np.int64(5), np.int64(3), np.int64(114)): arr1 = 0.015198, arr2 = 0.013733, Diff = 0.001465
Position (np.int64(12), np.int64(2), np.int64(31)): arr1 = -0.018188, arr2 = -0.016724, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 841 (4.11%)
[1.0e-06, 1.0e-05): 57 (0.28%)
[1.0e-05, 1.0e-04): 3134 (15.30%)
[1.0e-04, 1.0e-03): 16256 (79.38%)
[1.0e-03, 1.0e-02): 192 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=042dfa8a681f4bd63f7845d34adf0b3a
triton_output_md5=4e08dfaeb564de7e8f0827d2c7de61e7
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(124), np.int64(4), np.int64(68)): arr1 = 0.034424, arr2 = 0.034180, Diff = 0.000244
Position (np.int64(56), np.int64(2), np.int64(77)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(73), np.int64(1), np.int64(49)): arr1 = -0.032227, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(11), np.int64(3), np.int64(68)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(66), np.int64(0), np.int64(30)): arr1 = -0.035400, arr2 = -0.035156, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40748 (49.74%)
[1.0e-06, 1.0e-05): 3602 (4.40%)
[1.0e-05, 1.0e-04): 36159 (44.14%)
[1.0e-04, 1.0e-03): 1411 (1.72%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016776513075456023

Top differences:
Position (np.int64(15), np.int64(2), np.int64(56)): arr1 = -0.048096, arr2 = -0.046387, Diff = 0.001709
Position (np.int64(61), np.int64(0), np.int64(57)): arr1 = -0.020386, arr2 = -0.018677, Diff = 0.001709
Position (np.int64(103), np.int64(3), np.int64(38)): arr1 = -0.015442, arr2 = -0.013794, Diff = 0.001648
Position (np.int64(87), np.int64(4), np.int64(46)): arr1 = -0.011536, arr2 = -0.009888, Diff = 0.001648
Position (np.int64(100), np.int64(2), np.int64(40)): arr1 = -0.020630, arr2 = -0.019043, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3379 (4.12%)
[1.0e-06, 1.0e-05): 231 (0.28%)
[1.0e-05, 1.0e-04): 12536 (15.30%)
[1.0e-04, 1.0e-03): 65015 (79.36%)
[1.0e-03, 1.0e-02): 759 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d582aef8cf336855e91ecf9b55563d24
triton_output_md5=41fe8097b91a08ef4f2eb0ea6a6bdf02
diff.abs.max=0.000244140625
max_diff_thr=0.00023579344269819558

Top differences:
Position (np.int64(11), np.int64(1), np.int64(32)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(13), np.int64(4), np.int64(125)): arr1 = -0.020996, arr2 = -0.020874, Diff = 0.000122
Position (np.int64(9), np.int64(1), np.int64(101)): arr1 = -0.015869, arr2 = -0.015991, Diff = 0.000122
Position (np.int64(13), np.int64(4), np.int64(122)): arr1 = 0.018311, arr2 = 0.018188, Diff = 0.000122
Position (np.int64(24), np.int64(1), np.int64(13)): arr1 = -0.020020, arr2 = -0.020142, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 10151 (49.57%)
[1.0e-06, 1.0e-05): 891 (4.35%)
[1.0e-05, 1.0e-04): 9076 (44.32%)
[1.0e-04, 1.0e-03): 362 (1.77%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016756433760747313

Top differences:
Position (np.int64(31), np.int64(4), np.int64(123)): arr1 = 0.021606, arr2 = 0.019897, Diff = 0.001709
Position (np.int64(3), np.int64(3), np.int64(44)): arr1 = 0.002213, arr2 = 0.000687, Diff = 0.001526
Position (np.int64(29), np.int64(2), np.int64(62)): arr1 = -0.009216, arr2 = -0.007690, Diff = 0.001526
Position (np.int64(5), np.int64(4), np.int64(30)): arr1 = 0.018311, arr2 = 0.016846, Diff = 0.001465
Position (np.int64(21), np.int64(3), np.int64(50)): arr1 = -0.026978, arr2 = -0.025513, Diff = 0.001465[aiter INFO] 2025-09-27 09:25:34.550 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:34.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:142 - main_func
start build /root/.aiter/build/pa_58975c45fe227376bba4640961101191
hipcc -fPIC -D__HIP_PLATFORM_AMD__=1 -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_HCC__=1 -mllvm --lsr-drop-solution=1 -Wno-undefined-func-template -Wno-vla-cxx-extension -mllvm --amdgpu-kernarg-preload-count=16 -DLEGACY_HIPBLAS_DIRECT -U__HIP_NO_HALF_CONVERSIONS__ -DENABLE_FP8 -mllvm -amdgpu-coerce-illegal-types=1 -O3 -DUSE_PROF_API=1 -Wno-unused-result -DUSE_ROCM -fno-offload-uniform-block -Wno-switch-bool -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false --offload-arch=gfx942 -mllvm -enable-post-misched=0 -U__HIP_NO_HALF_OPERATORS__ -std=c++20 -I/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include -c pa_58975c45fe227376bba4640961101191.cpp -o pa_58975c45fe227376bba4640961101191.o
In file included from pa_58975c45fe227376bba4640961101191.cpp:1:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/quant_utils.cuh:19:
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_58975c45fe227376bba4640961101191.cpp:1:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/quant_utils.cuh:19:
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_58975c45fe227376bba4640961101191/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_58975c45fe227376bba4640961101191.o -o lib.so
[aiter INFO] 2025-09-27 09:25:54.467 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:220 - final_func
finish build /root/.aiter/build/pa_58975c45fe227376bba4640961101191, cost 19.85068109s
[aiter INFO] 2025-09-27 09:25:54.517 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.83482183324229 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:54.572 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 97, 98, 9, 42, 43, 108, 109, 10, 119, 53, 54, 86, 87, 153, 120, 152, 31}
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999814
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000069
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.67900000000003
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999992
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.4389999999999645
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999851
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.438999999999965
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.319000000000187
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.398999999999887
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.1590000000001055
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999851
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.958999999999833
[aiter INFO] 2025-09-27 09:25:54.573 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.918999999999983
[aiter INFO] 2025-09-27 09:25:54.592 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            678.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          1,387.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,254.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.5             22.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:54.593 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.45 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:55.223 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.19683163295878 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:55.273 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:55.273 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119
[aiter INFO] 2025-09-27 09:25:55.284 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,404.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:55.401 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.3724457754357 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:55.435 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {293, 6}
[aiter INFO] 2025-09-27 09:25:55.435 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:55.435 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:25:55.447 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            439.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:55.448 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:55.451 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:55.511 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.85424753167841 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 526, 527, 152, 153}
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.999000000000024
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.719000000000051
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.43899999999985
[aiter INFO] 2025-09-27 09:25:55.702 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:25:55.721 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            422.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,049.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,504.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.0             15.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:55.722 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:55.806 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.03597029896065 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:55.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {610, 12}
[aiter INFO] 2025-09-27 09:25:55.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.319999999999709
[aiter INFO] 2025-09-27 09:25:55.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000003
[aiter INFO] 2025-09-27 09:25:55.875 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,276.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:55.902 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.00060400219247 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:55.939 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:55.939 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-27 09:25:55.950 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:55.951 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:55.953 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:56.067 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.0700692723293 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.118 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 141, 142, 20, 21, 31, 32, 42, 43, 174, 175, 53, 54, 75, 76, 86, 87, 229, 230, 119, 120}
[aiter INFO] 2025-09-27 09:25:56.118 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.119000000000028
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.598999999999933
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.35899999999998
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.599000000000046
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.199000000000012
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.31899999999996
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.359000000000037
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.319000000000187
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000142
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.398999999999887
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000142
[aiter INFO] 2025-09-27 09:25:56.119 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999851
[aiter INFO] 2025-09-27 09:25:56.138 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            664.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          1,356.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,257.5              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.6             22.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.139 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:56.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.34731683695671 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.359 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:56.359 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.079000000000008
[aiter INFO] 2025-09-27 09:25:56.370 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,396.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.397 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.92497024471217 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.430 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 335}
[aiter INFO] 2025-09-27 09:25:56.430 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:25:56.430 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7599999999997635
[aiter INFO] 2025-09-27 09:25:56.442 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            439.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.443 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:56.446 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:56.506 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.67443599205205 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.558 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:56.558 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999969
[aiter INFO] 2025-09-27 09:25:56.558 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-27 09:25:56.577 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            432.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,077.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,510.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.577 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:56.660 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.57026747606768 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 116, 12}
[aiter INFO] 2025-09-27 09:25:56.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000001179
[aiter INFO] 2025-09-27 09:25:56.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.43999999999994
[aiter INFO] 2025-09-27 09:25:56.716 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.599000000000018
[aiter INFO] 2025-09-27 09:25:56.728 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,266.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.755 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.24019782023855 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.791 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:56.791 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-27 09:25:56.802 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            293.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.803 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:56.805 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:56.918 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.70927726750327 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 130, 131, 9, 10, 20, 21, 86, 87, 119, 120}
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.198999999999955
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.4389999999999645
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999995
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.31899999999996
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999999
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.638999999999896
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.639000000000124
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999814
[aiter INFO] 2025-09-27 09:25:56.969 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:25:56.988 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            699.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          1,430.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,248.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.5             22.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:56.988 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.42 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 820 (4.00%)
[1.0e-06, 1.0e-05): 51 (0.25%)
[1.0e-05, 1.0e-04): 3067 (14.98%)
[1.0e-04, 1.0e-03): 16325 (79.71%)
[1.0e-03, 1.0e-02): 217 (1.06%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=36fcec437f7c6d6935c436aa0fef292a
triton_output_md5=0f48e1b88b6a5feca3c5d374a85e6bb6
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(52), np.int64(3), np.int64(64)): arr1 = 0.609375, arr2 = 0.605469, Diff = 0.003906
Position (np.int64(44), np.int64(1), np.int64(9)): arr1 = -0.527344, arr2 = -0.523438, Diff = 0.003906
Position (np.int64(97), np.int64(2), np.int64(29)): arr1 = 0.585938, arr2 = 0.589844, Diff = 0.003906
Position (np.int64(65), np.int64(1), np.int64(73)): arr1 = -0.523438, arr2 = -0.527344, Diff = 0.003906
Position (np.int64(97), np.int64(2), np.int64(46)): arr1 = -0.824219, arr2 = -0.828125, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 76716 (58.53%)
[1.0e-06, 1.0e-05): 19 (0.01%)
[1.0e-05, 1.0e-04): 1203 (0.92%)
[1.0e-04, 1.0e-03): 46963 (35.83%)
[1.0e-03, 1.0e-02): 6171 (4.71%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0389404296875
max_diff_thr=0.03712756186723709

Top differences:
Position (np.int64(54), np.int64(6), np.int64(67)): arr1 = 0.009888, arr2 = 0.048828, Diff = 0.038940
Position (np.int64(36), np.int64(1), np.int64(1)): arr1 = 0.472656, arr2 = 0.435547, Diff = 0.037109
Position (np.int64(31), np.int64(6), np.int64(0)): arr1 = 0.148438, arr2 = 0.111328, Diff = 0.037109
Position (np.int64(13), np.int64(0), np.int64(83)): arr1 = 0.357422, arr2 = 0.320312, Diff = 0.037109
Position (np.int64(45), np.int64(4), np.int64(77)): arr1 = -0.550781, arr2 = -0.515625, Diff = 0.035156

Threshold statistics:
[0.0e+00, 1.0e-06): 5512 (4.21%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 57 (0.04%)
[1.0e-04, 1.0e-03): 9278 (7.08%)
[1.0e-03, 1.0e-02): 86897 (66.30%)
[1.0e-02, 1.0e-01): 29326 (22.37%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1de04fb78775042170099e08722b90cb
triton_output_md5=dc6426485d926f9fa30bea20217ef1d7
diff.abs.max=0.00390625
max_diff_thr=0.002597402548417449

Top differences:
Position (np.int64(5), np.int64(3), np.int64(99)): arr1 = 0.566406, arr2 = 0.562500, Diff = 0.003906
Position (np.int64(10), np.int64(2), np.int64(118)): arr1 = -0.589844, arr2 = -0.593750, Diff = 0.003906
Position (np.int64(21), np.int64(7), np.int64(62)): arr1 = 0.695312, arr2 = 0.691406, Diff = 0.003906
Position (np.int64(25), np.int64(7), np.int64(111)): arr1 = 0.593750, arr2 = 0.597656, Diff = 0.003906
Position (np.int64(0), np.int64(5), np.int64(82)): arr1 = 0.601562, arr2 = 0.605469, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 19058 (58.16%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 301 (0.92%)
[1.0e-04, 1.0e-03): 11899 (36.31%)
[1.0e-03, 1.0e-02): 1509 (4.61%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.03125
max_diff_thr=0.02700747549533844

Top differences:
Position (np.int64(22), np.int64(3), np.int64(74)): arr1 = 0.605469, arr2 = 0.574219, Diff = 0.031250
Position (np.int64(14), np.int64(2), np.int64(5)): arr1 = -0.361328, arr2 = -0.330078, Diff = 0.031250
Position (np.int64(11), np.int64(7), np.int64(127)): arr1 = 0.593750, arr2 = 0.562500, Diff = 0.031250
Position (np.int64(25), np.int64(4), np.int64(114)): arr1 = -0.496094, arr2 = -0.464844, Diff = 0.031250
Position (np.int64(22), np.int64(7), np.int64(74)): arr1 = 0.470703, arr2 = 0.439453, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 1496 (4.57%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 13 (0.04%)
[1.0e-04, 1.0e-03): 2477 (7.56%)
[1.0e-03, 1.0e-02): 21730 (66.31%)
[1.0e-02, 1.0e-01): 7052 (21.52%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9d26b9ce6cd7d289e0c164d14f51cc87
triton_output_md5=96ff52c3586e3b46f88f79ff8da72349
diff.abs.max=0.00390625
max_diff_thr=0.002597402548417449

Top differences:
Position (np.int64(45), np.int64(1), np.int64(75)): arr1 = 0.507812, arr2 = 0.503906, Diff = 0.003906
Position (np.int64(85), np.int64(4), np.int64(59)): arr1 = 0.291016, arr2 = 0.289062, Diff = 0.001953
Position (np.int64(83), np.int64(1), np.int64(69)): arr1 = -0.253906, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(60), np.int64(6), np.int64(67)): arr1 = -0.271484, arr2 = -0.273438, Diff = 0.001953
Position (np.int64(13), np.int64(6), np.int64(37)): arr1 = 0.255859, arr2 = 0.257812, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 75624 (57.70%)
[1.0e-06, 1.0e-05): 61 (0.05%)
[1.0e-05, 1.0e-04): 4092 (3.12%)
[1.0e-04, 1.0e-03): 50901 (38.83%)
[1.0e-03, 1.0e-02): 394 (0.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0234375
max_diff_thr=0.018668830394744873

Top differences:
Position (np.int64(49), np.int64(6), np.int64(117)): arr1 = -0.388672, arr2 = -0.365234, Diff = 0.023438
Position (np.int64(42), np.int64(2), np.int64(24)): arr1 = -0.225586, arr2 = -0.203125, Diff = 0.022461
Position (np.int64(15), np.int64(3), np.int64(39)): arr1 = -0.337891, arr2 = -0.316406, Diff = 0.021484
Position (np.int64(99), np.int64(7), np.int64(120)): arr1 = -0.240234, arr2 = -0.219727, Diff = 0.020508
Position (np.int64(78), np.int64(1), np.int64(77)): arr1 = -0.167969, arr2 = -0.147461, Diff = 0.020508

Threshold statistics:
[0.0e+00, 1.0e-06): 5487 (4.19%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 196 (0.15%)
[1.0e-04, 1.0e-03): 20985 (16.01%)
[1.0e-03, 1.0e-02): 100452 (76.64%)
[1.0e-02, 1.0e-01): 3952 (3.02%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2008dd08ef249840c6aa8b302d010a7d
triton_output_md5=9776af6e0696d948ef13989d125fbad8
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(2), np.int64(1), np.int64(87)): arr1 = 0.269531, arr2 = 0.267578, Diff = 0.001953
Position (np.int64(14), np.int64(5), np.int64(109)): arr1 = 0.312500, arr2 = 0.310547, Diff = 0.001953
Position (np.int64(27), np.int64(2), np.int64(1)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953
Position (np.int64(30), np.int64(5), np.int64(38)): arr1 = -0.250000, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(21), np.int64(1), np.int64(92)): arr1 = -0.283203, arr2 = -0.281250, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 18902 (57.68%)
[1.0e-06, 1.0e-05): 15 (0.05%)
[1.0e-05, 1.0e-04): 1021 (3.12%)
[1.0e-04, 1.0e-03): 12729 (38.85%)
[1.0e-03, 1.0e-02): 101 (0.31%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0205078125
max_diff_thr=0.01848980039358139

Top differences:
Position (np.int64(20), np.int64(0), np.int64(50)): arr1 = 0.172852, arr2 = 0.152344, Diff = 0.020508
Position (np.int64(20), np.int64(7), np.int64(20)): arr1 = -0.042236, arr2 = -0.023315, Diff = 0.018921
Position (np.int64(17), np.int64(2), np.int64(50)): arr1 = 0.196289, arr2 = 0.177734, Diff = 0.018555
Position (np.int64(30), np.int64(5), np.int64(101)): arr1 = 0.113770, arr2 = 0.095215, Diff = 0.018555
Position (np.int64(20), np.int64(7), np.int64(113)): arr1 = -0.189453, arr2 = -0.170898, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 1360 (4.15%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 60 (0.18%)
[1.0e-04, 1.0e-03): 5171 (15.78%)
[1.0e-03, 1.0e-02): 25132 (76.70%)
[1.0e-02, 1.0e-01): 1045 (3.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c8924ca3c7fc591b69651c71578d20af
triton_output_md5=ffdf102d1a627749b217d9bbca606aab
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(84), np.int64(6), np.int64(63)): arr1 = -0.257812, arr2 = -0.255859, Diff = 0.001953[aiter INFO] 2025-09-27 09:25:57.157 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.55405953083888 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.332 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:25:57.332 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.679000000000087
[aiter INFO] 2025-09-27 09:25:57.332 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.239000000000004
[aiter INFO] 2025-09-27 09:25:57.342 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,373.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.369 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.97606927510535 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.403 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {307, 293, 6}
[aiter INFO] 2025-09-27 09:25:57.403 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-27 09:25:57.404 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:57.404 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:25:57.415 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            434.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.416 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:57.420 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:57.479 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.04909917269603 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.532 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 339, 372, 340, 373, 471, 472}
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.079000000000008
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999978
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.43899999999985
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.358999999999469
[aiter INFO] 2025-09-27 09:25:57.533 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000342
[aiter INFO] 2025-09-27 09:25:57.551 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            418.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,042.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,508.5              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.552 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:57.635 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.01187146772253 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.691 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 662}
[aiter INFO] 2025-09-27 09:25:57.691 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.398999999999432
[aiter INFO] 2025-09-27 09:25:57.692 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.919999999999987
[aiter INFO] 2025-09-27 09:25:57.692 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.319000000000415
[aiter INFO] 2025-09-27 09:25:57.703 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,260.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.730 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.116613709985614 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 685, 6, 111}
[aiter INFO] 2025-09-27 09:25:57.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.67899999999986
[aiter INFO] 2025-09-27 09:25:57.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.238999999999578
[aiter INFO] 2025-09-27 09:25:57.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-27 09:25:57.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.63900000000001
[aiter INFO] 2025-09-27 09:25:57.778 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            286.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.779 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:57.780 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:57.896 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.45979221563528 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 42, 75, 43, 76, 10}
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.758999999999986
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.63900000000001
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.599000000000046
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-27 09:25:57.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:25:57.965 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            726.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,494.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,268.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.7             22.7         NaN          NaN
[aiter INFO] 2025-09-27 09:25:57.966 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.66 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:58.136 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.95049500052292 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.187 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:58.187 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.15900000000002
[aiter INFO] 2025-09-27 09:25:58.197 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,396.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.224 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.52138616218426 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.257 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 391}
[aiter INFO] 2025-09-27 09:25:58.257 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:25:58.257 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:25:58.269 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            439.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.269 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:58.273 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:58.332 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.63287119464118 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.384 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:25:58.384 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-09-27 09:25:58.384 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-27 09:25:58.402 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,082.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,514.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.403 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:58.486 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.38651498709575 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.541 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:25:58.541 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000007
[aiter INFO] 2025-09-27 09:25:58.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,291.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.21762377820393 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.615 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:58.615 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:25:58.627 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:58.629 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:58.742 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.68949509080093 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 163, 165, 9, 42, 43, 75, 76, 108, 109, 12, 53, 54, 86, 87}
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.320000000000164
[aiter INFO] 2025-09-27 09:25:58.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.959000000000003
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.559000000000083
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519999999999982
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.999000000000024
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.319000000000074
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.31899999999996
[aiter INFO] 2025-09-27 09:25:58.920 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-27 09:25:58.938 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            689.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          1,400.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,256.9              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.6             22.5         NaN          NaN
[aiter INFO] 2025-09-27 09:25:58.939 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(73), np.int64(6), np.int64(99)): arr1 = 0.265625, arr2 = 0.267578, Diff = 0.001953
Position (np.int64(60), np.int64(4), np.int64(78)): arr1 = 0.271484, arr2 = 0.273438, Diff = 0.001953
Position (np.int64(85), np.int64(6), np.int64(117)): arr1 = -0.257812, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(35), np.int64(6), np.int64(72)): arr1 = -0.261719, arr2 = -0.263672, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 75346 (57.48%)
[1.0e-06, 1.0e-05): 139 (0.11%)
[1.0e-05, 1.0e-04): 8342 (6.36%)
[1.0e-04, 1.0e-03): 47228 (36.03%)
[1.0e-03, 1.0e-02): 17 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0146484375
max_diff_thr=0.013181019574403763

Top differences:
Position (np.int64(91), np.int64(5), np.int64(36)): arr1 = 0.125977, arr2 = 0.111328, Diff = 0.014648
Position (np.int64(105), np.int64(7), np.int64(23)): arr1 = 0.144531, arr2 = 0.129883, Diff = 0.014648
Position (np.int64(58), np.int64(1), np.int64(45)): arr1 = -0.134766, arr2 = -0.120605, Diff = 0.014160
Position (np.int64(59), np.int64(0), np.int64(38)): arr1 = 0.142578, arr2 = 0.128906, Diff = 0.013672
Position (np.int64(44), np.int64(2), np.int64(43)): arr1 = -0.196289, arr2 = -0.182617, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 5474 (4.18%)
[1.0e-06, 1.0e-05): 11 (0.01%)
[1.0e-05, 1.0e-04): 430 (0.33%)
[1.0e-04, 1.0e-03): 30715 (23.43%)
[1.0e-03, 1.0e-02): 94188 (71.86%)
[1.0e-02, 1.0e-01): 254 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ead357de932fd82d5cbf0116c3637a1d
triton_output_md5=3763e11d05cf09146905f0c78e58ef47
diff.abs.max=0.001953125
max_diff_thr=0.0015408321050927043

Top differences:
Position (np.int64(18), np.int64(3), np.int64(67)): arr1 = 0.265625, arr2 = 0.267578, Diff = 0.001953
Position (np.int64(9), np.int64(6), np.int64(18)): arr1 = -0.158203, arr2 = -0.157227, Diff = 0.000977
Position (np.int64(21), np.int64(2), np.int64(122)): arr1 = 0.213867, arr2 = 0.212891, Diff = 0.000977
Position (np.int64(30), np.int64(1), np.int64(114)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(26), np.int64(0), np.int64(116)): arr1 = -0.161133, arr2 = -0.162109, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 19050 (58.14%)
[1.0e-06, 1.0e-05): 19 (0.06%)
[1.0e-05, 1.0e-04): 1999 (6.10%)
[1.0e-04, 1.0e-03): 11699 (35.70%)
[1.0e-03, 1.0e-02): 1 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0126953125
max_diff_thr=0.011690647341310978

Top differences:
Position (np.int64(23), np.int64(7), np.int64(111)): arr1 = -0.098633, arr2 = -0.085938, Diff = 0.012695
Position (np.int64(7), np.int64(2), np.int64(38)): arr1 = -0.205078, arr2 = -0.192383, Diff = 0.012695
Position (np.int64(17), np.int64(6), np.int64(44)): arr1 = 0.188477, arr2 = 0.175781, Diff = 0.012695
Position (np.int64(18), np.int64(4), np.int64(114)): arr1 = -0.170898, arr2 = -0.158203, Diff = 0.012695
Position (np.int64(18), np.int64(4), np.int64(34)): arr1 = -0.137695, arr2 = -0.125000, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1343 (4.10%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 106 (0.32%)
[1.0e-04, 1.0e-03): 7605 (23.21%)
[1.0e-03, 1.0e-02): 23660 (72.20%)
[1.0e-02, 1.0e-01): 54 (0.16%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ae6fc925ec89b7498cb111b6b96afa09
triton_output_md5=728087c2e49303b5f7738a7c832f570c
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(35), np.int64(5), np.int64(36)): arr1 = -0.277344, arr2 = -0.275391, Diff = 0.001953
Position (np.int64(87), np.int64(1), np.int64(110)): arr1 = -0.257812, arr2 = -0.255859, Diff = 0.001953
Position (np.int64(81), np.int64(3), np.int64(91)): arr1 = 0.269531, arr2 = 0.271484, Diff = 0.001953
Position (np.int64(69), np.int64(3), np.int64(105)): arr1 = 0.279297, arr2 = 0.277344, Diff = 0.001953
Position (np.int64(12), np.int64(4), np.int64(118)): arr1 = 0.250000, arr2 = 0.251953, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 75131 (57.32%)
[1.0e-06, 1.0e-05): 138 (0.11%)
[1.0e-05, 1.0e-04): 9459 (7.22%)
[1.0e-04, 1.0e-03): 46338 (35.35%)
[1.0e-03, 1.0e-02): 6 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.012540134601294994

Top differences:
Position (np.int64(100), np.int64(6), np.int64(69)): arr1 = 0.234375, arr2 = 0.220703, Diff = 0.013672
Position (np.int64(124), np.int64(3), np.int64(110)): arr1 = -0.184570, arr2 = -0.171875, Diff = 0.012695
Position (np.int64(95), np.int64(7), np.int64(32)): arr1 = -0.189453, arr2 = -0.176758, Diff = 0.012695
Position (np.int64(112), np.int64(1), np.int64(4)): arr1 = 0.140625, arr2 = 0.127930, Diff = 0.012695
Position (np.int64(57), np.int64(1), np.int64(87)): arr1 = 0.157227, arr2 = 0.144531, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 5340 (4.07%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 495 (0.38%)
[1.0e-04, 1.0e-03): 32408 (24.73%)
[1.0e-03, 1.0e-02): 92700 (70.72%)
[1.0e-02, 1.0e-01): 127 (0.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=17d7e8984e17c55984d87419ff40c009
triton_output_md5=7d4edcaa65a96651c5303eadcba912ba
diff.abs.max=0.001953125
max_diff_thr=0.0015576323494315147

Top differences:
Position (np.int64(1), np.int64(2), np.int64(23)): arr1 = 0.251953, arr2 = 0.253906, Diff = 0.001953
Position (np.int64(9), np.int64(1), np.int64(86)): arr1 = -0.287109, arr2 = -0.285156, Diff = 0.001953
Position (np.int64(14), np.int64(5), np.int64(86)): arr1 = -0.131836, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(16), np.int64(7), np.int64(73)): arr1 = -0.226562, arr2 = -0.227539, Diff = 0.000977
Position (np.int64(13), np.int64(3), np.int64(23)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 18792 (57.35%)
[1.0e-06, 1.0e-05): 33 (0.10%)
[1.0e-05, 1.0e-04): 2357 (7.19%)
[1.0e-04, 1.0e-03): 11584 (35.35%)
[1.0e-03, 1.0e-02): 2 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.012939453125
max_diff_thr=0.012547348625957966

Top differences:
Position (np.int64(5), np.int64(0), np.int64(83)): arr1 = 0.044189, arr2 = 0.031250, Diff = 0.012939
Position (np.int64(6), np.int64(6), np.int64(127)): arr1 = 0.078125, arr2 = 0.065918, Diff = 0.012207
Position (np.int64(7), np.int64(2), np.int64(117)): arr1 = -0.007660, arr2 = -0.019409, Diff = 0.011749
Position (np.int64(31), np.int64(1), np.int64(110)): arr1 = -0.226562, arr2 = -0.214844, Diff = 0.011719
Position (np.int64(16), np.int64(4), np.int64(41)): arr1 = 0.263672, arr2 = 0.251953, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1292 (3.94%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 114 (0.35%)
[1.0e-04, 1.0e-03): 8116 (24.77%)
[1.0e-03, 1.0e-02): 23214 (70.84%)
[1.0e-02, 1.0e-01): 32 (0.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=506cb80f1f47b2b47cfcd852db5df759
triton_output_md5=422eaf0d0347fd70a3b59d990bbde227
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(105), np.int64(6), np.int64(0)): arr1 = -0.129883, arr2 = -0.128906, Diff = 0.000977
Position (np.int64(106), np.int64(4), np.int64(81)): arr1 = -0.142578, arr2 = -0.143555, Diff = 0.000977
Position (np.int64(60), np.int64(4), np.int64(26)): arr1 = 0.131836, arr2 = 0.132812, Diff = 0.000977
Position (np.int64(24), np.int64(4), np.int64(16)): arr1 = -0.182617, arr2 = -0.183594, Diff = 0.000977
Position (np.int64(37), np.int64(4), np.int64(85)): arr1 = 0.146484, arr2 = 0.145508, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 74915 (57.16%)
[1.0e-06, 1.0e-05): 209 (0.16%)
[1.0e-05, 1.0e-04): 14434 (11.01%)
[1.0e-04, 1.0e-03): 41514 (31.67%)[aiter INFO] 2025-09-27 09:25:59.116 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.17308910176305 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.168 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:25:59.168 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.838999999999942
[aiter INFO] 2025-09-27 09:25:59.168 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.63900000000001
[aiter INFO] 2025-09-27 09:25:59.178 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,376.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.205 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.1162576333131 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.239 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 6, 139, 300, 335, 272, 307, 62}
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.279000000000025
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:25:59.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-27 09:25:59.252 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 93.0            0.0            411.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.252 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:59.256 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:59.315 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.92750481213673 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 20, 21}
[aiter INFO] 2025-09-27 09:25:59.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.07899999999995
[aiter INFO] 2025-09-27 09:25:59.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-27 09:25:59.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999969
[aiter INFO] 2025-09-27 09:25:59.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.478999999999985
[aiter INFO] 2025-09-27 09:25:59.387 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            427.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,063.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,506.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.388 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.05 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:59.471 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.59242579783543 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {779, 428, 12}
[aiter INFO] 2025-09-27 09:25:59.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999578
[aiter INFO] 2025-09-27 09:25:59.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000033
[aiter INFO] 2025-09-27 09:25:59.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999982
[aiter INFO] 2025-09-27 09:25:59.539 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,257.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.8         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.565 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.071485213418995 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.602 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:25:59.602 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000012
[aiter INFO] 2025-09-27 09:25:59.614 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            294.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.614 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:59.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:25:59.730 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.75800008112842 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 21, 31, 32, 42, 43, 53, 54, 64, 65, 75, 76, 86, 87, 97, 98, 229, 230, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.199000000000012
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999999
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-27 09:25:59.781 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.07899999999995
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999928
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.198999999999955
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.278999999999996
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.0
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.319000000000187
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.398999999999887
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.999000000000024
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.95900000000006
[aiter INFO] 2025-09-27 09:25:59.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:25:59.801 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0            654.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          1,336.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,251.4              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.5             22.4         NaN          NaN
[aiter INFO] 2025-09-27 09:25:59.801 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:25:59.975 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.85267323373567 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.026 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:00.026 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.239000000000004
[aiter INFO] 2025-09-27 09:26:00.036 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,402.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.063 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.03071298074014 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.096 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:00.096 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.439000000000021
[aiter INFO] 2025-09-27 09:26:00.107 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            444.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.108 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:00.111 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:00.170 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.38610918451064 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 196, 197, 9, 10, 108, 109, 526, 527, 1109, 1110, 702, 703}
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.598999999999933
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999742
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999984
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.358999999999924
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.318999999999505
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119000000000597
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999998632
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.198999999999614
[aiter INFO] 2025-09-27 09:26:00.222 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-27 09:26:00.241 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            405.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          1,009.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,506.8              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.241 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.05 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:00.323 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.90176262182764 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.378 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:00.378 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999982
[aiter INFO] 2025-09-27 09:26:00.390 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,290.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.417 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.08100001056596 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:00.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-27 09:26:00.592 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            294.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.593 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:00.595 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:00.711 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.42968338668936 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {262, 263, 9, 11, 152, 153, 31, 32, 53, 54, 185, 186, 75, 76, 207, 208, 86, 87, 97, 98, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.439999999999998
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.160000000000082
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999928
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.919000000000324
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000306
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.278999999999996
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.59900000000016
[aiter INFO] 2025-09-27 09:26:00.763 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.31899999999996
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000078
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999878
[aiter INFO] 2025-09-27 09:26:00.764 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:00.782 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0            653.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          1,339.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,253.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           22.5             22.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:00.783 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:00.960 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.40198023248428 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.012 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:26:01.012 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.998999999999796
[aiter INFO] 2025-09-27 09:26:01.012 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.399
[aiter INFO] 2025-09-27 09:26:01.023 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,376.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.14710897325289 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.083 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {419, 6, 391, 237, 657}
[aiter INFO] 2025-09-27 09:26:01.083 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:26:01.084 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-27 09:26:01.084 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:26:01.084 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:26:01.084 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-27 09:26:01.096 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            425.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.096 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0107421875
max_diff_thr=0.009847806766629219

Top differences:
Position (np.int64(28), np.int64(5), np.int64(87)): arr1 = 0.150391, arr2 = 0.139648, Diff = 0.010742
Position (np.int64(53), np.int64(5), np.int64(96)): arr1 = 0.101562, arr2 = 0.090820, Diff = 0.010742
Position (np.int64(45), np.int64(5), np.int64(24)): arr1 = 0.154297, arr2 = 0.143555, Diff = 0.010742
Position (np.int64(52), np.int64(3), np.int64(123)): arr1 = -0.082031, arr2 = -0.071777, Diff = 0.010254
Position (np.int64(16), np.int64(0), np.int64(24)): arr1 = 0.091309, arr2 = 0.081055, Diff = 0.010254

Threshold statistics:
[0.0e+00, 1.0e-06): 5350 (4.08%)
[1.0e-06, 1.0e-05): 11 (0.01%)
[1.0e-05, 1.0e-04): 803 (0.61%)
[1.0e-04, 1.0e-03): 40943 (31.24%)
[1.0e-03, 1.0e-02): 83960 (64.06%)
[1.0e-02, 1.0e-01): 5 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=39cc3dee40efc4d4e6f2e30b7fcd7ff0
triton_output_md5=4c16a23d374ffd8fb66ea5c7c5f49542
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(28), np.int64(3), np.int64(125)): arr1 = -0.143555, arr2 = -0.144531, Diff = 0.000977
Position (np.int64(10), np.int64(2), np.int64(24)): arr1 = -0.133789, arr2 = -0.134766, Diff = 0.000977
Position (np.int64(26), np.int64(7), np.int64(101)): arr1 = 0.141602, arr2 = 0.140625, Diff = 0.000977
Position (np.int64(12), np.int64(3), np.int64(97)): arr1 = 0.129883, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(22), np.int64(2), np.int64(121)): arr1 = 0.155273, arr2 = 0.156250, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 18770 (57.28%)
[1.0e-06, 1.0e-05): 60 (0.18%)
[1.0e-05, 1.0e-04): 3553 (10.84%)
[1.0e-04, 1.0e-03): 10385 (31.69%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.009765625
max_diff_thr=0.009062075056135654

Top differences:
Position (np.int64(15), np.int64(4), np.int64(41)): arr1 = -0.087402, arr2 = -0.077637, Diff = 0.009766
Position (np.int64(6), np.int64(6), np.int64(46)): arr1 = 0.020020, arr2 = 0.010925, Diff = 0.009094
Position (np.int64(25), np.int64(0), np.int64(45)): arr1 = -0.177734, arr2 = -0.168945, Diff = 0.008789
Position (np.int64(16), np.int64(4), np.int64(109)): arr1 = 0.140625, arr2 = 0.131836, Diff = 0.008789
Position (np.int64(22), np.int64(2), np.int64(25)): arr1 = -0.187500, arr2 = -0.178711, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1266 (3.86%)
[1.0e-06, 1.0e-05): 6 (0.02%)
[1.0e-05, 1.0e-04): 175 (0.53%)
[1.0e-04, 1.0e-03): 10379 (31.67%)
[1.0e-03, 1.0e-02): 20942 (63.91%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=35128410a3abc72658a81935e0340934
triton_output_md5=61cce8e7860b54529e9f7995ae386d9f
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(0), np.int64(6), np.int64(109)): arr1 = -0.134766, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(23), np.int64(4), np.int64(56)): arr1 = 0.132812, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(56), np.int64(7), np.int64(85)): arr1 = 0.170898, arr2 = 0.169922, Diff = 0.000977
Position (np.int64(89), np.int64(2), np.int64(57)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(90), np.int64(2), np.int64(39)): arr1 = 0.149414, arr2 = 0.148438, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 75467 (57.58%)
[1.0e-06, 1.0e-05): 274 (0.21%)
[1.0e-05, 1.0e-04): 15925 (12.15%)
[1.0e-04, 1.0e-03): 39406 (30.06%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.01025390625
max_diff_thr=0.009510869160294533

Top differences:
Position (np.int64(88), np.int64(6), np.int64(4)): arr1 = 0.088379, arr2 = 0.078125, Diff = 0.010254
Position (np.int64(90), np.int64(3), np.int64(23)): arr1 = 0.102539, arr2 = 0.092285, Diff = 0.010254
Position (np.int64(126), np.int64(6), np.int64(107)): arr1 = 0.152344, arr2 = 0.142578, Diff = 0.009766
Position (np.int64(24), np.int64(5), np.int64(64)): arr1 = -0.084961, arr2 = -0.075195, Diff = 0.009766
Position (np.int64(44), np.int64(1), np.int64(127)): arr1 = 0.139648, arr2 = 0.129883, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 5464 (4.17%)
[1.0e-06, 1.0e-05): 15 (0.01%)
[1.0e-05, 1.0e-04): 916 (0.70%)
[1.0e-04, 1.0e-03): 44172 (33.70%)
[1.0e-03, 1.0e-02): 80503 (61.42%)
[1.0e-02, 1.0e-01): 2 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f2c72d89cfb1e9ab847ccb7a4d2faf4d
triton_output_md5=d3f54ad392771723bdb84d50dc61b898
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(29), np.int64(1), np.int64(65)): arr1 = -0.128906, arr2 = -0.129883, Diff = 0.000977
Position (np.int64(30), np.int64(6), np.int64(38)): arr1 = 0.169922, arr2 = 0.168945, Diff = 0.000977
Position (np.int64(9), np.int64(5), np.int64(62)): arr1 = -0.139648, arr2 = -0.140625, Diff = 0.000977
Position (np.int64(18), np.int64(0), np.int64(80)): arr1 = -0.152344, arr2 = -0.151367, Diff = 0.000977
Position (np.int64(22), np.int64(7), np.int64(94)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 18749 (57.22%)
[1.0e-06, 1.0e-05): 64 (0.20%)
[1.0e-05, 1.0e-04): 3913 (11.94%)
[1.0e-04, 1.0e-03): 10042 (30.65%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0087890625
max_diff_thr=0.007971656508743763

Top differences:
Position (np.int64(2), np.int64(4), np.int64(31)): arr1 = -0.111328, arr2 = -0.102539, Diff = 0.008789
Position (np.int64(24), np.int64(2), np.int64(63)): arr1 = 0.053467, arr2 = 0.045166, Diff = 0.008301
Position (np.int64(13), np.int64(5), np.int64(23)): arr1 = -0.075684, arr2 = -0.067383, Diff = 0.008301
Position (np.int64(8), np.int64(2), np.int64(62)): arr1 = -0.104492, arr2 = -0.096191, Diff = 0.008301
Position (np.int64(16), np.int64(2), np.int64(75)): arr1 = -0.056152, arr2 = -0.048096, Diff = 0.008057

Threshold statistics:
[0.0e+00, 1.0e-06): 1399 (4.27%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 202 (0.62%)
[1.0e-04, 1.0e-03): 11063 (33.76%)
[1.0e-03, 1.0e-02): 20101 (61.34%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=25f21ebc2fd51068652b9cd55a5a4b88
triton_output_md5=c13489f8e520fb42fcc4ac546dcfa502
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(103), np.int64(0), np.int64(17)): arr1 = 0.157227, arr2 = 0.156250, Diff = 0.000977
Position (np.int64(64), np.int64(2), np.int64(124)): arr1 = 0.137695, arr2 = 0.136719, Diff = 0.000977
Position (np.int64(43), np.int64(1), np.int64(93)): arr1 = 0.129883, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(58), np.int64(5), np.int64(74)): arr1 = 0.163086, arr2 = 0.162109, Diff = 0.000977
Position (np.int64(17), np.int64(7), np.int64(90)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 75558 (57.65%)
[1.0e-06, 1.0e-05): 561 (0.43%)
[1.0e-05, 1.0e-04): 25331 (19.33%)
[1.0e-04, 1.0e-03): 29622 (22.60%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.007080078125
max_diff_thr=0.006712962873280048

Top differences:
Position (np.int64(35), np.int64(5), np.int64(125)): arr1 = 0.061768, arr2 = 0.054688, Diff = 0.007080
Position (np.int64(25), np.int64(4), np.int64(22)): arr1 = -0.070801, arr2 = -0.063965, Diff = 0.006836
Position (np.int64(36), np.int64(1), np.int64(85)): arr1 = -0.141602, arr2 = -0.134766, Diff = 0.006836
Position (np.int64(122), np.int64(4), np.int64(29)): arr1 = -0.075684, arr2 = -0.068848, Diff = 0.006836[aiter INFO] 2025-09-27 09:26:01.100 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:01.159 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.88193089950204 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 141, 142, 119, 120}
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000002
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-27 09:26:01.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000078
[aiter INFO] 2025-09-27 09:26:01.231 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            423.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,054.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,509.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.232 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:01.314 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.56629724077659 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.370 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1156, 12}
[aiter INFO] 2025-09-27 09:26:01.370 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.47899999999936
[aiter INFO] 2025-09-27 09:26:01.370 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000003
[aiter INFO] 2025-09-27 09:26:01.382 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,282.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             12.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.409 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.74515848584694 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.445 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:01.445 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999984
[aiter INFO] 2025-09-27 09:26:01.457 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            293.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.458 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:01.459 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:01.574 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.63603992686414 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 23, 31, 34, 42, 45, 53, 56, 955, 958, 64, 67, 75, 78, 97, 100, 108, 111}
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.239000000000004
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.198999999999955
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.679000000000087
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.158999999999992
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119000000000597
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000087
[aiter INFO] 2025-09-27 09:26:01.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.359000000000037
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.19900000000007
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.4389999999999645
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.278999999999996
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.598999999999933
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.038999999999987
[aiter INFO] 2025-09-27 09:26:01.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.598999999999933
[aiter INFO] 2025-09-27 09:26:01.644 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            685.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,171.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,153.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           31.5             31.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:01.645 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:02.276 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.01157441115618 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:02.327 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:02.328 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.51899999999998
[aiter INFO] 2025-09-27 09:26:02.338 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,486.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             44.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:02.481 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.273495091955255 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:02.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {496, 6}
[aiter INFO] 2025-09-27 09:26:02.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.59900000000016
[aiter INFO] 2025-09-27 09:26:02.515 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-27 09:26:02.526 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            512.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:02.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    50.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:02.530 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:02.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.78493075795693 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:02.641 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:02.641 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000037
[aiter INFO] 2025-09-27 09:26:02.641 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000028
[aiter INFO] 2025-09-27 09:26:02.660 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,110.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,541.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:02.660 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.41 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:02.877 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.48750487766644 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:02.934 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 12, 38}
[aiter INFO] 2025-09-27 09:26:02.934 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-09-27 09:26:02.934 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.998999999999995
[aiter INFO] 2025-09-27 09:26:02.934 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-09-27 09:26:02.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,280.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:02.973 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.571257547576835 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.010 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {594, 685, 118, 6}
[aiter INFO] 2025-09-27 09:26:03.010 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-27 09:26:03.010 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6390000000001237
[aiter INFO] 2025-09-27 09:26:03.010 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.9990000000000236
[aiter INFO] 2025-09-27 09:26:03.010 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999993
[aiter INFO] 2025-09-27 09:26:03.022 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            322.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.023 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:03.024 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:03.140 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.5018214754539 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.193 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 13, 20, 23, 31, 34, 42, 45, 53, 56, 1087, 64, 1090, 67, 75, 78, 86, 89, 97, 482, 100, 485, 108, 111}
[aiter INFO] 2025-09-27 09:26:03.193 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.319999999999993
[aiter INFO] 2025-09-27 09:26:03.193 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-27 09:26:03.193 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.43900000000002
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.6790000000000305
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.438999999999965
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.71900000000005
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.87900000000002
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.598999999999933
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.639000000001033
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.479999999999905
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000087
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119000000000028
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.638999999999896
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.639000000000124
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.759000000000015
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.27899999999954
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000078
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000378
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.439000000000078
[aiter INFO] 2025-09-27 09:26:03.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-27 09:26:03.213 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0            667.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          2,111.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,142.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           31.4             31.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.214 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.22 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:03.388 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 142.26983148272677 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.441 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77}
[aiter INFO] 2025-09-27 09:26:03.441 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.59900000000002
[aiter INFO] 2025-09-27 09:26:03.441 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.399
[aiter INFO] 2025-09-27 09:26:03.452 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,442.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             44.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.480 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.10357438249163 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {62, 6}
[aiter INFO] 2025-09-27 09:26:03.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-27 09:26:03.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999984
[aiter INFO] 2025-09-27 09:26:03.526 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            512.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.527 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    50.05 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:03.530 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:03.590 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.02690097719136 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.644 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:03.644 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519999999999982
[aiter INFO] 2025-09-27 09:26:03.644 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-27 09:26:03.663 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,131.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,562.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.6             15.6         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.663 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.63 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(25), np.int64(3), np.int64(22)): arr1 = -0.065918, arr2 = -0.059082, Diff = 0.006836

Threshold statistics:
[0.0e+00, 1.0e-06): 5362 (4.09%)
[1.0e-06, 1.0e-05): 24 (0.02%)
[1.0e-05, 1.0e-04): 1789 (1.36%)
[1.0e-04, 1.0e-03): 59316 (45.25%)
[1.0e-03, 1.0e-02): 64581 (49.27%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2d39fc0db7bff5107ccc1cbff02a3dac
triton_output_md5=b92d443fdbd3e0d9ce54012d2c613c43
diff.abs.max=0.0009765625
max_diff_thr=0.0008650519303046167

Top differences:
Position (np.int64(28), np.int64(2), np.int64(57)): arr1 = -0.132812, arr2 = -0.133789, Diff = 0.000977
Position (np.int64(23), np.int64(0), np.int64(43)): arr1 = -0.153320, arr2 = -0.154297, Diff = 0.000977
Position (np.int64(4), np.int64(5), np.int64(116)): arr1 = 0.127930, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(2), np.int64(4), np.int64(76)): arr1 = -0.069336, arr2 = -0.069824, Diff = 0.000488
Position (np.int64(26), np.int64(6), np.int64(69)): arr1 = 0.075684, arr2 = 0.075195, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 18768 (57.28%)
[1.0e-06, 1.0e-05): 132 (0.40%)
[1.0e-05, 1.0e-04): 6476 (19.76%)
[1.0e-04, 1.0e-03): 7392 (22.56%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.0062864841893315315

Top differences:
Position (np.int64(0), np.int64(0), np.int64(36)): arr1 = 0.094238, arr2 = 0.087402, Diff = 0.006836
Position (np.int64(17), np.int64(2), np.int64(103)): arr1 = 0.055664, arr2 = 0.049561, Diff = 0.006104
Position (np.int64(16), np.int64(1), np.int64(102)): arr1 = -0.019653, arr2 = -0.013672, Diff = 0.005981
Position (np.int64(18), np.int64(0), np.int64(41)): arr1 = 0.063477, arr2 = 0.057617, Diff = 0.005859
Position (np.int64(21), np.int64(1), np.int64(120)): arr1 = -0.109375, arr2 = -0.103516, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1285 (3.92%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 433 (1.32%)
[1.0e-04, 1.0e-03): 14895 (45.46%)
[1.0e-03, 1.0e-02): 16147 (49.28%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0dcb543c9f13197e20a6786c9772e636
triton_output_md5=4f467f3dc07e5ba1f8654b6d456fe8c8
diff.abs.max=0.0009765625
max_diff_thr=0.000869187293574214

Top differences:
Position (np.int64(30), np.int64(0), np.int64(72)): arr1 = -0.126953, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(107), np.int64(7), np.int64(40)): arr1 = -0.131836, arr2 = -0.130859, Diff = 0.000977
Position (np.int64(53), np.int64(4), np.int64(33)): arr1 = 0.141602, arr2 = 0.140625, Diff = 0.000977
Position (np.int64(32), np.int64(1), np.int64(86)): arr1 = 0.132812, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(123), np.int64(2), np.int64(7)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 66494 (50.73%)
[1.0e-06, 1.0e-05): 558 (0.43%)
[1.0e-05, 1.0e-04): 25566 (19.51%)
[1.0e-04, 1.0e-03): 38454 (29.34%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0078125
max_diff_thr=0.007315957918763161

Top differences:
Position (np.int64(106), np.int64(6), np.int64(11)): arr1 = 0.075684, arr2 = 0.067871, Diff = 0.007812
Position (np.int64(123), np.int64(2), np.int64(93)): arr1 = 0.100586, arr2 = 0.093262, Diff = 0.007324
Position (np.int64(41), np.int64(0), np.int64(12)): arr1 = -0.079590, arr2 = -0.072266, Diff = 0.007324
Position (np.int64(63), np.int64(7), np.int64(42)): arr1 = -0.068848, arr2 = -0.062256, Diff = 0.006592
Position (np.int64(106), np.int64(0), np.int64(11)): arr1 = 0.083008, arr2 = 0.076660, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 5273 (4.02%)
[1.0e-06, 1.0e-05): 36 (0.03%)
[1.0e-05, 1.0e-04): 1809 (1.38%)
[1.0e-04, 1.0e-03): 59270 (45.22%)
[1.0e-03, 1.0e-02): 64684 (49.35%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=057599962faa8851c1281f9dcf1e7f75
triton_output_md5=5ed9e8127d9241f277ec3ddc6222e4da
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(21), np.int64(3), np.int64(83)): arr1 = 0.127930, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(2), np.int64(5), np.int64(86)): arr1 = 0.126953, arr2 = 0.125977, Diff = 0.000977
Position (np.int64(0), np.int64(5), np.int64(65)): arr1 = 0.138672, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(0), np.int64(3), np.int64(65)): arr1 = 0.132812, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(9), np.int64(1), np.int64(97)): arr1 = 0.136719, arr2 = 0.137695, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 16518 (50.41%)
[1.0e-06, 1.0e-05): 133 (0.41%)
[1.0e-05, 1.0e-04): 6679 (20.38%)
[1.0e-04, 1.0e-03): 9438 (28.80%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.006401463411748409

Top differences:
Position (np.int64(9), np.int64(1), np.int64(126)): arr1 = -0.074707, arr2 = -0.067871, Diff = 0.006836
Position (np.int64(6), np.int64(3), np.int64(85)): arr1 = -0.007599, arr2 = -0.013733, Diff = 0.006134
Position (np.int64(29), np.int64(7), np.int64(63)): arr1 = -0.003296, arr2 = 0.002792, Diff = 0.006088
Position (np.int64(2), np.int64(0), np.int64(58)): arr1 = -0.080566, arr2 = -0.074707, Diff = 0.005859
Position (np.int64(28), np.int64(4), np.int64(24)): arr1 = -0.074707, arr2 = -0.068848, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1264 (3.86%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 442 (1.35%)
[1.0e-04, 1.0e-03): 14873 (45.39%)
[1.0e-03, 1.0e-02): 16181 (49.38%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ac41c836281eebaf8dc82260adc1ac40
triton_output_md5=b37db785c5a527125afeb7ee287060c2
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(26), np.int64(0), np.int64(9)): arr1 = -0.127930, arr2 = -0.128906, Diff = 0.000977
Position (np.int64(69), np.int64(6), np.int64(114)): arr1 = 0.141602, arr2 = 0.140625, Diff = 0.000977
Position (np.int64(34), np.int64(7), np.int64(42)): arr1 = -0.140625, arr2 = -0.139648, Diff = 0.000977
Position (np.int64(13), np.int64(3), np.int64(93)): arr1 = 0.126953, arr2 = 0.125977, Diff = 0.000977
Position (np.int64(68), np.int64(3), np.int64(44)): arr1 = -0.126953, arr2 = -0.125977, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 66355 (50.62%)
[1.0e-06, 1.0e-05): 543 (0.41%)
[1.0e-05, 1.0e-04): 26267 (20.04%)
[1.0e-04, 1.0e-03): 37907 (28.92%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.006320541724562645

Top differences:
Position (np.int64(112), np.int64(1), np.int64(47)): arr1 = -0.088379, arr2 = -0.081543, Diff = 0.006836
Position (np.int64(86), np.int64(4), np.int64(105)): arr1 = 0.066895, arr2 = 0.060303, Diff = 0.006592
Position (np.int64(74), np.int64(0), np.int64(33)): arr1 = 0.037354, arr2 = 0.031006, Diff = 0.006348
Position (np.int64(61), np.int64(2), np.int64(104)): arr1 = 0.027832, arr2 = 0.021606, Diff = 0.006226
Position (np.int64(15), np.int64(2), np.int64(39)): arr1 = -0.063477, arr2 = -0.057373, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 5282 (4.03%)
[1.0e-06, 1.0e-05): 24 (0.02%)
[1.0e-05, 1.0e-04): 1950 (1.49%)
[1.0e-04, 1.0e-03): 62051 (47.34%)
[1.0e-03, 1.0e-02): 61765 (47.12%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=714074954e1c700aca2c2f59cca8aaac
triton_output_md5=e27d148dc9a62d12350d5837f4acdd6c
diff.abs.max=0.0009765625
max_diff_thr=0.0008561643771827221[aiter INFO] 2025-09-27 09:26:03.747 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.30059397161597 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.804 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:03.804 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.919000000000011
[aiter INFO] 2025-09-27 09:26:03.816 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,311.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.843 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.61881209541075 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:03.879 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:03.879 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-27 09:26:03.891 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            335.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:03.892 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:03.893 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:04.008 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.43920761169774 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.058 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 23, 31, 34, 42, 45, 53, 56, 64, 67, 75, 78, 86, 89, 108, 111, 119, 122}
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.67999999999995
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.399
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.278999999999996
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.158999999999992
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.239000000000033
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.598999999999933
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.198999999999955
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.63900000000001
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.4389999999999645
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.239000000000033
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000115
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.879000000000133
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:26:04.059 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.88000000000011
[aiter INFO] 2025-09-27 09:26:04.060 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:04.078 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            679.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,144.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,118.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           31.2             31.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.078 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:04.248 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.12761333319222 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.298 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {675, 12}
[aiter INFO] 2025-09-27 09:26:04.298 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.438999999999396
[aiter INFO] 2025-09-27 09:26:04.298 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.79899999999998
[aiter INFO] 2025-09-27 09:26:04.308 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,439.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             44.8         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.335 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.91109907302526 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.501 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:04.501 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.078999999999979
[aiter INFO] 2025-09-27 09:26:04.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            513.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.514 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    49.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:04.518 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:04.577 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.79046528528232 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.632 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:04.632 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999976
[aiter INFO] 2025-09-27 09:26:04.632 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:04.650 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,117.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,549.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.651 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.49 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:04.735 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.58135637434401 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.792 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-09-27 09:26:04.792 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-09-27 09:26:04.792 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.199000000000012
[aiter INFO] 2025-09-27 09:26:04.804 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,292.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.831 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.006534592645004 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:04.868 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:04.868 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-27 09:26:04.880 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            334.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:04.881 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:04.882 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:04.999 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 123.07637627467071 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 9, 42, 812, 13, 46, 816, 20, 23, 31}
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.43900000000002
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.198999999999955
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.439000000000306
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.3989999999994325
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.839
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-27 09:26:05.050 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.67900000000003
[aiter INFO] 2025-09-27 09:26:05.069 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            719.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          2,818.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,698.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           37.0             36.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.069 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    36.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:05.244 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 148.65794025435306 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 103, 12, 77, 25}
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.718999999999994
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.63900000000001
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.63900000000004
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.759000000000015
[aiter INFO] 2025-09-27 09:26:05.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.559000000000026
[aiter INFO] 2025-09-27 09:26:05.305 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          5,364.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             55.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.472 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.56495044461572 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.506 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:05.506 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:05.518 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            632.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.519 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    62.20 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:05.522 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:05.582 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.37426781241257 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 9, 42, 43, 12, 119, 120}
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.038999999999987
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:26:05.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-27 09:26:05.637 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:26:05.637 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:26:05.655 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            418.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,449.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,930.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.3             19.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.656 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]


Top differences:
Position (np.int64(17), np.int64(1), np.int64(27)): arr1 = 0.139648, arr2 = 0.140625, Diff = 0.000977
Position (np.int64(31), np.int64(1), np.int64(95)): arr1 = 0.085938, arr2 = 0.085449, Diff = 0.000488
Position (np.int64(17), np.int64(6), np.int64(93)): arr1 = -0.063477, arr2 = -0.062988, Diff = 0.000488
Position (np.int64(12), np.int64(2), np.int64(113)): arr1 = 0.069824, arr2 = 0.069336, Diff = 0.000488
Position (np.int64(1), np.int64(4), np.int64(53)): arr1 = 0.077148, arr2 = 0.077637, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 16540 (50.48%)
[1.0e-06, 1.0e-05): 142 (0.43%)
[1.0e-05, 1.0e-04): 6481 (19.78%)
[1.0e-04, 1.0e-03): 9605 (29.31%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.005859375
max_diff_thr=0.0054054055362939835

Top differences:
Position (np.int64(31), np.int64(1), np.int64(95)): arr1 = 0.089844, arr2 = 0.083984, Diff = 0.005859
Position (np.int64(5), np.int64(7), np.int64(109)): arr1 = 0.023438, arr2 = 0.017944, Diff = 0.005493
Position (np.int64(1), np.int64(2), np.int64(44)): arr1 = 0.027466, arr2 = 0.021973, Diff = 0.005493
Position (np.int64(3), np.int64(3), np.int64(84)): arr1 = 0.029297, arr2 = 0.023926, Diff = 0.005371
Position (np.int64(16), np.int64(4), np.int64(64)): arr1 = 0.086914, arr2 = 0.081543, Diff = 0.005371

Threshold statistics:
[0.0e+00, 1.0e-06): 1383 (4.22%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 486 (1.48%)
[1.0e-04, 1.0e-03): 15522 (47.37%)
[1.0e-03, 1.0e-02): 15369 (46.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=64f4e9f0c34f91eae64e368b9f4579f6
triton_output_md5=d4e1ea32f6b682d7522cb38fcdca02e7
diff.abs.max=0.00048828125
max_diff_thr=0.0004723665479104966

Top differences:
Position (np.int64(91), np.int64(4), np.int64(1)): arr1 = -0.062988, arr2 = -0.062500, Diff = 0.000488
Position (np.int64(72), np.int64(7), np.int64(69)): arr1 = -0.066406, arr2 = -0.065918, Diff = 0.000488
Position (np.int64(102), np.int64(2), np.int64(76)): arr1 = -0.083984, arr2 = -0.084473, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(76)): arr1 = -0.064453, arr2 = -0.064941, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(66)): arr1 = -0.073730, arr2 = -0.073242, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 65391 (49.89%)
[1.0e-06, 1.0e-05): 927 (0.71%)
[1.0e-05, 1.0e-04): 35703 (27.24%)
[1.0e-04, 1.0e-03): 29051 (22.16%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00537109375
max_diff_thr=0.005003918893635273

Top differences:
Position (np.int64(14), np.int64(4), np.int64(87)): arr1 = -0.126953, arr2 = -0.121582, Diff = 0.005371
Position (np.int64(98), np.int64(6), np.int64(84)): arr1 = -0.082031, arr2 = -0.076660, Diff = 0.005371
Position (np.int64(125), np.int64(1), np.int64(120)): arr1 = -0.017456, arr2 = -0.012390, Diff = 0.005066
Position (np.int64(110), np.int64(3), np.int64(24)): arr1 = 0.049805, arr2 = 0.045166, Diff = 0.004639
Position (np.int64(58), np.int64(3), np.int64(70)): arr1 = -0.017822, arr2 = -0.013245, Diff = 0.004578

Threshold statistics:
[0.0e+00, 1.0e-06): 5320 (4.06%)
[1.0e-06, 1.0e-05): 52 (0.04%)
[1.0e-05, 1.0e-04): 3404 (2.60%)
[1.0e-04, 1.0e-03): 77170 (58.88%)
[1.0e-03, 1.0e-02): 45126 (34.43%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0dafd8e5da00bf35be33f54cc38880e6
triton_output_md5=58f15f97a5759be9e842e1ba75eedd46
diff.abs.max=0.00048828125
max_diff_thr=0.0004595588252414018

Top differences:
Position (np.int64(0), np.int64(4), np.int64(87)): arr1 = -0.070801, arr2 = -0.070312, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(9)): arr1 = -0.066895, arr2 = -0.066406, Diff = 0.000488
Position (np.int64(11), np.int64(2), np.int64(49)): arr1 = -0.063965, arr2 = -0.064453, Diff = 0.000488
Position (np.int64(6), np.int64(0), np.int64(17)): arr1 = -0.069824, arr2 = -0.070312, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(29)): arr1 = -0.078125, arr2 = -0.077637, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 16189 (49.40%)
[1.0e-06, 1.0e-05): 221 (0.67%)
[1.0e-05, 1.0e-04): 9178 (28.01%)
[1.0e-04, 1.0e-03): 7180 (21.91%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0048828125
max_diff_thr=0.004545454401522875

Top differences:
Position (np.int64(8), np.int64(3), np.int64(90)): arr1 = -0.079102, arr2 = -0.074219, Diff = 0.004883
Position (np.int64(19), np.int64(0), np.int64(21)): arr1 = -0.087891, arr2 = -0.083496, Diff = 0.004395
Position (np.int64(22), np.int64(7), np.int64(63)): arr1 = -0.075684, arr2 = -0.071289, Diff = 0.004395
Position (np.int64(28), np.int64(1), np.int64(73)): arr1 = 0.002930, arr2 = -0.001335, Diff = 0.004265
Position (np.int64(5), np.int64(7), np.int64(120)): arr1 = -0.004608, arr2 = -0.000425, Diff = 0.004183

Threshold statistics:
[0.0e+00, 1.0e-06): 1397 (4.26%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 817 (2.49%)
[1.0e-04, 1.0e-03): 19210 (58.62%)
[1.0e-03, 1.0e-02): 11337 (34.60%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=cde847578f6b32532ab2367562647037
triton_output_md5=8d66e0a4c9b3e81f42ebe5d31b2958b6
diff.abs.max=0.00048828125
max_diff_thr=0.0004666355671361089

Top differences:
Position (np.int64(44), np.int64(0), np.int64(24)): arr1 = 0.065430, arr2 = 0.064941, Diff = 0.000488
Position (np.int64(40), np.int64(4), np.int64(75)): arr1 = -0.076172, arr2 = -0.075684, Diff = 0.000488
Position (np.int64(102), np.int64(1), np.int64(116)): arr1 = -0.068359, arr2 = -0.068848, Diff = 0.000488
Position (np.int64(119), np.int64(2), np.int64(120)): arr1 = -0.085938, arr2 = -0.085449, Diff = 0.000488
Position (np.int64(62), np.int64(4), np.int64(66)): arr1 = -0.070312, arr2 = -0.070801, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 65668 (50.10%)
[1.0e-06, 1.0e-05): 906 (0.69%)
[1.0e-05, 1.0e-04): 35982 (27.45%)
[1.0e-04, 1.0e-03): 28516 (21.76%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0048828125
max_diff_thr=0.004570384044200182

Top differences:
Position (np.int64(20), np.int64(4), np.int64(24)): arr1 = -0.073242, arr2 = -0.068359, Diff = 0.004883
Position (np.int64(0), np.int64(5), np.int64(89)): arr1 = 0.088379, arr2 = 0.083496, Diff = 0.004883
Position (np.int64(2), np.int64(5), np.int64(80)): arr1 = -0.025391, arr2 = -0.020752, Diff = 0.004639
Position (np.int64(70), np.int64(7), np.int64(17)): arr1 = 0.021973, arr2 = 0.017456, Diff = 0.004517
Position (np.int64(32), np.int64(6), np.int64(100)): arr1 = 0.003464, arr2 = -0.000950, Diff = 0.004414

Threshold statistics:
[0.0e+00, 1.0e-06): 5370 (4.10%)
[1.0e-06, 1.0e-05): 72 (0.05%)
[1.0e-05, 1.0e-04): 3416 (2.61%)
[1.0e-04, 1.0e-03): 77416 (59.06%)
[1.0e-03, 1.0e-02): 44798 (34.18%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=44dca9870aba9d421143bbc38c7e5488
triton_output_md5=322b4168d84a84e17b06140fc00e71ca
diff.abs.max=0.00048828125
max_diff_thr=0.0004613610217347741

Top differences:
Position (np.int64(2), np.int64(3), np.int64(62)): arr1 = 0.071289, arr2 = 0.071777, Diff = 0.000488
Position (np.int64(15), np.int64(5), np.int64(109)): arr1 = 0.078125, arr2 = 0.077637, Diff = 0.000488
Position (np.int64(4), np.int64(3), np.int64(65)): arr1 = -0.069336, arr2 = -0.069824, Diff = 0.000488
Position (np.int64(25), np.int64(6), np.int64(117)): arr1 = 0.073730, arr2 = 0.073242, Diff = 0.000488
Position (np.int64(20), np.int64(3), np.int64(7)): arr1 = -0.062988, arr2 = -0.063477, Diff = 0.000488[aiter INFO] 2025-09-27 09:26:05.740 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.40949506511782 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {103, 12, 77, 1143, 25, 90}
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.759000000000015
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.719000000000023
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.678999999999974
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.838999999999942
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.80000000000001
[aiter INFO] 2025-09-27 09:26:05.796 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.678999999999974
[aiter INFO] 2025-09-27 09:26:05.808 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          2,209.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.835 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.91940606466615 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:05.872 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:05.872 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-27 09:26:05.884 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            392.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:05.884 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    27.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:05.886 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:06.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.28234670893983 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {954, 772, 9, 942, 49, 19, 762, 59}
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.518999999998414
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000342
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.07999999999998
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.15899999999965
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.19899999999996
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.4400000000005
[aiter INFO] 2025-09-27 09:26:06.068 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.7589999999999
[aiter INFO] 2025-09-27 09:26:06.086 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            933.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0         12,758.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       14,109.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          141.1            141.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:06.087 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   141.16 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:06.895 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 387.0069003931367 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:06.968 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {49, 12}
[aiter INFO] 2025-09-27 09:26:06.968 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 296.19999999999993
[aiter INFO] 2025-09-27 09:26:06.968 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 299.91999999999996
[aiter INFO] 2025-09-27 09:26:06.979 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         29,477.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0            297.8         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.264 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.39072289177687 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:07.299 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-27 09:26:07.299 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.59900000000016
[aiter INFO] 2025-09-27 09:26:07.299 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.599000000000018
[aiter INFO] 2025-09-27 09:26:07.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,215.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.312 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   310.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:07.315 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:07.377 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.13748603705133 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 223, 36, 69, 218, 42, 9, 47, 16, 20, 53, 58, 27, 31}
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.360000000000014
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.079000000000065
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.358999999999924
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.43900000000008
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.56
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.078999999999951
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.19900000000001
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.67900000000009
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.078999999999951
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-27 09:26:07.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.959
[aiter INFO] 2025-09-27 09:26:07.451 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            453.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          3,570.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,297.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           43.0             42.8         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.452 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    42.80 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:07.542 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.30983167001517 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:07.599 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 753, 51, 25, 90}
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.99899999999991
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.11900000000003
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.47999999999999
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.91899999999998
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.4399999999996
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.03999999999996
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.99900000000002
[aiter INFO] 2025-09-27 09:26:07.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.68000000000006
[aiter INFO] 2025-09-27 09:26:07.612 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 93.0            0.0          7,144.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             76.8         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.639 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.83466323472486 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:07.675 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-27 09:26:07.675 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.998999999999796
[aiter INFO] 2025-09-27 09:26:07.675 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-27 09:26:07.687 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            654.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.688 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    83.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:07.689 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:07.815 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 210.57498086206982 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {165, 357, 59, 1083, 9, 589, 176, 49, 466, 722, 19, 600, 1082, 347, 734, 479}
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.32000000000016
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999999833
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000000033
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.238999999999578
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.43899999999996
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.03999999999996
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.07899999999995
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.43899999999996
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.51900000000023
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.19899999999961
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.198999999999614
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.95899999999892
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.63900000000012
[aiter INFO] 2025-09-27 09:26:07.870 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-27 09:26:07.871 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.118999999999687
[aiter INFO] 2025-09-27 09:26:07.889 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            742.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0         11,576.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       13,235.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          132.4            132.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:07.890 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   132.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:08.555 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 367.570021069876 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:08.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1259, 12, 37, 1275}
[aiter INFO] 2025-09-27 09:26:08.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 278.4400000000005
[aiter INFO] 2025-09-27 09:26:08.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 278.91999999999996
[aiter INFO] 2025-09-27 09:26:08.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 276.44
[aiter INFO] 2025-09-27 09:26:08.625 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 278.27999999999884
[aiter INFO] 2025-09-27 09:26:08.635 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         26,917.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0            277.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:08.835 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.323386095538 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:08.869 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {517, 6, 503}
[aiter INFO] 2025-09-27 09:26:08.869 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.638999999999669
[aiter INFO] 2025-09-27 09:26:08.869 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.15900000000002
[aiter INFO] 2025-09-27 09:26:08.869 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999742
[aiter INFO] 2025-09-27 09:26:08.881 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            989.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:08.882 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   287.59 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:08.885 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:08.947 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 127.09231755816111 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {993, 36, 9, 42, 12, 47, 20, 24, 889, 988, 894, 31}
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.91899999999998
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.519000000000005
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.43900000000002
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-27 09:26:09.002 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.998999999999796
[aiter INFO] 2025-09-27 09:26:09.003 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.68000000000029
[aiter INFO] 2025-09-27 09:26:09.003 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-27 09:26:09.003 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.83899999999994
[aiter INFO] 2025-09-27 09:26:09.021 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            398.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,534.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,154.5              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           41.5             41.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:09.022 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:09.113 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.97961438292324 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:09.308 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.43899999999996
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.07899999999995
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.35999999999999
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.15899999999999
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.95999999999992
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.279
[aiter INFO] 2025-09-27 09:26:09.309 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.19899999999996
[aiter INFO] 2025-09-27 09:26:09.321 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0          7,175.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             76.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:09.348 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.998198056870166 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:09.385 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:09.385 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119
[aiter INFO] 2025-09-27 09:26:09.397 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            526.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:09.398 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    81.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 15936 (48.63%)
[1.0e-06, 1.0e-05): 240 (0.73%)
[1.0e-05, 1.0e-04): 9288 (28.34%)
[1.0e-04, 1.0e-03): 7304 (22.29%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.004638671875
max_diff_thr=0.0044258092530071735

Top differences:
Position (np.int64(28), np.int64(7), np.int64(18)): arr1 = 0.052734, arr2 = 0.048096, Diff = 0.004639
Position (np.int64(0), np.int64(7), np.int64(98)): arr1 = 0.057373, arr2 = 0.052979, Diff = 0.004395
Position (np.int64(7), np.int64(6), np.int64(63)): arr1 = -0.034912, arr2 = -0.030762, Diff = 0.004150
Position (np.int64(9), np.int64(1), np.int64(58)): arr1 = -0.036865, arr2 = -0.032715, Diff = 0.004150
Position (np.int64(29), np.int64(1), np.int64(22)): arr1 = -0.054932, arr2 = -0.050781, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1299 (3.96%)
[1.0e-06, 1.0e-05): 11 (0.03%)
[1.0e-05, 1.0e-04): 901 (2.75%)
[1.0e-04, 1.0e-03): 19382 (59.15%)
[1.0e-03, 1.0e-02): 11175 (34.10%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=44622e15cee78ad66e4b9d5dcc499eb8
triton_output_md5=c416a0aae5194cc5e4d6add1bd228170
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(80), np.int64(5), np.int64(112)): arr1 = -0.031494, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(38), np.int64(5), np.int64(20)): arr1 = -0.036621, arr2 = -0.036377, Diff = 0.000244
Position (np.int64(82), np.int64(7), np.int64(66)): arr1 = -0.032959, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(68), np.int64(0), np.int64(20)): arr1 = 0.034424, arr2 = 0.034668, Diff = 0.000244
Position (np.int64(58), np.int64(6), np.int64(45)): arr1 = -0.036133, arr2 = -0.036377, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 64631 (49.31%)
[1.0e-06, 1.0e-05): 5957 (4.54%)
[1.0e-05, 1.0e-04): 58382 (44.54%)
[1.0e-04, 1.0e-03): 2102 (1.60%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017799928318709135

Top differences:
Position (np.int64(73), np.int64(5), np.int64(127)): arr1 = -0.030518, arr2 = -0.028687, Diff = 0.001831
Position (np.int64(86), np.int64(7), np.int64(101)): arr1 = 0.004913, arr2 = 0.003235, Diff = 0.001678
Position (np.int64(94), np.int64(6), np.int64(117)): arr1 = -0.025879, arr2 = -0.024292, Diff = 0.001587
Position (np.int64(45), np.int64(6), np.int64(62)): arr1 = -0.000170, arr2 = -0.001717, Diff = 0.001547
Position (np.int64(68), np.int64(0), np.int64(114)): arr1 = 0.016724, arr2 = 0.015198, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 5521 (4.21%)
[1.0e-06, 1.0e-05): 385 (0.29%)
[1.0e-05, 1.0e-04): 20003 (15.26%)
[1.0e-04, 1.0e-03): 104010 (79.35%)
[1.0e-03, 1.0e-02): 1153 (0.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=092ecd77eed64036aaee555bca567809
triton_output_md5=a66488cc52831741ef938a52a8b58c02
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(23), np.int64(1), np.int64(93)): arr1 = -0.032471, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(2), np.int64(7), np.int64(103)): arr1 = -0.031738, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(16), np.int64(6), np.int64(35)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(19), np.int64(6), np.int64(120)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(15), np.int64(2), np.int64(75)): arr1 = -0.033203, arr2 = -0.033447, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 16211 (49.47%)
[1.0e-06, 1.0e-05): 1446 (4.41%)
[1.0e-05, 1.0e-04): 14540 (44.37%)
[1.0e-04, 1.0e-03): 571 (1.74%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0015869140625
max_diff_thr=0.001570427673868835

Top differences:
Position (np.int64(28), np.int64(3), np.int64(42)): arr1 = 0.012085, arr2 = 0.010498, Diff = 0.001587
Position (np.int64(7), np.int64(1), np.int64(100)): arr1 = -0.008240, arr2 = -0.006683, Diff = 0.001556
Position (np.int64(9), np.int64(4), np.int64(90)): arr1 = 0.012939, arr2 = 0.011475, Diff = 0.001465
Position (np.int64(5), np.int64(3), np.int64(18)): arr1 = 0.013000, arr2 = 0.011536, Diff = 0.001465
Position (np.int64(3), np.int64(5), np.int64(84)): arr1 = 0.017822, arr2 = 0.016357, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1381 (4.21%)
[1.0e-06, 1.0e-05): 103 (0.31%)
[1.0e-05, 1.0e-04): 4918 (15.01%)
[1.0e-04, 1.0e-03): 26024 (79.42%)
[1.0e-03, 1.0e-02): 342 (1.04%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2358c3d880fa7c3def4015dce5528132
triton_output_md5=cbf75eb79a03fe9984aca4f9f6de909b
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(64), np.int64(4), np.int64(102)): arr1 = -0.042236, arr2 = -0.042480, Diff = 0.000244
Position (np.int64(26), np.int64(5), np.int64(80)): arr1 = -0.038818, arr2 = -0.039062, Diff = 0.000244
Position (np.int64(94), np.int64(7), np.int64(21)): arr1 = -0.035156, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(113), np.int64(2), np.int64(99)): arr1 = -0.037598, arr2 = -0.037842, Diff = 0.000244
Position (np.int64(79), np.int64(5), np.int64(69)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 64932 (49.54%)
[1.0e-06, 1.0e-05): 5665 (4.32%)
[1.0e-05, 1.0e-04): 58307 (44.48%)
[1.0e-04, 1.0e-03): 2168 (1.65%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018002880970016122

Top differences:
Position (np.int64(125), np.int64(4), np.int64(41)): arr1 = -0.018921, arr2 = -0.017090, Diff = 0.001831
Position (np.int64(96), np.int64(0), np.int64(94)): arr1 = 0.034668, arr2 = 0.032959, Diff = 0.001709
Position (np.int64(21), np.int64(2), np.int64(103)): arr1 = -0.018921, arr2 = -0.017212, Diff = 0.001709
Position (np.int64(7), np.int64(1), np.int64(45)): arr1 = -0.034180, arr2 = -0.032471, Diff = 0.001709
Position (np.int64(16), np.int64(4), np.int64(26)): arr1 = 0.008606, arr2 = 0.006927, Diff = 0.001678

Threshold statistics:
[0.0e+00, 1.0e-06): 5486 (4.19%)
[1.0e-06, 1.0e-05): 374 (0.29%)
[1.0e-05, 1.0e-04): 19938 (15.21%)
[1.0e-04, 1.0e-03): 104054 (79.39%)
[1.0e-03, 1.0e-02): 1220 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=febc1e6e8c8d816535e099a2b0265fdc
triton_output_md5=b573835e17642af047ebc2718485a6b9
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(20), np.int64(3), np.int64(119)): arr1 = 0.032471, arr2 = 0.032227, Diff = 0.000244
Position (np.int64(3), np.int64(5), np.int64(127)): arr1 = -0.033203, arr2 = -0.033447, Diff = 0.000244
Position (np.int64(3), np.int64(7), np.int64(127)): arr1 = -0.035889, arr2 = -0.035645, Diff = 0.000244
Position (np.int64(4), np.int64(2), np.int64(75)): arr1 = -0.031738, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(2), np.int64(4), np.int64(107)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 16337 (49.86%)
[1.0e-06, 1.0e-05): 1500 (4.58%)
[1.0e-05, 1.0e-04): 14360 (43.82%)
[1.0e-04, 1.0e-03): 571 (1.74%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016884761862456799

Top differences:
Position (np.int64(13), np.int64(5), np.int64(90)): arr1 = 0.013855, arr2 = 0.012146, Diff = 0.001709
Position (np.int64(12), np.int64(2), np.int64(55)): arr1 = -0.023560, arr2 = -0.021973, Diff = 0.001587[aiter INFO] 2025-09-27 09:26:09.400 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:09.468 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:142 - main_func
start build /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2
hipcc -fPIC -D__HIP_PLATFORM_AMD__=1 -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_HCC__=1 -mllvm --lsr-drop-solution=1 -Wno-undefined-func-template -Wno-vla-cxx-extension -mllvm --amdgpu-kernarg-preload-count=16 -DLEGACY_HIPBLAS_DIRECT -U__HIP_NO_HALF_CONVERSIONS__ -DENABLE_FP8 -mllvm -amdgpu-coerce-illegal-types=1 -O3 -DUSE_PROF_API=1 -Wno-unused-result -DUSE_ROCM -fno-offload-uniform-block -Wno-switch-bool -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false --offload-arch=gfx942 -mllvm -enable-post-misched=0 -U__HIP_NO_HALF_OPERATORS__ -std=c++20 -I/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include -c pa_0bfea16d160d9b5d395c087a87de5bd2.cpp -o pa_0bfea16d160d9b5d395c087a87de5bd2.o
In file included from pa_0bfea16d160d9b5d395c087a87de5bd2.cpp:1:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_0bfea16d160d9b5d395c087a87de5bd2.cpp:1:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_0bfea16d160d9b5d395c087a87de5bd2.o -o lib.so
[aiter INFO] 2025-09-27 09:26:12.504 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:220 - final_func
finish build /root/.aiter/build/pa_0bfea16d160d9b5d395c087a87de5bd2, cost 3.03568796s
[aiter INFO] 2025-09-27 09:26:12.555 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.73186144439302 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:12.615 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 31, 32, 933, 934, 42, 43, 53, 54, 64, 65, 834, 835, 75, 76, 86, 87, 97, 98, 119, 120}
[aiter INFO] 2025-09-27 09:26:12.615 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.559000000000026
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.798999999999978
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000028
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000815
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.23899999999992
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.99899999999991
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000028
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.87900000000002
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000524
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999998923
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.960000000000036
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999814
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.95900000000006
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.439000000000078
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-27 09:26:12.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:26:12.617 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-27 09:26:12.635 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            808.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          1,371.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,430.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.3             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:12.636 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.22 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:13.270 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.96437606126955 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:13.324 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {220, 12, 142}
[aiter INFO] 2025-09-27 09:26:13.325 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.879000000000133
[aiter INFO] 2025-09-27 09:26:13.325 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.319000000000017
[aiter INFO] 2025-09-27 09:26:13.325 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.799999999999955
[aiter INFO] 2025-09-27 09:26:13.335 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,385.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:13.458 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.25762383890624 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:13.494 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {258, 6, 587, 559, 251}
[aiter INFO] 2025-09-27 09:26:13.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.75899999999956
[aiter INFO] 2025-09-27 09:26:13.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:26:13.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:26:13.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-27 09:26:13.495 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.839000000000169
[aiter INFO] 2025-09-27 09:26:13.507 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            431.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:13.508 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:13.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:13.571 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.1742379051624 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:13.627 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 207, 208, 815, 372, 373, 1021, 1022}
[aiter INFO] 2025-09-27 09:26:13.627 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.199000000000012
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.439000000000306
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000233
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.359000000000378
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000087
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.279000000000451
[aiter INFO] 2025-09-27 09:26:13.628 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000597
[aiter INFO] 2025-09-27 09:26:13.646 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            411.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,049.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,524.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.2             15.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:13.647 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.22 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:13.730 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.11524764854128 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:13.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77, 558}
[aiter INFO] 2025-09-27 09:26:13.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-09-27 09:26:13.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-09-27 09:26:13.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.639000000000124
[aiter INFO] 2025-09-27 09:26:13.799 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,284.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:13.826 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.002970301278744 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:13.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:13.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-27 09:26:13.875 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            300.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:13.875 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:13.877 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:13.992 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.02136615066246 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 21, 405, 406, 42, 43, 53, 54, 185, 186, 64, 65, 196, 197, 207, 208, 86, 87}
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.239000000000033
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.319000000000017
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999994
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999833
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.599000000000046
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.31899999999996
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000065
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.55899999999997
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.95900000000006
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999955
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999814
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-27 09:26:14.044 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:26:14.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-27 09:26:14.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.759000000000015
[aiter INFO] 2025-09-27 09:26:14.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-27 09:26:14.063 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            816.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,383.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,428.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.3             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.064 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:14.234 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.1623761258503 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.285 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {233, 51, 12}
[aiter INFO] 2025-09-27 09:26:14.285 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.758999999999787
[aiter INFO] 2025-09-27 09:26:14.285 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.759000000000015
[aiter INFO] 2025-09-27 09:26:14.285 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.63900000000001
[aiter INFO] 2025-09-27 09:26:14.295 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,377.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.322 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.99624762765252 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.355 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {356, 244, 293, 6}
[aiter INFO] 2025-09-27 09:26:14.355 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-27 09:26:14.356 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000133
[aiter INFO] 2025-09-27 09:26:14.356 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:26:14.356 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-27 09:26:14.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            435.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.368 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:14.373 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:14.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.74215856283018 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {153, 10, 9, 151}
[aiter INFO] 2025-09-27 09:26:14.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-27 09:26:14.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:14.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999976
[aiter INFO] 2025-09-27 09:26:14.626 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999915
[aiter INFO] 2025-09-27 09:26:14.645 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,085.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,529.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.646 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:14.730 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.23518801915765 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-27 09:26:14.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.478999999999985
[aiter INFO] 2025-09-27 09:26:14.787 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.039000000000016
[aiter INFO] 2025-09-27 09:26:14.799 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,287.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.826 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.22200011115263 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:14.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:14.863 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-27 09:26:14.875 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:14.876 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    15.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(6), np.int64(5), np.int64(119)): arr1 = 0.021484, arr2 = 0.019897, Diff = 0.001587
Position (np.int64(17), np.int64(0), np.int64(23)): arr1 = -0.017334, arr2 = -0.015747, Diff = 0.001587
Position (np.int64(14), np.int64(0), np.int64(103)): arr1 = -0.019287, arr2 = -0.017700, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1396 (4.26%)
[1.0e-06, 1.0e-05): 89 (0.27%)
[1.0e-05, 1.0e-04): 4865 (14.85%)
[1.0e-04, 1.0e-03): 26106 (79.67%)
[1.0e-03, 1.0e-02): 312 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=932523fdfaee1479549700f09ec3ef60
triton_output_md5=3dc73b0305f37692c2095de97d0cee16
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(3), np.int64(0), np.int64(95)): arr1 = -0.507812, arr2 = -0.511719, Diff = 0.003906
Position (np.int64(77), np.int64(2), np.int64(68)): arr1 = -0.507812, arr2 = -0.503906, Diff = 0.003906
Position (np.int64(103), np.int64(5), np.int64(112)): arr1 = 0.546875, arr2 = 0.550781, Diff = 0.003906
Position (np.int64(95), np.int64(9), np.int64(56)): arr1 = 0.515625, arr2 = 0.519531, Diff = 0.003906
Position (np.int64(126), np.int64(1), np.int64(71)): arr1 = -0.539062, arr2 = -0.542969, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 95926 (58.55%)
[1.0e-06, 1.0e-05): 22 (0.01%)
[1.0e-05, 1.0e-04): 1489 (0.91%)
[1.0e-04, 1.0e-03): 58863 (35.93%)
[1.0e-03, 1.0e-02): 7540 (4.60%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0390625
max_diff_thr=0.03137902542948723

Top differences:
Position (np.int64(10), np.int64(5), np.int64(116)): arr1 = -0.589844, arr2 = -0.550781, Diff = 0.039062
Position (np.int64(77), np.int64(7), np.int64(127)): arr1 = -0.527344, arr2 = -0.490234, Diff = 0.037109
Position (np.int64(104), np.int64(5), np.int64(16)): arr1 = 0.219727, arr2 = 0.182617, Diff = 0.037109
Position (np.int64(78), np.int64(2), np.int64(103)): arr1 = -0.546875, arr2 = -0.511719, Diff = 0.035156
Position (np.int64(29), np.int64(8), np.int64(13)): arr1 = -0.613281, arr2 = -0.578125, Diff = 0.035156

Threshold statistics:
[0.0e+00, 1.0e-06): 7000 (4.27%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 69 (0.04%)
[1.0e-04, 1.0e-03): 11644 (7.11%)
[1.0e-03, 1.0e-02): 108118 (65.99%)
[1.0e-02, 1.0e-01): 37007 (22.59%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a1ce0996eb9ba0c612143d7d54ed250d
triton_output_md5=21d708b09aa7f1bcfc12ef22f52cc202
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(8), np.int64(6), np.int64(102)): arr1 = -0.648438, arr2 = -0.652344, Diff = 0.003906
Position (np.int64(20), np.int64(7), np.int64(73)): arr1 = 0.531250, arr2 = 0.527344, Diff = 0.003906
Position (np.int64(16), np.int64(7), np.int64(80)): arr1 = 0.570312, arr2 = 0.566406, Diff = 0.003906
Position (np.int64(4), np.int64(7), np.int64(92)): arr1 = -0.601562, arr2 = -0.597656, Diff = 0.003906
Position (np.int64(4), np.int64(9), np.int64(19)): arr1 = 0.613281, arr2 = 0.617188, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 24159 (58.98%)
[1.0e-06, 1.0e-05): 9 (0.02%)
[1.0e-05, 1.0e-04): 407 (0.99%)
[1.0e-04, 1.0e-03): 14559 (35.54%)
[1.0e-03, 1.0e-02): 1826 (4.46%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.03515625
max_diff_thr=0.03365384787321091

Top differences:
Position (np.int64(23), np.int64(2), np.int64(56)): arr1 = -0.189453, arr2 = -0.154297, Diff = 0.035156
Position (np.int64(0), np.int64(5), np.int64(62)): arr1 = -0.722656, arr2 = -0.687500, Diff = 0.035156
Position (np.int64(24), np.int64(2), np.int64(80)): arr1 = -0.049805, arr2 = -0.015625, Diff = 0.034180
Position (np.int64(18), np.int64(3), np.int64(49)): arr1 = -0.118652, arr2 = -0.084961, Diff = 0.033691
Position (np.int64(21), np.int64(3), np.int64(112)): arr1 = -0.357422, arr2 = -0.324219, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 1799 (4.39%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 17 (0.04%)
[1.0e-04, 1.0e-03): 2915 (7.12%)
[1.0e-03, 1.0e-02): 26995 (65.91%)
[1.0e-02, 1.0e-01): 9233 (22.54%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1ff7ff073dd7ed18a1f233f439310412
triton_output_md5=8eb34d8af08aec9cdcc5430c459110a6
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(101), np.int64(6), np.int64(26)): arr1 = 0.339844, arr2 = 0.341797, Diff = 0.001953
Position (np.int64(27), np.int64(6), np.int64(33)): arr1 = 0.285156, arr2 = 0.287109, Diff = 0.001953
Position (np.int64(22), np.int64(0), np.int64(10)): arr1 = 0.253906, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(46), np.int64(4), np.int64(77)): arr1 = -0.324219, arr2 = -0.322266, Diff = 0.001953
Position (np.int64(39), np.int64(1), np.int64(126)): arr1 = 0.273438, arr2 = 0.275391, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 94806 (57.86%)
[1.0e-06, 1.0e-05): 71 (0.04%)
[1.0e-05, 1.0e-04): 4962 (3.03%)
[1.0e-04, 1.0e-03): 63483 (38.75%)
[1.0e-03, 1.0e-02): 518 (0.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0234375
max_diff_thr=0.021023765206336975

Top differences:
Position (np.int64(100), np.int64(6), np.int64(64)): arr1 = 0.287109, arr2 = 0.263672, Diff = 0.023438
Position (np.int64(5), np.int64(5), np.int64(1)): arr1 = 0.090820, arr2 = 0.068359, Diff = 0.022461
Position (np.int64(35), np.int64(2), np.int64(63)): arr1 = 0.185547, arr2 = 0.163086, Diff = 0.022461
Position (np.int64(89), np.int64(2), np.int64(60)): arr1 = 0.050049, arr2 = 0.030273, Diff = 0.019775
Position (np.int64(127), np.int64(4), np.int64(75)): arr1 = -0.316406, arr2 = -0.296875, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 6795 (4.15%)
[1.0e-06, 1.0e-05): 5 (0.00%)
[1.0e-05, 1.0e-04): 241 (0.15%)
[1.0e-04, 1.0e-03): 26217 (16.00%)
[1.0e-03, 1.0e-02): 125501 (76.60%)
[1.0e-02, 1.0e-01): 5081 (3.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4c5671ffc18f9dd40ddfe373a7ed32bf
triton_output_md5=7f4b1e39ef8b081740331284921657b5
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(7), np.int64(0), np.int64(125)): arr1 = 0.257812, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(25), np.int64(2), np.int64(22)): arr1 = 0.253906, arr2 = 0.255859, Diff = 0.001953
Position (np.int64(21), np.int64(3), np.int64(127)): arr1 = 0.265625, arr2 = 0.267578, Diff = 0.001953
Position (np.int64(16), np.int64(7), np.int64(84)): arr1 = -0.273438, arr2 = -0.271484, Diff = 0.001953
Position (np.int64(16), np.int64(5), np.int64(17)): arr1 = -0.261719, arr2 = -0.263672, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 23799 (58.10%)
[1.0e-06, 1.0e-05): 22 (0.05%)
[1.0e-05, 1.0e-04): 1236 (3.02%)
[1.0e-04, 1.0e-03): 15761 (38.48%)
[1.0e-03, 1.0e-02): 142 (0.35%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.025390625
max_diff_thr=0.017819948494434357

Top differences:
Position (np.int64(24), np.int64(7), np.int64(105)): arr1 = 0.460938, arr2 = 0.435547, Diff = 0.025391
Position (np.int64(20), np.int64(3), np.int64(80)): arr1 = -0.073730, arr2 = -0.054932, Diff = 0.018799
Position (np.int64(1), np.int64(4), np.int64(18)): arr1 = 0.210938, arr2 = 0.192383, Diff = 0.018555
Position (np.int64(26), np.int64(2), np.int64(15)): arr1 = -0.247070, arr2 = -0.228516, Diff = 0.018555
Position (np.int64(4), np.int64(1), np.int64(2)): arr1 = 0.156250, arr2 = 0.137695, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 1697 (4.14%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 49 (0.12%)
[1.0e-04, 1.0e-03): 6340 (15.48%)
[1.0e-03, 1.0e-02): 31461 (76.81%)
[1.0e-02, 1.0e-01): 1412 (3.45%)
[1.0e-01, 1.0e+00): 0 (0.00%)[aiter INFO] 2025-09-27 09:26:14.878 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:14.993 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.07879187151937 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 12, 20, 21, 42, 43, 53, 54, 64, 65, 75, 76, 207, 208, 86, 87, 97, 98, 108, 109}
[aiter INFO] 2025-09-27 09:26:15.045 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.479000000000042
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999878
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.119000000000028
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.918999999999983
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.678999999999974
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.319000000000074
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999969
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.519000000000005
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999915
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.63900000000001
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.998999999999796
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.278999999999996
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.31899999999996
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.118999999999915
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19899999999984
[aiter INFO] 2025-09-27 09:26:15.046 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-27 09:26:15.065 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            814.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          1,365.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,434.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.3             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.065 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:15.238 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.81189133330147 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.290 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:15.290 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.399
[aiter INFO] 2025-09-27 09:26:15.301 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,415.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.328 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.68891084400734 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.361 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 111}
[aiter INFO] 2025-09-27 09:26:15.361 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-27 09:26:15.361 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-27 09:26:15.373 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            447.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.374 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:15.378 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:15.438 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.77066304365007 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.491 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:15.492 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999976
[aiter INFO] 2025-09-27 09:26:15.492 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000035
[aiter INFO] 2025-09-27 09:26:15.510 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,091.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,522.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.2             15.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.511 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:15.594 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.34607928460187 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.650 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:15.650 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-09-27 09:26:15.662 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,303.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.689 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.534049309126225 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.725 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:15.725 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:26:15.737 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:15.740 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:15.854 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.34415820683583 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {262, 263, 9, 12, 20, 21, 152, 153, 163, 164, 53, 54, 64, 65, 86, 87, 97, 98, 867, 868, 108, 109}
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.31899999999996
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.83899999999997
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000021
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.55899999999997
[aiter INFO] 2025-09-27 09:26:15.905 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.598999999999933
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.95900000000006
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.798999999999978
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999928
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.24000000000001
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.159999999999854
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999942
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.398999999999887
[aiter INFO] 2025-09-27 09:26:15.906 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-27 09:26:15.924 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            812.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          1,377.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,443.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.4             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:15.925 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:16.102 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.03246507314172 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:26:16.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.59900000000016
[aiter INFO] 2025-09-27 09:26:16.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.758999999999986
[aiter INFO] 2025-09-27 09:26:16.162 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,405.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.188 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.730534731751625 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.358 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:16.358 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-27 09:26:16.370 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.371 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:16.375 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:16.435 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.2241288759921 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:16.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-09-27 09:26:16.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-27 09:26:16.509 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,089.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,519.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.2             15.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.510 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:16.593 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.6447423383741 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.649 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:16.650 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.87899999999999
[aiter INFO] 2025-09-27 09:26:16.662 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,311.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.688 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.610910975992084 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.726 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:16.726 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:26:16.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.739 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:16.740 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:16.856 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.7057526613226 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 97, 98, 9, 42, 43, 10, 20, 53, 21, 54, 86, 87}
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.359000000000037
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999955
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.679000000000087
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.59899999999999
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.23899999999992
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.278999999999996
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.559000000000083
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:26:16.908 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.3599999999999
[aiter INFO] 2025-09-27 09:26:16.927 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            851.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          1,428.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,433.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.3             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:16.928 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=28a2c400b12cc8e4ee6e42faa2cf6554
triton_output_md5=887950ccec793957b88bae5d3e28b471
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(15), np.int64(5), np.int64(117)): arr1 = -0.302734, arr2 = -0.304688, Diff = 0.001953
Position (np.int64(92), np.int64(4), np.int64(89)): arr1 = -0.253906, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(1), np.int64(7), np.int64(79)): arr1 = 0.279297, arr2 = 0.277344, Diff = 0.001953
Position (np.int64(26), np.int64(7), np.int64(13)): arr1 = -0.251953, arr2 = -0.250000, Diff = 0.001953
Position (np.int64(60), np.int64(5), np.int64(108)): arr1 = 0.251953, arr2 = 0.253906, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 94170 (57.48%)
[1.0e-06, 1.0e-05): 165 (0.10%)
[1.0e-05, 1.0e-04): 10255 (6.26%)
[1.0e-04, 1.0e-03): 59229 (36.15%)
[1.0e-03, 1.0e-02): 21 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.015625
max_diff_thr=0.014492753893136978

Top differences:
Position (np.int64(68), np.int64(0), np.int64(101)): arr1 = -0.259766, arr2 = -0.244141, Diff = 0.015625
Position (np.int64(40), np.int64(0), np.int64(19)): arr1 = -0.025391, arr2 = -0.010742, Diff = 0.014648
Position (np.int64(28), np.int64(0), np.int64(115)): arr1 = -0.235352, arr2 = -0.220703, Diff = 0.014648
Position (np.int64(17), np.int64(8), np.int64(11)): arr1 = -0.129883, arr2 = -0.115234, Diff = 0.014648
Position (np.int64(46), np.int64(3), np.int64(56)): arr1 = -0.011292, arr2 = 0.003220, Diff = 0.014511

Threshold statistics:
[0.0e+00, 1.0e-06): 6823 (4.16%)
[1.0e-06, 1.0e-05): 11 (0.01%)
[1.0e-05, 1.0e-04): 543 (0.33%)
[1.0e-04, 1.0e-03): 37955 (23.17%)
[1.0e-03, 1.0e-02): 118155 (72.12%)
[1.0e-02, 1.0e-01): 353 (0.22%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=db0c47e6bd0fdf2470109d2764b8f3ab
triton_output_md5=214d86fac6c0e16f1167482bc22d0fd0
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(0), np.int64(5), np.int64(3)): arr1 = -0.298828, arr2 = -0.296875, Diff = 0.001953
Position (np.int64(24), np.int64(9), np.int64(40)): arr1 = -0.279297, arr2 = -0.277344, Diff = 0.001953
Position (np.int64(0), np.int64(6), np.int64(3)): arr1 = -0.306641, arr2 = -0.308594, Diff = 0.001953
Position (np.int64(31), np.int64(5), np.int64(98)): arr1 = -0.265625, arr2 = -0.267578, Diff = 0.001953
Position (np.int64(9), np.int64(2), np.int64(107)): arr1 = -0.257812, arr2 = -0.259766, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 23704 (57.87%)
[1.0e-06, 1.0e-05): 33 (0.08%)
[1.0e-05, 1.0e-04): 2598 (6.34%)
[1.0e-04, 1.0e-03): 14618 (35.69%)
[1.0e-03, 1.0e-02): 7 (0.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.012367491610348225

Top differences:
Position (np.int64(0), np.int64(2), np.int64(3)): arr1 = -0.339844, arr2 = -0.326172, Diff = 0.013672
Position (np.int64(10), np.int64(0), np.int64(109)): arr1 = -0.119141, arr2 = -0.105469, Diff = 0.013672
Position (np.int64(17), np.int64(8), np.int64(110)): arr1 = -0.292969, arr2 = -0.279297, Diff = 0.013672
Position (np.int64(0), np.int64(3), np.int64(30)): arr1 = 0.189453, arr2 = 0.176758, Diff = 0.012695
Position (np.int64(9), np.int64(3), np.int64(59)): arr1 = -0.162109, arr2 = -0.149414, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1660 (4.05%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 124 (0.30%)
[1.0e-04, 1.0e-03): 9566 (23.35%)
[1.0e-03, 1.0e-02): 29528 (72.09%)
[1.0e-02, 1.0e-01): 82 (0.20%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e0df61e14ab1a945a5ba246fe6e5eedd
triton_output_md5=460beb3d6b36c5aca53f9bc4da321708
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(121), np.int64(3), np.int64(20)): arr1 = -0.250000, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(114), np.int64(1), np.int64(96)): arr1 = 0.253906, arr2 = 0.251953, Diff = 0.001953
Position (np.int64(119), np.int64(6), np.int64(28)): arr1 = 0.261719, arr2 = 0.259766, Diff = 0.001953
Position (np.int64(42), np.int64(3), np.int64(28)): arr1 = 0.251953, arr2 = 0.253906, Diff = 0.001953
Position (np.int64(28), np.int64(7), np.int64(2)): arr1 = 0.145508, arr2 = 0.146484, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 94324 (57.57%)
[1.0e-06, 1.0e-05): 163 (0.10%)
[1.0e-05, 1.0e-04): 11501 (7.02%)
[1.0e-04, 1.0e-03): 57848 (35.31%)
[1.0e-03, 1.0e-02): 4 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.012723845429718494

Top differences:
Position (np.int64(22), np.int64(0), np.int64(87)): arr1 = 0.095215, arr2 = 0.081543, Diff = 0.013672
Position (np.int64(121), np.int64(3), np.int64(20)): arr1 = -0.267578, arr2 = -0.253906, Diff = 0.013672
Position (np.int64(100), np.int64(7), np.int64(105)): arr1 = 0.214844, arr2 = 0.201172, Diff = 0.013672
Position (np.int64(35), np.int64(8), np.int64(73)): arr1 = 0.125977, arr2 = 0.112793, Diff = 0.013184
Position (np.int64(97), np.int64(0), np.int64(71)): arr1 = -0.049316, arr2 = -0.036133, Diff = 0.013184

Threshold statistics:
[0.0e+00, 1.0e-06): 6848 (4.18%)
[1.0e-06, 1.0e-05): 5 (0.00%)
[1.0e-05, 1.0e-04): 575 (0.35%)
[1.0e-04, 1.0e-03): 40776 (24.89%)
[1.0e-03, 1.0e-02): 115507 (70.50%)
[1.0e-02, 1.0e-01): 129 (0.08%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=91686d2a3eb82ca00eea765fef12e436
triton_output_md5=5f94065ef2d4722580c0a211ff6962d5
diff.abs.max=0.001953125
max_diff_thr=0.0015455950051546097

Top differences:
Position (np.int64(16), np.int64(1), np.int64(33)): arr1 = 0.261719, arr2 = 0.263672, Diff = 0.001953
Position (np.int64(13), np.int64(9), np.int64(96)): arr1 = -0.126953, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(22), np.int64(1), np.int64(37)): arr1 = -0.152344, arr2 = -0.153320, Diff = 0.000977
Position (np.int64(10), np.int64(6), np.int64(67)): arr1 = -0.143555, arr2 = -0.144531, Diff = 0.000977
Position (np.int64(27), np.int64(9), np.int64(4)): arr1 = -0.181641, arr2 = -0.182617, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23418 (57.17%)
[1.0e-06, 1.0e-05): 48 (0.12%)
[1.0e-05, 1.0e-04): 2903 (7.09%)
[1.0e-04, 1.0e-03): 14590 (35.62%)
[1.0e-03, 1.0e-02): 1 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.013671875
max_diff_thr=0.011877569369971752

Top differences:
Position (np.int64(25), np.int64(3), np.int64(19)): arr1 = -0.212891, arr2 = -0.199219, Diff = 0.013672
Position (np.int64(11), np.int64(0), np.int64(38)): arr1 = -0.233398, arr2 = -0.220703, Diff = 0.012695
Position (np.int64(15), np.int64(9), np.int64(67)): arr1 = -0.097656, arr2 = -0.084961, Diff = 0.012695
Position (np.int64(0), np.int64(7), np.int64(104)): arr1 = -0.131836, arr2 = -0.119141, Diff = 0.012695
Position (np.int64(9), np.int64(8), np.int64(73)): arr1 = 0.081543, arr2 = 0.068848, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1721 (4.20%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 154 (0.38%)
[1.0e-04, 1.0e-03): 10240 (25.00%)
[1.0e-03, 1.0e-02): 28815 (70.35%)
[1.0e-02, 1.0e-01): 30 (0.07%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1af840d4f03c5350412a84238ffb4ddc
triton_output_md5=d479229b8f9d3bc67fa4d46795b481a3
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(15), np.int64(8), np.int64(22)): arr1 = -0.159180, arr2 = -0.160156, Diff = 0.000977
Position (np.int64(24), np.int64(6), np.int64(5)): arr1 = -0.160156, arr2 = -0.159180, Diff = 0.000977
Position (np.int64(35), np.int64(4), np.int64(30)): arr1 = 0.145508, arr2 = 0.146484, Diff = 0.000977[aiter INFO] 2025-09-27 09:26:17.101 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.74536671791927 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 311, 207}
[aiter INFO] 2025-09-27 09:26:17.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.718999999999994
[aiter INFO] 2025-09-27 09:26:17.152 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.679000000000087
[aiter INFO] 2025-09-27 09:26:17.153 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.878999999999905
[aiter INFO] 2025-09-27 09:26:17.163 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,376.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.190 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.125326797218605 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.223 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:17.223 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5589999999999975
[aiter INFO] 2025-09-27 09:26:17.235 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            449.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.236 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:17.240 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:17.299 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.14693060723863 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:17.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-09-27 09:26:17.353 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:17.371 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,085.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,513.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.372 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:17.456 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.24669315201221 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1299, 12, 1143}
[aiter INFO] 2025-09-27 09:26:17.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.679000000000087
[aiter INFO] 2025-09-27 09:26:17.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000007
[aiter INFO] 2025-09-27 09:26:17.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.71900000000096
[aiter INFO] 2025-09-27 09:26:17.524 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,282.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.551 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.80733671607358 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.587 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:17.587 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-27 09:26:17.599 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.600 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:17.601 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:17.715 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.9021684078887 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 647, 648, 9, 12, 141, 142, 20, 21, 152, 153, 31, 32, 163, 164, 42, 43, 53, 54, 64, 65, 75, 77, 207, 208, 86, 87, 97, 98, 108, 109, 119, 120}
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.798999999999978
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999578
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999999833
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999995
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999955
[aiter INFO] 2025-09-27 09:26:17.765 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.439000000000078
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.998999999999967
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.678999999999974
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000142
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.559000000000026
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.079000000000065
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.63900000000001
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999928
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.99899999999991
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.63900000000001
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.198999999999614
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.920000000000073
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.7589999999999
[aiter INFO] 2025-09-27 09:26:17.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.878999999999905
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.598999999999933
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.31899999999996
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399000000000115
[aiter INFO] 2025-09-27 09:26:17.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.960000000000036
[aiter INFO] 2025-09-27 09:26:17.785 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  84.0            0.0            757.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  84.0            0.0          1,273.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,437.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.4             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:17.786 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:17.955 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.10772272383812 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.142 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:26:18.142 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.639000000001033
[aiter INFO] 2025-09-27 09:26:18.142 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.758999999999986
[aiter INFO] 2025-09-27 09:26:18.153 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,402.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.180 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.79347516906144 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.215 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:18.215 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-27 09:26:18.226 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            450.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.227 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:18.232 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:18.291 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.64193058427017 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 207, 208, 856, 857}
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000021
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.639000000000124
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.47899999999936
[aiter INFO] 2025-09-27 09:26:18.346 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.03899999999885
[aiter INFO] 2025-09-27 09:26:18.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            421.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,063.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,514.9              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.1             15.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.365 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:18.449 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.11996050754396 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.507 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-27 09:26:18.507 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.47899999999936
[aiter INFO] 2025-09-27 09:26:18.507 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000007
[aiter INFO] 2025-09-27 09:26:18.519 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,295.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.546 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.65881178933795 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.583 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:18.584 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-27 09:26:18.596 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.596 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.05 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:18.598 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:18.714 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.55838618715211 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 11, 20, 21, 152, 153, 669, 670, 42, 43, 53, 54, 64, 65, 75, 76, 86, 87, 97, 98}
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.038999999999987
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000044
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.480000000000018
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-27 09:26:18.766 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.598999999999933
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.078999999999724
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.359000000000037
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.599000000000046
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.999000000000024
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.039000000000101
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.918999999999983
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.95900000000006
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.920000000000073
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.67899999999986
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.598999999999933
[aiter INFO] 2025-09-27 09:26:18.767 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-27 09:26:18.786 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            817.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,389.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,437.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           24.4             24.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:18.786 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:18.958 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.54456428017947 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {272, 194, 12, 103}
[aiter INFO] 2025-09-27 09:26:19.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.798999999999978
[aiter INFO] 2025-09-27 09:26:19.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.71900000000005
[aiter INFO] 2025-09-27 09:26:19.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.799000000000007
[aiter INFO] 2025-09-27 09:26:19.009 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.718999999999937
[aiter INFO] 2025-09-27 09:26:19.020 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          2,346.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.047 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.73601006015693 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {454, 230, 6, 300, 209, 657, 664}
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000069
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000133
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.478999999999985
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000069
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-27 09:26:19.080 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.118999999999687
[aiter INFO] 2025-09-27 09:26:19.081 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-27 09:26:19.092 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0            423.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.093 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(125), np.int64(2), np.int64(100)): arr1 = 0.127930, arr2 = 0.126953, Diff = 0.000977
Position (np.int64(94), np.int64(1), np.int64(8)): arr1 = -0.148438, arr2 = -0.149414, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 94188 (57.49%)
[1.0e-06, 1.0e-05): 302 (0.18%)
[1.0e-05, 1.0e-04): 17579 (10.73%)
[1.0e-04, 1.0e-03): 51771 (31.60%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0107421875
max_diff_thr=0.009803921915590763

Top differences:
Position (np.int64(106), np.int64(3), np.int64(2)): arr1 = 0.116211, arr2 = 0.105469, Diff = 0.010742
Position (np.int64(106), np.int64(9), np.int64(33)): arr1 = 0.106445, arr2 = 0.095703, Diff = 0.010742
Position (np.int64(45), np.int64(8), np.int64(53)): arr1 = 0.081543, arr2 = 0.071289, Diff = 0.010254
Position (np.int64(95), np.int64(9), np.int64(80)): arr1 = -0.116699, arr2 = -0.106934, Diff = 0.009766
Position (np.int64(62), np.int64(9), np.int64(5)): arr1 = -0.192383, arr2 = -0.182617, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 6769 (4.13%)
[1.0e-06, 1.0e-05): 13 (0.01%)
[1.0e-05, 1.0e-04): 978 (0.60%)
[1.0e-04, 1.0e-03): 51455 (31.41%)
[1.0e-03, 1.0e-02): 104622 (63.86%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=249c2f8a0c84a869b0931a4aaf7de9ec
triton_output_md5=bd1acc6880b3cdbf3bdef8a760ac889d
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(12), np.int64(4), np.int64(106)): arr1 = 0.155273, arr2 = 0.154297, Diff = 0.000977
Position (np.int64(21), np.int64(3), np.int64(83)): arr1 = -0.146484, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(12), np.int64(9), np.int64(41)): arr1 = 0.134766, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(27), np.int64(3), np.int64(21)): arr1 = -0.132812, arr2 = -0.133789, Diff = 0.000977
Position (np.int64(24), np.int64(9), np.int64(72)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23592 (57.60%)
[1.0e-06, 1.0e-05): 69 (0.17%)
[1.0e-05, 1.0e-04): 4342 (10.60%)
[1.0e-04, 1.0e-03): 12957 (31.63%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.009765625
max_diff_thr=0.008771929889917374

Top differences:
Position (np.int64(30), np.int64(5), np.int64(92)): arr1 = 0.185547, arr2 = 0.175781, Diff = 0.009766
Position (np.int64(25), np.int64(4), np.int64(18)): arr1 = 0.140625, arr2 = 0.130859, Diff = 0.009766
Position (np.int64(6), np.int64(7), np.int64(125)): arr1 = -0.129883, arr2 = -0.120605, Diff = 0.009277
Position (np.int64(6), np.int64(9), np.int64(28)): arr1 = -0.066895, arr2 = -0.057617, Diff = 0.009277
Position (np.int64(0), np.int64(8), np.int64(37)): arr1 = -0.088867, arr2 = -0.079590, Diff = 0.009277

Threshold statistics:
[0.0e+00, 1.0e-06): 1666 (4.07%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 237 (0.58%)
[1.0e-04, 1.0e-03): 12771 (31.18%)
[1.0e-03, 1.0e-02): 26283 (64.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=07aae290b5655194880eaf179db85866
triton_output_md5=b345c40d4674f7c9ff01c8a6e3ec7d3c
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(27), np.int64(7), np.int64(83)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977
Position (np.int64(45), np.int64(0), np.int64(97)): arr1 = -0.143555, arr2 = -0.142578, Diff = 0.000977
Position (np.int64(105), np.int64(8), np.int64(123)): arr1 = -0.126953, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(119), np.int64(6), np.int64(54)): arr1 = 0.169922, arr2 = 0.170898, Diff = 0.000977
Position (np.int64(31), np.int64(3), np.int64(110)): arr1 = 0.128906, arr2 = 0.129883, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 93969 (57.35%)
[1.0e-06, 1.0e-05): 338 (0.21%)
[1.0e-05, 1.0e-04): 19959 (12.18%)
[1.0e-04, 1.0e-03): 49574 (30.26%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0087890625
max_diff_thr=0.008528397418558598

Top differences:
Position (np.int64(3), np.int64(3), np.int64(12)): arr1 = -0.147461, arr2 = -0.138672, Diff = 0.008789
Position (np.int64(8), np.int64(6), np.int64(123)): arr1 = -0.106934, arr2 = -0.098145, Diff = 0.008789
Position (np.int64(110), np.int64(8), np.int64(28)): arr1 = 0.095703, arr2 = 0.086914, Diff = 0.008789
Position (np.int64(18), np.int64(1), np.int64(113)): arr1 = -0.076660, arr2 = -0.067871, Diff = 0.008789
Position (np.int64(0), np.int64(0), np.int64(88)): arr1 = -0.152344, arr2 = -0.143555, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 6716 (4.10%)
[1.0e-06, 1.0e-05): 13 (0.01%)
[1.0e-05, 1.0e-04): 1170 (0.71%)
[1.0e-04, 1.0e-03): 54895 (33.51%)
[1.0e-03, 1.0e-02): 101046 (61.67%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2ede00ce040360ca9017785a02662a5b
triton_output_md5=47d9351237534b9321c4494bd9de692e
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(28), np.int64(6), np.int64(72)): arr1 = -0.150391, arr2 = -0.151367, Diff = 0.000977
Position (np.int64(20), np.int64(7), np.int64(90)): arr1 = 0.143555, arr2 = 0.144531, Diff = 0.000977
Position (np.int64(17), np.int64(0), np.int64(94)): arr1 = -0.148438, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(13), np.int64(3), np.int64(118)): arr1 = -0.152344, arr2 = -0.153320, Diff = 0.000977
Position (np.int64(20), np.int64(4), np.int64(72)): arr1 = -0.156250, arr2 = -0.157227, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23671 (57.79%)
[1.0e-06, 1.0e-05): 82 (0.20%)
[1.0e-05, 1.0e-04): 4832 (11.80%)
[1.0e-04, 1.0e-03): 12375 (30.21%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0087890625
max_diff_thr=0.00821884535253048

Top differences:
Position (np.int64(29), np.int64(5), np.int64(90)): arr1 = 0.110352, arr2 = 0.101562, Diff = 0.008789
Position (np.int64(2), np.int64(1), np.int64(12)): arr1 = 0.072266, arr2 = 0.063965, Diff = 0.008301
Position (np.int64(5), np.int64(5), np.int64(83)): arr1 = -0.060059, arr2 = -0.051758, Diff = 0.008301
Position (np.int64(19), np.int64(1), np.int64(43)): arr1 = 0.046143, arr2 = 0.037842, Diff = 0.008301
Position (np.int64(30), np.int64(6), np.int64(35)): arr1 = -0.110840, arr2 = -0.102539, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 1765 (4.31%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 246 (0.60%)
[1.0e-04, 1.0e-03): 14102 (34.43%)
[1.0e-03, 1.0e-02): 24846 (60.66%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e7a2aa511239a32317980d7dcd533b2c
triton_output_md5=4355ed7f1842aba92e61df7ceea3f50f
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(44), np.int64(4), np.int64(43)): arr1 = 0.129883, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(31), np.int64(6), np.int64(23)): arr1 = -0.125977, arr2 = -0.125000, Diff = 0.000977
Position (np.int64(5), np.int64(3), np.int64(118)): arr1 = 0.128906, arr2 = 0.127930, Diff = 0.000977
Position (np.int64(44), np.int64(3), np.int64(43)): arr1 = 0.134766, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(2), np.int64(9), np.int64(51)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 93797 (57.25%)
[1.0e-06, 1.0e-05): 690 (0.42%)
[1.0e-05, 1.0e-04): 32244 (19.68%)
[1.0e-04, 1.0e-03): 37109 (22.65%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00732421875[aiter INFO] 2025-09-27 09:26:19.097 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:19.156 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.71129681745379 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.210 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 9, 10, 31}
[aiter INFO] 2025-09-27 09:26:19.210 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000037
[aiter INFO] 2025-09-27 09:26:19.210 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.119000000000028
[aiter INFO] 2025-09-27 09:26:19.210 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-27 09:26:19.210 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999971
[aiter INFO] 2025-09-27 09:26:19.228 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,082.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,525.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.3             15.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.229 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.24 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:19.311 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.10808915076869 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 597}
[aiter INFO] 2025-09-27 09:26:19.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.518999999998414
[aiter INFO] 2025-09-27 09:26:19.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.599999999999994
[aiter INFO] 2025-09-27 09:26:19.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.639000000000124
[aiter INFO] 2025-09-27 09:26:19.379 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,280.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.406 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.84097044627265 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.442 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:19.442 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-27 09:26:19.454 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.454 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:19.456 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:19.571 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.11567355677633 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {900, 903, 9, 13, 20, 23, 31, 34, 42, 45, 53, 56, 1087, 64, 1090, 67, 75, 78, 86, 89, 97, 100}
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.639999999999418
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000306
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.95999999999998
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.638999999999953
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.278999999999996
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000037
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.399
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.799000000000092
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.519000000000005
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000005
[aiter INFO] 2025-09-27 09:26:19.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.799000000000888
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.920000000000073
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.318999999999505
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.198999999999955
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.319000000000074
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.19900000000007
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999878
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119000000000142
[aiter INFO] 2025-09-27 09:26:19.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.398999999999887
[aiter INFO] 2025-09-27 09:26:19.776 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            828.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          2,139.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,318.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           33.2             33.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:19.777 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:19.952 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.64759381808858 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.004 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-09-27 09:26:20.004 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.63900000000001
[aiter INFO] 2025-09-27 09:26:20.005 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.31900000000002
[aiter INFO] 2025-09-27 09:26:20.015 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,461.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             45.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.160 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.88297043666981 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 132, 6, 48, 447}
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.518999999999323
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-27 09:26:20.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.558999999999742
[aiter INFO] 2025-09-27 09:26:20.207 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            504.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.208 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    50.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:20.212 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:20.272 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.1504651679851 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.328 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:20.328 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-09-27 09:26:20.328 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-27 09:26:20.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            427.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,126.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,554.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.348 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:20.432 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.2352078238336 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:20.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.199000000000012
[aiter INFO] 2025-09-27 09:26:20.502 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,319.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.529 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.721752634437955 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.566 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:20.567 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000002
[aiter INFO] 2025-09-27 09:26:20.578 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            339.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.579 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.59 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:20.581 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:20.697 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.952891058851 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.748 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 23, 31, 34, 42, 45, 53, 56, 64, 67, 1098, 75, 1101, 78, 108, 111, 119, 122}
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.55899999999997
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.678999999999974
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.998999999999967
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.599999999999966
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.198999999999955
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.759000000000015
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.598999999999933
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999992
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.91899999999987
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.119000000000028
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000742
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999955
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.879000000000133
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-27 09:26:20.749 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.358999999999924
[aiter INFO] 2025-09-27 09:26:20.750 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-27 09:26:20.768 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            837.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,161.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,309.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           33.1             33.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:20.769 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:20.941 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.91297047681147 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:20.993 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-27 09:26:20.993 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.639999999999986
[aiter INFO] 2025-09-27 09:26:20.993 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.519000000000005
[aiter INFO] 2025-09-27 09:26:21.003 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,464.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             45.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.031 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.06831668597637 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.064 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:21.064 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-27 09:26:21.076 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            525.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.077 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    50.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

max_diff_thr=0.007184768095612526

Top differences:
Position (np.int64(66), np.int64(0), np.int64(41)): arr1 = 0.026733, arr2 = 0.019409, Diff = 0.007324
Position (np.int64(83), np.int64(6), np.int64(15)): arr1 = 0.053955, arr2 = 0.047119, Diff = 0.006836
Position (np.int64(123), np.int64(4), np.int64(59)): arr1 = 0.135742, arr2 = 0.128906, Diff = 0.006836
Position (np.int64(100), np.int64(2), np.int64(53)): arr1 = -0.085938, arr2 = -0.079102, Diff = 0.006836
Position (np.int64(58), np.int64(3), np.int64(104)): arr1 = -0.005463, arr2 = 0.001137, Diff = 0.006599

Threshold statistics:
[0.0e+00, 1.0e-06): 6734 (4.11%)
[1.0e-06, 1.0e-05): 26 (0.02%)
[1.0e-05, 1.0e-04): 2243 (1.37%)
[1.0e-04, 1.0e-03): 73588 (44.91%)
[1.0e-03, 1.0e-02): 81249 (49.59%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1926e71c92f72224780735f66d12fc9d
triton_output_md5=938055ab1c87edfc850755895a9895e3
diff.abs.max=0.0009765625
max_diff_thr=0.000859845255035907

Top differences:
Position (np.int64(20), np.int64(5), np.int64(81)): arr1 = -0.136719, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(2), np.int64(1), np.int64(125)): arr1 = 0.086914, arr2 = 0.087402, Diff = 0.000488
Position (np.int64(2), np.int64(0), np.int64(32)): arr1 = 0.074707, arr2 = 0.075195, Diff = 0.000488
Position (np.int64(12), np.int64(0), np.int64(80)): arr1 = 0.071777, arr2 = 0.072266, Diff = 0.000488
Position (np.int64(11), np.int64(7), np.int64(105)): arr1 = -0.063965, arr2 = -0.064453, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 23702 (57.87%)
[1.0e-06, 1.0e-05): 157 (0.38%)
[1.0e-05, 1.0e-04): 7854 (19.17%)
[1.0e-04, 1.0e-03): 9247 (22.58%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.006354970391839743

Top differences:
Position (np.int64(6), np.int64(2), np.int64(82)): arr1 = -0.091797, arr2 = -0.084961, Diff = 0.006836
Position (np.int64(10), np.int64(0), np.int64(91)): arr1 = 0.082520, arr2 = 0.075684, Diff = 0.006836
Position (np.int64(22), np.int64(2), np.int64(34)): arr1 = -0.033936, arr2 = -0.027466, Diff = 0.006470
Position (np.int64(25), np.int64(3), np.int64(96)): arr1 = -0.077637, arr2 = -0.071289, Diff = 0.006348
Position (np.int64(7), np.int64(0), np.int64(121)): arr1 = -0.073730, arr2 = -0.067383, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 1672 (4.08%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 546 (1.33%)
[1.0e-04, 1.0e-03): 18597 (45.40%)
[1.0e-03, 1.0e-02): 20138 (49.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ebaac44b13f513b9456742357fbcc466
triton_output_md5=0a9b8b7dfbf687a6dabc7975b9b62c5e
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(74), np.int64(6), np.int64(73)): arr1 = -0.127930, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(110), np.int64(3), np.int64(121)): arr1 = 0.126953, arr2 = 0.125977, Diff = 0.000977
Position (np.int64(115), np.int64(9), np.int64(78)): arr1 = 0.132812, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(57), np.int64(2), np.int64(52)): arr1 = -0.130859, arr2 = -0.129883, Diff = 0.000977
Position (np.int64(26), np.int64(2), np.int64(104)): arr1 = -0.129883, arr2 = -0.130859, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 82969 (50.64%)
[1.0e-06, 1.0e-05): 684 (0.42%)
[1.0e-05, 1.0e-04): 32282 (19.70%)
[1.0e-04, 1.0e-03): 47905 (29.24%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0078125
max_diff_thr=0.006938421633094549

Top differences:
Position (np.int64(5), np.int64(2), np.int64(72)): arr1 = 0.133789, arr2 = 0.125977, Diff = 0.007812
Position (np.int64(1), np.int64(4), np.int64(60)): arr1 = 0.087402, arr2 = 0.080566, Diff = 0.006836
Position (np.int64(94), np.int64(4), np.int64(94)): arr1 = 0.056885, arr2 = 0.050293, Diff = 0.006592
Position (np.int64(47), np.int64(6), np.int64(80)): arr1 = -0.078613, arr2 = -0.072266, Diff = 0.006348
Position (np.int64(71), np.int64(6), np.int64(77)): arr1 = -0.052979, arr2 = -0.046631, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6638 (4.05%)
[1.0e-06, 1.0e-05): 27 (0.02%)
[1.0e-05, 1.0e-04): 2264 (1.38%)
[1.0e-04, 1.0e-03): 74368 (45.39%)
[1.0e-03, 1.0e-02): 80543 (49.16%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ae29964bfdd92be7127ebeb56ec70211
triton_output_md5=b04787902c89851bf453f8c240c992bd
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(0), np.int64(5), np.int64(14)): arr1 = 0.128906, arr2 = 0.129883, Diff = 0.000977
Position (np.int64(12), np.int64(3), np.int64(76)): arr1 = -0.143555, arr2 = -0.144531, Diff = 0.000977
Position (np.int64(31), np.int64(7), np.int64(108)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(4), np.int64(6), np.int64(17)): arr1 = 0.135742, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(13), np.int64(6), np.int64(103)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 20657 (50.43%)
[1.0e-06, 1.0e-05): 160 (0.39%)
[1.0e-05, 1.0e-04): 8070 (19.70%)
[1.0e-04, 1.0e-03): 12073 (29.48%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0068359375
max_diff_thr=0.006013745907694101

Top differences:
Position (np.int64(4), np.int64(1), np.int64(17)): arr1 = 0.143555, arr2 = 0.136719, Diff = 0.006836
Position (np.int64(21), np.int64(3), np.int64(90)): arr1 = -0.124512, arr2 = -0.118164, Diff = 0.006348
Position (np.int64(27), np.int64(4), np.int64(45)): arr1 = -0.063477, arr2 = -0.057373, Diff = 0.006104
Position (np.int64(10), np.int64(7), np.int64(124)): arr1 = -0.046875, arr2 = -0.041016, Diff = 0.005859
Position (np.int64(7), np.int64(3), np.int64(109)): arr1 = 0.135742, arr2 = 0.129883, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1584 (3.87%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 569 (1.39%)
[1.0e-04, 1.0e-03): 18647 (45.52%)
[1.0e-03, 1.0e-02): 20153 (49.20%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e08090d0c633646c73968287d1360b2f
triton_output_md5=975e35556d765ec302329878fed895a1
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(7), np.int64(5), np.int64(70)): arr1 = 0.136719, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(4), np.int64(4), np.int64(111)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(12), np.int64(6), np.int64(81)): arr1 = 0.133789, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(7), np.int64(3), np.int64(70)): arr1 = 0.132812, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(51), np.int64(2), np.int64(87)): arr1 = -0.129883, arr2 = -0.128906, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 82349 (50.26%)
[1.0e-06, 1.0e-05): 734 (0.45%)
[1.0e-05, 1.0e-04): 33123 (20.22%)
[1.0e-04, 1.0e-03): 47634 (29.07%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.007568359375
max_diff_thr=0.007187572307884693

Top differences:
Position (np.int64(16), np.int64(1), np.int64(104)): arr1 = -0.060547, arr2 = -0.052979, Diff = 0.007568
Position (np.int64(108), np.int64(1), np.int64(107)): arr1 = 0.026978, arr2 = 0.019897, Diff = 0.007080
Position (np.int64(47), np.int64(7), np.int64(102)): arr1 = 0.057861, arr2 = 0.051025, Diff = 0.006836
Position (np.int64(78), np.int64(3), np.int64(113)): arr1 = -0.038086, arr2 = -0.031494, Diff = 0.006592
Position (np.int64(60), np.int64(0), np.int64(103)): arr1 = -0.097168, arr2 = -0.090820, Diff = 0.006348[aiter INFO] 2025-09-27 09:26:21.081 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:21.141 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.12233642304298 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 75, 76}
[aiter INFO] 2025-09-27 09:26:21.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.87899999999999
[aiter INFO] 2025-09-27 09:26:21.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-27 09:26:21.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.598999999999933
[aiter INFO] 2025-09-27 09:26:21.195 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:21.213 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            422.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,109.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,548.7              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.214 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.47 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:21.297 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.69859395463868 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.490 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-27 09:26:21.491 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.07899999999998
[aiter INFO] 2025-09-27 09:26:21.503 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,314.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.530 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.84416836618197 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.567 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:21.568 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-27 09:26:21.579 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            339.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.580 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.54 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:21.582 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:21.699 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.4978315399425 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.751 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 67, 9, 42, 12, 45, 20, 53, 23, 56}
[aiter INFO] 2025-09-27 09:26:21.751 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.479000000000042
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999992
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.718999999999994
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.118999999999915
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000021
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999992
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.678999999999974
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.63900000000001
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.518999999999949
[aiter INFO] 2025-09-27 09:26:21.752 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.039999999999964
[aiter INFO] 2025-09-27 09:26:21.770 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            882.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          2,299.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,323.3              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           33.2             33.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:21.771 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:21.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.61592073605792 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:21.998 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12}
[aiter INFO] 2025-09-27 09:26:21.998 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 45.839000000000055
[aiter INFO] 2025-09-27 09:26:21.998 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.399
[aiter INFO] 2025-09-27 09:26:22.008 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,469.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             45.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.035 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.13880198367751 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.069 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:22.069 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:26:22.081 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            526.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.082 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    50.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:22.086 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:22.146 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.6491089215373 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.201 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-27 09:26:22.201 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000013
[aiter INFO] 2025-09-27 09:26:22.202 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:22.220 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            426.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,147.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,574.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           15.7             15.7         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.221 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:22.306 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.21304938521716 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.362 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 38}
[aiter INFO] 2025-09-27 09:26:22.362 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.039000000000016
[aiter INFO] 2025-09-27 09:26:22.363 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.920000000000016
[aiter INFO] 2025-09-27 09:26:22.375 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,311.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.402 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.520613807852904 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.438 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 6, 76, 118, 188}
[aiter INFO] 2025-09-27 09:26:22.438 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.0790000000000646
[aiter INFO] 2025-09-27 09:26:22.439 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-27 09:26:22.439 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.0790000000000646
[aiter INFO] 2025-09-27 09:26:22.439 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.119000000000028
[aiter INFO] 2025-09-27 09:26:22.439 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.1189999999999145
[aiter INFO] 2025-09-27 09:26:22.450 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            325.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.451 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:22.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:22.569 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 124.11253493611176 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.620 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 68, 229, 233, 42, 9, 45, 13, 944, 339, 20, 53, 342, 23, 948, 57, 31}
[aiter INFO] 2025-09-27 09:26:22.620 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.958999999999946
[aiter INFO] 2025-09-27 09:26:22.620 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-27 09:26:22.620 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000065
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.878999999999905
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.43899999999985
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.399
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.959
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999983
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.318999999999505
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.838999999999942
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.44
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.399
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.199000000000012
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000028
[aiter INFO] 2025-09-27 09:26:22.621 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.399
[aiter INFO] 2025-09-27 09:26:22.640 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            835.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          2,718.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,872.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           38.7             38.6         NaN          NaN
[aiter INFO] 2025-09-27 09:26:22.640 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    38.62 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:22.814 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 148.35378335844172 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:22.864 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 90, 51, 12}
[aiter INFO] 2025-09-27 09:26:22.864 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.11900000000003
[aiter INFO] 2025-09-27 09:26:22.865 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.07999999999993
[aiter INFO] 2025-09-27 09:26:22.865 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.799999999999955
[aiter INFO] 2025-09-27 09:26:22.865 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.43900000000002
[aiter INFO] 2025-09-27 09:26:22.875 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          5,456.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             56.2         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.038 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.193811835333854 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:23.072 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:23.072 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-27 09:26:23.084 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            639.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.085 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    62.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:23.089 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:23.148 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.48355433020261 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 163, 164, 9, 42, 43, 10, 141, 142}
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999928
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.798999999999978
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.358999999999924
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000074
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.95900000000006
[aiter INFO] 2025-09-27 09:26:23.347 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000151
[aiter INFO] 2025-09-27 09:26:23.366 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            413.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,444.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,941.6              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           19.4             19.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.367 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 6796 (4.15%)
[1.0e-06, 1.0e-05): 39 (0.02%)
[1.0e-05, 1.0e-04): 2443 (1.49%)
[1.0e-04, 1.0e-03): 77137 (47.08%)
[1.0e-03, 1.0e-02): 77425 (47.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=74e9eb4c37eab8a44c083b42fa75d3f6
triton_output_md5=ee87d7b846e65dfaff2632f305ad35e0
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(19), np.int64(2), np.int64(112)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977
Position (np.int64(26), np.int64(8), np.int64(85)): arr1 = 0.133789, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(9), np.int64(4), np.int64(83)): arr1 = 0.125977, arr2 = 0.126953, Diff = 0.000977
Position (np.int64(28), np.int64(5), np.int64(57)): arr1 = -0.072754, arr2 = -0.072266, Diff = 0.000488
Position (np.int64(25), np.int64(0), np.int64(29)): arr1 = -0.069336, arr2 = -0.068848, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 20793 (50.76%)
[1.0e-06, 1.0e-05): 155 (0.38%)
[1.0e-05, 1.0e-04): 8151 (19.90%)
[1.0e-04, 1.0e-03): 11861 (28.96%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00634765625
max_diff_thr=0.005990783218294382

Top differences:
Position (np.int64(9), np.int64(5), np.int64(63)): arr1 = -0.065918, arr2 = -0.059570, Diff = 0.006348
Position (np.int64(1), np.int64(4), np.int64(75)): arr1 = -0.006165, arr2 = -0.000206, Diff = 0.005959
Position (np.int64(22), np.int64(4), np.int64(6)): arr1 = -0.043701, arr2 = -0.037842, Diff = 0.005859
Position (np.int64(16), np.int64(3), np.int64(12)): arr1 = -0.124512, arr2 = -0.118652, Diff = 0.005859
Position (np.int64(15), np.int64(1), np.int64(70)): arr1 = 0.053955, arr2 = 0.048340, Diff = 0.005615

Threshold statistics:
[0.0e+00, 1.0e-06): 1671 (4.08%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 616 (1.50%)
[1.0e-04, 1.0e-03): 19109 (46.65%)
[1.0e-03, 1.0e-02): 19557 (47.75%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7a75018d3d646db59dde6a114dcec57c
triton_output_md5=e9ecd52dc7c537777d1dcf28fe3d3592
diff.abs.max=0.00048828125
max_diff_thr=0.0004683840670622885

Top differences:
Position (np.int64(112), np.int64(2), np.int64(114)): arr1 = -0.104004, arr2 = -0.103516, Diff = 0.000488
Position (np.int64(112), np.int64(2), np.int64(121)): arr1 = 0.075195, arr2 = 0.075684, Diff = 0.000488
Position (np.int64(104), np.int64(0), np.int64(50)): arr1 = -0.083984, arr2 = -0.084473, Diff = 0.000488
Position (np.int64(74), np.int64(3), np.int64(85)): arr1 = -0.079102, arr2 = -0.079590, Diff = 0.000488
Position (np.int64(83), np.int64(9), np.int64(126)): arr1 = -0.069336, arr2 = -0.068848, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 81920 (50.00%)
[1.0e-06, 1.0e-05): 1092 (0.67%)
[1.0e-05, 1.0e-04): 44522 (27.17%)
[1.0e-04, 1.0e-03): 36306 (22.16%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0048828125
max_diff_thr=0.004570384044200182

Top differences:
Position (np.int64(113), np.int64(9), np.int64(88)): arr1 = 0.074219, arr2 = 0.069336, Diff = 0.004883
Position (np.int64(38), np.int64(4), np.int64(47)): arr1 = -0.073242, arr2 = -0.068359, Diff = 0.004883
Position (np.int64(107), np.int64(5), np.int64(29)): arr1 = 0.050049, arr2 = 0.045410, Diff = 0.004639
Position (np.int64(5), np.int64(8), np.int64(64)): arr1 = -0.012817, arr2 = -0.008362, Diff = 0.004456
Position (np.int64(22), np.int64(3), np.int64(56)): arr1 = 0.085938, arr2 = 0.081543, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 6653 (4.06%)
[1.0e-06, 1.0e-05): 66 (0.04%)
[1.0e-05, 1.0e-04): 4393 (2.68%)
[1.0e-04, 1.0e-03): 96413 (58.85%)
[1.0e-03, 1.0e-02): 56315 (34.37%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2d801ca1cdb64cd5db8dba557a37501a
triton_output_md5=5c42eec5612ed5ebe306159f68b6b6fa
diff.abs.max=0.00048828125
max_diff_thr=0.00047158688539639115

Top differences:
Position (np.int64(24), np.int64(4), np.int64(100)): arr1 = 0.071289, arr2 = 0.071777, Diff = 0.000488
Position (np.int64(12), np.int64(4), np.int64(64)): arr1 = -0.062500, arr2 = -0.062988, Diff = 0.000488
Position (np.int64(19), np.int64(5), np.int64(100)): arr1 = -0.066895, arr2 = -0.066406, Diff = 0.000488
Position (np.int64(22), np.int64(4), np.int64(58)): arr1 = 0.069824, arr2 = 0.070312, Diff = 0.000488
Position (np.int64(28), np.int64(8), np.int64(107)): arr1 = -0.064453, arr2 = -0.063965, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 19983 (48.79%)
[1.0e-06, 1.0e-05): 283 (0.69%)
[1.0e-05, 1.0e-04): 11632 (28.40%)
[1.0e-04, 1.0e-03): 9062 (22.12%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00537109375
max_diff_thr=0.00509495148435235

Top differences:
Position (np.int64(26), np.int64(0), np.int64(2)): arr1 = -0.059570, arr2 = -0.054199, Diff = 0.005371
Position (np.int64(24), np.int64(3), np.int64(13)): arr1 = 0.033203, arr2 = 0.028564, Diff = 0.004639
Position (np.int64(19), np.int64(4), np.int64(65)): arr1 = 0.009277, arr2 = 0.004944, Diff = 0.004333
Position (np.int64(15), np.int64(9), np.int64(101)): arr1 = -0.051270, arr2 = -0.047119, Diff = 0.004150
Position (np.int64(1), np.int64(3), np.int64(37)): arr1 = -0.056641, arr2 = -0.052490, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1638 (4.00%)
[1.0e-06, 1.0e-05): 19 (0.05%)
[1.0e-05, 1.0e-04): 1093 (2.67%)
[1.0e-04, 1.0e-03): 24252 (59.21%)
[1.0e-03, 1.0e-02): 13958 (34.08%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1135efe1816cbcba263181991a48ad09
triton_output_md5=7e27cc48e5209eba563141fda53a8f31
diff.abs.max=0.00048828125
max_diff_thr=0.00046948358067311347

Top differences:
Position (np.int64(68), np.int64(4), np.int64(120)): arr1 = 0.075684, arr2 = 0.075195, Diff = 0.000488
Position (np.int64(7), np.int64(2), np.int64(6)): arr1 = 0.067871, arr2 = 0.067383, Diff = 0.000488
Position (np.int64(17), np.int64(1), np.int64(96)): arr1 = -0.073242, arr2 = -0.072754, Diff = 0.000488
Position (np.int64(33), np.int64(1), np.int64(44)): arr1 = 0.069336, arr2 = 0.068848, Diff = 0.000488
Position (np.int64(49), np.int64(9), np.int64(104)): arr1 = -0.067383, arr2 = -0.066895, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 81958 (50.02%)
[1.0e-06, 1.0e-05): 1147 (0.70%)
[1.0e-05, 1.0e-04): 44446 (27.13%)
[1.0e-04, 1.0e-03): 36289 (22.15%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00537109375
max_diff_thr=0.005034324713051319

Top differences:
Position (np.int64(25), np.int64(0), np.int64(79)): arr1 = -0.072266, arr2 = -0.066895, Diff = 0.005371
Position (np.int64(96), np.int64(8), np.int64(96)): arr1 = -0.066895, arr2 = -0.062012, Diff = 0.004883
Position (np.int64(96), np.int64(3), np.int64(96)): arr1 = -0.071289, arr2 = -0.066406, Diff = 0.004883
Position (np.int64(38), np.int64(6), np.int64(65)): arr1 = 0.082031, arr2 = 0.077148, Diff = 0.004883
Position (np.int64(42), np.int64(0), np.int64(20)): arr1 = -0.069336, arr2 = -0.064453, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 6756 (4.12%)
[1.0e-06, 1.0e-05): 54 (0.03%)
[1.0e-05, 1.0e-04): 4292 (2.62%)
[1.0e-04, 1.0e-03): 96665 (59.00%)
[1.0e-03, 1.0e-02): 56073 (34.22%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d553d174c13816b48c6d7a65f9f772d6
triton_output_md5=e0911b48a6dfbd80eac67b4783c92905
diff.abs.max=0.00048828125
max_diff_thr=0.0004595588252414018

Top differences:
Position (np.int64(0), np.int64(5), np.int64(57)): arr1 = -0.071289, arr2 = -0.071777, Diff = 0.000488[aiter INFO] 2025-09-27 09:26:23.454 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.07685135378695 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:23.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 103, 12, 77}
[aiter INFO] 2025-09-27 09:26:23.512 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.038999999999987
[aiter INFO] 2025-09-27 09:26:23.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.918999999999983
[aiter INFO] 2025-09-27 09:26:23.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.99899999999991
[aiter INFO] 2025-09-27 09:26:23.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.440000000000026
[aiter INFO] 2025-09-27 09:26:23.513 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.999000000000024
[aiter INFO] 2025-09-27 09:26:23.525 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          2,241.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             23.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.552 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.218802113344175 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:23.588 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:23.589 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-27 09:26:23.601 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            396.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.601 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    27.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:23.603 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:23.733 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.44314782572263 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {776, 9, 303, 21, 790, 316}
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.19999999999982
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.31900000000002
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.55999999999995
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.999000000000024
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999069
[aiter INFO] 2025-09-27 09:26:23.789 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.358999999999924
[aiter INFO] 2025-09-27 09:26:23.808 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,129.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0         13,021.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       14,435.0              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          144.3            144.4         NaN          NaN
[aiter INFO] 2025-09-27 09:26:23.808 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   144.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:24.479 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 393.8274953034845 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {37, 1288, 1289, 12, 1011, 666, 444}
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.6
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.9599999999991
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 299.0400000000009
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 301.15999999999997
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 301.2000000000007
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.8800000000001
[aiter INFO] 2025-09-27 09:26:24.553 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.8400000000006
[aiter INFO] 2025-09-27 09:26:24.564 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0         28,213.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0            300.1         NaN          NaN
[aiter INFO] 2025-09-27 09:26:24.845 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.98198012845351 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:24.880 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {230, 6}
[aiter INFO] 2025-09-27 09:26:24.881 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.878999999999905
[aiter INFO] 2025-09-27 09:26:24.881 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.87899999999999
[aiter INFO] 2025-09-27 09:26:24.893 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,235.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.5         NaN          NaN
[aiter INFO] 2025-09-27 09:26:24.893 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   312.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:24.897 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:24.959 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 129.40759462590265 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 42, 14, 47, 894, 20, 53, 25, 57, 889, 31}
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.15900000000005
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.438999999999965
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999069
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.35899999999998
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.19900000000007
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.399999999999636
[aiter INFO] 2025-09-27 09:26:25.014 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.71900000000005
[aiter INFO] 2025-09-27 09:26:25.033 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            456.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          3,620.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,306.5              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           43.1             42.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:25.034 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    42.92 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:25.125 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.21009890513844 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 77, 51, 25, 90}
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.279
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.64000000000004
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.799
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.96000000000004
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.279
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.87899999999996
[aiter INFO] 2025-09-27 09:26:25.182 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.0390000000001
[aiter INFO] 2025-09-27 09:26:25.194 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0          7,262.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             77.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:25.221 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.646128651234186 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:25.257 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:25.257 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-27 09:26:25.269 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            666.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-27 09:26:25.270 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    83.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:25.272 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:25.398 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 215.4807725755295 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {611, 732, 168, 1033, 298, 9, 48, 720, 178, 19, 1044, 310, 598, 1110, 1111, 1082, 1083, 60}
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.878999999999905
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000051
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.11999999999989
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.83899999999994
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.99900000000025
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.64
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.19899999999996
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.31900000000041
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999742
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.799000000000035
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.59900000000016
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.720000000000255
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.27899999999954
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.35900000000038
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000306
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.51999999999862
[aiter INFO] 2025-09-27 09:26:25.453 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-09-27 09:26:25.454 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999969
[aiter INFO] 2025-09-27 09:26:25.475 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            897.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0         11,523.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       13,484.2              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN          134.8            135.0         NaN          NaN
[aiter INFO] 2025-09-27 09:26:25.476 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   135.01 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:26.133 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 368.945446639958 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:26.349 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 37}
[aiter INFO] 2025-09-27 09:26:26.349 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 280.72
[aiter INFO] 2025-09-27 09:26:26.349 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 277.8
[aiter INFO] 2025-09-27 09:26:26.360 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         27,648.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0            279.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:26.569 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.68256450053489 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:26.604 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-27 09:26:26.604 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.319000000000017
[aiter INFO] 2025-09-27 09:26:26.616 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,033.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:26.617 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   289.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:26.622 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-27 09:26:26.684 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.77904926196183 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:26.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 42, 14, 47, 20, 25, 31}
[aiter INFO] 2025-09-27 09:26:26.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-27 09:26:26.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.959
[aiter INFO] 2025-09-27 09:26:26.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.55899999999997
[aiter INFO] 2025-09-27 09:26:26.738 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-27 09:26:26.739 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-27 09:26:26.739 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.87899999999996
[aiter INFO] 2025-09-27 09:26:26.739 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.118999999999971
[aiter INFO] 2025-09-27 09:26:26.739 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.87900000000002
[aiter INFO] 2025-09-27 09:26:26.757 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            413.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,624.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,174.1              0.0         CPU        61399
[avg us/iter]                                                                                        NaN   NaN           41.7             41.6         NaN          NaN
[aiter INFO] 2025-09-27 09:26:26.758 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    41.62 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(0), np.int64(5), np.int64(55)): arr1 = -0.062988, arr2 = -0.063477, Diff = 0.000488
Position (np.int64(31), np.int64(6), np.int64(73)): arr1 = 0.070312, arr2 = 0.070801, Diff = 0.000488
Position (np.int64(1), np.int64(0), np.int64(126)): arr1 = -0.073730, arr2 = -0.073242, Diff = 0.000488
Position (np.int64(28), np.int64(9), np.int64(127)): arr1 = -0.065430, arr2 = -0.065918, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 20981 (51.22%)
[1.0e-06, 1.0e-05): 284 (0.69%)
[1.0e-05, 1.0e-04): 10563 (25.79%)
[1.0e-04, 1.0e-03): 9132 (22.29%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.0047607421875
max_diff_thr=0.004648944828659296

Top differences:
Position (np.int64(20), np.int64(7), np.int64(80)): arr1 = -0.028809, arr2 = -0.024048, Diff = 0.004761
Position (np.int64(10), np.int64(5), np.int64(72)): arr1 = -0.043213, arr2 = -0.038818, Diff = 0.004395
Position (np.int64(5), np.int64(0), np.int64(99)): arr1 = 0.044434, arr2 = 0.040039, Diff = 0.004395
Position (np.int64(16), np.int64(9), np.int64(106)): arr1 = 0.040283, arr2 = 0.036133, Diff = 0.004150
Position (np.int64(27), np.int64(7), np.int64(111)): arr1 = -0.065918, arr2 = -0.061768, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1623 (3.96%)
[1.0e-06, 1.0e-05): 11 (0.03%)
[1.0e-05, 1.0e-04): 1020 (2.49%)
[1.0e-04, 1.0e-03): 24298 (59.32%)
[1.0e-03, 1.0e-02): 14008 (34.20%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=eb7698e5e298d04f95613abdb8fd2411
triton_output_md5=4ef9b47399ede74992c554d73795d0a2
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(119), np.int64(4), np.int64(12)): arr1 = -0.034912, arr2 = -0.035156, Diff = 0.000244
Position (np.int64(96), np.int64(9), np.int64(26)): arr1 = -0.033936, arr2 = -0.033691, Diff = 0.000244
Position (np.int64(3), np.int64(4), np.int64(30)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(107), np.int64(6), np.int64(58)): arr1 = -0.033447, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(6), np.int64(1), np.int64(41)): arr1 = -0.036865, arr2 = -0.036621, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 81777 (49.91%)
[1.0e-06, 1.0e-05): 6976 (4.26%)
[1.0e-05, 1.0e-04): 72388 (44.18%)
[1.0e-04, 1.0e-03): 2699 (1.65%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017574692610651255

Top differences:
Position (np.int64(31), np.int64(1), np.int64(13)): arr1 = 0.008911, arr2 = 0.007141, Diff = 0.001770
Position (np.int64(3), np.int64(9), np.int64(13)): arr1 = -0.036377, arr2 = -0.034668, Diff = 0.001709
Position (np.int64(62), np.int64(6), np.int64(53)): arr1 = -0.019287, arr2 = -0.017578, Diff = 0.001709
Position (np.int64(30), np.int64(5), np.int64(32)): arr1 = 0.011841, arr2 = 0.010193, Diff = 0.001648
Position (np.int64(46), np.int64(7), np.int64(11)): arr1 = -0.016602, arr2 = -0.014954, Diff = 0.001648

Threshold statistics:
[0.0e+00, 1.0e-06): 7053 (4.30%)
[1.0e-06, 1.0e-05): 469 (0.29%)
[1.0e-05, 1.0e-04): 25229 (15.40%)
[1.0e-04, 1.0e-03): 129683 (79.15%)
[1.0e-03, 1.0e-02): 1406 (0.86%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9272310081b614313b640310e842dcfd
triton_output_md5=f5e003f042c3b156a2c43f24ba9050bb
diff.abs.max=0.000244140625
max_diff_thr=0.00023651844821870327

Top differences:
Position (np.int64(2), np.int64(3), np.int64(123)): arr1 = -0.032715, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(27), np.int64(2), np.int64(55)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(14), np.int64(6), np.int64(90)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(10), np.int64(3), np.int64(111)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(29), np.int64(7), np.int64(79)): arr1 = 0.017456, arr2 = 0.017578, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 20398 (49.80%)
[1.0e-06, 1.0e-05): 1823 (4.45%)
[1.0e-05, 1.0e-04): 18043 (44.05%)
[1.0e-04, 1.0e-03): 696 (1.70%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001692968187853694

Top differences:
Position (np.int64(2), np.int64(1), np.int64(48)): arr1 = -0.011169, arr2 = -0.009460, Diff = 0.001709
Position (np.int64(25), np.int64(0), np.int64(124)): arr1 = -0.019287, arr2 = -0.017578, Diff = 0.001709
Position (np.int64(10), np.int64(9), np.int64(97)): arr1 = -0.005554, arr2 = -0.003860, Diff = 0.001694
Position (np.int64(7), np.int64(8), np.int64(40)): arr1 = -0.010010, arr2 = -0.008484, Diff = 0.001526
Position (np.int64(24), np.int64(5), np.int64(7)): arr1 = 0.010986, arr2 = 0.009460, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 1645 (4.02%)
[1.0e-06, 1.0e-05): 107 (0.26%)
[1.0e-05, 1.0e-04): 6272 (15.31%)
[1.0e-04, 1.0e-03): 32566 (79.51%)
[1.0e-03, 1.0e-02): 370 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=bb29c9d98a4a040010b5976292903c17
triton_output_md5=add2f7bc834d9bcd747212a29ae6a72e
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(33), np.int64(9), np.int64(63)): arr1 = -0.032959, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(60), np.int64(7), np.int64(1)): arr1 = 0.032959, arr2 = 0.032715, Diff = 0.000244
Position (np.int64(67), np.int64(2), np.int64(10)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(97), np.int64(9), np.int64(67)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(29), np.int64(0), np.int64(102)): arr1 = -0.033203, arr2 = -0.033447, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 81688 (49.86%)
[1.0e-06, 1.0e-05): 7161 (4.37%)
[1.0e-05, 1.0e-04): 72265 (44.11%)
[1.0e-04, 1.0e-03): 2726 (1.66%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016774502582848072

Top differences:
Position (np.int64(82), np.int64(9), np.int64(44)): arr1 = 0.020508, arr2 = 0.018799, Diff = 0.001709
Position (np.int64(84), np.int64(6), np.int64(104)): arr1 = -0.011353, arr2 = -0.009705, Diff = 0.001648
Position (np.int64(45), np.int64(4), np.int64(80)): arr1 = 0.005615, arr2 = 0.003998, Diff = 0.001617
Position (np.int64(98), np.int64(8), np.int64(39)): arr1 = 0.002655, arr2 = 0.001060, Diff = 0.001595
Position (np.int64(107), np.int64(2), np.int64(64)): arr1 = -0.022095, arr2 = -0.020508, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 6897 (4.21%)
[1.0e-06, 1.0e-05): 437 (0.27%)
[1.0e-05, 1.0e-04): 24989 (15.25%)
[1.0e-04, 1.0e-03): 130044 (79.37%)
[1.0e-03, 1.0e-02): 1473 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ea571dc877f157444315aeeecc02eaad
triton_output_md5=c35612307606b9b288f8c75e337fce47
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

Top differences:
Position (np.int64(18), np.int64(1), np.int64(53)): arr1 = -0.035645, arr2 = -0.035400, Diff = 0.000244
Position (np.int64(23), np.int64(8), np.int64(120)): arr1 = -0.031494, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(29), np.int64(9), np.int64(96)): arr1 = 0.036133, arr2 = 0.036377, Diff = 0.000244
Position (np.int64(9), np.int64(6), np.int64(66)): arr1 = -0.032959, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(19), np.int64(0), np.int64(14)): arr1 = -0.031494, arr2 = -0.031738, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 20385 (49.77%)
[1.0e-06, 1.0e-05): 1691 (4.13%)[aiter INFO] 2025-09-27 09:26:26.849 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.32928713595513 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 1273, 38, 103, 12, 77, 51, 116, 25, 90, 1182}
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.83900000000006
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.39900000000125
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.15899999999999
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.43899999999996
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.36000000000001
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.67900000000009
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.24000000000001
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.63900000000012
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.67899999999997
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.35900000000004
[aiter INFO] 2025-09-27 09:26:26.907 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.39899999999943
[aiter INFO] 2025-09-27 09:26:26.919 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 90.0            0.0          6,917.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             76.9         NaN          NaN
[aiter INFO] 2025-09-27 09:26:26.946 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.23145533847337 us/iter from cuda.Event
[aiter INFO] 2025-09-27 09:26:26.984 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-27 09:26:26.984 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.719000000000051
[aiter INFO] 2025-09-27 09:26:26.984 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-27 09:26:26.996 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            526.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-27 09:26:26.996 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    82.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-27 09:26:27.004 - MainProcess:61399 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:916 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0          7         128    (5, 1)        128        1024  torch.bfloat16     1         20.4             0           28.3               0
1          7          32    (5, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
2         26         128    (5, 1)        128        1024  torch.bfloat16     1         19.7             0           28.3               0
3         26          32    (5, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
4         57         128    (5, 1)        128        1024  torch.bfloat16     1         19.9             0           28.3               0
5         57          32    (5, 1)        128        1024  torch.bfloat16     1         15.0             0           15.8               0
6         66         128    (5, 1)        128        1024  torch.bfloat16     1         19.8             0           28.3               0
7         66          32    (5, 1)        128        1024  torch.bfloat16     1         15.0             0           15.8               0
8        109         128    (5, 1)        128        1024  torch.bfloat16     1         19.6             0           28.3               0
9        109          32    (5, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
10       128         128    (5, 1)        128        1024  torch.bfloat16     1         19.8             0           28.3               0
11       128          32    (5, 1)        128        1024  torch.bfloat16     1         15.0             0           15.8               0
12       256         128    (5, 1)        128        1024  torch.bfloat16     1         19.8             0           28.2               0
13       256          32    (5, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
14       257         128    (5, 1)        128        1024  torch.bfloat16     1         28.5             0           49.7               0
15       257          32    (5, 1)        128        1024  torch.bfloat16     1         15.5             0           16.5               0
16       282         128    (5, 1)        128        1024  torch.bfloat16     1         28.3             0           49.7               0
17       282          32    (5, 1)        128        1024  torch.bfloat16     1         15.3             0           16.5               0
18       512         128    (5, 1)        128        1024  torch.bfloat16     1         28.5             0           49.7               0
19       512          32    (5, 1)        128        1024  torch.bfloat16     1         15.4             0           16.4               0
20       513         128    (5, 1)        128        1024  torch.bfloat16     1         34.2             0           61.9               0
21       513          32    (5, 1)        128        1024  torch.bfloat16     1         19.1             0           27.1               0
22      4097         128    (5, 1)        128        1024  torch.bfloat16     1        136.0             0          308.4               0
23      4097          32    (5, 1)        128        1024  torch.bfloat16     1         42.2             0           82.8               0
24      4096         128    (5, 1)        128        1024  torch.bfloat16     1        129.2             0          285.7               0
25      4096          32    (5, 1)        128        1024  torch.bfloat16     1         41.6             0           81.1               0
26         7         128    (8, 1)        128        1024  torch.bfloat16     1         22.4             0           28.5               0
27         7          32    (8, 1)        128        1024  torch.bfloat16     1         15.0             0           15.8               0
28        26         128    (8, 1)        128        1024  torch.bfloat16     1         22.5             0           28.4               0
29        26          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
30        57         128    (8, 1)        128        1024  torch.bfloat16     1         22.4             0           28.4               0
31        57          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.8               0
32        66         128    (8, 1)        128        1024  torch.bfloat16     1         22.7             0           28.4               0
33        66          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
34       109         128    (8, 1)        128        1024  torch.bfloat16     1         22.5             0           28.4               0
35       109          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.8               0
36       128         128    (8, 1)        128        1024  torch.bfloat16     1         22.4             0           28.5               0
37       128          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
38       256         128    (8, 1)        128        1024  torch.bfloat16     1         22.4             0           28.4               0
39       256          32    (8, 1)        128        1024  torch.bfloat16     1         15.1             0           15.9               0
40       257         128    (8, 1)        128        1024  torch.bfloat16     1         31.4             0           50.0               0
41       257          32    (8, 1)        128        1024  torch.bfloat16     1         15.4             0           16.4               0
42       282         128    (8, 1)        128        1024  torch.bfloat16     1         31.2             0           50.1               0
43       282          32    (8, 1)        128        1024  torch.bfloat16     1         15.6             0           16.5               0
44       512         128    (8, 1)        128        1024  torch.bfloat16     1         31.0             0           50.0               0
45       512          32    (8, 1)        128        1024  torch.bfloat16     1         15.5             0           16.4               0
46       513         128    (8, 1)        128        1024  torch.bfloat16     1         36.9             0           62.2               0
47       513          32    (8, 1)        128        1024  torch.bfloat16     1         19.3             0           27.2               0
48      4097         128    (8, 1)        128        1024  torch.bfloat16     1        141.2             0          310.0               0
49      4097          32    (8, 1)        128        1024  torch.bfloat16     1         42.8             0           83.4               0
50      4096         128    (8, 1)        128        1024  torch.bfloat16     1        132.5             0          287.6               0
51      4096          32    (8, 1)        128        1024  torch.bfloat16     1         41.4             0           81.6               0
52         7         128   (10, 1)        128        1024  torch.bfloat16     1         24.2             0           28.8               0
53         7          32   (10, 1)        128        1024  torch.bfloat16     1         15.2             0           16.1               0
54        26         128   (10, 1)        128        1024  torch.bfloat16     1         24.2             0           28.7               0
55        26          32   (10, 1)        128        1024  torch.bfloat16     1         15.3             0           16.0               0
56        57         128   (10, 1)        128        1024  torch.bfloat16     1         24.2             0           28.7               0
57        57          32   (10, 1)        128        1024  torch.bfloat16     1         15.2             0           16.0               0
58        66         128   (10, 1)        128        1024  torch.bfloat16     1         24.3             0           28.8               0
59        66          32   (10, 1)        128        1024  torch.bfloat16     1         15.2             0           16.1               0
60       109         128   (10, 1)        128        1024  torch.bfloat16     1         24.3             0           28.8               0
61       109          32   (10, 1)        128        1024  torch.bfloat16     1         15.1             0           16.1               0
62       128         128   (10, 1)        128        1024  torch.bfloat16     1         24.2             0           28.8               0
63       128          32   (10, 1)        128        1024  torch.bfloat16     1         15.1             0           16.1               0
64       256         128   (10, 1)        128        1024  torch.bfloat16     1         24.3             0           28.7               0
65       256          32   (10, 1)        128        1024  torch.bfloat16     1         15.2             0           16.0               0
66       257         128   (10, 1)        128        1024  torch.bfloat16     1         33.0             0           50.3               0
67       257          32   (10, 1)        128        1024  torch.bfloat16     1         15.5             0           16.6               0
68       282         128   (10, 1)        128        1024  torch.bfloat16     1         33.0             0           50.3               0
69       282          32   (10, 1)        128        1024  torch.bfloat16     1         15.5             0           16.5               0
70       512         128   (10, 1)        128        1024  torch.bfloat16     1         33.2             0           50.4               0
71       512          32   (10, 1)        128        1024  torch.bfloat16     1         15.7             0           16.6               0
72       513         128   (10, 1)        128        1024  torch.bfloat16     1         38.6             0           62.6               0
73       513          32   (10, 1)        128        1024  torch.bfloat16     1         19.4             0           27.3               0
74      4097         128   (10, 1)        128        1024  torch.bfloat16     1        144.4             0          312.6               0
75      4097          32   (10, 1)        128        1024  torch.bfloat16     1         42.9             0           83.9               0
76      4096         128   (10, 1)        128        1024  torch.bfloat16     1        135.0             0          289.6               0
77      4096          32   (10, 1)        128        1024  torch.bfloat16     1         41.6             0           82.2               0

[1.0e-05, 1.0e-04): 18213 (44.47%)
[1.0e-04, 1.0e-03): 671 (1.64%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016798656433820724

Top differences:
Position (np.int64(9), np.int64(5), np.int64(76)): arr1 = -0.019043, arr2 = -0.017334, Diff = 0.001709
Position (np.int64(9), np.int64(7), np.int64(103)): arr1 = -0.014160, arr2 = -0.012573, Diff = 0.001587
Position (np.int64(31), np.int64(8), np.int64(124)): arr1 = 0.017090, arr2 = 0.015503, Diff = 0.001587
Position (np.int64(19), np.int64(8), np.int64(55)): arr1 = -0.019287, arr2 = -0.017700, Diff = 0.001587
Position (np.int64(31), np.int64(0), np.int64(26)): arr1 = -0.024414, arr2 = -0.022827, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 1698 (4.15%)
[1.0e-06, 1.0e-05): 107 (0.26%)
[1.0e-05, 1.0e-04): 6238 (15.23%)
[1.0e-04, 1.0e-03): 32526 (79.41%)
[1.0e-03, 1.0e-02): 391 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9f7066702fa8759c653c71133ada8a27
triton_output_md5=ce9c17226caf27c9d3822a569cc53e57
++ set +x
