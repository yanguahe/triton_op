++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=6
++ HIP_VISIBLE_DEVICES=6
++ run_triton_op
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py -q 2 --block_size 1024 --trans_v
[aiter INFO] 2025-09-30 05:12:58.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:00.415 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.33697019355131 us/iter from cuda.Event
[W930 05:13:00.175148882 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-30 05:13:00.585 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:00.585 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.478999999999985
[aiter INFO] 2025-09-30 05:13:00.585 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-30 05:13:00.606 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            890.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,127.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,018.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           30.2             30.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:00.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    30.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:01.542 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.53032595804422 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:01.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:01.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.478999999999985
[aiter INFO] 2025-09-30 05:13:01.606 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,046.8        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:01.637 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.94039601205599 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 524, 335, 209, 62}
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3989999999999725
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999851
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.398999999999887
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.199000000000069
[aiter INFO] 2025-09-30 05:13:01.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999992
[aiter INFO] 2025-09-30 05:13:01.684 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            459.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:01.693 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:01.697 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:01.760 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.18925724289205 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:01.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:01.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.35899999999998
[aiter INFO] 2025-09-30 05:13:01.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-30 05:13:01.831 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,401.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,830.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:01.832 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:01.921 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.21344535185558 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:01.979 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:01.980 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.718999999999994
[aiter INFO] 2025-09-30 05:13:01.992 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,150.3        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.019 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.82751495590304 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:02.057 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 538, 678, 6}
[aiter INFO] 2025-09-30 05:13:02.057 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-30 05:13:02.057 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-30 05:13:02.058 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-30 05:13:02.058 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-30 05:13:02.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            320.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.071 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:02.073 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:02.195 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.5449008882636 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 97, 34, 67, 100, 185, 9, 75, 12, 78, 53, 86, 119, 56, 89, 122, 188, 31}
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000006
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.960000000000036
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999983
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799999999999955
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.718999999999824
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.959000000000003
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.079000000000008
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.438999999999965
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.679000000000087
[aiter INFO] 2025-09-30 05:13:02.246 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-30 05:13:02.247 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-30 05:13:02.247 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-30 05:13:02.247 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.878999999999905
[aiter INFO] 2025-09-30 05:13:02.247 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:02.265 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            810.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          1,884.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,941.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.4             29.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.266 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.29 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:02.447 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.63487088208151 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:02.500 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:02.500 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.63900000000001
[aiter INFO] 2025-09-30 05:13:02.511 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,048.2        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.539 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.722524693696805 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:02.573 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {209, 6}
[aiter INFO] 2025-09-30 05:13:02.574 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000033
[aiter INFO] 2025-09-30 05:13:02.574 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5589999999999975
[aiter INFO] 2025-09-30 05:13:02.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            474.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:02.591 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:02.805 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.54608896699283 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:02.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 405, 406}
[aiter INFO] 2025-09-30 05:13:02.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-09-30 05:13:02.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-30 05:13:02.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999869
[aiter INFO] 2025-09-30 05:13:02.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000000124
[aiter INFO] 2025-09-30 05:13:02.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            423.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,382.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,826.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:02.879 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:02.969 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.77263385116464 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.028 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:03.028 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:03.041 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,145.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.068 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.19978218060909 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.106 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:03.106 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-30 05:13:03.119 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            332.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.120 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:03.122 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:03.245 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.52509868144989 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 22, 31, 34, 53, 56, 64, 67, 75, 78, 86, 89, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.639000000000124
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.878999999999905
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.038999999999987
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000035
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.0
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.199000000000012
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.839000000000055
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.079000000000065
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19900000000007
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.878999999999905
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:03.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000087
[aiter INFO] 2025-09-30 05:13:03.297 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:03.297 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.719000000000051
[aiter INFO] 2025-09-30 05:13:03.297 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:03.297 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.83900000000017
[aiter INFO] 2025-09-30 05:13:03.315 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            804.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,859.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,941.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.4             29.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.316 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
THREADS_PER_WARP=64
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(252), np.int64(4), np.int64(116)): arr1 = 0.503906, arr2 = 0.500000, Diff = 0.003906
Position (np.int64(109), np.int64(2), np.int64(114)): arr1 = 0.589844, arr2 = 0.593750, Diff = 0.003906
Position (np.int64(109), np.int64(2), np.int64(37)): arr1 = -0.507812, arr2 = -0.511719, Diff = 0.003906
Position (np.int64(142), np.int64(1), np.int64(31)): arr1 = -0.511719, arr2 = -0.507812, Diff = 0.003906
Position (np.int64(26), np.int64(0), np.int64(74)): arr1 = -0.527344, arr2 = -0.531250, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 96799 (59.08%)
[1.0e-06, 1.0e-05): 18 (0.01%)
[1.0e-05, 1.0e-04): 1340 (0.82%)
[1.0e-04, 1.0e-03): 57200 (34.91%)
[1.0e-03, 1.0e-02): 8483 (5.18%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.04296875
max_diff_thr=0.033547792583703995

Top differences:
Position (np.int64(16), np.int64(1), np.int64(60)): arr1 = -0.404297, arr2 = -0.361328, Diff = 0.042969
Position (np.int64(71), np.int64(4), np.int64(74)): arr1 = 0.322266, arr2 = 0.281250, Diff = 0.041016
Position (np.int64(215), np.int64(3), np.int64(39)): arr1 = 0.640625, arr2 = 0.601562, Diff = 0.039062
Position (np.int64(134), np.int64(4), np.int64(89)): arr1 = 0.219727, arr2 = 0.255859, Diff = 0.036133
Position (np.int64(31), np.int64(2), np.int64(121)): arr1 = -0.098145, arr2 = -0.062500, Diff = 0.035645

Threshold statistics:
[0.0e+00, 1.0e-06): 7308 (4.46%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 61 (0.04%)
[1.0e-04, 1.0e-03): 11113 (6.78%)
[1.0e-03, 1.0e-02): 106326 (64.90%)
[1.0e-02, 1.0e-01): 39030 (23.82%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c89eb6e373994c54a36a1d567c4bb59f
triton_output_md5=f526de57a47b80320aa331cdf217ccd7
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(16), np.int64(4), np.int64(74)): arr1 = 0.570312, arr2 = 0.574219, Diff = 0.003906
Position (np.int64(48), np.int64(2), np.int64(65)): arr1 = -0.746094, arr2 = -0.750000, Diff = 0.003906
Position (np.int64(62), np.int64(3), np.int64(51)): arr1 = -0.652344, arr2 = -0.648438, Diff = 0.003906
Position (np.int64(40), np.int64(2), np.int64(44)): arr1 = 0.570312, arr2 = 0.574219, Diff = 0.003906
Position (np.int64(18), np.int64(1), np.int64(31)): arr1 = -0.507812, arr2 = -0.503906, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 23809 (58.13%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 326 (0.80%)
[1.0e-04, 1.0e-03): 14756 (36.03%)
[1.0e-03, 1.0e-02): 2066 (5.04%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.037109375
max_diff_thr=0.03218832612037659

Top differences:
Position (np.int64(54), np.int64(4), np.int64(48)): arr1 = -0.353516, arr2 = -0.316406, Diff = 0.037109
Position (np.int64(16), np.int64(1), np.int64(120)): arr1 = 0.265625, arr2 = 0.230469, Diff = 0.035156
Position (np.int64(38), np.int64(2), np.int64(3)): arr1 = 0.609375, arr2 = 0.574219, Diff = 0.035156
Position (np.int64(16), np.int64(1), np.int64(96)): arr1 = 0.632812, arr2 = 0.597656, Diff = 0.035156
Position (np.int64(2), np.int64(4), np.int64(79)): arr1 = -0.511719, arr2 = -0.478516, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 1764 (4.31%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 16 (0.04%)
[1.0e-04, 1.0e-03): 2708 (6.61%)
[1.0e-03, 1.0e-02): 26723 (65.24%)
[1.0e-02, 1.0e-01): 9749 (23.80%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=10a49634879cd0f2678ff330e76ef125
triton_output_md5=c578e82274cbbe7baa6dafa96888ee59
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(162), np.int64(1), np.int64(40)): arr1 = 0.285156, arr2 = 0.283203, Diff = 0.001953
Position (np.int64(237), np.int64(4), np.int64(84)): arr1 = 0.287109, arr2 = 0.285156, Diff = 0.001953
Position (np.int64(31), np.int64(3), np.int64(65)): arr1 = 0.292969, arr2 = 0.294922, Diff = 0.001953
Position (np.int64(105), np.int64(3), np.int64(92)): arr1 = -0.431641, arr2 = -0.429688, Diff = 0.001953
Position (np.int64(90), np.int64(0), np.int64(32)): arr1 = -0.279297, arr2 = -0.277344, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 94873 (57.91%)
[1.0e-06, 1.0e-05): 60 (0.04%)
[1.0e-05, 1.0e-04): 4935 (3.01%)
[1.0e-04, 1.0e-03): 63449 (38.73%)
[1.0e-03, 1.0e-02): 523 (0.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.021484375
max_diff_thr=0.018527429550886154

Top differences:
Position (np.int64(178), np.int64(1), np.int64(102)): arr1 = 0.419922, arr2 = 0.398438, Diff = 0.021484
Position (np.int64(36), np.int64(1), np.int64(43)): arr1 = -0.185547, arr2 = -0.165039, Diff = 0.020508
Position (np.int64(109), np.int64(2), np.int64(24)): arr1 = -0.201172, arr2 = -0.180664, Diff = 0.020508
Position (np.int64(230), np.int64(2), np.int64(36)): arr1 = -0.337891, arr2 = -0.318359, Diff = 0.019531
Position (np.int64(86), np.int64(2), np.int64(110)): arr1 = -0.332031, arr2 = -0.312500, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 6662 (4.07%)
[1.0e-06, 1.0e-05): 5 (0.00%)
[1.0e-05, 1.0e-04): 250 (0.15%)
[1.0e-04, 1.0e-03): 25992 (15.86%)
[1.0e-03, 1.0e-02): 125548 (76.63%)
[1.0e-02, 1.0e-01): 5383 (3.29%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7bda5ff1a9c1519031afcf84715770d9
triton_output_md5=7ad5b50f1f1eea6ff61d8a68b496a4cd
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(44), np.int64(2), np.int64(27)): arr1 = 0.281250, arr2 = 0.279297, Diff = 0.001953
Position (np.int64(62), np.int64(4), np.int64(107)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953
Position (np.int64(6), np.int64(1), np.int64(125)): arr1 = -0.271484, arr2 = -0.273438, Diff = 0.001953
Position (np.int64(2), np.int64(0), np.int64(85)): arr1 = 0.291016, arr2 = 0.292969, Diff = 0.001953
Position (np.int64(55), np.int64(2), np.int64(110)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 23661 (57.77%)
[1.0e-06, 1.0e-05): 15 (0.04%)
[1.0e-05, 1.0e-04): 1248 (3.05%)
[1.0e-04, 1.0e-03): 15913 (38.85%)
[1.0e-03, 1.0e-02): 123 (0.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01953125
max_diff_thr=0.01666666753590107

Top differences:
Position (np.int64(56), np.int64(3), np.int64(84)): arr1 = -0.294922, arr2 = -0.275391, Diff = 0.019531
Position (np.int64(8), np.int64(3), np.int64(53)): arr1 = 0.359375, arr2 = 0.339844, Diff = 0.019531
Position (np.int64(16), np.int64(2), np.int64(111)): arr1 = -0.191406, arr2 = -0.171875, Diff = 0.019531
Position (np.int64(12), np.int64(3), np.int64(53)): arr1 = 0.203125, arr2 = 0.185547, Diff = 0.017578
Position (np.int64(10), np.int64(1), np.int64(92)): arr1 = -0.263672, arr2 = -0.246094, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 1759 (4.29%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 39 (0.10%)
[1.0e-04, 1.0e-03): 6495 (15.86%)
[1.0e-03, 1.0e-02): 31261 (76.32%)
[1.0e-02, 1.0e-01): 1406 (3.43%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=89cca55ef62111f679f1a4b1689c1b3c
triton_output_md5=e47b463b5aa9dc3849428320fe6a6f45
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(11), np.int64(4), np.int64(26)): arr1 = -0.255859, arr2 = -0.257812, Diff = 0.001953[aiter INFO] 2025-09-30 05:13:03.497 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.84754530982215 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.548 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:03.548 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.15899999999999
[aiter INFO] 2025-09-30 05:13:03.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,046.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.39580172270831 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.621 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:03.621 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5989999999999895
[aiter INFO] 2025-09-30 05:13:03.633 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            480.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.634 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:03.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:03.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.27323731042371 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {548, 549, 9, 42, 43, 10}
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59900000000016
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.078999999999951
[aiter INFO] 2025-09-30 05:13:03.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 05:13:03.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            417.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,349.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,803.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.0             18.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:03.859 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.06098014175302 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:03.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.718999999999994
[aiter INFO] 2025-09-30 05:13:03.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,138.3        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:03.955 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.51938601325054 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:03.993 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:03.993 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-30 05:13:04.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:04.006 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:04.008 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:04.130 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.01699010865522 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:04.181 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 21, 31, 34, 42, 45, 53, 56, 64, 67, 196, 198, 75, 78, 86, 89, 361, 108, 364, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.359000000000037
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.559000000000026
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.678999999999974
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.479000000000042
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000233
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.95900000000006
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000005
[aiter INFO] 2025-09-30 05:13:04.182 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.95900000000006
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.91899999999987
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000005
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.919000000000324
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000006
[aiter INFO] 2025-09-30 05:13:04.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-30 05:13:04.201 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0            783.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          1,809.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,927.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.3             29.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:04.202 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:04.382 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.1441883710351 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:04.599 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:04.599 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.67900000000003
[aiter INFO] 2025-09-30 05:13:04.610 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,046.4        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:04.638 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.05321757008534 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:04.672 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {125, 6}
[aiter INFO] 2025-09-30 05:13:04.673 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000033
[aiter INFO] 2025-09-30 05:13:04.673 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-30 05:13:04.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            475.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:04.686 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:04.691 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:04.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.55083185375327 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {548, 549, 9, 10, 174, 175, 1076, 1077, 504, 505, 1021, 1022}
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239999999999782
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000012
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599000000000046
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.19900000000007
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000378
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-30 05:13:04.806 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999998705
[aiter INFO] 2025-09-30 05:13:04.825 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            407.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          1,311.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,809.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.1             18.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:04.826 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:04.914 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.21620829801748 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:04.971 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 402, 597, 636}
[aiter INFO] 2025-09-30 05:13:04.971 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.919999999998254
[aiter INFO] 2025-09-30 05:13:04.971 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.039000000000016
[aiter INFO] 2025-09-30 05:13:04.972 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.998999999999796
[aiter INFO] 2025-09-30 05:13:04.972 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.03899999999976
[aiter INFO] 2025-09-30 05:13:04.972 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.998999999999796
[aiter INFO] 2025-09-30 05:13:04.984 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 96.0            0.0          2,057.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.399396072519885 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.048 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:05.048 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-30 05:13:05.060 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            333.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.062 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:05.063 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:05.186 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.52192075063687 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.238 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 97, 67, 100, 9, 12, 53, 55}
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.07899999999995
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.31899999999996
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999983
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.88000000000011
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.079000000000008
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000012
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:05.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000028
[aiter INFO] 2025-09-30 05:13:05.258 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            856.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,988.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,938.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.4             29.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.258 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(65), np.int64(4), np.int64(113)): arr1 = 0.275391, arr2 = 0.273438, Diff = 0.001953
Position (np.int64(0), np.int64(4), np.int64(1)): arr1 = 0.251953, arr2 = 0.250000, Diff = 0.001953
Position (np.int64(204), np.int64(4), np.int64(28)): arr1 = 0.277344, arr2 = 0.279297, Diff = 0.001953
Position (np.int64(95), np.int64(2), np.int64(43)): arr1 = 0.289062, arr2 = 0.291016, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 94298 (57.55%)
[1.0e-06, 1.0e-05): 162 (0.10%)
[1.0e-05, 1.0e-04): 10232 (6.25%)
[1.0e-04, 1.0e-03): 59132 (36.09%)
[1.0e-03, 1.0e-02): 16 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01611328125
max_diff_thr=0.015270708128809929

Top differences:
Position (np.int64(22), np.int64(3), np.int64(27)): arr1 = -0.071289, arr2 = -0.055176, Diff = 0.016113
Position (np.int64(211), np.int64(0), np.int64(83)): arr1 = -0.025879, arr2 = -0.040039, Diff = 0.014160
Position (np.int64(123), np.int64(4), np.int64(103)): arr1 = 0.138672, arr2 = 0.124512, Diff = 0.014160
Position (np.int64(228), np.int64(0), np.int64(78)): arr1 = 0.096680, arr2 = 0.082520, Diff = 0.014160
Position (np.int64(93), np.int64(2), np.int64(82)): arr1 = -0.158203, arr2 = -0.144531, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 6612 (4.04%)
[1.0e-06, 1.0e-05): 9 (0.01%)
[1.0e-05, 1.0e-04): 515 (0.31%)
[1.0e-04, 1.0e-03): 37783 (23.06%)
[1.0e-03, 1.0e-02): 118570 (72.37%)
[1.0e-02, 1.0e-01): 351 (0.21%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=03b18f5941544299796c6bf36231db9f
triton_output_md5=bff176fc69126ba1b14eabc7aa4ed158
diff.abs.max=0.001953125
max_diff_thr=0.0015552099794149399

Top differences:
Position (np.int64(12), np.int64(1), np.int64(122)): arr1 = -0.253906, arr2 = -0.255859, Diff = 0.001953
Position (np.int64(17), np.int64(0), np.int64(29)): arr1 = -0.261719, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(19), np.int64(0), np.int64(19)): arr1 = 0.194336, arr2 = 0.193359, Diff = 0.000977
Position (np.int64(55), np.int64(0), np.int64(106)): arr1 = 0.138672, arr2 = 0.139648, Diff = 0.000977
Position (np.int64(24), np.int64(4), np.int64(0)): arr1 = 0.139648, arr2 = 0.140625, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23678 (57.81%)
[1.0e-06, 1.0e-05): 33 (0.08%)
[1.0e-05, 1.0e-04): 2539 (6.20%)
[1.0e-04, 1.0e-03): 14708 (35.91%)
[1.0e-03, 1.0e-02): 2 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0146484375
max_diff_thr=0.013327410444617271

Top differences:
Position (np.int64(13), np.int64(1), np.int64(61)): arr1 = 0.084473, arr2 = 0.099121, Diff = 0.014648
Position (np.int64(23), np.int64(3), np.int64(28)): arr1 = -0.267578, arr2 = -0.253906, Diff = 0.013672
Position (np.int64(22), np.int64(3), np.int64(53)): arr1 = 0.058105, arr2 = 0.045166, Diff = 0.012939
Position (np.int64(24), np.int64(0), np.int64(90)): arr1 = -0.039062, arr2 = -0.052002, Diff = 0.012939
Position (np.int64(2), np.int64(2), np.int64(115)): arr1 = -0.115723, arr2 = -0.103027, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1703 (4.16%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 127 (0.31%)
[1.0e-04, 1.0e-03): 9329 (22.78%)
[1.0e-03, 1.0e-02): 29717 (72.55%)
[1.0e-02, 1.0e-01): 83 (0.20%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2f159ba96db70b9b1281515d2407de0c
triton_output_md5=a2de64bfcb0617c5880a6953e9dfe239
diff.abs.max=0.001953125
max_diff_thr=0.0015479875728487968

Top differences:
Position (np.int64(31), np.int64(1), np.int64(57)): arr1 = 0.261719, arr2 = 0.263672, Diff = 0.001953
Position (np.int64(34), np.int64(1), np.int64(2)): arr1 = 0.271484, arr2 = 0.273438, Diff = 0.001953
Position (np.int64(53), np.int64(2), np.int64(14)): arr1 = -0.263672, arr2 = -0.265625, Diff = 0.001953
Position (np.int64(247), np.int64(4), np.int64(97)): arr1 = -0.279297, arr2 = -0.281250, Diff = 0.001953
Position (np.int64(195), np.int64(2), np.int64(22)): arr1 = -0.259766, arr2 = -0.261719, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 94144 (57.46%)
[1.0e-06, 1.0e-05): 186 (0.11%)
[1.0e-05, 1.0e-04): 11750 (7.17%)
[1.0e-04, 1.0e-03): 57754 (35.25%)
[1.0e-03, 1.0e-02): 6 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0166015625
max_diff_thr=0.013821138069033623

Top differences:
Position (np.int64(48), np.int64(3), np.int64(111)): arr1 = -0.217773, arr2 = -0.201172, Diff = 0.016602
Position (np.int64(238), np.int64(3), np.int64(37)): arr1 = -0.330078, arr2 = -0.316406, Diff = 0.013672
Position (np.int64(72), np.int64(3), np.int64(93)): arr1 = 0.089844, arr2 = 0.076172, Diff = 0.013672
Position (np.int64(220), np.int64(4), np.int64(89)): arr1 = 0.113770, arr2 = 0.100586, Diff = 0.013184
Position (np.int64(179), np.int64(4), np.int64(84)): arr1 = -0.229492, arr2 = -0.216797, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 6721 (4.10%)
[1.0e-06, 1.0e-05): 8 (0.00%)
[1.0e-05, 1.0e-04): 581 (0.35%)
[1.0e-04, 1.0e-03): 40484 (24.71%)
[1.0e-03, 1.0e-02): 115897 (70.74%)
[1.0e-02, 1.0e-01): 149 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=28864c79b8e113dbd2cccd970eb8c5b7
triton_output_md5=d4ceadd5eeaa991002460f9ff2411fa8
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(46), np.int64(0), np.int64(56)): arr1 = -0.277344, arr2 = -0.279297, Diff = 0.001953
Position (np.int64(41), np.int64(3), np.int64(110)): arr1 = 0.253906, arr2 = 0.251953, Diff = 0.001953
Position (np.int64(35), np.int64(2), np.int64(41)): arr1 = 0.253906, arr2 = 0.251953, Diff = 0.001953
Position (np.int64(32), np.int64(1), np.int64(26)): arr1 = -0.273438, arr2 = -0.271484, Diff = 0.001953
Position (np.int64(33), np.int64(4), np.int64(110)): arr1 = -0.164062, arr2 = -0.165039, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23579 (57.57%)
[1.0e-06, 1.0e-05): 49 (0.12%)
[1.0e-05, 1.0e-04): 2846 (6.95%)
[1.0e-04, 1.0e-03): 14482 (35.36%)
[1.0e-03, 1.0e-02): 4 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0126953125
max_diff_thr=0.010961214080452919

Top differences:
Position (np.int64(1), np.int64(3), np.int64(124)): arr1 = -0.175781, arr2 = -0.163086, Diff = 0.012695
Position (np.int64(52), np.int64(0), np.int64(43)): arr1 = -0.170898, arr2 = -0.158203, Diff = 0.012695
Position (np.int64(57), np.int64(4), np.int64(26)): arr1 = 0.154297, arr2 = 0.142578, Diff = 0.011719
Position (np.int64(38), np.int64(2), np.int64(37)): arr1 = 0.133789, arr2 = 0.122070, Diff = 0.011719
Position (np.int64(5), np.int64(1), np.int64(77)): arr1 = 0.209961, arr2 = 0.198242, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1666 (4.07%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 142 (0.35%)
[1.0e-04, 1.0e-03): 10261 (25.05%)
[1.0e-03, 1.0e-02): 28852 (70.44%)
[1.0e-02, 1.0e-01): 36 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e7f1c1c4df770f3376edaa088d1afc1d
triton_output_md5=cbe49f10dbadb397c0400f838f5a0314
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(201), np.int64(1), np.int64(5)): arr1 = -0.184570, arr2 = -0.183594, Diff = 0.000977
Position (np.int64(86), np.int64(2), np.int64(105)): arr1 = -0.145508, arr2 = -0.146484, Diff = 0.000977
Position (np.int64(126), np.int64(1), np.int64(1)): arr1 = 0.128906, arr2 = 0.129883, Diff = 0.000977[aiter INFO] 2025-09-30 05:13:05.439 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.85743595349905 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.492 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:05.492 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.759000000000015
[aiter INFO] 2025-09-30 05:13:05.503 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,044.8        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.530 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.572039635169624 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.566 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:05.566 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.63900000000001
[aiter INFO] 2025-09-30 05:13:05.578 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            480.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.580 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:05.584 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:05.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.585732586313 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {196, 197, 9, 394, 395, 10, 691, 692, 823, 824, 537, 538, 350, 351}
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999705
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.639000000000124
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000233
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.399000000001251
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999997963
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.318999999999505
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.31899999999996
[aiter INFO] 2025-09-30 05:13:05.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.320000000000164
[aiter INFO] 2025-09-30 05:13:05.719 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            403.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          1,297.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,815.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.2             18.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.720 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:05.807 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.7654951315115 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:05.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 558}
[aiter INFO] 2025-09-30 05:13:05.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.759000000000015
[aiter INFO] 2025-09-30 05:13:05.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.87899999999999
[aiter INFO] 2025-09-30 05:13:05.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.039999999999964
[aiter INFO] 2025-09-30 05:13:05.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0          2,100.7        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:05.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.31664365411985 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.152 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {118, 6}
[aiter INFO] 2025-09-30 05:13:06.152 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.9189999999999827
[aiter INFO] 2025-09-30 05:13:06.152 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-30 05:13:06.164 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            330.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:06.166 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:06.168 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:06.292 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.39760368236222 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 100, 9, 12, 174, 177, 152, 155, 636, 639}
[aiter INFO] 2025-09-30 05:13:06.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:06.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000133
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000024
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.039999999999964
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000133
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.118999999999687
[aiter INFO] 2025-09-30 05:13:06.346 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-30 05:13:06.365 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            847.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,980.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,949.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.5             29.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:06.366 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:06.548 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.84950463016435 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:06.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.11899999999997
[aiter INFO] 2025-09-30 05:13:06.612 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,040.2        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:06.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.99305940618609 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.674 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {601, 636, 125, 6}
[aiter INFO] 2025-09-30 05:13:06.674 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-30 05:13:06.674 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-30 05:13:06.674 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000033
[aiter INFO] 2025-09-30 05:13:06.674 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-30 05:13:06.687 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            468.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:06.688 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:06.692 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:06.754 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.74525708019144 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {900, 901, 9, 10, 174, 175}
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000378
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999967
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-09-30 05:13:06.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000051
[aiter INFO] 2025-09-30 05:13:06.827 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            420.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,358.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,820.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.2             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:06.828 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:06.917 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.04157465991408 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:06.974 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {584, 792, 1312, 12}
[aiter INFO] 2025-09-30 05:13:06.974 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.91899999999987
[aiter INFO] 2025-09-30 05:13:06.974 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999833
[aiter INFO] 2025-09-30 05:13:06.974 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.838999999999942
[aiter INFO] 2025-09-30 05:13:06.974 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.91900000000001
[aiter INFO] 2025-09-30 05:13:06.986 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 97.0            0.0          2,076.3        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.014 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.00968309204177 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:07.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 6}
[aiter INFO] 2025-09-30 05:13:07.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.719000000000051
[aiter INFO] 2025-09-30 05:13:07.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-30 05:13:07.064 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            328.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.065 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:07.067 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:07.190 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.90649497390974 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 273, 20, 276, 22, 31, 34, 53, 56, 64, 67, 75, 78, 86, 89, 999, 1002}
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.959000000000003
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.798999999999978
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999992
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.079000000000178
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.998999999999967
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.07899999999995
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.358999999999924
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:07.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19900000000007
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.718999999999937
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999983
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.919000000000096
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.15899999999965
[aiter INFO] 2025-09-30 05:13:07.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.799000000000888
[aiter INFO] 2025-09-30 05:13:07.260 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            806.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,857.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,936.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           29.4             29.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(27), np.int64(0), np.int64(59)): arr1 = 0.157227, arr2 = 0.156250, Diff = 0.000977
Position (np.int64(216), np.int64(0), np.int64(21)): arr1 = 0.148438, arr2 = 0.147461, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 94962 (57.96%)
[1.0e-06, 1.0e-05): 302 (0.18%)
[1.0e-05, 1.0e-04): 17405 (10.62%)
[1.0e-04, 1.0e-03): 51171 (31.23%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01123046875
max_diff_thr=0.010599078610539436

Top differences:
Position (np.int64(167), np.int64(2), np.int64(74)): arr1 = -0.070801, arr2 = -0.059570, Diff = 0.011230
Position (np.int64(19), np.int64(2), np.int64(71)): arr1 = -0.039062, arr2 = -0.028198, Diff = 0.010864
Position (np.int64(88), np.int64(1), np.int64(117)): arr1 = 0.118164, arr2 = 0.107910, Diff = 0.010254
Position (np.int64(0), np.int64(4), np.int64(83)): arr1 = -0.223633, arr2 = -0.213867, Diff = 0.009766
Position (np.int64(86), np.int64(2), np.int64(21)): arr1 = 0.079590, arr2 = 0.069824, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 6761 (4.13%)
[1.0e-06, 1.0e-05): 8 (0.00%)
[1.0e-05, 1.0e-04): 976 (0.60%)
[1.0e-04, 1.0e-03): 50979 (31.12%)
[1.0e-03, 1.0e-02): 105113 (64.16%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6f2afd50d1c23094e5b4367771800ce3
triton_output_md5=f6276af787d19462233cef848d980ccc
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(41), np.int64(4), np.int64(60)): arr1 = 0.149414, arr2 = 0.150391, Diff = 0.000977
Position (np.int64(45), np.int64(3), np.int64(119)): arr1 = -0.157227, arr2 = -0.158203, Diff = 0.000977
Position (np.int64(6), np.int64(1), np.int64(7)): arr1 = -0.134766, arr2 = -0.133789, Diff = 0.000977
Position (np.int64(53), np.int64(1), np.int64(35)): arr1 = -0.126953, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(42), np.int64(3), np.int64(88)): arr1 = 0.152344, arr2 = 0.153320, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23624 (57.68%)
[1.0e-06, 1.0e-05): 59 (0.14%)
[1.0e-05, 1.0e-04): 4404 (10.75%)
[1.0e-04, 1.0e-03): 12873 (31.43%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009765625
max_diff_thr=0.008989827707409859

Top differences:
Position (np.int64(52), np.int64(4), np.int64(108)): arr1 = -0.103516, arr2 = -0.093750, Diff = 0.009766
Position (np.int64(18), np.int64(3), np.int64(118)): arr1 = 0.045410, arr2 = 0.036133, Diff = 0.009277
Position (np.int64(39), np.int64(0), np.int64(78)): arr1 = -0.041260, arr2 = -0.031982, Diff = 0.009277
Position (np.int64(44), np.int64(1), np.int64(119)): arr1 = -0.171875, arr2 = -0.163086, Diff = 0.008789
Position (np.int64(9), np.int64(3), np.int64(8)): arr1 = 0.034424, arr2 = 0.025635, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1613 (3.94%)
[1.0e-06, 1.0e-05): 4 (0.01%)
[1.0e-05, 1.0e-04): 218 (0.53%)
[1.0e-04, 1.0e-03): 12699 (31.00%)
[1.0e-03, 1.0e-02): 26426 (64.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=252b85f36ffa53b03e0639e1bf5b438a
triton_output_md5=21e0447bcccb97825598c1d2e2c2f0fa
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(146), np.int64(3), np.int64(70)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(69), np.int64(0), np.int64(67)): arr1 = 0.137695, arr2 = 0.136719, Diff = 0.000977
Position (np.int64(84), np.int64(0), np.int64(110)): arr1 = 0.131836, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(47), np.int64(4), np.int64(101)): arr1 = 0.135742, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(14), np.int64(4), np.int64(102)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 93902 (57.31%)
[1.0e-06, 1.0e-05): 347 (0.21%)
[1.0e-05, 1.0e-04): 20005 (12.21%)
[1.0e-04, 1.0e-03): 49586 (30.26%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009521484375
max_diff_thr=0.009124941192567348

Top differences:
Position (np.int64(210), np.int64(1), np.int64(105)): arr1 = 0.052979, arr2 = 0.043457, Diff = 0.009521
Position (np.int64(76), np.int64(1), np.int64(43)): arr1 = 0.083984, arr2 = 0.074707, Diff = 0.009277
Position (np.int64(205), np.int64(1), np.int64(36)): arr1 = 0.082520, arr2 = 0.073242, Diff = 0.009277
Position (np.int64(194), np.int64(4), np.int64(115)): arr1 = 0.118164, arr2 = 0.108887, Diff = 0.009277
Position (np.int64(217), np.int64(4), np.int64(18)): arr1 = -0.131836, arr2 = -0.123047, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 6613 (4.04%)
[1.0e-06, 1.0e-05): 20 (0.01%)
[1.0e-05, 1.0e-04): 1150 (0.70%)
[1.0e-04, 1.0e-03): 55008 (33.57%)
[1.0e-03, 1.0e-02): 101049 (61.68%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=82075b48d96dfae57f62444b839cbe66
triton_output_md5=a3e89756751d9dc67ca1a2cfcd0d841e
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(62), np.int64(2), np.int64(63)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977
Position (np.int64(21), np.int64(4), np.int64(74)): arr1 = 0.131836, arr2 = 0.132812, Diff = 0.000977
Position (np.int64(60), np.int64(1), np.int64(103)): arr1 = -0.133789, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(10), np.int64(4), np.int64(80)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(22), np.int64(3), np.int64(93)): arr1 = 0.128906, arr2 = 0.129883, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 23488 (57.34%)
[1.0e-06, 1.0e-05): 88 (0.21%)
[1.0e-05, 1.0e-04): 5029 (12.28%)
[1.0e-04, 1.0e-03): 12355 (30.16%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00927734375
max_diff_thr=0.00859266147017479

Top differences:
Position (np.int64(32), np.int64(0), np.int64(118)): arr1 = -0.119141, arr2 = -0.109863, Diff = 0.009277
Position (np.int64(2), np.int64(2), np.int64(79)): arr1 = 0.060303, arr2 = 0.051270, Diff = 0.009033
Position (np.int64(15), np.int64(0), np.int64(70)): arr1 = -0.125000, arr2 = -0.116211, Diff = 0.008789
Position (np.int64(9), np.int64(1), np.int64(36)): arr1 = -0.099609, arr2 = -0.090820, Diff = 0.008789
Position (np.int64(30), np.int64(3), np.int64(72)): arr1 = -0.040039, arr2 = -0.031494, Diff = 0.008545

Threshold statistics:
[0.0e+00, 1.0e-06): 1661 (4.06%)
[1.0e-06, 1.0e-05): 11 (0.03%)
[1.0e-05, 1.0e-04): 270 (0.66%)
[1.0e-04, 1.0e-03): 13750 (33.57%)
[1.0e-03, 1.0e-02): 25268 (61.69%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=457854f425f6c0224c6b7644b2b20d5e
triton_output_md5=1c73db634406ecc62242400b4e2c4bb6
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(27), np.int64(2), np.int64(68)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(226), np.int64(4), np.int64(55)): arr1 = -0.137695, arr2 = -0.138672, Diff = 0.000977
Position (np.int64(175), np.int64(0), np.int64(88)): arr1 = 0.133789, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(215), np.int64(2), np.int64(90)): arr1 = 0.138672, arr2 = 0.139648, Diff = 0.000977
Position (np.int64(26), np.int64(2), np.int64(18)): arr1 = -0.143555, arr2 = -0.144531, Diff = 0.000977[aiter INFO] 2025-09-30 05:13:07.441 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.63251483676456 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:07.494 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {129, 259, 12}
[aiter INFO] 2025-09-30 05:13:07.494 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.19900000000007
[aiter INFO] 2025-09-30 05:13:07.494 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.19900000000007
[aiter INFO] 2025-09-30 05:13:07.494 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.998999999999995
[aiter INFO] 2025-09-30 05:13:07.504 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0          3,960.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.531 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.66436649431096 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:07.565 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:07.566 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-30 05:13:07.578 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            478.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.579 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.19 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:07.583 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:07.644 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.52825751871165 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:07.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 11}
[aiter INFO] 2025-09-30 05:13:07.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-09-30 05:13:07.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.719000000000051
[aiter INFO] 2025-09-30 05:13:07.718 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            427.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,391.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,819.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.2             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:07.719 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:07.807 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.3179804647323 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.044 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:08.044 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839
[aiter INFO] 2025-09-30 05:13:08.057 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,147.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.084 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.94312867433718 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.123 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {209, 6}
[aiter INFO] 2025-09-30 05:13:08.123 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.9190000000000964
[aiter INFO] 2025-09-30 05:13:08.124 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-30 05:13:08.136 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            330.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.137 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:08.139 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:08.264 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.67565408791646 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 68, 9, 42, 108, 13, 46, 112, 20, 53, 86, 23, 57, 90, 31}
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.399
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.559000000000026
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.07899999999995
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.15899999999988
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.079000000000008
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000096
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.998999999999796
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.95999999999998
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.35900000000004
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.43900000000008
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.839000000000055
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-30 05:13:08.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.999000000000024
[aiter INFO] 2025-09-30 05:13:08.338 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            830.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          2,893.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,017.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           40.2             40.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.339 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    40.04 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:08.524 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 173.45041597243582 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {961, 38, 12, 77, 1039, 51}
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.63900000000012
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.839
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.59900000000002
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.79899999999998
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.59900000000016
[aiter INFO] 2025-09-30 05:13:08.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.0390000000001
[aiter INFO] 2025-09-30 05:13:08.590 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 95.0            0.0          7,239.6        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             76.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.620 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.091653451471046 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.656 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {531, 475, 6}
[aiter INFO] 2025-09-30 05:13:08.657 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000069
[aiter INFO] 2025-09-30 05:13:08.657 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000069
[aiter INFO] 2025-09-30 05:13:08.657 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119
[aiter INFO] 2025-09-30 05:13:08.669 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            553.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.670 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    81.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:08.675 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:08.737 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.52628716796931 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.794 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:08.794 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-09-30 05:13:08.794 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.0
[aiter INFO] 2025-09-30 05:13:08.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,414.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,842.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.4             18.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.814 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:08.901 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.76315811423973 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:08.959 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:08.959 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.398999999999972
[aiter INFO] 2025-09-30 05:13:08.972 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,161.9        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:08.999 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.39423761715983 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:09.037 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 111}
[aiter INFO] 2025-09-30 05:13:09.037 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-30 05:13:09.037 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.3190000000000737
[aiter INFO] 2025-09-30 05:13:09.049 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            370.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:09.050 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:09.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:09.176 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 127.19129682472435 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 42, 12, 45, 20, 23, 31}
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799000000000092
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.118999999999915
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.99899999999991
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.99899999999997
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000008
[aiter INFO] 2025-09-30 05:13:09.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.83899999999994
[aiter INFO] 2025-09-30 05:13:09.247 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            869.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,021.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,017.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           40.2             40.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:09.248 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    40.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 94362 (57.59%)
[1.0e-06, 1.0e-05): 623 (0.38%)
[1.0e-05, 1.0e-04): 31801 (19.41%)
[1.0e-04, 1.0e-03): 37054 (22.62%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.006508600432425737

Top differences:
Position (np.int64(158), np.int64(1), np.int64(116)): arr1 = -0.109375, arr2 = -0.102539, Diff = 0.006836
Position (np.int64(177), np.int64(3), np.int64(51)): arr1 = 0.072266, arr2 = 0.065430, Diff = 0.006836
Position (np.int64(233), np.int64(4), np.int64(113)): arr1 = 0.057129, arr2 = 0.050293, Diff = 0.006836
Position (np.int64(135), np.int64(1), np.int64(79)): arr1 = 0.071289, arr2 = 0.064453, Diff = 0.006836
Position (np.int64(123), np.int64(0), np.int64(84)): arr1 = -0.058838, arr2 = -0.052490, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6458 (3.94%)
[1.0e-06, 1.0e-05): 26 (0.02%)
[1.0e-05, 1.0e-04): 2261 (1.38%)
[1.0e-04, 1.0e-03): 73791 (45.04%)
[1.0e-03, 1.0e-02): 81304 (49.62%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=43db9ea1972cd2c701f1c75b7421c203
triton_output_md5=0449e97a1cac6e5d81c6c5f882ff17ec
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(33), np.int64(3), np.int64(96)): arr1 = -0.133789, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(45), np.int64(1), np.int64(61)): arr1 = 0.131836, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(59), np.int64(3), np.int64(60)): arr1 = 0.125000, arr2 = 0.125977, Diff = 0.000977
Position (np.int64(46), np.int64(2), np.int64(82)): arr1 = -0.082031, arr2 = -0.082520, Diff = 0.000488
Position (np.int64(9), np.int64(0), np.int64(27)): arr1 = 0.110352, arr2 = 0.109863, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 23371 (57.06%)
[1.0e-06, 1.0e-05): 188 (0.46%)
[1.0e-05, 1.0e-04): 8169 (19.94%)
[1.0e-04, 1.0e-03): 9232 (22.54%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.006591796875
max_diff_thr=0.006234126165509224

Top differences:
Position (np.int64(54), np.int64(0), np.int64(15)): arr1 = 0.063965, arr2 = 0.057373, Diff = 0.006592
Position (np.int64(6), np.int64(4), np.int64(1)): arr1 = -0.109863, arr2 = -0.103516, Diff = 0.006348
Position (np.int64(24), np.int64(1), np.int64(16)): arr1 = 0.022461, arr2 = 0.016235, Diff = 0.006226
Position (np.int64(46), np.int64(0), np.int64(96)): arr1 = 0.030518, arr2 = 0.024536, Diff = 0.005981
Position (np.int64(33), np.int64(2), np.int64(58)): arr1 = 0.046875, arr2 = 0.041016, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1741 (4.25%)
[1.0e-06, 1.0e-05): 5 (0.01%)
[1.0e-05, 1.0e-04): 537 (1.31%)
[1.0e-04, 1.0e-03): 18520 (45.21%)
[1.0e-03, 1.0e-02): 20157 (49.21%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1e5be40621da30d68f36643e1f04f6b6
triton_output_md5=fde74eeb21d86405a42ef68b3d280305
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(107), np.int64(3), np.int64(104)): arr1 = -0.131836, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(212), np.int64(3), np.int64(50)): arr1 = -0.135742, arr2 = -0.136719, Diff = 0.000977
Position (np.int64(197), np.int64(1), np.int64(71)): arr1 = -0.133789, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(69), np.int64(3), np.int64(27)): arr1 = -0.142578, arr2 = -0.143555, Diff = 0.000977
Position (np.int64(161), np.int64(3), np.int64(59)): arr1 = -0.127930, arr2 = -0.128906, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 88864 (54.24%)
[1.0e-06, 1.0e-05): 669 (0.41%)
[1.0e-05, 1.0e-04): 31922 (19.48%)
[1.0e-04, 1.0e-03): 42385 (25.87%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00732421875
max_diff_thr=0.006714719347655773

Top differences:
Position (np.int64(187), np.int64(4), np.int64(18)): arr1 = 0.098633, arr2 = 0.091309, Diff = 0.007324
Position (np.int64(196), np.int64(1), np.int64(24)): arr1 = -0.001198, arr2 = 0.005554, Diff = 0.006752
Position (np.int64(31), np.int64(1), np.int64(30)): arr1 = 0.025024, arr2 = 0.018555, Diff = 0.006470
Position (np.int64(49), np.int64(2), np.int64(91)): arr1 = 0.043945, arr2 = 0.037598, Diff = 0.006348
Position (np.int64(69), np.int64(2), np.int64(27)): arr1 = -0.130859, arr2 = -0.124512, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6610 (4.03%)
[1.0e-06, 1.0e-05): 37 (0.02%)
[1.0e-05, 1.0e-04): 2253 (1.38%)
[1.0e-04, 1.0e-03): 74191 (45.28%)
[1.0e-03, 1.0e-02): 80749 (49.29%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1a12e45b4ddc64043e1087cf506ed7c8
triton_output_md5=4316992d893e9b49b555bd72bea08776
diff.abs.max=0.0009765625
max_diff_thr=0.0008643042529001832

Top differences:
Position (np.int64(21), np.int64(0), np.int64(124)): arr1 = 0.135742, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(45), np.int64(4), np.int64(1)): arr1 = 0.128906, arr2 = 0.129883, Diff = 0.000977
Position (np.int64(5), np.int64(2), np.int64(78)): arr1 = 0.138672, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(53), np.int64(3), np.int64(89)): arr1 = 0.131836, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(29), np.int64(2), np.int64(82)): arr1 = -0.140625, arr2 = -0.139648, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 22181 (54.15%)
[1.0e-06, 1.0e-05): 186 (0.45%)
[1.0e-05, 1.0e-04): 8053 (19.66%)
[1.0e-04, 1.0e-03): 10540 (25.73%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.006395614240318537

Top differences:
Position (np.int64(57), np.int64(4), np.int64(118)): arr1 = 0.075684, arr2 = 0.068848, Diff = 0.006836
Position (np.int64(32), np.int64(2), np.int64(20)): arr1 = -0.102051, arr2 = -0.095703, Diff = 0.006348
Position (np.int64(37), np.int64(2), np.int64(16)): arr1 = 0.080078, arr2 = 0.073730, Diff = 0.006348
Position (np.int64(61), np.int64(4), np.int64(30)): arr1 = -0.081543, arr2 = -0.075195, Diff = 0.006348
Position (np.int64(20), np.int64(3), np.int64(97)): arr1 = 0.067871, arr2 = 0.061768, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 1695 (4.14%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 556 (1.36%)
[1.0e-04, 1.0e-03): 18649 (45.53%)
[1.0e-03, 1.0e-02): 20052 (48.96%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=08136984637d2f5c893556fec3f83df8
triton_output_md5=2f47568422ff0309f93b32269dece491
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(196), np.int64(0), np.int64(70)): arr1 = 0.132812, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(154), np.int64(1), np.int64(59)): arr1 = -0.133789, arr2 = -0.134766, Diff = 0.000977
Position (np.int64(98), np.int64(2), np.int64(89)): arr1 = -0.148438, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(116), np.int64(2), np.int64(84)): arr1 = -0.126953, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(225), np.int64(0), np.int64(85)): arr1 = -0.137695, arr2 = -0.136719, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 82310 (50.24%)
[1.0e-06, 1.0e-05): 676 (0.41%)
[1.0e-05, 1.0e-04): 33314 (20.33%)
[1.0e-04, 1.0e-03): 47540 (29.02%)[aiter INFO] 2025-09-30 05:13:09.434 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.96131696795473 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:09.485 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 12, 103}
[aiter INFO] 2025-09-30 05:13:09.485 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.79899999999998
[aiter INFO] 2025-09-30 05:13:09.485 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.31900000000002
[aiter INFO] 2025-09-30 05:13:09.485 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.15899999999999
[aiter INFO] 2025-09-30 05:13:09.498 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0          7,458.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             76.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:09.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.52889111402011 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:09.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:09.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 05:13:09.571 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            562.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:09.573 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    81.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:09.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:09.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.93013859031224 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 119, 120, 185, 186, 350, 351}
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.240000000000009
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.719000000000051
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999596
[aiter INFO] 2025-09-30 05:13:09.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.398999999999887
[aiter INFO] 2025-09-30 05:13:09.890 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            416.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,353.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,827.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:09.891 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:09.980 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.51204939939008 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.039 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:10.039 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.599000000000018
[aiter INFO] 2025-09-30 05:13:10.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,169.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.080 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.978772325680985 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.119 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {195, 6}
[aiter INFO] 2025-09-30 05:13:10.119 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000000327
[aiter INFO] 2025-09-30 05:13:10.119 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-30 05:13:10.132 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            371.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:10.135 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:10.260 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.04396066925312 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 34, 68, 9, 42, 13, 46, 20, 53, 86, 23, 57, 90, 31}
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.278999999999996
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.84000000000003
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.038999999999987
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.63900000000001
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.63899999999995
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.15899999999999
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.118999999999915
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.998999999999967
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-30 05:13:10.314 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.678999999999974
[aiter INFO] 2025-09-30 05:13:10.333 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            841.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          2,933.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,025.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           40.3             40.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.334 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    40.16 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:10.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.15656429706235 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.578 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:10.578 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.79899999999998
[aiter INFO] 2025-09-30 05:13:10.591 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          7,615.6        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             76.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.618 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.63660408187621 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.653 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {419, 412, 6}
[aiter INFO] 2025-09-30 05:13:10.653 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000287
[aiter INFO] 2025-09-30 05:13:10.653 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999796
[aiter INFO] 2025-09-30 05:13:10.653 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 05:13:10.665 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            549.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    81.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:10.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:10.732 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.09417824461909 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.788 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 174, 175}
[aiter INFO] 2025-09-30 05:13:10.789 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.35899999999998
[aiter INFO] 2025-09-30 05:13:10.789 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 05:13:10.789 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-09-30 05:13:10.789 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-30 05:13:10.807 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            424.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,390.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,834.9              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.808 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:10.896 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.91278270447609 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:10.954 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-30 05:13:10.954 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:10.954 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.35900000000001
[aiter INFO] 2025-09-30 05:13:10.966 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,143.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:10.993 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.38197023414149 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:11.031 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {489, 195, 6}
[aiter INFO] 2025-09-30 05:13:11.031 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.1590000000001055
[aiter INFO] 2025-09-30 05:13:11.031 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-30 05:13:11.031 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000017
[aiter INFO] 2025-09-30 05:13:11.043 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            367.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:11.044 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:11.046 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:11.171 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.90495108259788 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 762, 36, 69, 9, 42, 75, 47, 80, 16, 20, 53, 757, 25, 58, 31}
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.87900000000002
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.55899999999997
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.438999999999965
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.35900000000004
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.7589999999999
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.07899999999995
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-30 05:13:11.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.519000000000005
[aiter INFO] 2025-09-30 05:13:11.224 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.198999999999955
[aiter INFO] 2025-09-30 05:13:11.224 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.878999999999905
[aiter INFO] 2025-09-30 05:13:11.224 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999983
[aiter INFO] 2025-09-30 05:13:11.224 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-30 05:13:11.224 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.23900000000003
[aiter INFO] 2025-09-30 05:13:11.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            823.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          3,531.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,694.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           46.9             46.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:11.243 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.006406382191926241

Top differences:
Position (np.int64(48), np.int64(2), np.int64(41)): arr1 = 0.101074, arr2 = 0.094238, Diff = 0.006836
Position (np.int64(16), np.int64(1), np.int64(113)): arr1 = 0.055908, arr2 = 0.049316, Diff = 0.006592
Position (np.int64(91), np.int64(3), np.int64(59)): arr1 = 0.056152, arr2 = 0.049561, Diff = 0.006592
Position (np.int64(10), np.int64(0), np.int64(98)): arr1 = 0.003418, arr2 = 0.009888, Diff = 0.006470
Position (np.int64(203), np.int64(0), np.int64(46)): arr1 = 0.052979, arr2 = 0.046631, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6763 (4.13%)
[1.0e-06, 1.0e-05): 37 (0.02%)
[1.0e-05, 1.0e-04): 2476 (1.51%)
[1.0e-04, 1.0e-03): 77597 (47.36%)
[1.0e-03, 1.0e-02): 76967 (46.98%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b131776fb99f321714b2abba744a8c68
triton_output_md5=0b1f431e5df2fb42736a5b0892187b7e
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(43), np.int64(2), np.int64(34)): arr1 = -0.125000, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(51), np.int64(3), np.int64(51)): arr1 = -0.145508, arr2 = -0.144531, Diff = 0.000977
Position (np.int64(2), np.int64(4), np.int64(44)): arr1 = -0.080566, arr2 = -0.081055, Diff = 0.000488
Position (np.int64(35), np.int64(1), np.int64(22)): arr1 = -0.082031, arr2 = -0.081543, Diff = 0.000488
Position (np.int64(26), np.int64(1), np.int64(74)): arr1 = -0.077148, arr2 = -0.076660, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 21071 (51.44%)
[1.0e-06, 1.0e-05): 200 (0.49%)
[1.0e-05, 1.0e-04): 7968 (19.45%)
[1.0e-04, 1.0e-03): 11721 (28.62%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00634765625
max_diff_thr=0.006073347292840481

Top differences:
Position (np.int64(46), np.int64(3), np.int64(71)): arr1 = 0.051514, arr2 = 0.045166, Diff = 0.006348
Position (np.int64(27), np.int64(2), np.int64(48)): arr1 = 0.075195, arr2 = 0.068848, Diff = 0.006348
Position (np.int64(36), np.int64(2), np.int64(20)): arr1 = 0.127930, arr2 = 0.122070, Diff = 0.005859
Position (np.int64(19), np.int64(4), np.int64(98)): arr1 = 0.017212, arr2 = 0.011536, Diff = 0.005676
Position (np.int64(25), np.int64(0), np.int64(90)): arr1 = 0.062500, arr2 = 0.056885, Diff = 0.005615

Threshold statistics:
[0.0e+00, 1.0e-06): 1705 (4.16%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 585 (1.43%)
[1.0e-04, 1.0e-03): 19197 (46.87%)
[1.0e-03, 1.0e-02): 19466 (47.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6154635aed7e6bcb04bffd5104a6bb5f
triton_output_md5=96c1f4fa81c555f8633767da4541ed32
diff.abs.max=0.00048828125
max_diff_thr=0.0004678362456616014

Top differences:
Position (np.int64(161), np.int64(2), np.int64(125)): arr1 = 0.067383, arr2 = 0.067871, Diff = 0.000488
Position (np.int64(72), np.int64(3), np.int64(44)): arr1 = -0.090332, arr2 = -0.089844, Diff = 0.000488
Position (np.int64(10), np.int64(2), np.int64(95)): arr1 = -0.074219, arr2 = -0.074707, Diff = 0.000488
Position (np.int64(37), np.int64(0), np.int64(63)): arr1 = 0.062500, arr2 = 0.062988, Diff = 0.000488
Position (np.int64(195), np.int64(1), np.int64(28)): arr1 = -0.080566, arr2 = -0.081055, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 81845 (49.95%)
[1.0e-06, 1.0e-05): 1151 (0.70%)
[1.0e-05, 1.0e-04): 44914 (27.41%)
[1.0e-04, 1.0e-03): 35930 (21.93%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00537109375
max_diff_thr=0.005122235044836998

Top differences:
Position (np.int64(184), np.int64(4), np.int64(35)): arr1 = -0.053955, arr2 = -0.048584, Diff = 0.005371
Position (np.int64(222), np.int64(4), np.int64(89)): arr1 = -0.087402, arr2 = -0.082520, Diff = 0.004883
Position (np.int64(175), np.int64(4), np.int64(68)): arr1 = 0.122070, arr2 = 0.117188, Diff = 0.004883
Position (np.int64(159), np.int64(1), np.int64(127)): arr1 = 0.065918, arr2 = 0.061279, Diff = 0.004639
Position (np.int64(48), np.int64(4), np.int64(114)): arr1 = 0.048340, arr2 = 0.043701, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 6602 (4.03%)
[1.0e-06, 1.0e-05): 61 (0.04%)
[1.0e-05, 1.0e-04): 4297 (2.62%)
[1.0e-04, 1.0e-03): 96103 (58.66%)
[1.0e-03, 1.0e-02): 56777 (34.65%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d1191a74ded2f90c145fe57894638989
triton_output_md5=a6dcf07c3d414c50c2ea1f966749cf6e
diff.abs.max=0.00048828125
max_diff_thr=0.000462000461993739

Top differences:
Position (np.int64(3), np.int64(1), np.int64(39)): arr1 = -0.078125, arr2 = -0.078613, Diff = 0.000488
Position (np.int64(50), np.int64(1), np.int64(18)): arr1 = -0.100586, arr2 = -0.101074, Diff = 0.000488
Position (np.int64(21), np.int64(3), np.int64(45)): arr1 = -0.066895, arr2 = -0.067383, Diff = 0.000488
Position (np.int64(36), np.int64(0), np.int64(72)): arr1 = -0.075684, arr2 = -0.075195, Diff = 0.000488
Position (np.int64(11), np.int64(0), np.int64(75)): arr1 = -0.062988, arr2 = -0.063477, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 20607 (50.31%)
[1.0e-06, 1.0e-05): 267 (0.65%)
[1.0e-05, 1.0e-04): 10916 (26.65%)
[1.0e-04, 1.0e-03): 9170 (22.39%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.004608154296875
max_diff_thr=0.004576173610985279

Top differences:
Position (np.int64(6), np.int64(4), np.int64(120)): arr1 = 0.011597, arr2 = 0.006989, Diff = 0.004608
Position (np.int64(8), np.int64(0), np.int64(43)): arr1 = 0.062988, arr2 = 0.058594, Diff = 0.004395
Position (np.int64(2), np.int64(3), np.int64(39)): arr1 = -0.079102, arr2 = -0.074707, Diff = 0.004395
Position (np.int64(35), np.int64(0), np.int64(62)): arr1 = -0.034180, arr2 = -0.029785, Diff = 0.004395
Position (np.int64(14), np.int64(4), np.int64(54)): arr1 = -0.053223, arr2 = -0.049072, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1705 (4.16%)
[1.0e-06, 1.0e-05): 14 (0.03%)
[1.0e-05, 1.0e-04): 1025 (2.50%)
[1.0e-04, 1.0e-03): 24069 (58.76%)
[1.0e-03, 1.0e-02): 14147 (34.54%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0497de248f0389f2f1c76866bdf2cc7a
triton_output_md5=9a5459d470ec6ff7f2b4aa695061a1f4
diff.abs.max=0.00048828125
max_diff_thr=0.00046533270506188273

Top differences:
Position (np.int64(217), np.int64(1), np.int64(22)): arr1 = -0.068359, arr2 = -0.067871, Diff = 0.000488
Position (np.int64(131), np.int64(2), np.int64(63)): arr1 = 0.080566, arr2 = 0.081055, Diff = 0.000488
Position (np.int64(88), np.int64(2), np.int64(25)): arr1 = -0.065430, arr2 = -0.065918, Diff = 0.000488
Position (np.int64(47), np.int64(4), np.int64(14)): arr1 = 0.070801, arr2 = 0.071289, Diff = 0.000488
Position (np.int64(31), np.int64(1), np.int64(98)): arr1 = 0.084473, arr2 = 0.084961, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 81720 (49.88%)
[1.0e-06, 1.0e-05): 1145 (0.70%)
[1.0e-05, 1.0e-04): 44801 (27.34%)
[1.0e-04, 1.0e-03): 36174 (22.08%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:[aiter INFO] 2025-09-30 05:13:11.429 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.8556332092474 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 1091, 1156, 1221, 38, 103, 1065, 12, 1169, 51, 1208, 25, 90, 1247}
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.87900000000002
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.95900000000074
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.63900000000103
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.35900000000038
[aiter INFO] 2025-09-30 05:13:11.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.75999999999999
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.91899999999987
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.55899999999929
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.99900000000002
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.63999999999942
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.87900000000002
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.20000000000073
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.839
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.95899999999995
[aiter INFO] 2025-09-30 05:13:11.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.16000000000167
[aiter INFO] 2025-09-30 05:13:11.493 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 87.0            0.0          8,264.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             95.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:11.523 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.12414853584649 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:11.763 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {461, 13, 6}
[aiter INFO] 2025-09-30 05:13:11.764 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000142
[aiter INFO] 2025-09-30 05:13:11.764 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.360000000000014
[aiter INFO] 2025-09-30 05:13:11.764 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999985
[aiter INFO] 2025-09-30 05:13:11.776 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            663.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:11.777 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   101.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:11.782 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:11.844 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.6676732602686 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:11.903 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 100, 9, 42, 75, 12, 45, 78, 141, 144, 174, 177, 86, 119, 88, 122}
[aiter INFO] 2025-09-30 05:13:11.903 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.679000000000087
[aiter INFO] 2025-09-30 05:13:11.903 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999842
[aiter INFO] 2025-09-30 05:13:11.903 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71999999999997
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.438999999999965
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.27900000000011
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000005
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.759000000000015
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.679000000000087
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000005
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:11.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999842
[aiter INFO] 2025-09-30 05:13:11.923 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            397.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          1,872.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,451.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           24.5             24.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:11.924 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.41 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:12.014 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 132.36316876246198 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.072 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:12.072 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.03899999999999
[aiter INFO] 2025-09-30 05:13:12.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          3,945.1        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             39.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.112 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.846524817223596 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.150 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:12.150 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.039000000000016
[aiter INFO] 2025-09-30 05:13:12.162 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            431.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.164 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    43.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:12.165 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:12.305 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 249.87643529282937 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {870, 9, 883, 1076, 1077, 22}
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.59999999999854
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.48000000000002
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000306
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 156.35900000000038
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.359000000000378
[aiter INFO] 2025-09-30 05:13:12.364 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.038999999999987
[aiter INFO] 2025-09-30 05:13:12.383 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            930.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0         15,397.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       16,660.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          166.6            166.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.384 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   166.61 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:12.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 570.2101198753508 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.707 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1262, 1242, 61, 1278}
[aiter INFO] 2025-09-30 05:13:12.708 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 479.68
[aiter INFO] 2025-09-30 05:13:12.708 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 477.72000000000116
[aiter INFO] 2025-09-30 05:13:12.708 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 477.72099999999955
[aiter INFO] 2025-09-30 05:13:12.708 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 474.28099999999995
[aiter INFO] 2025-09-30 05:13:12.708 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 477.6800000000003
[aiter INFO] 2025-09-30 05:13:12.718 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 96.0            0.0         45,733.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            476.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.749 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.5641286656408 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.784 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {307, 6}
[aiter INFO] 2025-09-30 05:13:12.784 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.278999999999996
[aiter INFO] 2025-09-30 05:13:12.784 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-30 05:13:12.796 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,046.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.797 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   486.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:12.802 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:12.867 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.24481181224974 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 86, 27, 93, 31}
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000065
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.19900000000001
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.31899999999996
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.999000000000024
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.83899999999994
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.1189999999999145
[aiter INFO] 2025-09-30 05:13:12.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.958999999999946
[aiter INFO] 2025-09-30 05:13:12.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            403.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,643.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,269.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           52.7             52.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:12.942 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    52.58 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:13.039 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.85696015381575 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 76, 12, 55, 89, 25}
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.88
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.76
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.47899999999998
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.159
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.07899999999995
[aiter INFO] 2025-09-30 05:13:13.101 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.19899999999996
[aiter INFO] 2025-09-30 05:13:13.114 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 95.0            0.0         12,343.7        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            129.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:13.141 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.98869310570235 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:13.179 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 13, 6}
[aiter INFO] 2025-09-30 05:13:13.179 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000524
[aiter INFO] 2025-09-30 05:13:13.179 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-30 05:13:13.179 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000004
[aiter INFO] 2025-09-30 05:13:13.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            552.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:13.193 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   135.57 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:13.195 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:13.335 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 263.76318961086844 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:13.394 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 204, 221, 22}
[aiter INFO] 2025-09-30 05:13:13.395 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.07999999999998
[aiter INFO] 2025-09-30 05:13:13.395 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.23900000000003
[aiter INFO] 2025-09-30 05:13:13.395 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.31899999999996
[aiter INFO] 2025-09-30 05:13:13.395 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-30 05:13:13.414 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,130.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0         16,569.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       17,877.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          178.8            178.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:13.414 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   178.79 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:13.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 602.5032778777698 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:13.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1271}
[aiter INFO] 2025-09-30 05:13:13.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 515.361
[aiter INFO] 2025-09-30 05:13:13.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 510.96099999999933
[aiter INFO] 2025-09-30 05:13:13.926 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         50,727.6        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            512.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:13.956 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.54194072390547 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:13.992 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:13.992 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.158999999999992
[aiter INFO] 2025-09-30 05:13:14.004 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,283.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             12.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   525.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00537109375
max_diff_thr=0.005041246768087149

Top differences:
Position (np.int64(173), np.int64(0), np.int64(30)): arr1 = -0.070801, arr2 = -0.065430, Diff = 0.005371
Position (np.int64(206), np.int64(1), np.int64(64)): arr1 = -0.044189, arr2 = -0.039062, Diff = 0.005127
Position (np.int64(117), np.int64(1), np.int64(32)): arr1 = 0.051270, arr2 = 0.046387, Diff = 0.004883
Position (np.int64(221), np.int64(0), np.int64(2)): arr1 = 0.001060, arr2 = 0.005707, Diff = 0.004646
Position (np.int64(120), np.int64(1), np.int64(8)): arr1 = 0.051025, arr2 = 0.046387, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 6489 (3.96%)
[1.0e-06, 1.0e-05): 67 (0.04%)
[1.0e-05, 1.0e-04): 4262 (2.60%)
[1.0e-04, 1.0e-03): 96745 (59.05%)
[1.0e-03, 1.0e-02): 56277 (34.35%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a095abd2e58a047a4cf498d923ce7b13
triton_output_md5=5693ca362a6c47cd01aaa65719c6fea1
diff.abs.max=0.00048828125
max_diff_thr=0.00046490004751831293

Top differences:
Position (np.int64(40), np.int64(0), np.int64(3)): arr1 = -0.068359, arr2 = -0.067871, Diff = 0.000488
Position (np.int64(37), np.int64(4), np.int64(108)): arr1 = 0.064941, arr2 = 0.065430, Diff = 0.000488
Position (np.int64(29), np.int64(3), np.int64(37)): arr1 = -0.065430, arr2 = -0.065918, Diff = 0.000488
Position (np.int64(27), np.int64(1), np.int64(21)): arr1 = -0.071777, arr2 = -0.071289, Diff = 0.000488
Position (np.int64(19), np.int64(4), np.int64(14)): arr1 = 0.075195, arr2 = 0.075684, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 20408 (49.82%)
[1.0e-06, 1.0e-05): 266 (0.65%)
[1.0e-05, 1.0e-04): 11239 (27.44%)
[1.0e-04, 1.0e-03): 9047 (22.09%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.004638671875
max_diff_thr=0.004423748701810837

Top differences:
Position (np.int64(6), np.int64(4), np.int64(5)): arr1 = 0.053223, arr2 = 0.048584, Diff = 0.004639
Position (np.int64(34), np.int64(4), np.int64(18)): arr1 = 0.055176, arr2 = 0.050781, Diff = 0.004395
Position (np.int64(28), np.int64(2), np.int64(77)): arr1 = -0.042725, arr2 = -0.038330, Diff = 0.004395
Position (np.int64(20), np.int64(3), np.int64(45)): arr1 = -0.076660, arr2 = -0.072266, Diff = 0.004395
Position (np.int64(27), np.int64(0), np.int64(93)): arr1 = 0.080566, arr2 = 0.076172, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 1702 (4.16%)
[1.0e-06, 1.0e-05): 15 (0.04%)
[1.0e-05, 1.0e-04): 1088 (2.66%)
[1.0e-04, 1.0e-03): 24047 (58.71%)
[1.0e-03, 1.0e-02): 14108 (34.44%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f5942181d1c816953b3ce3d8c07e5b61
triton_output_md5=d8ef0af98aa5fe6a3eb44bfe5aacb7de
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(201), np.int64(4), np.int64(1)): arr1 = -0.032471, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(255), np.int64(1), np.int64(121)): arr1 = -0.033203, arr2 = -0.033447, Diff = 0.000244
Position (np.int64(243), np.int64(2), np.int64(51)): arr1 = 0.034180, arr2 = 0.034424, Diff = 0.000244
Position (np.int64(50), np.int64(4), np.int64(77)): arr1 = -0.033691, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(125), np.int64(3), np.int64(29)): arr1 = -0.036865, arr2 = -0.037109, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 81187 (49.55%)
[1.0e-06, 1.0e-05): 7164 (4.37%)
[1.0e-05, 1.0e-04): 72743 (44.40%)
[1.0e-04, 1.0e-03): 2746 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00201416015625
max_diff_thr=0.0019931145943701267

Top differences:
Position (np.int64(97), np.int64(4), np.int64(38)): arr1 = 0.015869, arr2 = 0.013855, Diff = 0.002014
Position (np.int64(215), np.int64(4), np.int64(41)): arr1 = 0.012573, arr2 = 0.010559, Diff = 0.002014
Position (np.int64(112), np.int64(2), np.int64(91)): arr1 = -0.011169, arr2 = -0.009399, Diff = 0.001770
Position (np.int64(92), np.int64(1), np.int64(98)): arr1 = 0.022827, arr2 = 0.021118, Diff = 0.001709
Position (np.int64(249), np.int64(4), np.int64(22)): arr1 = 0.034912, arr2 = 0.033203, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 6785 (4.14%)
[1.0e-06, 1.0e-05): 445 (0.27%)
[1.0e-05, 1.0e-04): 24656 (15.05%)
[1.0e-04, 1.0e-03): 130401 (79.59%)
[1.0e-03, 1.0e-02): 1553 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=71cd5c07147b3e470197b90d93486f2a
triton_output_md5=d4b07915c3ffba4c68b7be8bf2ce074e
diff.abs.max=0.000244140625
max_diff_thr=0.00023646252520848066

Top differences:
Position (np.int64(3), np.int64(4), np.int64(65)): arr1 = -0.041016, arr2 = -0.040771, Diff = 0.000244
Position (np.int64(53), np.int64(4), np.int64(55)): arr1 = 0.034668, arr2 = 0.034912, Diff = 0.000244
Position (np.int64(44), np.int64(3), np.int64(22)): arr1 = -0.032715, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(53), np.int64(0), np.int64(44)): arr1 = -0.037598, arr2 = -0.037842, Diff = 0.000244
Position (np.int64(52), np.int64(1), np.int64(55)): arr1 = 0.036865, arr2 = 0.037109, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 20267 (49.48%)
[1.0e-06, 1.0e-05): 1718 (4.19%)
[1.0e-05, 1.0e-04): 18257 (44.57%)
[1.0e-04, 1.0e-03): 718 (1.75%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0018310546875
max_diff_thr=0.001802018261514604

Top differences:
Position (np.int64(53), np.int64(1), np.int64(9)): arr1 = 0.017944, arr2 = 0.016113, Diff = 0.001831
Position (np.int64(54), np.int64(2), np.int64(79)): arr1 = 0.008545, arr2 = 0.006927, Diff = 0.001617
Position (np.int64(50), np.int64(4), np.int64(113)): arr1 = 0.014832, arr2 = 0.013245, Diff = 0.001587
Position (np.int64(45), np.int64(3), np.int64(120)): arr1 = -0.008301, arr2 = -0.009888, Diff = 0.001587
Position (np.int64(48), np.int64(0), np.int64(119)): arr1 = 0.014221, arr2 = 0.012695, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 1678 (4.10%)
[1.0e-06, 1.0e-05): 110 (0.27%)
[1.0e-05, 1.0e-04): 6099 (14.89%)
[1.0e-04, 1.0e-03): 32661 (79.74%)
[1.0e-03, 1.0e-02): 412 (1.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b037ae7bb9c578ccd9fce1998249c717
triton_output_md5=6d28ef04940dc5c60355b743808fa43b
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(182), np.int64(4), np.int64(33)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(228), np.int64(1), np.int64(47)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(127), np.int64(1), np.int64(29)): arr1 = 0.031738, arr2 = 0.031494, Diff = 0.000244
Position (np.int64(183), np.int64(4), np.int64(33)): arr1 = -0.034180, arr2 = -0.034424, Diff = 0.000244
Position (np.int64(19), np.int64(3), np.int64(94)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 81527 (49.76%)
[1.0e-06, 1.0e-05): 7166 (4.37%)
[1.0e-05, 1.0e-04): 72442 (44.22%)
[1.0e-04, 1.0e-03): 2705 (1.65%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.001708984375
max_diff_thr=0.0016851227264851332[aiter INFO] 2025-09-30 05:13:14.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:14.075 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.06022736223616 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.95900000000006
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.55899999999997
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.358999999999924
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.63900000000001
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.79900000000009
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-30 05:13:14.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.639999999999986
[aiter INFO] 2025-09-30 05:13:14.152 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            460.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,687.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,373.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           53.7             53.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.153 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    53.63 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:14.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 228.11002911317465 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 102, 838, 76, 12, 51, 89, 1306, 25}
[aiter INFO] 2025-09-30 05:13:14.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.07900000000006
[aiter INFO] 2025-09-30 05:13:14.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.31899999999996
[aiter INFO] 2025-09-30 05:13:14.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.95900000000074
[aiter INFO] 2025-09-30 05:13:14.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.31899999999996
[aiter INFO] 2025-09-30 05:13:14.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.67900000000003
[aiter INFO] 2025-09-30 05:13:14.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.84000000000003
[aiter INFO] 2025-09-30 05:13:14.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.84000000000015
[aiter INFO] 2025-09-30 05:13:14.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.07999999999993
[aiter INFO] 2025-09-30 05:13:14.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.64
[aiter INFO] 2025-09-30 05:13:14.331 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 92.0            0.0         12,005.5        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            130.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.359 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.71421796024436 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.398 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-30 05:13:14.398 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519000000000233
[aiter INFO] 2025-09-30 05:13:14.398 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-30 05:13:14.410 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            692.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.412 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   137.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:14.414 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:14.539 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.0063065579622 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.593 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 135, 9, 12, 143, 146, 154, 157, 33, 418, 35, 421, 44, 47, 176, 179, 55, 58, 66, 69, 77, 80, 88, 91, 99, 102, 110, 113}
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.838999999999942
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.559000000000026
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000021
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.878999999999905
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.479000000000042
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.438999999999396
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.07899999999995
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.319000000000415
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.08000000000004
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999955
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.55899999999974
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.159000000000106
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:14.594 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.91899999999987
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.038999999999987
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.07899999999995
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.759000000000015
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.038999999999987
[aiter INFO] 2025-09-30 05:13:14.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:14.617 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  87.0            0.0          1,061.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  87.0            0.0          1,786.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,291.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           32.9             32.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.618 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:14.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.46143527314214 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:14.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.44
[aiter INFO] 2025-09-30 05:13:14.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,063.3        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.906 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.3752475236312 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:14.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {377, 13, 6}
[aiter INFO] 2025-09-30 05:13:14.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999851
[aiter INFO] 2025-09-30 05:13:14.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 05:13:14.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.758999999999986
[aiter INFO] 2025-09-30 05:13:14.953 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            487.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:14.954 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:14.961 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:15.022 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.35045557033897 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:15.079 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:15.079 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-09-30 05:13:15.079 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-30 05:13:15.098 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            450.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,366.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,817.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.2             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:15.099 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:15.186 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.1793463702249 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:15.244 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:15.244 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.039000000000016
[aiter INFO] 2025-09-30 05:13:15.256 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,146.9        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:15.283 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.70236622372476 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:15.321 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {202, 181, 230, 6}
[aiter INFO] 2025-09-30 05:13:15.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.8789999999999054
[aiter INFO] 2025-09-30 05:13:15.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.7189999999998236
[aiter INFO] 2025-09-30 05:13:15.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.838999999999942
[aiter INFO] 2025-09-30 05:13:15.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-30 05:13:15.334 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            320.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:15.335 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:15.337 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:15.461 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.39997059815 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:15.697 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 12, 141, 144, 20, 21, 152, 155, 31, 32, 163, 166, 42, 45, 53, 56, 64, 67, 75, 78, 86, 89, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:15.697 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999833
[aiter INFO] 2025-09-30 05:13:15.697 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000115
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.63900000000001
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.59899999999999
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.358999999999924
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.799000000000035
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.59899999999999
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999805
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839999999999918
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.358999999999924
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999878
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999946
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.759000000000015
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999919
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.55899999999997
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000078
[aiter INFO] 2025-09-30 05:13:15.698 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.479000000000042
[aiter INFO] 2025-09-30 05:13:15.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:15.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.878999999999905
[aiter INFO] 2025-09-30 05:13:15.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.159000000000106
[aiter INFO] 2025-09-30 05:13:15.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.878999999999905
[aiter INFO] 2025-09-30 05:13:15.699 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-30 05:13:15.717 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  87.0            0.0          1,070.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  87.0            0.0          1,777.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,293.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           32.9             32.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:15.718 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:15.904 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.28238639146974 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:15.957 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:15.957 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.87900000000002
[aiter INFO] 2025-09-30 05:13:15.970 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,062.8        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:15.998 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.98472279664313 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.033 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {468, 6}
[aiter INFO] 2025-09-30 05:13:16.033 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-30 05:13:16.034 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.758999999999986
[aiter INFO] 2025-09-30 05:13:16.046 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            491.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.047 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Top differences:
Position (np.int64(57), np.int64(4), np.int64(64)): arr1 = 0.015869, arr2 = 0.014160, Diff = 0.001709
Position (np.int64(135), np.int64(3), np.int64(116)): arr1 = 0.007996, arr2 = 0.006317, Diff = 0.001678
Position (np.int64(161), np.int64(4), np.int64(29)): arr1 = 0.009521, arr2 = 0.007874, Diff = 0.001648
Position (np.int64(248), np.int64(3), np.int64(51)): arr1 = 0.001343, arr2 = 0.002960, Diff = 0.001617
Position (np.int64(132), np.int64(3), np.int64(112)): arr1 = 0.005371, arr2 = 0.003754, Diff = 0.001617

Threshold statistics:
[0.0e+00, 1.0e-06): 6810 (4.16%)
[1.0e-06, 1.0e-05): 498 (0.30%)
[1.0e-05, 1.0e-04): 25355 (15.48%)
[1.0e-04, 1.0e-03): 129584 (79.09%)
[1.0e-03, 1.0e-02): 1593 (0.97%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b94e55a4ae5cb4999af7eba351f82f66
triton_output_md5=679eff4971d4f80f2b13c6ed370a67ea
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(31), np.int64(3), np.int64(32)): arr1 = -0.031738, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(22), np.int64(3), np.int64(31)): arr1 = -0.032471, arr2 = -0.032715, Diff = 0.000244
Position (np.int64(28), np.int64(1), np.int64(85)): arr1 = -0.031738, arr2 = -0.031982, Diff = 0.000244
Position (np.int64(23), np.int64(4), np.int64(31)): arr1 = -0.032715, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(30), np.int64(4), np.int64(32)): arr1 = -0.033936, arr2 = -0.033691, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 20356 (49.70%)
[1.0e-06, 1.0e-05): 1797 (4.39%)
[1.0e-05, 1.0e-04): 18114 (44.22%)
[1.0e-04, 1.0e-03): 693 (1.69%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00152587890625
max_diff_thr=0.0015189815312623978

Top differences:
Position (np.int64(34), np.int64(3), np.int64(60)): arr1 = 0.006958, arr2 = 0.005432, Diff = 0.001526
Position (np.int64(56), np.int64(3), np.int64(22)): arr1 = -0.000507, arr2 = -0.002029, Diff = 0.001522
Position (np.int64(6), np.int64(1), np.int64(66)): arr1 = -0.004547, arr2 = -0.003067, Diff = 0.001480
Position (np.int64(4), np.int64(2), np.int64(100)): arr1 = -0.017700, arr2 = -0.016235, Diff = 0.001465
Position (np.int64(4), np.int64(1), np.int64(5)): arr1 = -0.029053, arr2 = -0.027588, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1731 (4.23%)
[1.0e-06, 1.0e-05): 129 (0.31%)
[1.0e-05, 1.0e-04): 6110 (14.92%)
[1.0e-04, 1.0e-03): 32593 (79.57%)
[1.0e-03, 1.0e-02): 397 (0.97%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ac8e5ff26ef71dfb10ac6d50919218d1
triton_output_md5=72253e8108a6885488dd65672c2ef2e2
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(12), np.int64(5), np.int64(127)): arr1 = -0.679688, arr2 = -0.675781, Diff = 0.003906
Position (np.int64(139), np.int64(4), np.int64(122)): arr1 = -0.566406, arr2 = -0.570312, Diff = 0.003906
Position (np.int64(194), np.int64(6), np.int64(85)): arr1 = 0.527344, arr2 = 0.523438, Diff = 0.003906
Position (np.int64(25), np.int64(2), np.int64(18)): arr1 = 0.585938, arr2 = 0.589844, Diff = 0.003906
Position (np.int64(114), np.int64(6), np.int64(107)): arr1 = 0.625000, arr2 = 0.628906, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 154472 (58.93%)
[1.0e-06, 1.0e-05): 33 (0.01%)
[1.0e-05, 1.0e-04): 2343 (0.89%)
[1.0e-04, 1.0e-03): 91873 (35.05%)
[1.0e-03, 1.0e-02): 13423 (5.12%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.046875
max_diff_thr=0.03937676176428795

Top differences:
Position (np.int64(147), np.int64(5), np.int64(81)): arr1 = -0.318359, arr2 = -0.271484, Diff = 0.046875
Position (np.int64(147), np.int64(5), np.int64(66)): arr1 = -0.046387, arr2 = -0.006744, Diff = 0.039642
Position (np.int64(208), np.int64(3), np.int64(60)): arr1 = 0.322266, arr2 = 0.283203, Diff = 0.039062
Position (np.int64(150), np.int64(1), np.int64(2)): arr1 = -0.201172, arr2 = -0.164062, Diff = 0.037109
Position (np.int64(184), np.int64(6), np.int64(110)): arr1 = -0.101562, arr2 = -0.138672, Diff = 0.037109

Threshold statistics:
[0.0e+00, 1.0e-06): 11531 (4.40%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 119 (0.05%)
[1.0e-04, 1.0e-03): 17493 (6.67%)
[1.0e-03, 1.0e-02): 169771 (64.76%)
[1.0e-02, 1.0e-01): 63229 (24.12%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=924167f88e7d8727babde45a8ea2e0d5
triton_output_md5=0eff91b571fa7b6dddb8b42b371587a7
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(42), np.int64(1), np.int64(122)): arr1 = -0.507812, arr2 = -0.503906, Diff = 0.003906
Position (np.int64(7), np.int64(4), np.int64(84)): arr1 = -0.500000, arr2 = -0.503906, Diff = 0.003906
Position (np.int64(34), np.int64(4), np.int64(24)): arr1 = 0.625000, arr2 = 0.628906, Diff = 0.003906
Position (np.int64(24), np.int64(6), np.int64(69)): arr1 = 0.539062, arr2 = 0.535156, Diff = 0.003906
Position (np.int64(30), np.int64(3), np.int64(38)): arr1 = 0.535156, arr2 = 0.531250, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 38099 (58.13%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 582 (0.89%)
[1.0e-04, 1.0e-03): 23357 (35.64%)
[1.0e-03, 1.0e-02): 3492 (5.33%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.037811279296875
max_diff_thr=0.037601288408041

Top differences:
Position (np.int64(26), np.int64(5), np.int64(86)): arr1 = 0.032227, arr2 = -0.005585, Diff = 0.037811
Position (np.int64(28), np.int64(2), np.int64(6)): arr1 = -0.394531, arr2 = -0.361328, Diff = 0.033203
Position (np.int64(5), np.int64(0), np.int64(9)): arr1 = -0.328125, arr2 = -0.294922, Diff = 0.033203
Position (np.int64(12), np.int64(2), np.int64(3)): arr1 = 0.223633, arr2 = 0.191406, Diff = 0.032227
Position (np.int64(45), np.int64(7), np.int64(44)): arr1 = 0.566406, arr2 = 0.535156, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 2905 (4.43%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 25 (0.04%)
[1.0e-04, 1.0e-03): 4421 (6.75%)
[1.0e-03, 1.0e-02): 43119 (65.79%)
[1.0e-02, 1.0e-01): 15066 (22.99%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c5cfffa1594c8acf506737ef22bfe4a2
triton_output_md5=46fcd8e59821bf4fda88793e95497c99
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(232), np.int64(5), np.int64(109)): arr1 = -0.257812, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(75), np.int64(3), np.int64(45)): arr1 = 0.267578, arr2 = 0.265625, Diff = 0.001953
Position (np.int64(122), np.int64(7), np.int64(84)): arr1 = -0.269531, arr2 = -0.271484, Diff = 0.001953
Position (np.int64(146), np.int64(0), np.int64(77)): arr1 = -0.386719, arr2 = -0.384766, Diff = 0.001953
Position (np.int64(152), np.int64(7), np.int64(40)): arr1 = -0.287109, arr2 = -0.289062, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 151963 (57.97%)
[1.0e-06, 1.0e-05): 110 (0.04%)
[1.0e-05, 1.0e-04): 7866 (3.00%)
[1.0e-04, 1.0e-03): 101317 (38.65%)
[1.0e-03, 1.0e-02): 888 (0.34%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0234375
max_diff_thr=0.01929260417819023

Top differences:
Position (np.int64(214), np.int64(5), np.int64(97)): arr1 = 0.380859, arr2 = 0.357422, Diff = 0.023438
Position (np.int64(8), np.int64(0), np.int64(72)): arr1 = -0.416016, arr2 = -0.392578, Diff = 0.023438[aiter INFO] 2025-09-30 05:13:16.054 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:16.116 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.45460417306069 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 815}
[aiter INFO] 2025-09-30 05:13:16.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-30 05:13:16.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 05:13:16.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999998996
[aiter INFO] 2025-09-30 05:13:16.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.59900000000016
[aiter INFO] 2025-09-30 05:13:16.193 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            448.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,357.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,827.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.194 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.24 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:16.282 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.43958419384343 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.341 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:16.341 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.07899999999998
[aiter INFO] 2025-09-30 05:13:16.353 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,150.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.380 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.554207998337134 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.419 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:16.419 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-30 05:13:16.431 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            327.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.432 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:16.434 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:16.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.35005938003559 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 22, 152, 155, 31, 34, 42, 45, 53, 56, 64, 67, 75, 78, 86, 89, 97, 98, 108, 111}
[aiter INFO] 2025-09-30 05:13:16.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.560000000000173
[aiter INFO] 2025-09-30 05:13:16.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.398999999999887
[aiter INFO] 2025-09-30 05:13:16.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.52000000000004
[aiter INFO] 2025-09-30 05:13:16.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.87900000000002
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000021
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.919000000000096
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319000000000074
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999992
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.918999999999983
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.598999999999933
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.759000000000015
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.438999999999965
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.999000000000024
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000078
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.83900000000017
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.43899999999985
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.07899999999995
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.55899999999997
[aiter INFO] 2025-09-30 05:13:16.615 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000151
[aiter INFO] 2025-09-30 05:13:16.634 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0          1,088.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          1,827.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,294.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           32.9             32.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.635 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:16.818 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.74735631565056 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.870 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {649, 12}
[aiter INFO] 2025-09-30 05:13:16.870 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.399999999999636
[aiter INFO] 2025-09-30 05:13:16.870 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.959
[aiter INFO] 2025-09-30 05:13:16.883 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          4,025.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.910 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.16016833292375 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:16.945 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 6}
[aiter INFO] 2025-09-30 05:13:16.945 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 05:13:16.945 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.63900000000001
[aiter INFO] 2025-09-30 05:13:16.957 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            492.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:16.959 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:16.966 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:17.028 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.99877241460405 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:17.084 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 152, 153, 350, 351}
[aiter INFO] 2025-09-30 05:13:17.084 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-09-30 05:13:17.084 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:17.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.67899999999986
[aiter INFO] 2025-09-30 05:13:17.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999969
[aiter INFO] 2025-09-30 05:13:17.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:17.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-30 05:13:17.103 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            440.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,348.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,827.4              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:17.105 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:17.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.56476239638754 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:17.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:17.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839
[aiter INFO] 2025-09-30 05:13:17.458 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,149.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:17.487 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.53285168362136 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:17.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {181, 6}
[aiter INFO] 2025-09-30 05:13:17.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.798999999999978
[aiter INFO] 2025-09-30 05:13:17.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-30 05:13:17.538 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            326.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:17.539 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:17.542 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:17.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.40630698499113 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:17.723 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 21, 152, 155, 31, 34, 42, 45, 53, 56, 64, 67, 75, 78, 86, 89, 97, 100, 108, 109, 119, 122}
[aiter INFO] 2025-09-30 05:13:17.723 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.160000000000082
[aiter INFO] 2025-09-30 05:13:17.723 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319999999999993
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.31899999999996
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000006
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.31899999999996
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.478999999999928
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999946
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000037
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999878
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.07899999999995
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.91899999999987
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:17.724 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.479000000000042
[aiter INFO] 2025-09-30 05:13:17.725 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-09-30 05:13:17.725 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-30 05:13:17.725 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:17.743 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  88.0            0.0          1,080.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  88.0            0.0          1,809.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,305.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           33.1             32.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:17.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:17.929 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.8182274268405 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:17.982 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1195, 12}
[aiter INFO] 2025-09-30 05:13:17.982 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.55999999999949
[aiter INFO] 2025-09-30 05:13:17.983 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.87900000000002
[aiter INFO] 2025-09-30 05:13:17.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          4,021.9        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.023 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.52293082983187 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.058 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:18.058 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999982
[aiter INFO] 2025-09-30 05:13:18.071 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            495.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.072 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(159), np.int64(5), np.int64(33)): arr1 = -0.423828, arr2 = -0.402344, Diff = 0.021484
Position (np.int64(183), np.int64(1), np.int64(46)): arr1 = -0.145508, arr2 = -0.124023, Diff = 0.021484
Position (np.int64(18), np.int64(0), np.int64(118)): arr1 = -0.083496, arr2 = -0.062988, Diff = 0.020508

Threshold statistics:
[0.0e+00, 1.0e-06): 10865 (4.14%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 350 (0.13%)
[1.0e-04, 1.0e-03): 41230 (15.73%)
[1.0e-03, 1.0e-02): 200776 (76.59%)
[1.0e-02, 1.0e-01): 8921 (3.40%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a6d5217b310bc150821ada4828062cce
triton_output_md5=d42cc86d455cf0b9dce615d7891e87fb
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(59), np.int64(1), np.int64(54)): arr1 = -0.275391, arr2 = -0.273438, Diff = 0.001953
Position (np.int64(23), np.int64(2), np.int64(101)): arr1 = -0.291016, arr2 = -0.289062, Diff = 0.001953
Position (np.int64(34), np.int64(7), np.int64(44)): arr1 = 0.257812, arr2 = 0.259766, Diff = 0.001953
Position (np.int64(40), np.int64(4), np.int64(29)): arr1 = -0.291016, arr2 = -0.289062, Diff = 0.001953
Position (np.int64(11), np.int64(7), np.int64(105)): arr1 = 0.279297, arr2 = 0.277344, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 38011 (58.00%)
[1.0e-06, 1.0e-05): 32 (0.05%)
[1.0e-05, 1.0e-04): 1859 (2.84%)
[1.0e-04, 1.0e-03): 25419 (38.79%)
[1.0e-03, 1.0e-02): 215 (0.33%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.021484375
max_diff_thr=0.0181818176060915

Top differences:
Position (np.int64(34), np.int64(5), np.int64(103)): arr1 = -0.222656, arr2 = -0.201172, Diff = 0.021484
Position (np.int64(39), np.int64(3), np.int64(48)): arr1 = -0.249023, arr2 = -0.229492, Diff = 0.019531
Position (np.int64(42), np.int64(2), np.int64(82)): arr1 = -0.180664, arr2 = -0.161133, Diff = 0.019531
Position (np.int64(41), np.int64(7), np.int64(99)): arr1 = 0.199219, arr2 = 0.179688, Diff = 0.019531
Position (np.int64(47), np.int64(3), np.int64(21)): arr1 = -0.433594, arr2 = -0.414062, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 2742 (4.18%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 85 (0.13%)
[1.0e-04, 1.0e-03): 10170 (15.52%)
[1.0e-03, 1.0e-02): 50278 (76.72%)
[1.0e-02, 1.0e-01): 2258 (3.45%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b7eef2ab160416d6f5dbff34c7e977e4
triton_output_md5=3b024a132dd284e32eb1db8f776e5f9c
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(150), np.int64(6), np.int64(127)): arr1 = -0.257812, arr2 = -0.255859, Diff = 0.001953
Position (np.int64(7), np.int64(7), np.int64(47)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953
Position (np.int64(247), np.int64(0), np.int64(3)): arr1 = -0.259766, arr2 = -0.257812, Diff = 0.001953
Position (np.int64(20), np.int64(2), np.int64(116)): arr1 = -0.287109, arr2 = -0.285156, Diff = 0.001953
Position (np.int64(213), np.int64(1), np.int64(20)): arr1 = 0.294922, arr2 = 0.292969, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 150350 (57.35%)
[1.0e-06, 1.0e-05): 241 (0.09%)
[1.0e-05, 1.0e-04): 16296 (6.22%)
[1.0e-04, 1.0e-03): 95229 (36.33%)
[1.0e-03, 1.0e-02): 28 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0146484375
max_diff_thr=0.0133677301928401

Top differences:
Position (np.int64(60), np.int64(1), np.int64(55)): arr1 = 0.122559, arr2 = 0.107910, Diff = 0.014648
Position (np.int64(84), np.int64(6), np.int64(60)): arr1 = -0.098633, arr2 = -0.084473, Diff = 0.014160
Position (np.int64(214), np.int64(3), np.int64(42)): arr1 = -0.054932, arr2 = -0.041016, Diff = 0.013916
Position (np.int64(105), np.int64(6), np.int64(31)): arr1 = 0.163086, arr2 = 0.149414, Diff = 0.013672
Position (np.int64(19), np.int64(3), np.int64(91)): arr1 = 0.231445, arr2 = 0.217773, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 10980 (4.19%)
[1.0e-06, 1.0e-05): 18 (0.01%)
[1.0e-05, 1.0e-04): 797 (0.30%)
[1.0e-04, 1.0e-03): 61151 (23.33%)
[1.0e-03, 1.0e-02): 188647 (71.96%)
[1.0e-02, 1.0e-01): 551 (0.21%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=775e9e299d41b179dd9ea965369807da
triton_output_md5=3eba96c2277fc7e0493bdf1b149eb236
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(60), np.int64(5), np.int64(28)): arr1 = -0.253906, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(46), np.int64(6), np.int64(11)): arr1 = 0.345703, arr2 = 0.347656, Diff = 0.001953
Position (np.int64(46), np.int64(0), np.int64(11)): arr1 = 0.322266, arr2 = 0.324219, Diff = 0.001953
Position (np.int64(9), np.int64(2), np.int64(1)): arr1 = 0.251953, arr2 = 0.253906, Diff = 0.001953
Position (np.int64(37), np.int64(5), np.int64(67)): arr1 = 0.261719, arr2 = 0.263672, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 37763 (57.62%)
[1.0e-06, 1.0e-05): 65 (0.10%)
[1.0e-05, 1.0e-04): 4010 (6.12%)
[1.0e-04, 1.0e-03): 23693 (36.15%)
[1.0e-03, 1.0e-02): 5 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0142822265625
max_diff_thr=0.013910355046391487

Top differences:
Position (np.int64(12), np.int64(1), np.int64(122)): arr1 = 0.041016, arr2 = 0.026733, Diff = 0.014282
Position (np.int64(28), np.int64(2), np.int64(44)): arr1 = -0.339844, arr2 = -0.326172, Diff = 0.013672
Position (np.int64(13), np.int64(5), np.int64(62)): arr1 = -0.275391, arr2 = -0.261719, Diff = 0.013672
Position (np.int64(31), np.int64(5), np.int64(107)): arr1 = 0.198242, arr2 = 0.184570, Diff = 0.013672
Position (np.int64(39), np.int64(4), np.int64(39)): arr1 = -0.104492, arr2 = -0.091309, Diff = 0.013184

Threshold statistics:
[0.0e+00, 1.0e-06): 2737 (4.18%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 201 (0.31%)
[1.0e-04, 1.0e-03): 15120 (23.07%)
[1.0e-03, 1.0e-02): 47336 (72.23%)
[1.0e-02, 1.0e-01): 139 (0.21%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=073e8e1c3680934f815d159b92109f7d
triton_output_md5=56a0e5ab3494de9150f7d84277a8981a
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(113), np.int64(4), np.int64(44)): arr1 = 0.267578, arr2 = 0.265625, Diff = 0.001953
Position (np.int64(48), np.int64(6), np.int64(0)): arr1 = -0.261719, arr2 = -0.259766, Diff = 0.001953
Position (np.int64(113), np.int64(2), np.int64(97)): arr1 = -0.253906, arr2 = -0.255859, Diff = 0.001953
Position (np.int64(139), np.int64(4), np.int64(105)): arr1 = 0.330078, arr2 = 0.332031, Diff = 0.001953
Position (np.int64(240), np.int64(1), np.int64(43)): arr1 = -0.292969, arr2 = -0.291016, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 151066 (57.63%)
[1.0e-06, 1.0e-05): 266 (0.10%)
[1.0e-05, 1.0e-04): 18377 (7.01%)
[1.0e-04, 1.0e-03): 92416 (35.25%)
[1.0e-03, 1.0e-02): 19 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.015625
max_diff_thr=0.013840830884873867

Top differences:
Position (np.int64(84), np.int64(2), np.int64(9)): arr1 = -0.144531, arr2 = -0.128906, Diff = 0.015625
Position (np.int64(17), np.int64(4), np.int64(106)): arr1 = 0.162109, arr2 = 0.148438, Diff = 0.013672
Position (np.int64(84), np.int64(7), np.int64(90)): arr1 = -0.108887, arr2 = -0.095215, Diff = 0.013672
Position (np.int64(146), np.int64(2), np.int64(85)): arr1 = -0.244141, arr2 = -0.230469, Diff = 0.013672[aiter INFO] 2025-09-30 05:13:18.079 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:18.141 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.36546517067616 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.199 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 815}
[aiter INFO] 2025-09-30 05:13:18.199 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-09-30 05:13:18.199 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 05:13:18.199 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.879000000000815
[aiter INFO] 2025-09-30 05:13:18.199 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.479000000001179
[aiter INFO] 2025-09-30 05:13:18.218 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            446.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,356.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,827.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.3             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.219 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:18.307 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.5382276330844 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.366 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:18.366 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.998999999999995
[aiter INFO] 2025-09-30 05:13:18.378 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,150.9        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.405 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.12572282139618 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.443 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:18.444 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-30 05:13:18.456 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            329.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.457 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:18.459 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:18.584 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.42888121144605 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.638 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 22, 152, 155, 31, 34, 163, 166, 42, 45, 53, 56, 185, 188, 64, 67, 75, 78, 86, 89, 218, 221, 97, 100, 229, 232, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:18.638 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000005
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.59899999999999
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.199000000000012
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.83900000000017
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319000000000074
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999992
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.479000000000042
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.67899999999986
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.038999999999987
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999955
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.159999999999968
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.119000000000028
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000005
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999955
[aiter INFO] 2025-09-30 05:13:18.639 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999992
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.838999999999942
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000078
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.159000000000106
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.078999999999724
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.83900000000017
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.679000000000087
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.518999999999778
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.759000000000015
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:18.640 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:18.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  84.0            0.0          1,027.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  84.0            0.0          1,718.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,293.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           32.9             32.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.660 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:18.844 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.48360428715696 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.895 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:18.895 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.84000000000003
[aiter INFO] 2025-09-30 05:13:18.907 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,056.2        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.935 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.77284141312732 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:18.969 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:18.969 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-30 05:13:18.982 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            497.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:18.983 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:18.990 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:19.051 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.50448504178831 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:19.295 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 130, 131}
[aiter INFO] 2025-09-30 05:13:19.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:19.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-09-30 05:13:19.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.19900000000007
[aiter INFO] 2025-09-30 05:13:19.296 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5190000000000055
[aiter INFO] 2025-09-30 05:13:19.315 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            445.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,348.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,813.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.1             18.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:19.316 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:19.405 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.13459442511643 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:19.465 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77}
[aiter INFO] 2025-09-30 05:13:19.465 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.039000000000016
[aiter INFO] 2025-09-30 05:13:19.465 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.079000000000065
[aiter INFO] 2025-09-30 05:13:19.477 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,123.9        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:19.505 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.8592179140242 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:19.543 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 6}
[aiter INFO] 2025-09-30 05:13:19.543 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.839000000000169
[aiter INFO] 2025-09-30 05:13:19.543 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-30 05:13:19.555 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            325.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:19.556 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:19.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:19.684 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.51759409432364 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 132, 9, 12, 20, 22, 31, 32, 42, 45, 53, 56, 64, 67, 75, 78, 86, 89, 97, 100, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.55899999999997
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000078
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000037
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:19.738 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000026
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999992
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999955
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.599000000000046
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000037
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.159000000000106
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.079999999999927
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.438999999999965
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000006
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.95900000000006
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319999999999936
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.878999999999905
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.878999999999905
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000115
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.439000000000078
[aiter INFO] 2025-09-30 05:13:19.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999915
[aiter INFO] 2025-09-30 05:13:19.758 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  89.0            0.0          1,092.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  89.0            0.0          1,822.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,292.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           32.9             32.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:19.759 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:19.943 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 142.90619781701872 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:19.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:19.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.920000000000016
[aiter INFO] 2025-09-30 05:13:20.007 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,063.0        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.035 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.477396161839515 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 251, 6}
[aiter INFO] 2025-09-30 05:13:20.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:20.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999851
[aiter INFO] 2025-09-30 05:13:20.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999982
[aiter INFO] 2025-09-30 05:13:20.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            487.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(236), np.int64(1), np.int64(87)): arr1 = 0.063477, arr2 = 0.050537, Diff = 0.012939

Threshold statistics:
[0.0e+00, 1.0e-06): 10706 (4.08%)
[1.0e-06, 1.0e-05): 20 (0.01%)
[1.0e-05, 1.0e-04): 1009 (0.38%)
[1.0e-04, 1.0e-03): 65088 (24.83%)
[1.0e-03, 1.0e-02): 185081 (70.60%)
[1.0e-02, 1.0e-01): 240 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8f9baa877717996e53bd38242ff9410d
triton_output_md5=0b4db08873e8c9bdde41f0693373baaa
diff.abs.max=0.001953125
max_diff_thr=0.0015552099794149399

Top differences:
Position (np.int64(50), np.int64(4), np.int64(82)): arr1 = -0.296875, arr2 = -0.294922, Diff = 0.001953
Position (np.int64(15), np.int64(5), np.int64(13)): arr1 = -0.277344, arr2 = -0.279297, Diff = 0.001953
Position (np.int64(28), np.int64(3), np.int64(10)): arr1 = 0.259766, arr2 = 0.261719, Diff = 0.001953
Position (np.int64(45), np.int64(7), np.int64(46)): arr1 = -0.281250, arr2 = -0.279297, Diff = 0.001953
Position (np.int64(53), np.int64(6), np.int64(71)): arr1 = -0.253906, arr2 = -0.255859, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 37469 (57.17%)
[1.0e-06, 1.0e-05): 69 (0.11%)
[1.0e-05, 1.0e-04): 4721 (7.20%)
[1.0e-04, 1.0e-03): 23272 (35.51%)
[1.0e-03, 1.0e-02): 5 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0126953125
max_diff_thr=0.011932616122066975

Top differences:
Position (np.int64(47), np.int64(7), np.int64(55)): arr1 = -0.169922, arr2 = -0.157227, Diff = 0.012695
Position (np.int64(30), np.int64(4), np.int64(122)): arr1 = -0.055908, arr2 = -0.043457, Diff = 0.012451
Position (np.int64(26), np.int64(5), np.int64(6)): arr1 = -0.102051, arr2 = -0.089844, Diff = 0.012207
Position (np.int64(8), np.int64(2), np.int64(76)): arr1 = 0.104004, arr2 = 0.091797, Diff = 0.012207
Position (np.int64(62), np.int64(4), np.int64(1)): arr1 = -0.101074, arr2 = -0.088867, Diff = 0.012207

Threshold statistics:
[0.0e+00, 1.0e-06): 2756 (4.21%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 244 (0.37%)
[1.0e-04, 1.0e-03): 16175 (24.68%)
[1.0e-03, 1.0e-02): 46308 (70.66%)
[1.0e-02, 1.0e-01): 52 (0.08%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=51f4280d5e8c1d0abb937053dbffdb1a
triton_output_md5=b44f5ae76df87e2eed51e6d7995f2a64
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(227), np.int64(5), np.int64(31)): arr1 = -0.142578, arr2 = -0.143555, Diff = 0.000977
Position (np.int64(159), np.int64(0), np.int64(61)): arr1 = -0.141602, arr2 = -0.142578, Diff = 0.000977
Position (np.int64(22), np.int64(3), np.int64(46)): arr1 = -0.148438, arr2 = -0.149414, Diff = 0.000977
Position (np.int64(218), np.int64(4), np.int64(99)): arr1 = -0.126953, arr2 = -0.125977, Diff = 0.000977
Position (np.int64(254), np.int64(3), np.int64(79)): arr1 = 0.164062, arr2 = 0.163086, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 150103 (57.26%)
[1.0e-06, 1.0e-05): 438 (0.17%)
[1.0e-05, 1.0e-04): 28565 (10.90%)
[1.0e-04, 1.0e-03): 83038 (31.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01171875
max_diff_thr=0.010550996288657188

Top differences:
Position (np.int64(56), np.int64(7), np.int64(18)): arr1 = -0.144531, arr2 = -0.132812, Diff = 0.011719
Position (np.int64(174), np.int64(0), np.int64(15)): arr1 = -0.052246, arr2 = -0.041260, Diff = 0.010986
Position (np.int64(76), np.int64(7), np.int64(120)): arr1 = 0.211914, arr2 = 0.201172, Diff = 0.010742
Position (np.int64(169), np.int64(5), np.int64(15)): arr1 = 0.089355, arr2 = 0.078613, Diff = 0.010742
Position (np.int64(237), np.int64(2), np.int64(38)): arr1 = 0.111328, arr2 = 0.100586, Diff = 0.010742

Threshold statistics:
[0.0e+00, 1.0e-06): 10611 (4.05%)
[1.0e-06, 1.0e-05): 25 (0.01%)
[1.0e-05, 1.0e-04): 1606 (0.61%)
[1.0e-04, 1.0e-03): 82278 (31.39%)
[1.0e-03, 1.0e-02): 167614 (63.94%)
[1.0e-02, 1.0e-01): 10 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8829a78ba1c0f4edeba76686fb709cde
triton_output_md5=8f94a0346dfe2d3a8f8168a1fbd2f824
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(24), np.int64(2), np.int64(97)): arr1 = 0.192383, arr2 = 0.191406, Diff = 0.000977
Position (np.int64(37), np.int64(5), np.int64(73)): arr1 = 0.127930, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(23), np.int64(0), np.int64(88)): arr1 = 0.143555, arr2 = 0.144531, Diff = 0.000977
Position (np.int64(43), np.int64(1), np.int64(107)): arr1 = 0.138672, arr2 = 0.139648, Diff = 0.000977
Position (np.int64(4), np.int64(0), np.int64(2)): arr1 = -0.127930, arr2 = -0.128906, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 37442 (57.13%)
[1.0e-06, 1.0e-05): 122 (0.19%)
[1.0e-05, 1.0e-04): 7047 (10.75%)
[1.0e-04, 1.0e-03): 20925 (31.93%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01123046875
max_diff_thr=0.010176991112530231

Top differences:
Position (np.int64(49), np.int64(0), np.int64(63)): arr1 = -0.114746, arr2 = -0.103516, Diff = 0.011230
Position (np.int64(44), np.int64(7), np.int64(25)): arr1 = -0.181641, arr2 = -0.170898, Diff = 0.010742
Position (np.int64(44), np.int64(7), np.int64(24)): arr1 = -0.114258, arr2 = -0.103516, Diff = 0.010742
Position (np.int64(61), np.int64(0), np.int64(49)): arr1 = -0.072754, arr2 = -0.062500, Diff = 0.010254
Position (np.int64(63), np.int64(5), np.int64(74)): arr1 = -0.046387, arr2 = -0.036377, Diff = 0.010010

Threshold statistics:
[0.0e+00, 1.0e-06): 2712 (4.14%)
[1.0e-06, 1.0e-05): 11 (0.02%)
[1.0e-05, 1.0e-04): 367 (0.56%)
[1.0e-04, 1.0e-03): 20724 (31.62%)
[1.0e-03, 1.0e-02): 41717 (63.66%)
[1.0e-02, 1.0e-01): 5 (0.01%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2ceeb63e01b4cb7e98db06474f57cd99
triton_output_md5=3d1b955445bdf901c8299e65a578c213
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(11), np.int64(2), np.int64(102)): arr1 = -0.137695, arr2 = -0.136719, Diff = 0.000977
Position (np.int64(109), np.int64(3), np.int64(35)): arr1 = -0.139648, arr2 = -0.138672, Diff = 0.000977
Position (np.int64(27), np.int64(6), np.int64(66)): arr1 = -0.148438, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(129), np.int64(5), np.int64(53)): arr1 = -0.186523, arr2 = -0.185547, Diff = 0.000977
Position (np.int64(41), np.int64(0), np.int64(39)): arr1 = -0.173828, arr2 = -0.172852, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 150877 (57.56%)
[1.0e-06, 1.0e-05): 510 (0.19%)
[1.0e-05, 1.0e-04): 31416 (11.98%)
[1.0e-04, 1.0e-03): 79341 (30.27%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009765625
max_diff_thr=0.00932618323713541

Top differences:
Position (np.int64(121), np.int64(5), np.int64(6)): arr1 = -0.193359, arr2 = -0.183594, Diff = 0.009766
Position (np.int64(43), np.int64(7), np.int64(65)): arr1 = -0.204102, arr2 = -0.194336, Diff = 0.009766
Position (np.int64(176), np.int64(3), np.int64(4)): arr1 = 0.093262, arr2 = 0.083496, Diff = 0.009766
Position (np.int64(143), np.int64(3), np.int64(99)): arr1 = 0.056885, arr2 = 0.047119, Diff = 0.009766
Position (np.int64(61), np.int64(7), np.int64(61)): arr1 = -0.100098, arr2 = -0.090820, Diff = 0.009277

Threshold statistics:
[0.0e+00, 1.0e-06): 10456 (3.99%)[aiter INFO] 2025-09-30 05:13:20.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:20.151 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.9361783903424 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.208 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:20.208 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-09-30 05:13:20.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-30 05:13:20.227 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            449.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,363.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,813.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.1             18.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.228 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:20.316 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.49621800975044 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1104, 1312, 12, 1117}
[aiter INFO] 2025-09-30 05:13:20.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.998999999999796
[aiter INFO] 2025-09-30 05:13:20.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.91899999999987
[aiter INFO] 2025-09-30 05:13:20.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.400000000000006
[aiter INFO] 2025-09-30 05:13:20.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.998999999999796
[aiter INFO] 2025-09-30 05:13:20.388 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 97.0            0.0          2,089.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.415 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.340772283549356 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.454 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {188, 6, 223}
[aiter INFO] 2025-09-30 05:13:20.454 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.838999999999942
[aiter INFO] 2025-09-30 05:13:20.454 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-30 05:13:20.454 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.879000000000133
[aiter INFO] 2025-09-30 05:13:20.466 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            324.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.467 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:20.470 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:20.593 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.52436656349956 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 23, 31, 34, 42, 45, 53, 56, 64, 67, 86, 89, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.838999999999942
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.638999999999896
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.59899999999999
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.63900000000001
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.639999999999986
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999992
[aiter INFO] 2025-09-30 05:13:20.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000005
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999915
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.438999999999965
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.19900000000007
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000005
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.238999999999805
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.43899999999985
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.159000000000106
[aiter INFO] 2025-09-30 05:13:20.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-09-30 05:13:20.666 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0          1,117.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,883.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,312.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           33.1             33.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.666 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:20.850 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.0293465191775 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:20.901 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 909}
[aiter INFO] 2025-09-30 05:13:20.901 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.07899999999995
[aiter INFO] 2025-09-30 05:13:20.901 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.91899999999987
[aiter INFO] 2025-09-30 05:13:20.913 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          4,022.8        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:20.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.05561392761693 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:21.155 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:21.155 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.518999999999977
[aiter INFO] 2025-09-30 05:13:21.168 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            499.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:21.169 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:21.177 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:21.239 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.74607918699189 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:21.298 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:21.298 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-09-30 05:13:21.298 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 05:13:21.317 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            450.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,367.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,817.4              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.2             18.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:21.318 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:21.407 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.9591585197071 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:21.469 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:21.469 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.038999999999987
[aiter INFO] 2025-09-30 05:13:21.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,151.1        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:21.508 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.81523772897107 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:21.548 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:21.548 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-30 05:13:21.560 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            327.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:21.561 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    24.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:21.564 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:21.689 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 131.60317848519523 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:21.743 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 68, 9, 42, 75, 812, 13, 46, 79, 819, 20, 53, 23, 57, 31}
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.079000000000065
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.358999999999924
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.718999999999994
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.23899999999992
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.879000000000815
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.718999999999994
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.358999999999924
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000078
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.679000000000087
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.519000000000005
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.07899999999995
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.679000000000087
[aiter INFO] 2025-09-30 05:13:21.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.839000000000055
[aiter INFO] 2025-09-30 05:13:21.763 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          1,159.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          2,922.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,400.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           44.0             43.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:21.764 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:21.953 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.18868338117505 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 870, 103}
[aiter INFO] 2025-09-30 05:13:22.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.11899999999997
[aiter INFO] 2025-09-30 05:13:22.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.95899999999983
[aiter INFO] 2025-09-30 05:13:22.005 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.55900000000008
[aiter INFO] 2025-09-30 05:13:22.017 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0          7,517.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             76.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.047 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.585921025807316 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {265, 20, 6}
[aiter INFO] 2025-09-30 05:13:22.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000378
[aiter INFO] 2025-09-30 05:13:22.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.159000000000049
[aiter INFO] 2025-09-30 05:13:22.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.478999999999985
[aiter INFO] 2025-09-30 05:13:22.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            567.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.096 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    82.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

[1.0e-06, 1.0e-05): 26 (0.01%)
[1.0e-05, 1.0e-04): 1909 (0.73%)
[1.0e-04, 1.0e-03): 87934 (33.54%)
[1.0e-03, 1.0e-02): 161819 (61.73%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1e6c364dfa05f11f0b8f319963556b5b
triton_output_md5=61df48eff71e5ae763cdb84c14baa6f1
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(47), np.int64(0), np.int64(8)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(44), np.int64(4), np.int64(94)): arr1 = -0.138672, arr2 = -0.137695, Diff = 0.000977
Position (np.int64(18), np.int64(2), np.int64(58)): arr1 = 0.151367, arr2 = 0.150391, Diff = 0.000977
Position (np.int64(9), np.int64(4), np.int64(19)): arr1 = 0.168945, arr2 = 0.169922, Diff = 0.000977
Position (np.int64(5), np.int64(2), np.int64(80)): arr1 = 0.134766, arr2 = 0.133789, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 37938 (57.89%)
[1.0e-06, 1.0e-05): 156 (0.24%)
[1.0e-05, 1.0e-04): 7650 (11.67%)
[1.0e-04, 1.0e-03): 19792 (30.20%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009765625
max_diff_thr=0.008960151113569736

Top differences:
Position (np.int64(30), np.int64(7), np.int64(27)): arr1 = -0.140625, arr2 = -0.130859, Diff = 0.009766
Position (np.int64(47), np.int64(7), np.int64(104)): arr1 = 0.143555, arr2 = 0.133789, Diff = 0.009766
Position (np.int64(21), np.int64(4), np.int64(9)): arr1 = -0.044678, arr2 = -0.035400, Diff = 0.009277
Position (np.int64(14), np.int64(3), np.int64(53)): arr1 = -0.112305, arr2 = -0.103516, Diff = 0.008789
Position (np.int64(16), np.int64(0), np.int64(117)): arr1 = 0.013733, arr2 = 0.005096, Diff = 0.008636

Threshold statistics:
[0.0e+00, 1.0e-06): 2673 (4.08%)
[1.0e-06, 1.0e-05): 5 (0.01%)
[1.0e-05, 1.0e-04): 457 (0.70%)
[1.0e-04, 1.0e-03): 22133 (33.77%)
[1.0e-03, 1.0e-02): 40268 (61.44%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=3d6afe8765fc1cff000be5b89191295d
triton_output_md5=631db13a1722b3a0532eef639d4f0ce5
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(113), np.int64(2), np.int64(49)): arr1 = -0.128906, arr2 = -0.129883, Diff = 0.000977
Position (np.int64(34), np.int64(5), np.int64(90)): arr1 = -0.146484, arr2 = -0.145508, Diff = 0.000977
Position (np.int64(129), np.int64(4), np.int64(3)): arr1 = -0.136719, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(199), np.int64(4), np.int64(70)): arr1 = -0.136719, arr2 = -0.137695, Diff = 0.000977
Position (np.int64(146), np.int64(0), np.int64(63)): arr1 = 0.132812, arr2 = 0.131836, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 151112 (57.64%)
[1.0e-06, 1.0e-05): 1115 (0.43%)
[1.0e-05, 1.0e-04): 51072 (19.48%)
[1.0e-04, 1.0e-03): 58845 (22.45%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0078125
max_diff_thr=0.00722779193893075

Top differences:
Position (np.int64(177), np.int64(7), np.int64(116)): arr1 = -0.088867, arr2 = -0.081055, Diff = 0.007812
Position (np.int64(246), np.int64(3), np.int64(36)): arr1 = -0.054688, arr2 = -0.047119, Diff = 0.007568
Position (np.int64(232), np.int64(5), np.int64(123)): arr1 = -0.078613, arr2 = -0.071289, Diff = 0.007324
Position (np.int64(137), np.int64(7), np.int64(89)): arr1 = 0.077148, arr2 = 0.069824, Diff = 0.007324
Position (np.int64(105), np.int64(6), np.int64(60)): arr1 = -0.043701, arr2 = -0.036621, Diff = 0.007080

Threshold statistics:
[0.0e+00, 1.0e-06): 10831 (4.13%)
[1.0e-06, 1.0e-05): 66 (0.03%)
[1.0e-05, 1.0e-04): 3605 (1.38%)
[1.0e-04, 1.0e-03): 117659 (44.88%)
[1.0e-03, 1.0e-02): 129983 (49.58%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=70624b3780ebb8d8988ca6907782df20
triton_output_md5=42aab0523ab8512c57429072715369fc
diff.abs.max=0.0009765625
max_diff_thr=0.0008643042529001832

Top differences:
Position (np.int64(26), np.int64(3), np.int64(87)): arr1 = 0.130859, arr2 = 0.129883, Diff = 0.000977
Position (np.int64(2), np.int64(2), np.int64(119)): arr1 = -0.087891, arr2 = -0.087402, Diff = 0.000488
Position (np.int64(2), np.int64(2), np.int64(114)): arr1 = 0.078613, arr2 = 0.079102, Diff = 0.000488
Position (np.int64(21), np.int64(1), np.int64(105)): arr1 = 0.074219, arr2 = 0.074707, Diff = 0.000488
Position (np.int64(10), np.int64(7), np.int64(101)): arr1 = -0.094238, arr2 = -0.094727, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 37515 (57.24%)
[1.0e-06, 1.0e-05): 280 (0.43%)
[1.0e-05, 1.0e-04): 12697 (19.37%)
[1.0e-04, 1.0e-03): 15044 (22.96%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.00642201816663146

Top differences:
Position (np.int64(46), np.int64(2), np.int64(7)): arr1 = -0.071289, arr2 = -0.064453, Diff = 0.006836
Position (np.int64(48), np.int64(6), np.int64(61)): arr1 = -0.079102, arr2 = -0.072266, Diff = 0.006836
Position (np.int64(0), np.int64(0), np.int64(36)): arr1 = 0.092285, arr2 = 0.085449, Diff = 0.006836
Position (np.int64(57), np.int64(0), np.int64(74)): arr1 = 0.040771, arr2 = 0.034180, Diff = 0.006592
Position (np.int64(60), np.int64(4), np.int64(82)): arr1 = 0.109375, arr2 = 0.103027, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 2654 (4.05%)
[1.0e-06, 1.0e-05): 7 (0.01%)
[1.0e-05, 1.0e-04): 906 (1.38%)
[1.0e-04, 1.0e-03): 29518 (45.04%)
[1.0e-03, 1.0e-02): 32451 (49.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f241a0a1b9db0b11a8c1fdc3549c730c
triton_output_md5=0494e5e6a5f929da0f844fac145b528f
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(15), np.int64(4), np.int64(65)): arr1 = 0.147461, arr2 = 0.146484, Diff = 0.000977
Position (np.int64(81), np.int64(2), np.int64(27)): arr1 = 0.132812, arr2 = 0.133789, Diff = 0.000977
Position (np.int64(86), np.int64(0), np.int64(74)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977
Position (np.int64(5), np.int64(2), np.int64(122)): arr1 = 0.127930, arr2 = 0.126953, Diff = 0.000977
Position (np.int64(122), np.int64(2), np.int64(127)): arr1 = 0.125977, arr2 = 0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 141535 (53.99%)
[1.0e-06, 1.0e-05): 1102 (0.42%)
[1.0e-05, 1.0e-04): 51676 (19.71%)
[1.0e-04, 1.0e-03): 67831 (25.88%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00732421875
max_diff_thr=0.006949270144104958

Top differences:
Position (np.int64(82), np.int64(0), np.int64(12)): arr1 = -0.071289, arr2 = -0.063965, Diff = 0.007324
Position (np.int64(247), np.int64(0), np.int64(86)): arr1 = 0.061279, arr2 = 0.053955, Diff = 0.007324
Position (np.int64(196), np.int64(5), np.int64(113)): arr1 = 0.071289, arr2 = 0.064453, Diff = 0.006836
Position (np.int64(151), np.int64(5), np.int64(3)): arr1 = -0.049561, arr2 = -0.042969, Diff = 0.006592
Position (np.int64(175), np.int64(7), np.int64(110)): arr1 = -0.053467, arr2 = -0.046875, Diff = 0.006592

Threshold statistics:
[0.0e+00, 1.0e-06): 10650 (4.06%)
[1.0e-06, 1.0e-05): 54 (0.02%)
[1.0e-05, 1.0e-04): 3599 (1.37%)
[1.0e-04, 1.0e-03): 118874 (45.35%)
[1.0e-03, 1.0e-02): 128967 (49.20%)
[1.0e-02, 1.0e-01): 0 (0.00%)[aiter INFO] 2025-09-30 05:13:22.103 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:22.165 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.14053498046232 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:22.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.118999999999971
[aiter INFO] 2025-09-30 05:13:22.223 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599000000000046
[aiter INFO] 2025-09-30 05:13:22.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            450.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,386.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,836.9              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.4             18.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.243 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:22.330 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.28829705656165 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.389 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:22.389 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.558999999999997
[aiter INFO] 2025-09-30 05:13:22.401 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,174.1        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.429 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.81205931453422 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.466 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:22.466 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-30 05:13:22.479 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            372.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.480 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:22.482 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:22.606 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 131.36755461149878 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 68, 739, 9, 42, 75, 108, 13, 46, 79, 112, 735, 20, 53, 24, 57, 31}
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.27900000000011
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000083
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.59900000000016
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.47900000000004
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.39999999999998
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.639999999999986
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.478999999999814
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.638999999999896
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.5590000000002
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.79899999999998
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.399
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000037
[aiter INFO] 2025-09-30 05:13:22.659 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.87900000000002
[aiter INFO] 2025-09-30 05:13:22.678 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0          1,146.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          2,885.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,397.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           44.0             43.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:22.679 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:23.051 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 173.06745524453646 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.103 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12}
[aiter INFO] 2025-09-30 05:13:23.103 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.23900000000003
[aiter INFO] 2025-09-30 05:13:23.103 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.19900000000001
[aiter INFO] 2025-09-30 05:13:23.116 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          7,571.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             76.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.144 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.20176230356245 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {454, 6, 363, 139, 398, 468, 118, 566, 412}
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000178
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000004
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999651
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999842
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.1590000000001055
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.1590000000001055
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.31899999999996
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999396
[aiter INFO] 2025-09-30 05:13:23.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000142
[aiter INFO] 2025-09-30 05:13:23.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0            529.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.194 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    82.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:23.201 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:23.263 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.23635652867875 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.324 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:23.324 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999976
[aiter INFO] 2025-09-30 05:13:23.325 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 05:13:23.343 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            454.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,397.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,851.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.5             18.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.344 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:23.434 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 123.52396031417469 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.495 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77}
[aiter INFO] 2025-09-30 05:13:23.495 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.59899999999999
[aiter INFO] 2025-09-30 05:13:23.496 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.479000000000042
[aiter INFO] 2025-09-30 05:13:23.508 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,158.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.536 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.587108729499406 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.575 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:23.575 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999976
[aiter INFO] 2025-09-30 05:13:23.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            372.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.589 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:23.591 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:23.717 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 131.3109014293935 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:23.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 35, 101, 9, 42, 75, 12, 46, 79, 20, 53, 86, 23, 57, 90, 31}
[aiter INFO] 2025-09-30 05:13:23.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.919000000000096
[aiter INFO] 2025-09-30 05:13:23.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:23.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-30 05:13:23.772 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.91899999999998
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.59899999999993
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.118999999999915
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.519000000000005
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999919
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.718999999999994
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.19900000000007
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.43999999999983
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.438999999999965
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-09-30 05:13:23.773 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.91899999999998
[aiter INFO] 2025-09-30 05:13:23.792 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          1,159.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          2,903.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,384.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           43.8             43.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:23.793 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    43.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:23.991 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.38668410966892 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.043 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:24.044 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.67900000000003
[aiter INFO] 2025-09-30 05:13:24.056 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          7,647.5        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             76.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.085 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.80294050261526 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.120 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:24.121 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-30 05:13:24.133 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            577.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.134 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    82.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a165bd300d0a9a167df15efb25bc644f
triton_output_md5=41307a44efc3ddaf19939ae776f5c006
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(19), np.int64(1), np.int64(97)): arr1 = 0.129883, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(13), np.int64(0), np.int64(38)): arr1 = 0.138672, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(21), np.int64(1), np.int64(87)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(22), np.int64(0), np.int64(111)): arr1 = -0.127930, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(0), np.int64(5), np.int64(65)): arr1 = 0.139648, arr2 = 0.138672, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 35190 (53.70%)
[1.0e-06, 1.0e-05): 269 (0.41%)
[1.0e-05, 1.0e-04): 13207 (20.15%)
[1.0e-04, 1.0e-03): 16870 (25.74%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.007517814636230469
max_diff_thr=0.0074606663547456264

Top differences:
Position (np.int64(51), np.int64(4), np.int64(111)): arr1 = 0.000142, arr2 = 0.007660, Diff = 0.007518
Position (np.int64(45), np.int64(5), np.int64(118)): arr1 = -0.015747, arr2 = -0.008667, Diff = 0.007080
Position (np.int64(7), np.int64(1), np.int64(47)): arr1 = 0.056152, arr2 = 0.049561, Diff = 0.006592
Position (np.int64(31), np.int64(4), np.int64(71)): arr1 = -0.023193, arr2 = -0.016968, Diff = 0.006226
Position (np.int64(18), np.int64(2), np.int64(80)): arr1 = 0.050537, arr2 = 0.044434, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 2731 (4.17%)
[1.0e-06, 1.0e-05): 12 (0.02%)
[1.0e-05, 1.0e-04): 892 (1.36%)
[1.0e-04, 1.0e-03): 29643 (45.23%)
[1.0e-03, 1.0e-02): 32258 (49.22%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a9e53560530afc2c463b856c6c4134b0
triton_output_md5=79a6ea35bef20343c5aa4107e732d25a
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(128), np.int64(5), np.int64(39)): arr1 = 0.128906, arr2 = 0.127930, Diff = 0.000977
Position (np.int64(146), np.int64(4), np.int64(68)): arr1 = -0.131836, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(198), np.int64(4), np.int64(107)): arr1 = 0.139648, arr2 = 0.140625, Diff = 0.000977
Position (np.int64(56), np.int64(5), np.int64(41)): arr1 = -0.134766, arr2 = -0.135742, Diff = 0.000977
Position (np.int64(56), np.int64(7), np.int64(41)): arr1 = -0.135742, arr2 = -0.134766, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 132243 (50.45%)
[1.0e-06, 1.0e-05): 1052 (0.40%)
[1.0e-05, 1.0e-04): 53004 (20.22%)
[1.0e-04, 1.0e-03): 75845 (28.93%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0078125
max_diff_thr=0.007067137863487005

Top differences:
Position (np.int64(84), np.int64(3), np.int64(123)): arr1 = 0.113281, arr2 = 0.105469, Diff = 0.007812
Position (np.int64(91), np.int64(2), np.int64(24)): arr1 = 0.086426, arr2 = 0.079102, Diff = 0.007324
Position (np.int64(156), np.int64(6), np.int64(83)): arr1 = -0.073242, arr2 = -0.066895, Diff = 0.006348
Position (np.int64(224), np.int64(3), np.int64(0)): arr1 = 0.056396, arr2 = 0.050049, Diff = 0.006348
Position (np.int64(40), np.int64(0), np.int64(33)): arr1 = -0.119141, arr2 = -0.112793, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 10608 (4.05%)
[1.0e-06, 1.0e-05): 47 (0.02%)
[1.0e-05, 1.0e-04): 3986 (1.52%)
[1.0e-04, 1.0e-03): 123371 (47.06%)
[1.0e-03, 1.0e-02): 124132 (47.35%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e8396e4c6716cd4ce50c05a9bae41f73
triton_output_md5=4805a586fe85a5a0eb269c6c149abde3
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(33), np.int64(5), np.int64(122)): arr1 = -0.147461, arr2 = -0.148438, Diff = 0.000977
Position (np.int64(21), np.int64(5), np.int64(80)): arr1 = 0.135742, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(33), np.int64(3), np.int64(122)): arr1 = -0.134766, arr2 = -0.133789, Diff = 0.000977
Position (np.int64(53), np.int64(7), np.int64(65)): arr1 = -0.133789, arr2 = -0.132812, Diff = 0.000977
Position (np.int64(43), np.int64(7), np.int64(77)): arr1 = 0.125977, arr2 = 0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 33232 (50.71%)
[1.0e-06, 1.0e-05): 253 (0.39%)
[1.0e-05, 1.0e-04): 13048 (19.91%)
[1.0e-04, 1.0e-03): 19003 (29.00%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.005859375
max_diff_thr=0.005653710104525089

Top differences:
Position (np.int64(43), np.int64(1), np.int64(58)): arr1 = 0.084473, arr2 = 0.078613, Diff = 0.005859
Position (np.int64(9), np.int64(6), np.int64(26)): arr1 = -0.110840, arr2 = -0.104980, Diff = 0.005859
Position (np.int64(8), np.int64(1), np.int64(26)): arr1 = -0.092285, arr2 = -0.086426, Diff = 0.005859
Position (np.int64(33), np.int64(1), np.int64(122)): arr1 = -0.124023, arr2 = -0.118164, Diff = 0.005859
Position (np.int64(60), np.int64(0), np.int64(96)): arr1 = -0.042236, arr2 = -0.036377, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 2787 (4.25%)
[1.0e-06, 1.0e-05): 13 (0.02%)
[1.0e-05, 1.0e-04): 985 (1.50%)
[1.0e-04, 1.0e-03): 30675 (46.81%)
[1.0e-03, 1.0e-02): 31076 (47.42%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=db7d5676e8c5d026fe74edb4c4159a7d
triton_output_md5=cba74cfc71fd72b29fe44318738ab6c8
diff.abs.max=0.00048828125
max_diff_thr=0.0004660918202716857

Top differences:
Position (np.int64(202), np.int64(3), np.int64(81)): arr1 = 0.083008, arr2 = 0.083496, Diff = 0.000488
Position (np.int64(48), np.int64(3), np.int64(12)): arr1 = -0.064453, arr2 = -0.063965, Diff = 0.000488
Position (np.int64(48), np.int64(3), np.int64(80)): arr1 = -0.068848, arr2 = -0.068359, Diff = 0.000488
Position (np.int64(15), np.int64(6), np.int64(21)): arr1 = -0.064941, arr2 = -0.064453, Diff = 0.000488
Position (np.int64(165), np.int64(5), np.int64(98)): arr1 = 0.070801, arr2 = 0.070312, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 131087 (50.01%)
[1.0e-06, 1.0e-05): 1851 (0.71%)
[1.0e-05, 1.0e-04): 70966 (27.07%)
[1.0e-04, 1.0e-03): 58240 (22.22%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0057373046875
max_diff_thr=0.005582610610872507

Top differences:
Position (np.int64(63), np.int64(3), np.int64(29)): arr1 = -0.033447, arr2 = -0.027710, Diff = 0.005737
Position (np.int64(7), np.int64(2), np.int64(60)): arr1 = -0.036133, arr2 = -0.030762, Diff = 0.005371
Position (np.int64(86), np.int64(1), np.int64(118)): arr1 = 0.044678, arr2 = 0.039551, Diff = 0.005127
Position (np.int64(28), np.int64(0), np.int64(87)): arr1 = -0.096680, arr2 = -0.091797, Diff = 0.004883
Position (np.int64(179), np.int64(1), np.int64(86)): arr1 = 0.029053, arr2 = 0.024170, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 10626 (4.05%)
[1.0e-06, 1.0e-05): 100 (0.04%)
[1.0e-05, 1.0e-04): 6863 (2.62%)
[1.0e-04, 1.0e-03): 154587 (58.97%)
[1.0e-03, 1.0e-02): 89968 (34.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e1efd339792635ef78c5dbcf7edf2b06[aiter INFO] 2025-09-30 05:13:24.141 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:24.203 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.48432664351888 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 229, 230}
[aiter INFO] 2025-09-30 05:13:24.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999976
[aiter INFO] 2025-09-30 05:13:24.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:24.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.2800000000002
[aiter INFO] 2025-09-30 05:13:24.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000287
[aiter INFO] 2025-09-30 05:13:24.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            442.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,386.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,850.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.5             18.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.281 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.47 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:24.369 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.52197020596797 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:24.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-30 05:13:24.613 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,174.1        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.641 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.1930594700988 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.681 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 335}
[aiter INFO] 2025-09-30 05:13:24.681 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000017
[aiter INFO] 2025-09-30 05:13:24.681 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000000327
[aiter INFO] 2025-09-30 05:13:24.693 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            369.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.694 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:24.697 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:24.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.58497072918578 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 36, 69, 9, 42, 75, 14, 47, 80, 20, 53, 25, 57, 31}
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.678999999999974
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.719000000000051
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.559000000000026
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.71900000000005
[aiter INFO] 2025-09-30 05:13:24.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.999000000000024
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.559000000000026
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.43899999999985
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.958999999999946
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.47899999999993
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.358999999999924
[aiter INFO] 2025-09-30 05:13:24.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.879999999999995
[aiter INFO] 2025-09-30 05:13:24.896 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0          1,163.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          3,544.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,023.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           50.2             50.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:24.897 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    50.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:25.087 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 188.94829667440735 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {363, 1195, 1260, 12, 1104, 883, 1208, 857, 831}
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.19899999999961
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.92000000000007
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.91899999999987
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.96000000000001
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.07899999999972
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.95899999999983
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.83899999999994
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.75900000000001
[aiter INFO] 2025-09-30 05:13:25.142 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.8799999999992
[aiter INFO] 2025-09-30 05:13:25.155 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 92.0            0.0          8,780.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             95.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.185 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.723336657380116 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.221 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {20, 6}
[aiter INFO] 2025-09-30 05:13:25.221 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.439000000000021
[aiter INFO] 2025-09-30 05:13:25.221 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-30 05:13:25.233 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            690.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.234 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   102.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:25.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:25.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.7167716232857 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.359 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-30 05:13:25.359 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839
[aiter INFO] 2025-09-30 05:13:25.359 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-30 05:13:25.378 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            452.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,027.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,480.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           24.8             24.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.379 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.80 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:25.469 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.0867317065154 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12, 1052, 25, 220}
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.55899999999997
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.19999999999999
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.878999999998996
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.43900000000002
[aiter INFO] 2025-09-30 05:13:25.529 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.19900000000007
[aiter INFO] 2025-09-30 05:13:25.541 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 96.0            0.0          3,792.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             39.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.568 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.952267329881685 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.606 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:25.607 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-30 05:13:25.619 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            433.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.620 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    43.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:25.622 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:25.762 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 255.7089011562933 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {707, 676, 9, 1055, 335, 688, 721, 21, 1052, 1053, 1054, 319}
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 156.36000000000058
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.8800000000001
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 161.079
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.03899999999885
[aiter INFO] 2025-09-30 05:13:25.823 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999614
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000706
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.07899999999972
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.958999999998923
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.28000000000065
[aiter INFO] 2025-09-30 05:13:25.824 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.63999999999987
[aiter INFO] 2025-09-30 05:13:25.843 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,241.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0         14,975.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       17,074.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          170.7            170.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:25.844 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   170.71 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:26.078 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 570.9748521889791 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:26.169 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:26.169 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 482.64099999999996
[aiter INFO] 2025-09-30 05:13:26.180 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         47,821.5        CUDA            8
[avg us/iter]                       NaN   NaN            0.0            478.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:26.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.18592082008277 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:26.245 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:26.245 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999997
[aiter INFO] 2025-09-30 05:13:26.257 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,122.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             11.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:26.258 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   489.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:26.265 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:26.331 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.51878190630734 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.59899999999999
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.0
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.839000000000055
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.19900000000007
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5989999999999895
[aiter INFO] 2025-09-30 05:13:26.385 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999969
[aiter INFO] 2025-09-30 05:13:26.386 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.03899999999999
[aiter INFO] 2025-09-30 05:13:26.404 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            448.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,604.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,271.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           52.7             52.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:26.405 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    52.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

triton_output_md5=e83320cb40b8b712a2fefcb4dc2c2ee9
diff.abs.max=0.00048828125
max_diff_thr=0.00046948358067311347

Top differences:
Position (np.int64(36), np.int64(3), np.int64(69)): arr1 = -0.063477, arr2 = -0.062988, Diff = 0.000488
Position (np.int64(16), np.int64(1), np.int64(102)): arr1 = 0.074219, arr2 = 0.073730, Diff = 0.000488
Position (np.int64(16), np.int64(1), np.int64(61)): arr1 = -0.080566, arr2 = -0.081055, Diff = 0.000488
Position (np.int64(52), np.int64(2), np.int64(124)): arr1 = 0.071777, arr2 = 0.072266, Diff = 0.000488
Position (np.int64(27), np.int64(5), np.int64(9)): arr1 = -0.091797, arr2 = -0.091309, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 32335 (49.34%)
[1.0e-06, 1.0e-05): 455 (0.69%)
[1.0e-05, 1.0e-04): 18253 (27.85%)
[1.0e-04, 1.0e-03): 14493 (22.11%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0048828125
max_diff_thr=0.004644681699573994

Top differences:
Position (np.int64(46), np.int64(2), np.int64(65)): arr1 = -0.074707, arr2 = -0.069824, Diff = 0.004883
Position (np.int64(61), np.int64(0), np.int64(35)): arr1 = -0.056152, arr2 = -0.051270, Diff = 0.004883
Position (np.int64(20), np.int64(2), np.int64(77)): arr1 = -0.062988, arr2 = -0.058350, Diff = 0.004639
Position (np.int64(2), np.int64(6), np.int64(111)): arr1 = -0.044678, arr2 = -0.040039, Diff = 0.004639
Position (np.int64(23), np.int64(4), np.int64(57)): arr1 = 0.047363, arr2 = 0.042725, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 2586 (3.95%)
[1.0e-06, 1.0e-05): 20 (0.03%)
[1.0e-05, 1.0e-04): 1760 (2.69%)
[1.0e-04, 1.0e-03): 38598 (58.90%)
[1.0e-03, 1.0e-02): 22572 (34.44%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=07fdbefeb37d042777d397224ef299a0
triton_output_md5=3e85b0fc61d5a2ab44c8c2e688919fc0
diff.abs.max=0.00048828125
max_diff_thr=0.0004710315552074462

Top differences:
Position (np.int64(238), np.int64(3), np.int64(120)): arr1 = -0.072266, arr2 = -0.071777, Diff = 0.000488
Position (np.int64(119), np.int64(4), np.int64(3)): arr1 = -0.075684, arr2 = -0.075195, Diff = 0.000488
Position (np.int64(114), np.int64(1), np.int64(48)): arr1 = 0.072754, arr2 = 0.073242, Diff = 0.000488
Position (np.int64(138), np.int64(4), np.int64(78)): arr1 = -0.076172, arr2 = -0.075684, Diff = 0.000488
Position (np.int64(100), np.int64(0), np.int64(82)): arr1 = -0.069336, arr2 = -0.068848, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 130186 (49.66%)
[1.0e-06, 1.0e-05): 1871 (0.71%)
[1.0e-05, 1.0e-04): 72145 (27.52%)
[1.0e-04, 1.0e-03): 57942 (22.10%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0048828125
max_diff_thr=0.004574565216898918

Top differences:
Position (np.int64(35), np.int64(1), np.int64(2)): arr1 = -0.076660, arr2 = -0.071777, Diff = 0.004883
Position (np.int64(0), np.int64(5), np.int64(89)): arr1 = 0.088867, arr2 = 0.083984, Diff = 0.004883
Position (np.int64(246), np.int64(0), np.int64(76)): arr1 = 0.072266, arr2 = 0.067383, Diff = 0.004883
Position (np.int64(138), np.int64(4), np.int64(6)): arr1 = 0.035156, arr2 = 0.030518, Diff = 0.004639
Position (np.int64(226), np.int64(5), np.int64(13)): arr1 = -0.037842, arr2 = -0.033203, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 10626 (4.05%)
[1.0e-06, 1.0e-05): 113 (0.04%)
[1.0e-05, 1.0e-04): 6965 (2.66%)
[1.0e-04, 1.0e-03): 154530 (58.95%)
[1.0e-03, 1.0e-02): 89910 (34.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f6f0562e7d997f0d6dc2ec8accc83df4
triton_output_md5=ee7d93d61b6c3675f4e6c177196af956
diff.abs.max=0.00048828125
max_diff_thr=0.0004595588252414018

Top differences:
Position (np.int64(7), np.int64(5), np.int64(75)): arr1 = 0.064941, arr2 = 0.065430, Diff = 0.000488
Position (np.int64(40), np.int64(2), np.int64(54)): arr1 = 0.082031, arr2 = 0.082520, Diff = 0.000488
Position (np.int64(62), np.int64(0), np.int64(8)): arr1 = -0.064453, arr2 = -0.063965, Diff = 0.000488
Position (np.int64(43), np.int64(0), np.int64(120)): arr1 = -0.080566, arr2 = -0.080078, Diff = 0.000488
Position (np.int64(51), np.int64(7), np.int64(38)): arr1 = -0.065430, arr2 = -0.065918, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 32352 (49.37%)
[1.0e-06, 1.0e-05): 457 (0.70%)
[1.0e-05, 1.0e-04): 18392 (28.06%)
[1.0e-04, 1.0e-03): 14335 (21.87%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00537109375
max_diff_thr=0.005113900639116764

Top differences:
Position (np.int64(28), np.int64(6), np.int64(87)): arr1 = -0.055664, arr2 = -0.050293, Diff = 0.005371
Position (np.int64(60), np.int64(3), np.int64(46)): arr1 = -0.075684, arr2 = -0.070801, Diff = 0.004883
Position (np.int64(19), np.int64(1), np.int64(82)): arr1 = 0.008362, arr2 = 0.003677, Diff = 0.004684
Position (np.int64(0), np.int64(7), np.int64(98)): arr1 = 0.055420, arr2 = 0.050781, Diff = 0.004639
Position (np.int64(45), np.int64(1), np.int64(51)): arr1 = -0.015320, arr2 = -0.010742, Diff = 0.004578

Threshold statistics:
[0.0e+00, 1.0e-06): 2592 (3.96%)
[1.0e-06, 1.0e-05): 21 (0.03%)
[1.0e-05, 1.0e-04): 1766 (2.69%)
[1.0e-04, 1.0e-03): 38822 (59.24%)
[1.0e-03, 1.0e-02): 22335 (34.08%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c94814c09d7f313aab47bfd10f72e2b8
triton_output_md5=f39737eb76d0c3ed5489203ee655c0b4
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(142), np.int64(5), np.int64(97)): arr1 = 0.031738, arr2 = 0.031494, Diff = 0.000244
Position (np.int64(231), np.int64(6), np.int64(45)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(221), np.int64(3), np.int64(18)): arr1 = 0.031494, arr2 = 0.031738, Diff = 0.000244
Position (np.int64(72), np.int64(4), np.int64(22)): arr1 = -0.036865, arr2 = -0.036621, Diff = 0.000244
Position (np.int64(226), np.int64(5), np.int64(124)): arr1 = -0.032715, arr2 = -0.032471, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 129692 (49.47%)
[1.0e-06, 1.0e-05): 11616 (4.43%)
[1.0e-05, 1.0e-04): 116465 (44.43%)
[1.0e-04, 1.0e-03): 4371 (1.67%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00189208984375
max_diff_thr=0.0018716416088864207

Top differences:
Position (np.int64(253), np.int64(2), np.int64(96)): arr1 = 0.012817, arr2 = 0.010925, Diff = 0.001892
Position (np.int64(113), np.int64(6), np.int64(82)): arr1 = 0.015564, arr2 = 0.013794, Diff = 0.001770
Position (np.int64(24), np.int64(1), np.int64(42)): arr1 = -0.000977, arr2 = -0.002716, Diff = 0.001740
Position (np.int64(240), np.int64(0), np.int64(97)): arr1 = 0.017944, arr2 = 0.016235, Diff = 0.001709
Position (np.int64(142), np.int64(3), np.int64(13)): arr1 = -0.023315, arr2 = -0.021606, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 11046 (4.21%)
[1.0e-06, 1.0e-05): 752 (0.29%)
[1.0e-05, 1.0e-04): 40140 (15.31%)
[1.0e-04, 1.0e-03): 207768 (79.26%)
[1.0e-03, 1.0e-02): 2438 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=89595d4ea99c0735262e09f97a2f93f0
triton_output_md5=ad14df7c36e01b7dd38211a3feec003d
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:[aiter INFO] 2025-09-30 05:13:26.689 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.35753475321403 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:26.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 76, 12, 55, 25}
[aiter INFO] 2025-09-30 05:13:26.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.67899999999997
[aiter INFO] 2025-09-30 05:13:26.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.159
[aiter INFO] 2025-09-30 05:13:26.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.87900000000002
[aiter INFO] 2025-09-30 05:13:26.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.88
[aiter INFO] 2025-09-30 05:13:26.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.40000000000003
[aiter INFO] 2025-09-30 05:13:26.765 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 96.0            0.0         12,546.3        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            130.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:26.792 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.94553469755862 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:26.831 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 321, 706, 6}
[aiter INFO] 2025-09-30 05:13:26.831 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000178
[aiter INFO] 2025-09-30 05:13:26.831 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.079000000000178
[aiter INFO] 2025-09-30 05:13:26.831 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.03899999999976
[aiter INFO] 2025-09-30 05:13:26.832 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-30 05:13:26.844 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            544.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:26.845 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   136.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:26.847 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:26.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 267.9109399271484 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {40, 9, 56, 23}
[aiter INFO] 2025-09-30 05:13:27.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 168.039
[aiter INFO] 2025-09-30 05:13:27.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 168.99899999999997
[aiter INFO] 2025-09-30 05:13:27.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.799999999999955
[aiter INFO] 2025-09-30 05:13:27.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000003
[aiter INFO] 2025-09-30 05:13:27.071 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,574.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0         16,500.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       18,258.7              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          182.6            182.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.072 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   182.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:27.309 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 611.4023380940503 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.405 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:27.405 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 515.801
[aiter INFO] 2025-09-30 05:13:27.416 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         51,323.5        CUDA            8
[avg us/iter]                       NaN   NaN            0.0            513.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.665920634966085 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:27.481 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-09-30 05:13:27.493 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,326.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             13.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.495 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   526.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:27.501 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:27.567 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.54029630198337 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {933, 38, 9, 42, 940, 16, 49, 20, 27, 31}
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.71899999999914
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.438999999999965
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.71899999999994
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999214
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.558999999999969
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.79899999999998
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-30 05:13:27.627 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.08000000000004
[aiter INFO] 2025-09-30 05:13:27.646 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            549.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,669.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,446.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           54.5             54.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.647 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    54.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:27.747 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 227.4616835731091 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.809 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 102, 76, 12, 89, 25, 57}
[aiter INFO] 2025-09-30 05:13:27.809 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.88
[aiter INFO] 2025-09-30 05:13:27.809 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.8789999999999
[aiter INFO] 2025-09-30 05:13:27.809 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.83900000000006
[aiter INFO] 2025-09-30 05:13:27.810 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.72
[aiter INFO] 2025-09-30 05:13:27.810 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.24
[aiter INFO] 2025-09-30 05:13:27.810 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.87900000000002
[aiter INFO] 2025-09-30 05:13:27.810 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.87900000000002
[aiter INFO] 2025-09-30 05:13:27.822 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         12,312.7        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            131.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.849 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.67265364026079 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:27.887 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {370, 6, 55}
[aiter INFO] 2025-09-30 05:13:27.887 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 05:13:27.887 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-30 05:13:27.887 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.678999999999974
[aiter INFO] 2025-09-30 05:13:27.899 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            678.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:27.900 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   137.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:27.903 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:28.028 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 122.3405843766609 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.081 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 135, 9, 12, 143, 146, 33, 35, 165, 168, 44, 47, 176, 179, 308, 309, 55, 58, 66, 69, 77, 80, 88, 91, 110, 111}
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.960000000000036
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.119000000000028
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.67900000000003
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.838999999999942
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.198999999999955
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319999999999936
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.638999999999896
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.598999999999705
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999796
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.398999999999887
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999869
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.99899999999991
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.119000000000028
[aiter INFO] 2025-09-30 05:13:28.082 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999833
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59900000000016
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.919000000000096
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000096
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.91899999999987
[aiter INFO] 2025-09-30 05:13:28.083 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000096
[aiter INFO] 2025-09-30 05:13:28.105 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  88.0            0.0          1,289.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  88.0            0.0          1,822.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,553.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.5             35.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:28.105 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:28.294 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.16283122973866 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12}
[aiter INFO] 2025-09-30 05:13:28.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.679999999999836
[aiter INFO] 2025-09-30 05:13:28.345 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.519000000000005
[aiter INFO] 2025-09-30 05:13:28.358 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          4,041.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:28.564 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.71146544401009 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:28.601 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000007
[aiter INFO] 2025-09-30 05:13:28.613 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            570.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:28.614 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:28.623 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:28.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.0799307427784 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 98, 9, 10, 306, 307, 185, 186, 317, 318}
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.439000000000021
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.559000000000026
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.03899999999976
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:28.744 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 05:13:28.763 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            447.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,353.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,883.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.8             18.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:28.764 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(59), np.int64(1), np.int64(9)): arr1 = 0.032471, arr2 = 0.032227, Diff = 0.000244
Position (np.int64(17), np.int64(3), np.int64(77)): arr1 = -0.031494, arr2 = -0.031250, Diff = 0.000244
Position (np.int64(62), np.int64(6), np.int64(74)): arr1 = -0.017334, arr2 = -0.017456, Diff = 0.000122
Position (np.int64(17), np.int64(4), np.int64(118)): arr1 = -0.024170, arr2 = -0.024292, Diff = 0.000122
Position (np.int64(31), np.int64(2), np.int64(86)): arr1 = -0.021851, arr2 = -0.021729, Diff = 0.000122

Threshold statistics:
[0.0e+00, 1.0e-06): 32151 (49.06%)
[1.0e-06, 1.0e-05): 2871 (4.38%)
[1.0e-05, 1.0e-04): 29236 (44.61%)
[1.0e-04, 1.0e-03): 1278 (1.95%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.001708984375
max_diff_thr=0.0016945049865171313

Top differences:
Position (np.int64(21), np.int64(3), np.int64(64)): arr1 = 0.025269, arr2 = 0.023560, Diff = 0.001709
Position (np.int64(58), np.int64(0), np.int64(0)): arr1 = -0.023804, arr2 = -0.022095, Diff = 0.001709
Position (np.int64(15), np.int64(6), np.int64(101)): arr1 = -0.015625, arr2 = -0.013916, Diff = 0.001709
Position (np.int64(31), np.int64(1), np.int64(100)): arr1 = -0.010254, arr2 = -0.008545, Diff = 0.001709
Position (np.int64(33), np.int64(4), np.int64(113)): arr1 = 0.003143, arr2 = 0.001480, Diff = 0.001663

Threshold statistics:
[0.0e+00, 1.0e-06): 2744 (4.19%)
[1.0e-06, 1.0e-05): 168 (0.26%)
[1.0e-05, 1.0e-04): 9854 (15.04%)
[1.0e-04, 1.0e-03): 52056 (79.43%)
[1.0e-03, 1.0e-02): 714 (1.09%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c2e0b9ba7db838e92d27f13af1ba32c5
triton_output_md5=4c55287770176d81d594d1852efedba5
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(26), np.int64(0), np.int64(47)): arr1 = -0.037109, arr2 = -0.037354, Diff = 0.000244
Position (np.int64(95), np.int64(3), np.int64(41)): arr1 = -0.031494, arr2 = -0.031738, Diff = 0.000244
Position (np.int64(226), np.int64(2), np.int64(13)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(84), np.int64(4), np.int64(58)): arr1 = -0.033936, arr2 = -0.034180, Diff = 0.000244
Position (np.int64(209), np.int64(5), np.int64(85)): arr1 = -0.036377, arr2 = -0.036133, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 129425 (49.37%)
[1.0e-06, 1.0e-05): 11743 (4.48%)
[1.0e-05, 1.0e-04): 116570 (44.47%)
[1.0e-04, 1.0e-03): 4406 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0018310546875
max_diff_thr=0.0017976989038288593

Top differences:
Position (np.int64(52), np.int64(4), np.int64(50)): arr1 = -0.026978, arr2 = -0.025146, Diff = 0.001831
Position (np.int64(140), np.int64(4), np.int64(15)): arr1 = -0.020386, arr2 = -0.018555, Diff = 0.001831
Position (np.int64(33), np.int64(7), np.int64(4)): arr1 = 0.022949, arr2 = 0.021240, Diff = 0.001709
Position (np.int64(248), np.int64(2), np.int64(5)): arr1 = -0.007324, arr2 = -0.009033, Diff = 0.001709
Position (np.int64(106), np.int64(4), np.int64(80)): arr1 = -0.042236, arr2 = -0.040527, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 11110 (4.24%)
[1.0e-06, 1.0e-05): 770 (0.29%)
[1.0e-05, 1.0e-04): 39651 (15.13%)
[1.0e-04, 1.0e-03): 208188 (79.42%)
[1.0e-03, 1.0e-02): 2425 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=819e5f7cc8e903da663dde89cf42b1f3
triton_output_md5=842e4ca126a41debc3fffff2803e1e23
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

Top differences:
Position (np.int64(62), np.int64(1), np.int64(115)): arr1 = -0.031738, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(14), np.int64(0), np.int64(99)): arr1 = -0.031982, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(41), np.int64(1), np.int64(32)): arr1 = 0.035156, arr2 = 0.035400, Diff = 0.000244
Position (np.int64(37), np.int64(0), np.int64(27)): arr1 = 0.031250, arr2 = 0.031494, Diff = 0.000244
Position (np.int64(53), np.int64(5), np.int64(18)): arr1 = -0.036377, arr2 = -0.036133, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 32835 (50.10%)
[1.0e-06, 1.0e-05): 2783 (4.25%)
[1.0e-05, 1.0e-04): 28732 (43.84%)
[1.0e-04, 1.0e-03): 1186 (1.81%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0015869140625
max_diff_thr=0.0015662650112062693

Top differences:
Position (np.int64(10), np.int64(4), np.int64(76)): arr1 = 0.014771, arr2 = 0.013184, Diff = 0.001587
Position (np.int64(2), np.int64(2), np.int64(107)): arr1 = -0.021729, arr2 = -0.020142, Diff = 0.001587
Position (np.int64(39), np.int64(2), np.int64(59)): arr1 = -0.004272, arr2 = -0.002716, Diff = 0.001556
Position (np.int64(46), np.int64(2), np.int64(71)): arr1 = -0.016968, arr2 = -0.015442, Diff = 0.001526
Position (np.int64(63), np.int64(1), np.int64(22)): arr1 = 0.008545, arr2 = 0.007050, Diff = 0.001495

Threshold statistics:
[0.0e+00, 1.0e-06): 2700 (4.12%)
[1.0e-06, 1.0e-05): 207 (0.32%)
[1.0e-05, 1.0e-04): 9884 (15.08%)
[1.0e-04, 1.0e-03): 52116 (79.52%)
[1.0e-03, 1.0e-02): 629 (0.96%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=25e20a2864b0e0642ee8d80725df69a1
triton_output_md5=54af650152092e438ac385cfb00d35dc
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(78), np.int64(2), np.int64(118)): arr1 = 0.546875, arr2 = 0.542969, Diff = 0.003906
Position (np.int64(222), np.int64(4), np.int64(111)): arr1 = 0.550781, arr2 = 0.554688, Diff = 0.003906
Position (np.int64(164), np.int64(9), np.int64(88)): arr1 = 0.527344, arr2 = 0.531250, Diff = 0.003906
Position (np.int64(180), np.int64(5), np.int64(105)): arr1 = 0.519531, arr2 = 0.523438, Diff = 0.003906
Position (np.int64(98), np.int64(4), np.int64(89)): arr1 = -0.550781, arr2 = -0.554688, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 192466 (58.74%)
[1.0e-06, 1.0e-05): 36 (0.01%)
[1.0e-05, 1.0e-04): 2711 (0.83%)
[1.0e-04, 1.0e-03): 115536 (35.26%)
[1.0e-03, 1.0e-02): 16931 (5.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0390625
max_diff_thr=0.0372738242149353

Top differences:
Position (np.int64(93), np.int64(5), np.int64(81)): arr1 = 0.710938, arr2 = 0.671875, Diff = 0.039062
Position (np.int64(224), np.int64(3), np.int64(46)): arr1 = -0.451172, arr2 = -0.412109, Diff = 0.039062
Position (np.int64(64), np.int64(6), np.int64(9)): arr1 = -0.423828, arr2 = -0.384766, Diff = 0.039062
Position (np.int64(208), np.int64(5), np.int64(11)): arr1 = 0.010986, arr2 = 0.049805, Diff = 0.038818
Position (np.int64(64), np.int64(6), np.int64(19)): arr1 = 0.025757, arr2 = -0.011963, Diff = 0.037720

Threshold statistics:
[0.0e+00, 1.0e-06): 13996 (4.27%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 143 (0.04%)
[1.0e-04, 1.0e-03): 22084 (6.74%)
[1.0e-03, 1.0e-02): 211675 (64.60%)
[1.0e-02, 1.0e-01): 79782 (24.35%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e6bf46e05ebc885822ea8a0e7c84895c
triton_output_md5=b4bb5ffc238c0438aec4c3f7efab68b6
diff.abs.max=0.00390625
max_diff_thr=0.0026041667442768812

Top differences:
Position (np.int64(32), np.int64(0), np.int64(95)): arr1 = -0.738281, arr2 = -0.742188, Diff = 0.003906
Position (np.int64(41), np.int64(7), np.int64(73)): arr1 = 0.625000, arr2 = 0.621094, Diff = 0.003906[aiter INFO] 2025-09-30 05:13:28.853 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.57422766236976 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-09-30 05:13:28.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.198999999999955
[aiter INFO] 2025-09-30 05:13:28.915 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839
[aiter INFO] 2025-09-30 05:13:28.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,140.6        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:28.955 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.53087130454507 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:28.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {314, 6}
[aiter INFO] 2025-09-30 05:13:28.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.1589999999996508
[aiter INFO] 2025-09-30 05:13:28.995 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-30 05:13:29.007 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            368.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.008 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:29.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:29.136 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 121.8672969406194 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 64, 66, 9, 812, 12, 815, 20, 53, 21, 119, 56, 122, 31}
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19900000000007
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.718999999999994
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.638999999999214
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.35899999999998
[aiter INFO] 2025-09-30 05:13:29.191 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:29.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:29.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71900000000005
[aiter INFO] 2025-09-30 05:13:29.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:29.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-09-30 05:13:29.192 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.678999999999974
[aiter INFO] 2025-09-30 05:13:29.211 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0          1,378.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0          1,949.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,556.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.6             35.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.212 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.41 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:29.396 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.0134951466381 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.448 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1013}
[aiter INFO] 2025-09-30 05:13:29.448 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.59899999999999
[aiter INFO] 2025-09-30 05:13:29.448 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.95899999999983
[aiter INFO] 2025-09-30 05:13:29.461 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          4,042.0        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             40.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.489 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.573623694995845 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {482, 6, 503}
[aiter INFO] 2025-09-30 05:13:29.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999651
[aiter INFO] 2025-09-30 05:13:29.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-30 05:13:29.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999596
[aiter INFO] 2025-09-30 05:13:29.537 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            558.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.539 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:29.547 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:29.609 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.27162359374584 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {768, 97, 98, 769, 9, 10}
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999505
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999933
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-09-30 05:13:29.667 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-30 05:13:29.686 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            458.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,374.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,870.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.7             18.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.687 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.71 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:29.775 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.0019409255226 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.833 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1221, 675, 12, 493}
[aiter INFO] 2025-09-30 05:13:29.834 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.638999999999214
[aiter INFO] 2025-09-30 05:13:29.834 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.15899999999965
[aiter INFO] 2025-09-30 05:13:29.834 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:29.834 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.159000000000106
[aiter INFO] 2025-09-30 05:13:29.846 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 97.0            0.0          2,093.5        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.873 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.28097031110585 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:29.911 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:29.911 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-30 05:13:29.923 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            373.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:29.924 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:29.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:30.050 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 121.4138416960688 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 23, 152, 155, 31, 34, 42, 45, 53, 56, 64, 67, 75, 78, 1109, 86, 1110, 89, 97, 100, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.238999999999805
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639000000000124
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.959000000000003
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-30 05:13:30.279 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.11899999999997
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559000000000083
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.599000000000046
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.559000000000083
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999933
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.759000000000015
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.99899999999991
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.519000000000233
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999833
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.318999999999505
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559000000000196
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.479000000000042
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639000000000124
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.83900000000017
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839999999999918
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19899999999984
[aiter INFO] 2025-09-30 05:13:30.280 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-30 05:13:30.299 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  87.0            0.0          1,275.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  87.0            0.0          1,788.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,543.9              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.4             35.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:30.300 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:30.487 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.48912845625736 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:30.540 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:30.540 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.519000000000005
[aiter INFO] 2025-09-30 05:13:30.552 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,068.0        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:30.581 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.685712885148455 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:30.617 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:30.617 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.438999999999993
[aiter INFO] 2025-09-30 05:13:30.629 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            568.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:30.630 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:30.638 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:30.700 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.81539580904611 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {548, 549, 9, 10, 1021, 1022}
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.198999999999614
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15899999999965
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59899999999999
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999287
[aiter INFO] 2025-09-30 05:13:30.761 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-30 05:13:30.780 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            458.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,379.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,879.4              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.8             18.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:30.781 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(39), np.int64(5), np.int64(95)): arr1 = 0.503906, arr2 = 0.507812, Diff = 0.003906
Position (np.int64(11), np.int64(9), np.int64(104)): arr1 = 0.523438, arr2 = 0.527344, Diff = 0.003906
Position (np.int64(14), np.int64(8), np.int64(0)): arr1 = -0.527344, arr2 = -0.523438, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 48343 (59.01%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 752 (0.92%)
[1.0e-04, 1.0e-03): 28703 (35.04%)
[1.0e-03, 1.0e-02): 4116 (5.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0390625
max_diff_thr=0.030588235706090927

Top differences:
Position (np.int64(42), np.int64(7), np.int64(17)): arr1 = -0.593750, arr2 = -0.554688, Diff = 0.039062
Position (np.int64(28), np.int64(7), np.int64(29)): arr1 = 0.283203, arr2 = 0.245117, Diff = 0.038086
Position (np.int64(46), np.int64(4), np.int64(51)): arr1 = 0.488281, arr2 = 0.453125, Diff = 0.035156
Position (np.int64(22), np.int64(4), np.int64(78)): arr1 = 0.777344, arr2 = 0.742188, Diff = 0.035156
Position (np.int64(10), np.int64(7), np.int64(22)): arr1 = 0.161133, arr2 = 0.127930, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 3510 (4.28%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 27 (0.03%)
[1.0e-04, 1.0e-03): 5493 (6.71%)
[1.0e-03, 1.0e-02): 53059 (64.77%)
[1.0e-02, 1.0e-01): 19831 (24.21%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4044f89429330728b9059f3892527941
triton_output_md5=8cc2cb1e90042c68a5445a8968981151
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(222), np.int64(7), np.int64(103)): arr1 = 0.271484, arr2 = 0.269531, Diff = 0.001953
Position (np.int64(54), np.int64(0), np.int64(73)): arr1 = 0.322266, arr2 = 0.320312, Diff = 0.001953
Position (np.int64(244), np.int64(3), np.int64(78)): arr1 = -0.279297, arr2 = -0.277344, Diff = 0.001953
Position (np.int64(127), np.int64(8), np.int64(50)): arr1 = -0.283203, arr2 = -0.281250, Diff = 0.001953
Position (np.int64(28), np.int64(5), np.int64(104)): arr1 = 0.275391, arr2 = 0.273438, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 189366 (57.79%)
[1.0e-06, 1.0e-05): 141 (0.04%)
[1.0e-05, 1.0e-04): 9999 (3.05%)
[1.0e-04, 1.0e-03): 127113 (38.79%)
[1.0e-03, 1.0e-02): 1061 (0.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0244140625
max_diff_thr=0.022371364757418633

Top differences:
Position (np.int64(115), np.int64(8), np.int64(19)): arr1 = -0.115723, arr2 = -0.091309, Diff = 0.024414
Position (np.int64(70), np.int64(9), np.int64(63)): arr1 = 0.140625, arr2 = 0.117676, Diff = 0.022949
Position (np.int64(125), np.int64(3), np.int64(10)): arr1 = 0.255859, arr2 = 0.234375, Diff = 0.021484
Position (np.int64(242), np.int64(8), np.int64(7)): arr1 = -0.055176, arr2 = -0.034180, Diff = 0.020996
Position (np.int64(199), np.int64(5), np.int64(34)): arr1 = -0.242188, arr2 = -0.221680, Diff = 0.020508

Threshold statistics:
[0.0e+00, 1.0e-06): 13866 (4.23%)
[1.0e-06, 1.0e-05): 8 (0.00%)
[1.0e-05, 1.0e-04): 489 (0.15%)
[1.0e-04, 1.0e-03): 51735 (15.79%)
[1.0e-03, 1.0e-02): 250619 (76.48%)
[1.0e-02, 1.0e-01): 10963 (3.35%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ecfe119de602f8e9d7a709892032421e
triton_output_md5=970b130ef3bf3d0a322a3a4a5b78867b
diff.abs.max=0.001953125
max_diff_thr=0.0015625000232830644

Top differences:
Position (np.int64(1), np.int64(9), np.int64(88)): arr1 = -0.269531, arr2 = -0.271484, Diff = 0.001953
Position (np.int64(8), np.int64(4), np.int64(59)): arr1 = -0.250000, arr2 = -0.251953, Diff = 0.001953
Position (np.int64(14), np.int64(4), np.int64(52)): arr1 = 0.296875, arr2 = 0.294922, Diff = 0.001953
Position (np.int64(52), np.int64(0), np.int64(67)): arr1 = 0.363281, arr2 = 0.361328, Diff = 0.001953
Position (np.int64(1), np.int64(7), np.int64(35)): arr1 = -0.261719, arr2 = -0.263672, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 47604 (58.11%)
[1.0e-06, 1.0e-05): 37 (0.05%)
[1.0e-05, 1.0e-04): 2505 (3.06%)
[1.0e-04, 1.0e-03): 31467 (38.41%)
[1.0e-03, 1.0e-02): 307 (0.37%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.02001953125
max_diff_thr=0.018653322011232376

Top differences:
Position (np.int64(25), np.int64(9), np.int64(3)): arr1 = 0.093262, arr2 = 0.073242, Diff = 0.020020
Position (np.int64(49), np.int64(3), np.int64(63)): arr1 = 0.233398, arr2 = 0.213867, Diff = 0.019531
Position (np.int64(41), np.int64(4), np.int64(88)): arr1 = -0.265625, arr2 = -0.246094, Diff = 0.019531
Position (np.int64(24), np.int64(6), np.int64(28)): arr1 = 0.083984, arr2 = 0.064941, Diff = 0.019043
Position (np.int64(18), np.int64(6), np.int64(73)): arr1 = -0.259766, arr2 = -0.241211, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 3482 (4.25%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 116 (0.14%)
[1.0e-04, 1.0e-03): 12865 (15.70%)
[1.0e-03, 1.0e-02): 62630 (76.45%)
[1.0e-02, 1.0e-01): 2826 (3.45%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fa3ed7e2844942fe8f099b717f479909
triton_output_md5=82a9db9c940bfb3493511f5b929886ae
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(90), np.int64(7), np.int64(21)): arr1 = -0.275391, arr2 = -0.273438, Diff = 0.001953
Position (np.int64(31), np.int64(5), np.int64(117)): arr1 = -0.261719, arr2 = -0.263672, Diff = 0.001953
Position (np.int64(91), np.int64(9), np.int64(115)): arr1 = -0.271484, arr2 = -0.273438, Diff = 0.001953
Position (np.int64(228), np.int64(6), np.int64(122)): arr1 = 0.259766, arr2 = 0.257812, Diff = 0.001953
Position (np.int64(187), np.int64(3), np.int64(119)): arr1 = 0.257812, arr2 = 0.259766, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 188219 (57.44%)
[1.0e-06, 1.0e-05): 307 (0.09%)
[1.0e-05, 1.0e-04): 20395 (6.22%)
[1.0e-04, 1.0e-03): 118726 (36.23%)
[1.0e-03, 1.0e-02): 33 (0.01%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01708984375
max_diff_thr=0.01580849103629589

Top differences:
Position (np.int64(123), np.int64(5), np.int64(29)): arr1 = 0.098145, arr2 = 0.081055, Diff = 0.017090
Position (np.int64(49), np.int64(4), np.int64(107)): arr1 = -0.269531, arr2 = -0.253906, Diff = 0.015625
Position (np.int64(56), np.int64(9), np.int64(115)): arr1 = -0.235352, arr2 = -0.220703, Diff = 0.014648
Position (np.int64(171), np.int64(7), np.int64(28)): arr1 = -0.152344, arr2 = -0.137695, Diff = 0.014648
Position (np.int64(86), np.int64(4), np.int64(114)): arr1 = -0.032959, arr2 = -0.019043, Diff = 0.013916

Threshold statistics:
[0.0e+00, 1.0e-06): 13295 (4.06%)
[1.0e-06, 1.0e-05): 10 (0.00%)
[1.0e-05, 1.0e-04): 1058 (0.32%)
[1.0e-04, 1.0e-03): 75994 (23.19%)
[1.0e-03, 1.0e-02): 236654 (72.22%)
[1.0e-02, 1.0e-01): 669 (0.20%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4bcf1db87a33a8ba890f9c0151041c0f
triton_output_md5=4a5ee5969d9a4274f905452cfee4dfcc
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(52), np.int64(7), np.int64(45)): arr1 = -0.275391, arr2 = -0.277344, Diff = 0.001953
Position (np.int64(28), np.int64(6), np.int64(21)): arr1 = -0.269531, arr2 = -0.267578, Diff = 0.001953
Position (np.int64(18), np.int64(4), np.int64(109)): arr1 = -0.263672, arr2 = -0.265625, Diff = 0.001953
Position (np.int64(52), np.int64(0), np.int64(45)): arr1 = -0.289062, arr2 = -0.287109, Diff = 0.001953[aiter INFO] 2025-09-30 05:13:30.870 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.90212871237557 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:30.933 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:30.933 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.998999999999967
[aiter INFO] 2025-09-30 05:13:30.946 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,153.4        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:30.973 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.40729697063418 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.013 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:31.013 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-30 05:13:31.025 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            372.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:31.027 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:31.029 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:31.154 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 122.62971264005888 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 20, 23, 31, 34, 163, 166, 42, 45, 174, 177, 53, 56, 64, 67, 196, 199, 75, 78, 207, 210, 86, 89, 97, 100, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.038999999999987
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.038999999999987
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.438999999999965
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.758999999999787
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999833
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.679000000000087
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999869
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.359000000000037
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-09-30 05:13:31.209 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999992
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.959000000000287
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59900000000016
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.478999999999928
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559000000000196
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000005
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319000000000187
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839999999999918
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19900000000007
[aiter INFO] 2025-09-30 05:13:31.210 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-30 05:13:31.229 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  85.0            0.0          1,246.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  85.0            0.0          1,761.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,563.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.6             35.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:31.230 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:31.417 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.0356833096778 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.470 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:31.470 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.91900000000004
[aiter INFO] 2025-09-30 05:13:31.482 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,078.4        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:31.510 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.945118901458116 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.545 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:31.545 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-30 05:13:31.557 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            570.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:31.559 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:31.567 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:31.629 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.96549491481025 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {196, 197, 9, 10, 427, 428}
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000487
[aiter INFO] 2025-09-30 05:13:31.685 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999687
[aiter INFO] 2025-09-30 05:13:31.704 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            457.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,381.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,878.4              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.8             18.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:31.705 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:31.795 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.07796052717927 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:31.852 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:31.852 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.87899999999999
[aiter INFO] 2025-09-30 05:13:31.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,160.9        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.092 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 65.39149504929486 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.132 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:32.132 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:32.144 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            374.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.145 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:32.148 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:32.274 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 121.98136643608018 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 42, 10, 45, 53, 86, 56, 89}
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.99899999999991
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.478999999999985
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999919
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.599000000000046
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.480000000000018
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559999999999945
[aiter INFO] 2025-09-30 05:13:32.329 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:32.348 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,422.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          2,018.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,552.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.5             35.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.349 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.47 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:32.536 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.33427721202963 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.591 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:32.591 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.519000000000005
[aiter INFO] 2025-09-30 05:13:32.603 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,077.6        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.632 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.8655050216925 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.669 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:32.669 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.438999999999993
[aiter INFO] 2025-09-30 05:13:32.681 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            570.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.682 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:32.690 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:32.753 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.91007841223536 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 823, 845, 846, 438, 439, 824, 350, 351}
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999965
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599999999999966
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.518999999998414
[aiter INFO] 2025-09-30 05:13:32.812 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-30 05:13:32.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.47900000000027
[aiter INFO] 2025-09-30 05:13:32.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:32.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999141
[aiter INFO] 2025-09-30 05:13:32.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.400000000000091
[aiter INFO] 2025-09-30 05:13:32.813 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 05:13:32.832 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            449.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          1,341.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,865.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.7             18.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:32.833 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.65 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

Position (np.int64(55), np.int64(5), np.int64(82)): arr1 = 0.259766, arr2 = 0.261719, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 47102 (57.50%)
[1.0e-06, 1.0e-05): 75 (0.09%)
[1.0e-05, 1.0e-04): 5046 (6.16%)
[1.0e-04, 1.0e-03): 29682 (36.23%)
[1.0e-03, 1.0e-02): 15 (0.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01434326171875
max_diff_thr=0.01419596467167139

Top differences:
Position (np.int64(34), np.int64(1), np.int64(18)): arr1 = -0.003967, arr2 = 0.010376, Diff = 0.014343
Position (np.int64(19), np.int64(5), np.int64(21)): arr1 = 0.089844, arr2 = 0.075684, Diff = 0.014160
Position (np.int64(54), np.int64(6), np.int64(20)): arr1 = 0.101562, arr2 = 0.087891, Diff = 0.013672
Position (np.int64(56), np.int64(3), np.int64(59)): arr1 = -0.178711, arr2 = -0.165039, Diff = 0.013672
Position (np.int64(49), np.int64(4), np.int64(126)): arr1 = 0.147461, arr2 = 0.133789, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 3370 (4.11%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 252 (0.31%)
[1.0e-04, 1.0e-03): 18857 (23.02%)
[1.0e-03, 1.0e-02): 59256 (72.33%)
[1.0e-02, 1.0e-01): 182 (0.22%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f554222613068c99f983ed329874dedd
triton_output_md5=ff320e1ea57d6b2036f2d571c088bc85
diff.abs.max=0.001953125
max_diff_thr=0.0015600624028593302

Top differences:
Position (np.int64(116), np.int64(7), np.int64(54)): arr1 = 0.316406, arr2 = 0.314453, Diff = 0.001953
Position (np.int64(9), np.int64(0), np.int64(105)): arr1 = 0.265625, arr2 = 0.263672, Diff = 0.001953
Position (np.int64(79), np.int64(5), np.int64(68)): arr1 = -0.251953, arr2 = -0.253906, Diff = 0.001953
Position (np.int64(116), np.int64(1), np.int64(54)): arr1 = 0.330078, arr2 = 0.332031, Diff = 0.001953
Position (np.int64(78), np.int64(8), np.int64(68)): arr1 = -0.253906, arr2 = -0.251953, Diff = 0.001953

Threshold statistics:
[0.0e+00, 1.0e-06): 188375 (57.49%)
[1.0e-06, 1.0e-05): 358 (0.11%)
[1.0e-05, 1.0e-04): 22911 (6.99%)
[1.0e-04, 1.0e-03): 116028 (35.41%)
[1.0e-03, 1.0e-02): 8 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0146484375
max_diff_thr=0.012842466123402119

Top differences:
Position (np.int64(222), np.int64(8), np.int64(82)): arr1 = 0.243164, arr2 = 0.228516, Diff = 0.014648
Position (np.int64(154), np.int64(5), np.int64(120)): arr1 = -0.219727, arr2 = -0.205078, Diff = 0.014648
Position (np.int64(170), np.int64(0), np.int64(80)): arr1 = 0.155273, arr2 = 0.140625, Diff = 0.014648
Position (np.int64(115), np.int64(5), np.int64(88)): arr1 = 0.267578, arr2 = 0.253906, Diff = 0.013672
Position (np.int64(118), np.int64(4), np.int64(125)): arr1 = 0.143555, arr2 = 0.129883, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 13459 (4.11%)
[1.0e-06, 1.0e-05): 17 (0.01%)
[1.0e-05, 1.0e-04): 1171 (0.36%)
[1.0e-04, 1.0e-03): 81271 (24.80%)
[1.0e-03, 1.0e-02): 231452 (70.63%)
[1.0e-02, 1.0e-01): 310 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8c00f39e2c6042e77418169f15b0bf36
triton_output_md5=6838b1fd83b67398ed41e62382ab8b43
diff.abs.max=0.001953125
max_diff_thr=0.0015455950051546097

Top differences:
Position (np.int64(8), np.int64(9), np.int64(69)): arr1 = 0.261719, arr2 = 0.263672, Diff = 0.001953
Position (np.int64(34), np.int64(2), np.int64(9)): arr1 = 0.267578, arr2 = 0.265625, Diff = 0.001953
Position (np.int64(57), np.int64(7), np.int64(12)): arr1 = 0.136719, arr2 = 0.135742, Diff = 0.000977
Position (np.int64(8), np.int64(8), np.int64(96)): arr1 = -0.168945, arr2 = -0.169922, Diff = 0.000977
Position (np.int64(14), np.int64(6), np.int64(62)): arr1 = -0.140625, arr2 = -0.139648, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 46936 (57.29%)
[1.0e-06, 1.0e-05): 91 (0.11%)
[1.0e-05, 1.0e-04): 5730 (6.99%)
[1.0e-04, 1.0e-03): 29161 (35.60%)
[1.0e-03, 1.0e-02): 2 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0126953125
max_diff_thr=0.012169435620307922

Top differences:
Position (np.int64(0), np.int64(7), np.int64(104)): arr1 = -0.126953, arr2 = -0.114258, Diff = 0.012695
Position (np.int64(49), np.int64(8), np.int64(44)): arr1 = -0.055908, arr2 = -0.043213, Diff = 0.012695
Position (np.int64(15), np.int64(6), np.int64(73)): arr1 = 0.081543, arr2 = 0.069336, Diff = 0.012207
Position (np.int64(8), np.int64(8), np.int64(46)): arr1 = -0.091797, arr2 = -0.079590, Diff = 0.012207
Position (np.int64(52), np.int64(0), np.int64(118)): arr1 = -0.042236, arr2 = -0.030273, Diff = 0.011963

Threshold statistics:
[0.0e+00, 1.0e-06): 3394 (4.14%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 268 (0.33%)
[1.0e-04, 1.0e-03): 20156 (24.60%)
[1.0e-03, 1.0e-02): 58033 (70.84%)
[1.0e-02, 1.0e-01): 63 (0.08%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=911ebcc0dfb5d9d5239ae69a4893036e
triton_output_md5=fd4b012fdffae73a28b2e2d3d1e281a0
diff.abs.max=0.001953125
max_diff_thr=0.0015455950051546097

Top differences:
Position (np.int64(243), np.int64(5), np.int64(100)): arr1 = 0.261719, arr2 = 0.263672, Diff = 0.001953
Position (np.int64(128), np.int64(8), np.int64(43)): arr1 = -0.158203, arr2 = -0.159180, Diff = 0.000977
Position (np.int64(233), np.int64(2), np.int64(57)): arr1 = -0.153320, arr2 = -0.152344, Diff = 0.000977
Position (np.int64(67), np.int64(3), np.int64(87)): arr1 = 0.138672, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(254), np.int64(6), np.int64(14)): arr1 = 0.152344, arr2 = 0.153320, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 188025 (57.38%)
[1.0e-06, 1.0e-05): 580 (0.18%)
[1.0e-05, 1.0e-04): 35394 (10.80%)
[1.0e-04, 1.0e-03): 103680 (31.64%)
[1.0e-03, 1.0e-02): 1 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0107421875
max_diff_thr=0.010404763743281364

Top differences:
Position (np.int64(116), np.int64(7), np.int64(3)): arr1 = -0.242188, arr2 = -0.231445, Diff = 0.010742
Position (np.int64(185), np.int64(4), np.int64(25)): arr1 = 0.082520, arr2 = 0.071777, Diff = 0.010742
Position (np.int64(254), np.int64(2), np.int64(78)): arr1 = 0.025391, arr2 = 0.014832, Diff = 0.010559
Position (np.int64(76), np.int64(0), np.int64(83)): arr1 = 0.035400, arr2 = 0.025146, Diff = 0.010254
Position (np.int64(133), np.int64(6), np.int64(43)): arr1 = 0.115234, arr2 = 0.104980, Diff = 0.010254

Threshold statistics:
[0.0e+00, 1.0e-06): 13417 (4.09%)
[1.0e-06, 1.0e-05): 21 (0.01%)
[1.0e-05, 1.0e-04): 1939 (0.59%)
[1.0e-04, 1.0e-03): 102629 (31.32%)
[1.0e-03, 1.0e-02): 209666 (63.98%)
[1.0e-02, 1.0e-01): 8 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fbe13c16ff783640b96e5f54bb0932ea
triton_output_md5=2507f039c43046f78b0246fbc6ebc7f2
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(1), np.int64(4), np.int64(105)): arr1 = 0.166992, arr2 = 0.166016, Diff = 0.000977
Position (np.int64(21), np.int64(4), np.int64(82)): arr1 = 0.142578, arr2 = 0.143555, Diff = 0.000977
Position (np.int64(23), np.int64(8), np.int64(72)): arr1 = 0.125977, arr2 = 0.125000, Diff = 0.000977
Position (np.int64(41), np.int64(1), np.int64(63)): arr1 = -0.152344, arr2 = -0.153320, Diff = 0.000977
Position (np.int64(60), np.int64(6), np.int64(41)): arr1 = 0.144531, arr2 = 0.143555, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 47065 (57.45%)[aiter INFO] 2025-09-30 05:13:32.922 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 120.93423742173921 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:32.981 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {961, 12}
[aiter INFO] 2025-09-30 05:13:32.981 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.798999999999978
[aiter INFO] 2025-09-30 05:13:32.981 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000003
[aiter INFO] 2025-09-30 05:13:32.994 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,137.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.021 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.91660390868046 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:33.059 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:33.059 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-30 05:13:33.071 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            374.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.073 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:33.075 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:33.200 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 122.38176248156198 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 141, 144, 20, 21, 152, 155, 31, 34, 163, 166, 42, 45, 53, 56, 64, 67, 196, 199, 75, 78, 207, 210, 86, 89, 97, 100, 108, 111, 119, 122}
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639000000000124
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.35899999999998
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.999000000000024
[aiter INFO] 2025-09-30 05:13:33.253 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.319000000000017
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.879000000000133
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.638999999999896
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.56000000000006
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19900000000007
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.839000000000055
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.639999999999986
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839000000000055
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.478999999999814
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.159000000000106
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.119000000000028
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999633
[aiter INFO] 2025-09-30 05:13:33.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399000000000115
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999905
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.638999999999896
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.838999999999942
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:33.255 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-30 05:13:33.274 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  84.0            0.0          1,231.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  84.0            0.0          1,734.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,555.9              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.6             35.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.274 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:33.472 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.60041567004552 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:33.524 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:33.524 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.478999999999985
[aiter INFO] 2025-09-30 05:13:33.536 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,073.2        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.564 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.747494980545326 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:33.599 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:33.599 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.438999999999993
[aiter INFO] 2025-09-30 05:13:33.612 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            568.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.613 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:33.621 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:33.683 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.24631696113266 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:33.919 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 196, 197}
[aiter INFO] 2025-09-30 05:13:33.919 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-09-30 05:13:33.919 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 05:13:33.919 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000233
[aiter INFO] 2025-09-30 05:13:33.919 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-30 05:13:33.938 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            460.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,389.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,869.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.7             18.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:33.939 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:34.033 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.02966358520017 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-30 05:13:34.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.919000000001688
[aiter INFO] 2025-09-30 05:13:34.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000004
[aiter INFO] 2025-09-30 05:13:34.107 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,143.7        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.136 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.16018813759974 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.176 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:34.176 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-30 05:13:34.188 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            371.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.190 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:34.193 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:34.319 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 122.50134710333136 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.374 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 67, 9, 42, 75, 108, 45, 78, 111, 207, 12, 210, 20, 21, 86, 89}
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999992
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.839
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.439000000000078
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.07900000000018
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999905
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.638999999999896
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.55899999999974
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.319999999999709
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.279999999999973
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-30 05:13:34.375 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999824
[aiter INFO] 2025-09-30 05:13:34.394 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          1,361.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0          1,938.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,559.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           35.6             35.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.395 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    35.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:34.581 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.98102021335376 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.636 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:34.636 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.11899999999997
[aiter INFO] 2025-09-30 05:13:34.648 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          4,079.9        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             40.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.677 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.447673216019524 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.713 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:34.713 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-30 05:13:34.726 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            569.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.727 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    46.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:34.736 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:34.798 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.67915810688888 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:34.858 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1032, 1033, 10, 9}
[aiter INFO] 2025-09-30 05:13:34.858 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.398999999999432
[aiter INFO] 2025-09-30 05:13:34.858 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-30 05:13:34.858 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 05:13:34.858 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999965
[aiter INFO] 2025-09-30 05:13:34.877 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            462.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,393.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,873.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.7             18.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:34.878 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

[1.0e-06, 1.0e-05): 138 (0.17%)
[1.0e-05, 1.0e-04): 8619 (10.52%)
[1.0e-04, 1.0e-03): 26098 (31.86%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.01123046875
max_diff_thr=0.010021786205470562

Top differences:
Position (np.int64(49), np.int64(6), np.int64(124)): arr1 = -0.131836, arr2 = -0.120605, Diff = 0.011230
Position (np.int64(1), np.int64(0), np.int64(19)): arr1 = -0.099609, arr2 = -0.089355, Diff = 0.010254
Position (np.int64(63), np.int64(0), np.int64(124)): arr1 = 0.048340, arr2 = 0.038818, Diff = 0.009521
Position (np.int64(6), np.int64(1), np.int64(83)): arr1 = 0.121582, arr2 = 0.112305, Diff = 0.009277
Position (np.int64(27), np.int64(8), np.int64(126)): arr1 = 0.073730, arr2 = 0.064453, Diff = 0.009277

Threshold statistics:
[0.0e+00, 1.0e-06): 3307 (4.04%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 459 (0.56%)
[1.0e-04, 1.0e-03): 25416 (31.03%)
[1.0e-03, 1.0e-02): 52733 (64.37%)
[1.0e-02, 1.0e-01): 2 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=273bc1e2c178d1b50cc451c921e2d7f5
triton_output_md5=cd90f41d9f6a14827365e624525d8bdc
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(160), np.int64(7), np.int64(11)): arr1 = -0.146484, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(147), np.int64(4), np.int64(59)): arr1 = 0.129883, arr2 = 0.130859, Diff = 0.000977
Position (np.int64(76), np.int64(6), np.int64(66)): arr1 = 0.147461, arr2 = 0.146484, Diff = 0.000977
Position (np.int64(74), np.int64(5), np.int64(118)): arr1 = -0.140625, arr2 = -0.139648, Diff = 0.000977
Position (np.int64(196), np.int64(0), np.int64(75)): arr1 = 0.173828, arr2 = 0.174805, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 189144 (57.72%)
[1.0e-06, 1.0e-05): 658 (0.20%)
[1.0e-05, 1.0e-04): 39646 (12.10%)
[1.0e-04, 1.0e-03): 98232 (29.98%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009765625
max_diff_thr=0.009187447838485241

Top differences:
Position (np.int64(108), np.int64(7), np.int64(124)): arr1 = 0.115234, arr2 = 0.105469, Diff = 0.009766
Position (np.int64(152), np.int64(9), np.int64(44)): arr1 = -0.143555, arr2 = -0.133789, Diff = 0.009766
Position (np.int64(7), np.int64(0), np.int64(12)): arr1 = -0.161133, arr2 = -0.151367, Diff = 0.009766
Position (np.int64(45), np.int64(0), np.int64(82)): arr1 = 0.116699, arr2 = 0.106934, Diff = 0.009766
Position (np.int64(134), np.int64(7), np.int64(98)): arr1 = -0.165039, arr2 = -0.155273, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 13536 (4.13%)
[1.0e-06, 1.0e-05): 31 (0.01%)
[1.0e-05, 1.0e-04): 2244 (0.68%)
[1.0e-04, 1.0e-03): 109970 (33.56%)
[1.0e-03, 1.0e-02): 201899 (61.61%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=78fb33e44ac99c1506c583d92385f00e
triton_output_md5=b6004eeb458afec69b7dd9c3a270cb36
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(2), np.int64(2), np.int64(5)): arr1 = 0.136719, arr2 = 0.137695, Diff = 0.000977
Position (np.int64(60), np.int64(4), np.int64(28)): arr1 = -0.125977, arr2 = -0.125000, Diff = 0.000977
Position (np.int64(17), np.int64(8), np.int64(35)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(63), np.int64(0), np.int64(6)): arr1 = -0.148438, arr2 = -0.147461, Diff = 0.000977
Position (np.int64(13), np.int64(4), np.int64(69)): arr1 = -0.142578, arr2 = -0.143555, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 47583 (58.08%)
[1.0e-06, 1.0e-05): 162 (0.20%)
[1.0e-05, 1.0e-04): 9694 (11.83%)
[1.0e-04, 1.0e-03): 24481 (29.88%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.009521484375
max_diff_thr=0.009057129733264446

Top differences:
Position (np.int64(56), np.int64(5), np.int64(85)): arr1 = 0.060791, arr2 = 0.051270, Diff = 0.009521
Position (np.int64(32), np.int64(8), np.int64(1)): arr1 = 0.045654, arr2 = 0.036377, Diff = 0.009277
Position (np.int64(23), np.int64(1), np.int64(110)): arr1 = 0.055664, arr2 = 0.046387, Diff = 0.009277
Position (np.int64(27), np.int64(0), np.int64(1)): arr1 = -0.055420, arr2 = -0.046387, Diff = 0.009033
Position (np.int64(24), np.int64(2), np.int64(124)): arr1 = 0.171875, arr2 = 0.163086, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 3379 (4.12%)
[1.0e-06, 1.0e-05): 9 (0.01%)
[1.0e-05, 1.0e-04): 579 (0.71%)
[1.0e-04, 1.0e-03): 27688 (33.80%)
[1.0e-03, 1.0e-02): 50265 (61.36%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fde720c52b1f51dba87da31455014802
triton_output_md5=c0495c6f153b7f5f9359a9bdc9a89017
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(4), np.int64(8), np.int64(51)): arr1 = -0.128906, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(183), np.int64(5), np.int64(32)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(181), np.int64(4), np.int64(74)): arr1 = 0.126953, arr2 = 0.125977, Diff = 0.000977
Position (np.int64(183), np.int64(9), np.int64(28)): arr1 = -0.125977, arr2 = -0.125000, Diff = 0.000977
Position (np.int64(10), np.int64(8), np.int64(67)): arr1 = 0.127930, arr2 = 0.126953, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 188177 (57.43%)
[1.0e-06, 1.0e-05): 1359 (0.41%)
[1.0e-05, 1.0e-04): 64381 (19.65%)
[1.0e-04, 1.0e-03): 73763 (22.51%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.006402655970305204

Top differences:
Position (np.int64(27), np.int64(3), np.int64(17)): arr1 = 0.095215, arr2 = 0.088379, Diff = 0.006836
Position (np.int64(7), np.int64(8), np.int64(32)): arr1 = 0.036133, arr2 = 0.029541, Diff = 0.006592
Position (np.int64(241), np.int64(0), np.int64(22)): arr1 = -0.066895, arr2 = -0.060547, Diff = 0.006348
Position (np.int64(203), np.int64(1), np.int64(98)): arr1 = 0.093750, arr2 = 0.087402, Diff = 0.006348
Position (np.int64(8), np.int64(2), np.int64(7)): arr1 = 0.033203, arr2 = 0.026855, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 13335 (4.07%)
[1.0e-06, 1.0e-05): 51 (0.02%)
[1.0e-05, 1.0e-04): 4431 (1.35%)
[1.0e-04, 1.0e-03): 147420 (44.99%)
[1.0e-03, 1.0e-02): 162443 (49.57%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=60a180567c037c3d5f9bef7c4d1bd8d0
triton_output_md5=3e2609d03aa72a6922e66fc4e0686a64
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(11), np.int64(7), np.int64(81)): arr1 = -0.125977, arr2 = -0.126953, Diff = 0.000977
Position (np.int64(39), np.int64(9), np.int64(65)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(31), np.int64(1), np.int64(2)): arr1 = -0.129883, arr2 = -0.130859, Diff = 0.000977
Position (np.int64(6), np.int64(2), np.int64(26)): arr1 = -0.132812, arr2 = -0.133789, Diff = 0.000977
Position (np.int64(11), np.int64(1), np.int64(81)): arr1 = -0.133789, arr2 = -0.132812, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 47297 (57.74%)
[1.0e-06, 1.0e-05): 298 (0.36%)
[1.0e-05, 1.0e-04): 15757 (19.23%)
[1.0e-04, 1.0e-03): 18568 (22.67%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)[aiter INFO] 2025-09-30 05:13:34.970 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.9912473158081 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.029 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 38}
[aiter INFO] 2025-09-30 05:13:35.029 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.998999999999967
[aiter INFO] 2025-09-30 05:13:35.029 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:35.042 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          2,143.1        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             21.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:35.070 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.19302963089235 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.108 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:35.108 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-30 05:13:35.120 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            372.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:35.121 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    25.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:35.124 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:35.249 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.62495055293093 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 67, 9, 42, 13, 46, 20, 53, 23, 57, 31}
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.87900000000002
[aiter INFO] 2025-09-30 05:13:35.302 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.15899999999999
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.19900000000007
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.59899999999999
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.519000000000005
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-30 05:13:35.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.59899999999993
[aiter INFO] 2025-09-30 05:13:35.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,407.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          2,994.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,646.3              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           46.5             46.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:35.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:35.513 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.4345745237747 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.565 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:35.565 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.23999999999995
[aiter INFO] 2025-09-30 05:13:35.577 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          7,687.5        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             76.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:35.607 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.51818813162275 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.843 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {83, 6}
[aiter INFO] 2025-09-30 05:13:35.843 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-30 05:13:35.843 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.599000000000018
[aiter INFO] 2025-09-30 05:13:35.855 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            702.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:35.857 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    83.97 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:35.867 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:35.930 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.72589109911776 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:35.988 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 174, 175, 20, 53, 21, 54}
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.199000000000012
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000033
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.31899999999996
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:35.989 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-30 05:13:36.008 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            452.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,385.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,897.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           19.0             18.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.009 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:36.100 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.965901403734 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.162 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:36.162 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.87900000000002
[aiter INFO] 2025-09-30 05:13:36.175 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,186.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.203 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.095623801545344 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.244 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {475, 6}
[aiter INFO] 2025-09-30 05:13:36.245 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 05:13:36.245 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.039000000000016
[aiter INFO] 2025-09-30 05:13:36.257 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            441.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.258 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    26.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:36.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:36.388 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.9521086452031 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.445 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 42, 12, 46, 20, 23, 31}
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.87900000000002
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.47899999999993
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.399
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-09-30 05:13:36.446 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.839000000000055
[aiter INFO] 2025-09-30 05:13:36.465 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,432.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          3,072.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,651.0              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           46.5             46.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.466 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:36.657 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.24653472758757 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.712 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {233, 12}
[aiter INFO] 2025-09-30 05:13:36.712 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.59900000000016
[aiter INFO] 2025-09-30 05:13:36.712 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.99900000000002
[aiter INFO] 2025-09-30 05:13:36.725 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0          7,602.3        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             76.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.38511884212494 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.788 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {146, 636, 6}
[aiter INFO] 2025-09-30 05:13:36.788 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000087
[aiter INFO] 2025-09-30 05:13:36.788 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.479000000000269
[aiter INFO] 2025-09-30 05:13:36.788 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.919000000000011
[aiter INFO] 2025-09-30 05:13:36.800 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            696.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.801 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    83.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:36.809 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:36.872 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.19003988374578 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:36.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-30 05:13:36.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.840000000000032
[aiter INFO] 2025-09-30 05:13:36.927 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-30 05:13:36.946 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            463.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,427.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,890.8              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           18.9             18.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:36.947 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00830078125
max_diff_thr=0.007552199065685272

Top differences:
Position (np.int64(21), np.int64(7), np.int64(126)): arr1 = 0.107422, arr2 = 0.099121, Diff = 0.008301
Position (np.int64(26), np.int64(2), np.int64(114)): arr1 = 0.051270, arr2 = 0.043945, Diff = 0.007324
Position (np.int64(36), np.int64(6), np.int64(86)): arr1 = -0.038086, arr2 = -0.031006, Diff = 0.007080
Position (np.int64(31), np.int64(3), np.int64(44)): arr1 = -0.113281, arr2 = -0.106445, Diff = 0.006836
Position (np.int64(26), np.int64(8), np.int64(80)): arr1 = -0.057129, arr2 = -0.050781, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 3411 (4.16%)
[1.0e-06, 1.0e-05): 9 (0.01%)
[1.0e-05, 1.0e-04): 1079 (1.32%)
[1.0e-04, 1.0e-03): 37029 (45.20%)
[1.0e-03, 1.0e-02): 40392 (49.31%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7d0a87d733b874ba04f7617baafc7b16
triton_output_md5=7e9fc9f61df69bca9c84fd9aac5cdc4e
diff.abs.max=0.0009765625
max_diff_thr=0.0008680555620230734

Top differences:
Position (np.int64(11), np.int64(8), np.int64(72)): arr1 = 0.128906, arr2 = 0.127930, Diff = 0.000977
Position (np.int64(165), np.int64(3), np.int64(54)): arr1 = -0.128906, arr2 = -0.129883, Diff = 0.000977
Position (np.int64(219), np.int64(1), np.int64(15)): arr1 = 0.129883, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(221), np.int64(6), np.int64(121)): arr1 = 0.130859, arr2 = 0.131836, Diff = 0.000977
Position (np.int64(221), np.int64(0), np.int64(121)): arr1 = 0.136719, arr2 = 0.137695, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 176715 (53.93%)
[1.0e-06, 1.0e-05): 1377 (0.42%)
[1.0e-05, 1.0e-04): 64942 (19.82%)
[1.0e-04, 1.0e-03): 84646 (25.83%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0078125
max_diff_thr=0.007683073170483112

Top differences:
Position (np.int64(21), np.int64(8), np.int64(103)): arr1 = -0.024658, arr2 = -0.016846, Diff = 0.007812
Position (np.int64(99), np.int64(4), np.int64(45)): arr1 = -0.076172, arr2 = -0.068848, Diff = 0.007324
Position (np.int64(108), np.int64(7), np.int64(96)): arr1 = -0.065430, arr2 = -0.058350, Diff = 0.007080
Position (np.int64(235), np.int64(5), np.int64(1)): arr1 = 0.068848, arr2 = 0.061768, Diff = 0.007080
Position (np.int64(161), np.int64(7), np.int64(86)): arr1 = -0.142578, arr2 = -0.135742, Diff = 0.006836

Threshold statistics:
[0.0e+00, 1.0e-06): 13361 (4.08%)
[1.0e-06, 1.0e-05): 58 (0.02%)
[1.0e-05, 1.0e-04): 4530 (1.38%)
[1.0e-04, 1.0e-03): 149206 (45.53%)
[1.0e-03, 1.0e-02): 160525 (48.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=72478f70a46e76bd9924380ca5c51e6d
triton_output_md5=9d8765f4a75d2427b6c793b833830b1f
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(57), np.int64(5), np.int64(51)): arr1 = 0.134766, arr2 = 0.135742, Diff = 0.000977
Position (np.int64(6), np.int64(5), np.int64(19)): arr1 = 0.138672, arr2 = 0.139648, Diff = 0.000977
Position (np.int64(25), np.int64(5), np.int64(76)): arr1 = -0.149414, arr2 = -0.150391, Diff = 0.000977
Position (np.int64(47), np.int64(2), np.int64(29)): arr1 = -0.129883, arr2 = -0.128906, Diff = 0.000977
Position (np.int64(55), np.int64(6), np.int64(1)): arr1 = -0.140625, arr2 = -0.139648, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 44161 (53.91%)
[1.0e-06, 1.0e-05): 350 (0.43%)
[1.0e-05, 1.0e-04): 15995 (19.53%)
[1.0e-04, 1.0e-03): 21414 (26.14%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0068359375
max_diff_thr=0.006583138834685087

Top differences:
Position (np.int64(33), np.int64(8), np.int64(122)): arr1 = -0.145508, arr2 = -0.138672, Diff = 0.006836
Position (np.int64(54), np.int64(8), np.int64(28)): arr1 = 0.075195, arr2 = 0.068359, Diff = 0.006836
Position (np.int64(57), np.int64(4), np.int64(51)): arr1 = 0.146484, arr2 = 0.139648, Diff = 0.006836
Position (np.int64(9), np.int64(4), np.int64(61)): arr1 = -0.012573, arr2 = -0.005951, Diff = 0.006622
Position (np.int64(14), np.int64(0), np.int64(72)): arr1 = 0.041260, arr2 = 0.034668, Diff = 0.006592

Threshold statistics:
[0.0e+00, 1.0e-06): 3208 (3.92%)
[1.0e-06, 1.0e-05): 13 (0.02%)
[1.0e-05, 1.0e-04): 1098 (1.34%)
[1.0e-04, 1.0e-03): 37078 (45.26%)
[1.0e-03, 1.0e-02): 40523 (49.47%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=157b0a0d10d159b02ae2ba51a8d6c1a4
triton_output_md5=52d6751ebd842be7d5e76f9550e232d5
diff.abs.max=0.0009765625
max_diff_thr=0.0008673027041368186

Top differences:
Position (np.int64(125), np.int64(0), np.int64(113)): arr1 = 0.141602, arr2 = 0.142578, Diff = 0.000977
Position (np.int64(133), np.int64(1), np.int64(62)): arr1 = 0.129883, arr2 = 0.128906, Diff = 0.000977
Position (np.int64(46), np.int64(8), np.int64(8)): arr1 = 0.133789, arr2 = 0.134766, Diff = 0.000977
Position (np.int64(14), np.int64(1), np.int64(70)): arr1 = 0.125977, arr2 = 0.126953, Diff = 0.000977
Position (np.int64(89), np.int64(6), np.int64(92)): arr1 = 0.125000, arr2 = 0.125977, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 165307 (50.45%)
[1.0e-06, 1.0e-05): 1334 (0.41%)
[1.0e-05, 1.0e-04): 65977 (20.13%)
[1.0e-04, 1.0e-03): 95062 (29.01%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.006591796875
max_diff_thr=0.006568943616002798

Top differences:
Position (np.int64(156), np.int64(0), np.int64(90)): arr1 = -0.010071, arr2 = -0.003479, Diff = 0.006592
Position (np.int64(104), np.int64(2), np.int64(25)): arr1 = -0.000011, arr2 = 0.006500, Diff = 0.006512
Position (np.int64(6), np.int64(3), np.int64(25)): arr1 = -0.074707, arr2 = -0.068359, Diff = 0.006348
Position (np.int64(93), np.int64(6), np.int64(106)): arr1 = -0.076660, arr2 = -0.070312, Diff = 0.006348
Position (np.int64(200), np.int64(0), np.int64(33)): arr1 = -0.047363, arr2 = -0.041016, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 13394 (4.09%)
[1.0e-06, 1.0e-05): 56 (0.02%)
[1.0e-05, 1.0e-04): 4809 (1.47%)
[1.0e-04, 1.0e-03): 154460 (47.14%)
[1.0e-03, 1.0e-02): 154961 (47.29%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f59dc2d26abb1ba0f21a295655b5d5d4
triton_output_md5=0a96656a8b6d1110b153ff5e6c73e165
diff.abs.max=0.0009765625
max_diff_thr=0.000866551126819104

Top differences:
Position (np.int64(50), np.int64(4), np.int64(87)): arr1 = -0.130859, arr2 = -0.129883, Diff = 0.000977
Position (np.int64(54), np.int64(4), np.int64(65)): arr1 = 0.125977, arr2 = 0.126953, Diff = 0.000977
Position (np.int64(32), np.int64(6), np.int64(12)): arr1 = -0.126953, arr2 = -0.127930, Diff = 0.000977
Position (np.int64(21), np.int64(1), np.int64(80)): arr1 = -0.130859, arr2 = -0.131836, Diff = 0.000977
Position (np.int64(21), np.int64(9), np.int64(80)): arr1 = -0.135742, arr2 = -0.136719, Diff = 0.000977

Threshold statistics:
[0.0e+00, 1.0e-06): 41468 (50.62%)
[1.0e-06, 1.0e-05): 311 (0.38%)
[1.0e-05, 1.0e-04): 16180 (19.75%)
[1.0e-04, 1.0e-03): 23961 (29.25%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])[aiter INFO] 2025-09-30 05:13:37.035 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.7033267451985 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:37.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:37.095 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.758999999999986
[aiter INFO] 2025-09-30 05:13:37.107 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,183.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:37.134 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.7934556942765 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:37.172 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {587, 6}
[aiter INFO] 2025-09-30 05:13:37.173 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000815
[aiter INFO] 2025-09-30 05:13:37.173 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.998999999999995
[aiter INFO] 2025-09-30 05:13:37.185 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            441.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:37.186 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    26.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:37.188 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:37.313 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.46773253218964 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 20, 24, 31, 35, 42, 46, 53, 57, 64, 68, 75, 79, 86, 90, 97, 101, 108, 111}
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.87900000000002
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.64000000000004
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.11900000000003
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.91899999999998
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.47899999999993
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.79899999999998
[aiter INFO] 2025-09-30 05:13:37.586 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.43900000000008
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.999000000000024
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.878999999999905
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000096
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.59900000000016
[aiter INFO] 2025-09-30 05:13:37.587 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.118999999999915
[aiter INFO] 2025-09-30 05:13:37.606 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0          1,346.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,876.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        4,659.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           46.6             46.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:37.607 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    46.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:37.797 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.32964346668507 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:37.851 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:37.851 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.03900000000004
[aiter INFO] 2025-09-30 05:13:37.864 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          7,684.4        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             76.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:37.892 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.51860410801255 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:37.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {321, 97, 6, 335}
[aiter INFO] 2025-09-30 05:13:37.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000306
[aiter INFO] 2025-09-30 05:13:37.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000078
[aiter INFO] 2025-09-30 05:13:37.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-30 05:13:37.928 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999851
[aiter INFO] 2025-09-30 05:13:37.940 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            686.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:37.941 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    83.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:37.949 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:38.012 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.86291081716519 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.069 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {240, 241, 11, 9}
[aiter INFO] 2025-09-30 05:13:38.069 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.958999999999833
[aiter INFO] 2025-09-30 05:13:38.069 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:38.069 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-30 05:13:38.069 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999999
[aiter INFO] 2025-09-30 05:13:38.088 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            461.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,430.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,913.2              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           19.1             19.1         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.089 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:38.178 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.93104954049139 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:38.242 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.63899999999998
[aiter INFO] 2025-09-30 05:13:38.254 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          2,186.3        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             21.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.282 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.79066323879922 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:38.322 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.038999999999987
[aiter INFO] 2025-09-30 05:13:38.335 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            446.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.336 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    26.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:38.339 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:38.468 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.13546513448847 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 35, 68, 9, 42, 75, 779, 812, 46, 13, 80, 784, 819, 20, 53, 24, 58, 31}
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.59899999999993
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599000000000046
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719999999999914
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.60000000000002
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.23900000000003
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.79899999999998
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.55999999999949
[aiter INFO] 2025-09-30 05:13:38.525 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.39899999999943
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000008
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.15899999999965
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.838999999999942
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.559000000000026
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.958999999999946
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000096
[aiter INFO] 2025-09-30 05:13:38.526 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.15899999999999
[aiter INFO] 2025-09-30 05:13:38.545 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0          1,355.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  92.0            0.0          3,564.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,363.5              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           53.6             53.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.546 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    53.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:38.739 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.17327779118375 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.793 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:38.793 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.55899999999997
[aiter INFO] 2025-09-30 05:13:38.805 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0          9,617.6        CUDA            8
[avg us/iter]                       NaN   NaN            0.0             96.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.836 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.473059407555226 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:38.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:38.871 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.519000000000005
[aiter INFO] 2025-09-30 05:13:38.883 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            940.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              9.4         NaN          NaN
[aiter INFO] 2025-09-30 05:13:38.885 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   105.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:38.893 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:38.955 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.3512479096356 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 133, 9, 12, 141, 144, 20, 21, 42, 45, 174, 177, 53, 56, 185, 188, 64, 67, 196, 197, 75, 78, 86, 89, 97, 100, 119, 122}
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.358999999999924
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5590000000001965
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.278999999999996
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999896
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000005
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.798999999999978
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.19899999999984
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.158999999999992
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999974
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.639999999999873
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-30 05:13:39.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.079000000000065
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.559000000000196
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999596
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.239000000000033
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.55899999999997
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.67899999999986
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.95900000000006
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.118999999999915
[aiter INFO] 2025-09-30 05:13:39.011 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.559999999999945
[aiter INFO] 2025-09-30 05:13:39.030 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  87.0            0.0            407.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  87.0            0.0          1,769.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,523.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           25.2             25.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:39.031 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    25.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:39.120 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.89624669174157 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:39.178 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12, 77}
[aiter INFO] 2025-09-30 05:13:39.178 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.55899999999997
[aiter INFO] 2025-09-30 05:13:39.178 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.31899999999999
[aiter INFO] 2025-09-30 05:13:39.178 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.519000000000005
[aiter INFO] 2025-09-30 05:13:39.190 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0          3,882.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0             39.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:39.217 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.43858398718409 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:39.435 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:39.435 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-30 05:13:39.447 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            551.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:39.449 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    45.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.00634765625
max_diff_thr=0.005990783218294382

Top differences:
Position (np.int64(4), np.int64(7), np.int64(112)): arr1 = -0.065918, arr2 = -0.059570, Diff = 0.006348
Position (np.int64(21), np.int64(0), np.int64(18)): arr1 = 0.081055, arr2 = 0.074707, Diff = 0.006348
Position (np.int64(11), np.int64(8), np.int64(118)): arr1 = 0.043945, arr2 = 0.037842, Diff = 0.006104
Position (np.int64(19), np.int64(8), np.int64(110)): arr1 = -0.086914, arr2 = -0.081055, Diff = 0.005859
Position (np.int64(15), np.int64(1), np.int64(87)): arr1 = -0.039551, arr2 = -0.033691, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 3473 (4.24%)
[1.0e-06, 1.0e-05): 17 (0.02%)
[1.0e-05, 1.0e-04): 1226 (1.50%)
[1.0e-04, 1.0e-03): 38610 (47.13%)
[1.0e-03, 1.0e-02): 38594 (47.11%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=85f49099426180fc116f94ca2926563c
triton_output_md5=c37665e5fe8e768fadec99adff55aed5
diff.abs.max=0.00048828125
max_diff_thr=0.00046948358067311347

Top differences:
Position (np.int64(175), np.int64(2), np.int64(77)): arr1 = 0.062988, arr2 = 0.063477, Diff = 0.000488
Position (np.int64(181), np.int64(8), np.int64(32)): arr1 = 0.068848, arr2 = 0.068359, Diff = 0.000488
Position (np.int64(17), np.int64(7), np.int64(72)): arr1 = 0.097168, arr2 = 0.096680, Diff = 0.000488
Position (np.int64(54), np.int64(5), np.int64(93)): arr1 = -0.076172, arr2 = -0.076660, Diff = 0.000488
Position (np.int64(201), np.int64(4), np.int64(122)): arr1 = -0.071777, arr2 = -0.072266, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 163653 (49.94%)
[1.0e-06, 1.0e-05): 2266 (0.69%)
[1.0e-05, 1.0e-04): 88566 (27.03%)
[1.0e-04, 1.0e-03): 73195 (22.34%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.005126953125
max_diff_thr=0.005038895178586245

Top differences:
Position (np.int64(198), np.int64(4), np.int64(75)): arr1 = -0.043457, arr2 = -0.038330, Diff = 0.005127
Position (np.int64(1), np.int64(2), np.int64(0)): arr1 = 0.002716, arr2 = -0.002335, Diff = 0.005051
Position (np.int64(222), np.int64(1), np.int64(23)): arr1 = -0.004456, arr2 = 0.000443, Diff = 0.004898
Position (np.int64(53), np.int64(8), np.int64(53)): arr1 = -0.031494, arr2 = -0.026611, Diff = 0.004883
Position (np.int64(60), np.int64(1), np.int64(52)): arr1 = -0.057373, arr2 = -0.052490, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 13475 (4.11%)
[1.0e-06, 1.0e-05): 120 (0.04%)
[1.0e-05, 1.0e-04): 8651 (2.64%)
[1.0e-04, 1.0e-03): 192499 (58.75%)
[1.0e-03, 1.0e-02): 112935 (34.47%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a07995a388a06cdb9f759af3c0164ae6
triton_output_md5=df12ef38a1a758d15ed8eea0c844dfe7
diff.abs.max=0.00048828125
max_diff_thr=0.00047158688539639115

Top differences:
Position (np.int64(41), np.int64(2), np.int64(51)): arr1 = -0.068848, arr2 = -0.068359, Diff = 0.000488
Position (np.int64(20), np.int64(9), np.int64(95)): arr1 = -0.076172, arr2 = -0.075684, Diff = 0.000488
Position (np.int64(17), np.int64(7), np.int64(53)): arr1 = 0.063477, arr2 = 0.063965, Diff = 0.000488
Position (np.int64(52), np.int64(5), np.int64(90)): arr1 = 0.070801, arr2 = 0.070312, Diff = 0.000488
Position (np.int64(24), np.int64(0), np.int64(34)): arr1 = -0.071289, arr2 = -0.071777, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 40471 (49.40%)
[1.0e-06, 1.0e-05): 605 (0.74%)
[1.0e-05, 1.0e-04): 22794 (27.82%)
[1.0e-04, 1.0e-03): 18050 (22.03%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0048828125
max_diff_thr=0.0047950129956007

Top differences:
Position (np.int64(46), np.int64(2), np.int64(39)): arr1 = 0.023193, arr2 = 0.018311, Diff = 0.004883
Position (np.int64(34), np.int64(9), np.int64(8)): arr1 = -0.059814, arr2 = -0.055176, Diff = 0.004639
Position (np.int64(57), np.int64(3), np.int64(115)): arr1 = 0.043213, arr2 = 0.038574, Diff = 0.004639
Position (np.int64(1), np.int64(0), np.int64(46)): arr1 = 0.062500, arr2 = 0.058105, Diff = 0.004395
Position (np.int64(18), np.int64(9), np.int64(52)): arr1 = 0.075684, arr2 = 0.071289, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 3124 (3.81%)
[1.0e-06, 1.0e-05): 29 (0.04%)
[1.0e-05, 1.0e-04): 2235 (2.73%)
[1.0e-04, 1.0e-03): 48383 (59.06%)
[1.0e-03, 1.0e-02): 28149 (34.36%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9b70b3d32ef1cf4030cac2eb1f1718cd
triton_output_md5=1eda135de2fefa9aeb491e9049d851cc
diff.abs.max=0.00048828125
max_diff_thr=0.0004720320866908878

Top differences:
Position (np.int64(127), np.int64(6), np.int64(32)): arr1 = 0.083496, arr2 = 0.083008, Diff = 0.000488
Position (np.int64(216), np.int64(5), np.int64(120)): arr1 = -0.071777, arr2 = -0.072266, Diff = 0.000488
Position (np.int64(228), np.int64(2), np.int64(62)): arr1 = 0.095215, arr2 = 0.095703, Diff = 0.000488
Position (np.int64(189), np.int64(6), np.int64(59)): arr1 = -0.064941, arr2 = -0.065430, Diff = 0.000488
Position (np.int64(80), np.int64(5), np.int64(80)): arr1 = 0.066406, arr2 = 0.066895, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 164675 (50.25%)
[1.0e-06, 1.0e-05): 2338 (0.71%)
[1.0e-05, 1.0e-04): 88220 (26.92%)
[1.0e-04, 1.0e-03): 72447 (22.11%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.005615234375
max_diff_thr=0.005356311332434416

Top differences:
Position (np.int64(3), np.int64(1), np.int64(115)): arr1 = 0.053955, arr2 = 0.048340, Diff = 0.005615
Position (np.int64(134), np.int64(6), np.int64(47)): arr1 = -0.058594, arr2 = -0.053467, Diff = 0.005127
Position (np.int64(172), np.int64(9), np.int64(43)): arr1 = 0.033447, arr2 = 0.028320, Diff = 0.005127
Position (np.int64(125), np.int64(1), np.int64(98)): arr1 = 0.020386, arr2 = 0.015381, Diff = 0.005005
Position (np.int64(231), np.int64(4), np.int64(15)): arr1 = -0.099121, arr2 = -0.094238, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 13448 (4.10%)
[1.0e-06, 1.0e-05): 99 (0.03%)
[1.0e-05, 1.0e-04): 8561 (2.61%)
[1.0e-04, 1.0e-03): 193111 (58.93%)
[1.0e-03, 1.0e-02): 112461 (34.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f9d477a088be6836b2a5ed9ba1122a0a
triton_output_md5=8612c66cecd12fab9a5b7ee1414ae713
diff.abs.max=0.00048828125
max_diff_thr=0.0004729250504169613

Top differences:
Position (np.int64(60), np.int64(2), np.int64(78)): arr1 = -0.063477, arr2 = -0.062988, Diff = 0.000488
Position (np.int64(29), np.int64(9), np.int64(38)): arr1 = 0.074219, arr2 = 0.073730, Diff = 0.000488
Position (np.int64(55), np.int64(3), np.int64(77)): arr1 = 0.066895, arr2 = 0.067383, Diff = 0.000488
Position (np.int64(19), np.int64(7), np.int64(87)): arr1 = 0.068848, arr2 = 0.069336, Diff = 0.000488
Position (np.int64(59), np.int64(2), np.int64(115)): arr1 = -0.068359, arr2 = -0.068848, Diff = 0.000488

Threshold statistics:
[0.0e+00, 1.0e-06): 41346 (50.47%)
[1.0e-06, 1.0e-05): 567 (0.69%)
[1.0e-05, 1.0e-04): 21712 (26.50%)
[1.0e-04, 1.0e-03): 18295 (22.33%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.005859375
max_diff_thr=0.00572382565587759

Top differences:
Position (np.int64(13), np.int64(2), np.int64(73)): arr1 = 0.029541, arr2 = 0.023682, Diff = 0.005859[aiter INFO] 2025-09-30 05:13:39.452 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:39.595 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 259.6107122331562 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:39.658 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21, 1044, 1045}
[aiter INFO] 2025-09-30 05:13:39.658 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.039
[aiter INFO] 2025-09-30 05:13:39.658 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-09-30 05:13:39.658 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.88000000000102
[aiter INFO] 2025-09-30 05:13:39.658 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000233
[aiter INFO] 2025-09-30 05:13:39.677 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,535.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0         15,851.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       17,562.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          175.6            175.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:39.677 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   175.63 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:39.917 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 567.5023847287243 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-30 05:13:40.010 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 482.76099999999997
[aiter INFO] 2025-09-30 05:13:40.021 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         47,996.7        CUDA            8
[avg us/iter]                       NaN   NaN            0.0            480.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.052 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 61.07344559513697 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6, 139, 111, 146, 83, 20, 118, 125}
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759999999999991
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.87899999999999
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.758999999999787
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.799000000000092
[aiter INFO] 2025-09-30 05:13:40.090 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000133
[aiter INFO] 2025-09-30 05:13:40.102 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,272.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             13.8         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.104 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   493.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:40.113 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:40.179 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.2111885181748 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {416, 38, 423, 9, 42, 16, 49, 20, 27, 31}
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.15900000000056
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.03899999999999
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.599000000000046
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-30 05:13:40.240 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.95999999999998
[aiter INFO] 2025-09-30 05:13:40.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.038999999999987
[aiter INFO] 2025-09-30 05:13:40.241 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.91899999999998
[aiter INFO] 2025-09-30 05:13:40.260 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            462.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,690.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,380.1              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           53.8             53.7         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.261 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    53.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:40.362 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 230.9547622900198 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.426 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {65, 38, 12, 51, 87, 25}
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.47899999999993
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.59900000000005
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.75900000000001
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.03999999999996
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.9190000000001
[aiter INFO] 2025-09-30 05:13:40.427 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.8
[aiter INFO] 2025-09-30 05:13:40.439 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 95.0            0.0         12,436.2        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            130.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.468 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.99343565844073 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.507 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {594, 6}
[aiter INFO] 2025-09-30 05:13:40.507 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.118999999999687
[aiter INFO] 2025-09-30 05:13:40.507 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-09-30 05:13:40.519 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            754.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.6         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.521 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   138.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:40.523 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:40.666 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 273.05274346087236 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:40.728 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 23}
[aiter INFO] 2025-09-30 05:13:40.728 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 173.03900000000004
[aiter INFO] 2025-09-30 05:13:40.728 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.35899999999998
[aiter INFO] 2025-09-30 05:13:40.747 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,894.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0         17,037.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       18,931.4              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN          189.3            189.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:40.748 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   189.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:40.990 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 607.0720063577785 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:41.086 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1270}
[aiter INFO] 2025-09-30 05:13:41.086 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 519.001
[aiter INFO] 2025-09-30 05:13:41.086 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 514.4409999999989
[aiter INFO] 2025-09-30 05:13:41.096 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         51,074.8        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            515.9         NaN          NaN
[aiter INFO] 2025-09-30 05:13:41.127 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 66.86515884824318 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:41.162 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-30 05:13:41.162 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.91900000000001
[aiter INFO] 2025-09-30 05:13:41.174 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,852.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             18.5         NaN          NaN
[aiter INFO] 2025-09-30 05:13:41.175 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   534.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:41.183 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-09-30 05:13:41.249 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.67415859675646 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:41.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 53, 27, 60, 31}
[aiter INFO] 2025-09-30 05:13:41.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.878999999999905
[aiter INFO] 2025-09-30 05:13:41.303 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.07900000000001
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.55900000000008
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.399
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.03899999999999
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.838999999999999
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.799000000000092
[aiter INFO] 2025-09-30 05:13:41.304 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.87999999999994
[aiter INFO] 2025-09-30 05:13:41.323 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            561.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          4,738.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        5,532.6              0.0         CPU        90661
[avg us/iter]                                                                                        NaN   NaN           55.3             55.2         NaN          NaN
[aiter INFO] 2025-09-30 05:13:41.323 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    55.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-30 05:13:41.422 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 226.05931670358865 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:41.670 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 102, 76, 12, 89, 58, 25}
[aiter INFO] 2025-09-30 05:13:41.670 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.79999999999995
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.6790000000001
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.16000000000008
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.44
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.23899999999992
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.83899999999994
[aiter INFO] 2025-09-30 05:13:41.671 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.59900000000005
[aiter INFO] 2025-09-30 05:13:41.683 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 94.0            0.0         12,345.4        CUDA            8
[avg us/iter]                       NaN  NaN            0.0            131.3         NaN          NaN
[aiter INFO] 2025-09-30 05:13:41.712 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.975237615332745 us/iter from cuda.Event
[aiter INFO] 2025-09-30 05:13:41.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {272, 6}
[aiter INFO] 2025-09-30 05:13:41.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.598999999999705
[aiter INFO] 2025-09-30 05:13:41.752 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.998999999999995
[aiter INFO] 2025-09-30 05:13:41.765 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            992.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.0         NaN          NaN
[aiter INFO] 2025-09-30 05:13:41.766 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   141.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(55), np.int64(5), np.int64(17)): arr1 = 0.092285, arr2 = 0.087402, Diff = 0.004883
Position (np.int64(1), np.int64(9), np.int64(110)): arr1 = 0.062500, arr2 = 0.058105, Diff = 0.004395
Position (np.int64(54), np.int64(7), np.int64(37)): arr1 = -0.067871, arr2 = -0.063477, Diff = 0.004395
Position (np.int64(44), np.int64(3), np.int64(26)): arr1 = 0.055664, arr2 = 0.051270, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 3306 (4.04%)
[1.0e-06, 1.0e-05): 27 (0.03%)
[1.0e-05, 1.0e-04): 2156 (2.63%)
[1.0e-04, 1.0e-03): 48274 (58.93%)
[1.0e-03, 1.0e-02): 28157 (34.37%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=15d1f18211d0705f5c26a2b053f51c5f
triton_output_md5=0e421636c68c9b1017ef4caaa094dcf6
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(140), np.int64(8), np.int64(105)): arr1 = -0.033203, arr2 = -0.032959, Diff = 0.000244
Position (np.int64(198), np.int64(0), np.int64(59)): arr1 = -0.034424, arr2 = -0.034180, Diff = 0.000244
Position (np.int64(5), np.int64(8), np.int64(49)): arr1 = 0.031250, arr2 = 0.031494, Diff = 0.000244
Position (np.int64(81), np.int64(4), np.int64(15)): arr1 = -0.034180, arr2 = -0.033936, Diff = 0.000244
Position (np.int64(228), np.int64(2), np.int64(41)): arr1 = 0.031250, arr2 = 0.031494, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 163706 (49.96%)
[1.0e-06, 1.0e-05): 14253 (4.35%)
[1.0e-05, 1.0e-04): 144170 (44.00%)
[1.0e-04, 1.0e-03): 5551 (1.69%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.001708984375
max_diff_thr=0.0017022311221808195

Top differences:
Position (np.int64(32), np.int64(2), np.int64(125)): arr1 = -0.033203, arr2 = -0.031494, Diff = 0.001709
Position (np.int64(176), np.int64(0), np.int64(65)): arr1 = -0.002258, arr2 = -0.003967, Diff = 0.001709
Position (np.int64(250), np.int64(9), np.int64(119)): arr1 = 0.024170, arr2 = 0.022461, Diff = 0.001709
Position (np.int64(103), np.int64(7), np.int64(32)): arr1 = -0.010681, arr2 = -0.008972, Diff = 0.001709
Position (np.int64(146), np.int64(7), np.int64(101)): arr1 = -0.023315, arr2 = -0.021606, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 13851 (4.23%)
[1.0e-06, 1.0e-05): 965 (0.29%)
[1.0e-05, 1.0e-04): 49935 (15.24%)
[1.0e-04, 1.0e-03): 259989 (79.34%)
[1.0e-03, 1.0e-02): 2940 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7a0f16abd8319b710c24fa956003cd79
triton_output_md5=02031ad7843f34e655616ceb2c76c87a
diff.abs.max=0.000244140625
max_diff_thr=0.00023651844821870327

Top differences:
Position (np.int64(4), np.int64(7), np.int64(23)): arr1 = -0.032715, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(46), np.int64(2), np.int64(60)): arr1 = 0.035889, arr2 = 0.036133, Diff = 0.000244
Position (np.int64(46), np.int64(6), np.int64(60)): arr1 = 0.034668, arr2 = 0.034912, Diff = 0.000244
Position (np.int64(5), np.int64(9), np.int64(23)): arr1 = -0.032959, arr2 = -0.033203, Diff = 0.000244
Position (np.int64(35), np.int64(0), np.int64(118)): arr1 = -0.034180, arr2 = -0.034424, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 40305 (49.20%)
[1.0e-06, 1.0e-05): 3693 (4.51%)
[1.0e-05, 1.0e-04): 36540 (44.60%)
[1.0e-04, 1.0e-03): 1382 (1.69%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0018310546875
max_diff_thr=0.001781684230081737

Top differences:
Position (np.int64(1), np.int64(8), np.int64(77)): arr1 = 0.029541, arr2 = 0.027710, Diff = 0.001831
Position (np.int64(18), np.int64(7), np.int64(107)): arr1 = -0.020874, arr2 = -0.019165, Diff = 0.001709
Position (np.int64(23), np.int64(6), np.int64(26)): arr1 = -0.019409, arr2 = -0.017700, Diff = 0.001709
Position (np.int64(24), np.int64(9), np.int64(127)): arr1 = 0.001816, arr2 = 0.000113, Diff = 0.001703
Position (np.int64(58), np.int64(8), np.int64(2)): arr1 = 0.015564, arr2 = 0.013916, Diff = 0.001648

Threshold statistics:
[0.0e+00, 1.0e-06): 3412 (4.17%)
[1.0e-06, 1.0e-05): 225 (0.27%)
[1.0e-05, 1.0e-04): 12584 (15.36%)
[1.0e-04, 1.0e-03): 65004 (79.35%)
[1.0e-03, 1.0e-02): 695 (0.85%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d8fca158a3a54937d88f54ecf14f387e
triton_output_md5=a74762239f463df5c6ad27f1dc52b1e7
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(19), np.int64(8), np.int64(118)): arr1 = -0.031738, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(238), np.int64(7), np.int64(12)): arr1 = -0.032471, arr2 = -0.032227, Diff = 0.000244
Position (np.int64(77), np.int64(8), np.int64(1)): arr1 = -0.031494, arr2 = -0.031250, Diff = 0.000244
Position (np.int64(81), np.int64(8), np.int64(4)): arr1 = -0.039062, arr2 = -0.038818, Diff = 0.000244
Position (np.int64(67), np.int64(5), np.int64(102)): arr1 = -0.034668, arr2 = -0.034912, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 163371 (49.86%)
[1.0e-06, 1.0e-05): 14267 (4.35%)
[1.0e-05, 1.0e-04): 144529 (44.11%)
[1.0e-04, 1.0e-03): 5513 (1.68%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.0018310546875
max_diff_thr=0.0017852892633527517

Top differences:
Position (np.int64(180), np.int64(0), np.int64(122)): arr1 = -0.027466, arr2 = -0.025635, Diff = 0.001831
Position (np.int64(68), np.int64(0), np.int64(64)): arr1 = -0.029419, arr2 = -0.027588, Diff = 0.001831
Position (np.int64(37), np.int64(8), np.int64(127)): arr1 = -0.030762, arr2 = -0.029053, Diff = 0.001709
Position (np.int64(53), np.int64(7), np.int64(20)): arr1 = -0.029419, arr2 = -0.027710, Diff = 0.001709
Position (np.int64(23), np.int64(5), np.int64(5)): arr1 = -0.023926, arr2 = -0.022217, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 13652 (4.17%)
[1.0e-06, 1.0e-05): 915 (0.28%)
[1.0e-05, 1.0e-04): 49237 (15.03%)
[1.0e-04, 1.0e-03): 260770 (79.58%)
[1.0e-03, 1.0e-02): 3106 (0.95%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=de9bc1e5414790a09f4fc968b8c82a6c
triton_output_md5=d352ec0181126c6093b30f44bb167b11
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

Top differences:
Position (np.int64(46), np.int64(7), np.int64(76)): arr1 = 0.034668, arr2 = 0.034424, Diff = 0.000244
Position (np.int64(57), np.int64(4), np.int64(82)): arr1 = -0.031250, arr2 = -0.031494, Diff = 0.000244
Position (np.int64(6), np.int64(9), np.int64(21)): arr1 = -0.031494, arr2 = -0.031250, Diff = 0.000244
Position (np.int64(11), np.int64(5), np.int64(3)): arr1 = -0.032227, arr2 = -0.032471, Diff = 0.000244
Position (np.int64(25), np.int64(0), np.int64(60)): arr1 = -0.031982, arr2 = -0.031738, Diff = 0.000244

Threshold statistics:
[0.0e+00, 1.0e-06): 41241 (50.34%)
[1.0e-06, 1.0e-05): 3519 (4.30%)
[1.0e-05, 1.0e-04): 35754 (43.65%)
[1.0e-04, 1.0e-03): 1406 (1.72%)
[1.0e-03, 1.0e-02): 0 (0.00%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
trans v_quant_.shape=torch.Size([512, 1, 64, 128, 16])
tmp_output_nan_cnt=0
output_nan_cnt=0
diff.abs.max=0.001708984375
max_diff_thr=0.0016794626135379076

Top differences:
Position (np.int64(17), np.int64(0), np.int64(88)): arr1 = -0.019287, arr2 = -0.017578, Diff = 0.001709
Position (np.int64(31), np.int64(6), np.int64(97)): arr1 = -0.009094, arr2 = -0.007416, Diff = 0.001678
Position (np.int64(46), np.int64(7), np.int64(53)): arr1 = -0.024170, arr2 = -0.022583, Diff = 0.001587[aiter INFO] 2025-09-30 05:13:41.776 - MainProcess:90661 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:851 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  err_hip_bf16  us_triton_fp8  err_triton_fp8
0          7         128    (5, 1)        128        1024  torch.bfloat16     2     True         30.2             0           45.3               0
1          7          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.3             0           24.8               0
2         26         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.3             0           45.3               0
3         26          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
4         57         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.3             0           45.3               0
5         57          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.0             0           24.7               0
6         66         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.1             0           45.3               0
7         66          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.1             0           24.8               0
8        109         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.3             0           45.3               0
9        109          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.1             0           24.8               0
10       128         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.5             0           45.2               0
11       128          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.7               0
12       256         128    (5, 1)        128        1024  torch.bfloat16     2     True         29.3             0           45.2               0
13       256          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
14       257         128    (5, 1)        128        1024  torch.bfloat16     2     True         40.0             0           81.8               0
15       257          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.4             0           25.4               0
16       282         128    (5, 1)        128        1024  torch.bfloat16     2     True         40.1             0           81.7               0
17       282          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.3             0           25.5               0
18       512         128    (5, 1)        128        1024  torch.bfloat16     2     True         40.2             0           81.8               0
19       512          32    (5, 1)        128        1024  torch.bfloat16     2     True         18.3             0           25.4               0
20       513         128    (5, 1)        128        1024  torch.bfloat16     2     True         46.8             0          101.8               0
21       513          32    (5, 1)        128        1024  torch.bfloat16     2     True         24.4             0           43.8               0
22      4096         128    (5, 1)        128        1024  torch.bfloat16     2     True        166.6             0          487.0               0
23      4096          32    (5, 1)        128        1024  torch.bfloat16     2     True         52.6             0          135.6               0
24      4097         128    (5, 1)        128        1024  torch.bfloat16     2     True        178.8             0          525.2               0
25      4097          32    (5, 1)        128        1024  torch.bfloat16     2     True         53.6             0          137.5               0
26         7         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.7             0           45.6               0
27         7          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
28        26         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.7             0           45.6               0
29        26          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
30        57         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.8             0           45.6               0
31        57          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.3             0           24.8               0
32        66         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.8             0           45.6               0
33        66          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
34       109         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.7             0           45.5               0
35       109          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.1             0           24.7               0
36       128         128    (8, 1)        128        1024  torch.bfloat16     2     True         32.8             0           45.6               0
37       128          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.1             0           24.8               0
38       256         128    (8, 1)        128        1024  torch.bfloat16     2     True         33.0             0           45.6               0
39       256          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.2             0           24.8               0
40       257         128    (8, 1)        128        1024  torch.bfloat16     2     True         43.9             0           82.5               0
41       257          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.4             0           25.5               0
42       282         128    (8, 1)        128        1024  torch.bfloat16     2     True         43.8             0           82.2               0
43       282          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.5             0           25.5               0
44       512         128    (8, 1)        128        1024  torch.bfloat16     2     True         43.7             0           82.3               0
45       512          32    (8, 1)        128        1024  torch.bfloat16     2     True         18.5             0           25.5               0
46       513         128    (8, 1)        128        1024  torch.bfloat16     2     True         50.1             0          102.4               0
47       513          32    (8, 1)        128        1024  torch.bfloat16     2     True         24.8             0           43.8               0
48      4096         128    (8, 1)        128        1024  torch.bfloat16     2     True        170.7             0          489.4               0
49      4096          32    (8, 1)        128        1024  torch.bfloat16     2     True         52.6             0          136.3               0
50      4097         128    (8, 1)        128        1024  torch.bfloat16     2     True        182.6             0          526.5               0
51      4097          32    (8, 1)        128        1024  torch.bfloat16     2     True         54.4             0          137.9               0
52         7         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.4             0           46.5               0
53         7          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.8             0           25.3               0
54        26         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.4             0           46.5               0
55        26          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.7             0           25.3               0
56        57         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.2             0           46.4               0
57        57          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.8             0           25.3               0
58        66         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.4             0           46.5               0
59        66          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.8             0           25.4               0
60       109         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.5             0           46.5               0
61       109          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.7             0           25.3               0
62       128         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.3             0           46.4               0
63       128          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.7             0           25.4               0
64       256         128   (10, 1)        128        1024  torch.bfloat16     2     True         35.5             0           46.5               0
65       256          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.7             0           25.4               0
66       257         128   (10, 1)        128        1024  torch.bfloat16     2     True         46.3             0           84.0               0
67       257          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.9             0           26.3               0
68       282         128   (10, 1)        128        1024  torch.bfloat16     2     True         46.4             0           83.9               0
69       282          32   (10, 1)        128        1024  torch.bfloat16     2     True         18.9             0           26.3               0
70       512         128   (10, 1)        128        1024  torch.bfloat16     2     True         46.4             0           83.9               0
71       512          32   (10, 1)        128        1024  torch.bfloat16     2     True         19.1             0           26.3               0
72       513         128   (10, 1)        128        1024  torch.bfloat16     2     True         53.5             0          105.6               0
73       513          32   (10, 1)        128        1024  torch.bfloat16     2     True         25.0             0           45.1               0
74      4096         128   (10, 1)        128        1024  torch.bfloat16     2     True        175.6             0          493.8               0
75      4096          32   (10, 1)        128        1024  torch.bfloat16     2     True         53.7             0          138.5               0
76      4097         128   (10, 1)        128        1024  torch.bfloat16     2     True        189.3             0          534.4               0
77      4097          32   (10, 1)        128        1024  torch.bfloat16     2     True         55.2             0          141.4               0

Position (np.int64(49), np.int64(8), np.int64(114)): arr1 = -0.014343, arr2 = -0.012756, Diff = 0.001587
Position (np.int64(19), np.int64(0), np.int64(125)): arr1 = 0.023071, arr2 = 0.021484, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3340 (4.08%)
[1.0e-06, 1.0e-05): 208 (0.25%)
[1.0e-05, 1.0e-04): 12469 (15.22%)
[1.0e-04, 1.0e-03): 65111 (79.48%)
[1.0e-03, 1.0e-02): 792 (0.97%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8570ed49790a9b7883208a93b61a72e5
triton_output_md5=2d0b0a31d4f223cda17d2f08868f1dec
++ set +x
