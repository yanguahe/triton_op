++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=6
++ HIP_VISIBLE_DEVICES=6
++ run_triton_op
++ rm -rf /root/.triton/cache
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py -q 1
[aiter INFO] 2025-09-25 11:44:27.132 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:28.525 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.55317805309107 us/iter from cuda.Event
[W925 11:44:28.286509401 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-25 11:44:28.696 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {489, 482, 10, 9}
[aiter INFO] 2025-09-25 11:44:28.696 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:44:28.696 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 43.998999999999796
[aiter INFO] 2025-09-25 11:44:28.696 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:44:28.697 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-09-25 11:44:28.717 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            470.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,033.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,552.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.5             15.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:28.760 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:30.081 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.34725723644294 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:30.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:30.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.438999999999965
[aiter INFO] 2025-09-25 11:44:30.140 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,929.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:30.394 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.0591681127501 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:30.428 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:30.428 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999992
[aiter INFO] 2025-09-25 11:44:30.440 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            439.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:30.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:31.310 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.30093051596444 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.363 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:31.363 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.079000000000036
[aiter INFO] 2025-09-25 11:44:31.375 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,530.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.500 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.53796038031578 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:31.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:44:31.555 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            472.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.557 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp.co GetFunction: _ZN5aiter35pa_bf16_pertokenFp8_gqa8_2tg_4w_uhpE Success
[aiter INFO] 2025-09-25 11:44:31.623 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.22267327642086 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {299, 259, 4}
[aiter INFO] 2025-09-25 11:44:31.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000051
[aiter INFO] 2025-09-25 11:44:31.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.799000000000206
[aiter INFO] 2025-09-25 11:44:31.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.559000000000026
[aiter INFO] 2025-09-25 11:44:31.663 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0            901.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          921.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.664 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.20 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:31.664 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:31.722 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.22646526416929 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110}
[aiter INFO] 2025-09-25 11:44:31.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.91900000000004
[aiter INFO] 2025-09-25 11:44:31.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:44:31.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.119000000000597
[aiter INFO] 2025-09-25 11:44:31.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:44:31.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            858.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,297.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:31.845 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.17851464111025 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.894 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:31.894 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.479000000000013
[aiter INFO] 2025-09-25 11:44:31.904 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,587.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             15.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.930 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.617207896886484 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:31.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:31.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-25 11:44:31.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            332.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:31.981 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:32.064 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.71000058049022 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:32.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:44:32.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.078999999999724
[aiter INFO] 2025-09-25 11:44:32.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-09-25 11:44:32.302 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,366.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.8         NaN          NaN
[aiter INFO] 2025-09-25 11:44:32.329 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.97560398885519 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:32.375 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:44:32.376 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.8789999999999054
[aiter INFO] 2025-09-25 11:44:32.376 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:44:32.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            326.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:32.389 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:32.425 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 35.333198098705545 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:32.450 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {204, 4}
[aiter INFO] 2025-09-25 11:44:32.450 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-25 11:44:32.450 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.719000000000023
[aiter INFO] 2025-09-25 11:44:32.465 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            719.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          727.0              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:32.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:32.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:32.581 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.78565350735542 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:32.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 218, 219}
[aiter INFO] 2025-09-25 11:44:32.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-25 11:44:32.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.999000000000024
[aiter INFO] 2025-09-25 11:44:32.655 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.358999999999924
[aiter INFO] 2025-09-25 11:44:32.655 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999669
[aiter INFO] 2025-09-25 11:44:32.673 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            462.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,054.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,533.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:32.674 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.32 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:33.375 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.93417780293096 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:33.427 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:33.427 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.319000000000017
[aiter INFO] 2025-09-25 11:44:33.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,030.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:33.464 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.407297011649256 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:33.498 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {48, 6}
[aiter INFO] 2025-09-25 11:44:33.498 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.6790000000000305
[aiter INFO] 2025-09-25 11:44:33.499 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999992
[aiter INFO] 2025-09-25 11:44:33.510 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            461.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:33.511 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:34.449 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.54962371422512 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:34.502 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.43900000000002
[aiter INFO] 2025-09-25 11:44:34.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,565.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:34.539 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.357772297493305 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:34.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.199000000000012
[aiter INFO] 2025-09-25 11:44:34.594 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            472.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:34.595 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:34.639 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.627029549367357 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.664 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:34.664 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.599000000000018
[aiter INFO] 2025-09-25 11:44:34.679 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            929.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          929.3              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:34.680 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:34.681 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:34.740 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.89731716814607 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 262, 263, 9, 10, 240, 241}
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.47900000000027
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.038999999999987
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.159000000000106
[aiter INFO] 2025-09-25 11:44:34.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:44:34.819 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            417.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            850.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,311.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:34.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:34.865 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.9896336445714 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.914 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:34.914 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.35899999999998
[aiter INFO] 2025-09-25 11:44:34.925 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,630.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:34.951 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.661960473155034 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:34.988 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:34.989 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:44:35.000 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            332.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.001 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.63 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:35.266 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.4906237326046 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1208, 1312, 1091, 12}
[aiter INFO] 2025-09-25 11:44:35.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.439000000000306
[aiter INFO] 2025-09-25 11:44:35.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.600000000000364
[aiter INFO] 2025-09-25 11:44:35.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.439000000000306
[aiter INFO] 2025-09-25 11:44:35.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999997
[aiter INFO] 2025-09-25 11:44:35.330 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          1,362.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.356 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.99500006525823 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:35.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:44:35.414 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            329.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.415 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.34 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:35.452 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.53437637279529 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:35.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799000000000007
[aiter INFO] 2025-09-25 11:44:35.492 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            737.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          737.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:35.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:35.607 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.49022773291806 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.681 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:44:35.681 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.079000000000008
[aiter INFO] 2025-09-25 11:44:35.681 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999955
[aiter INFO] 2025-09-25 11:44:35.700 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            466.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,073.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,539.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.701 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:35.748 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.04586145488344 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:35.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.839
[aiter INFO] 2025-09-25 11:44:35.807 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,045.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.24966338129327 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:35.867 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:35.867 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:44:35.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            469.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:35.880 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:36.044 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.26010904512783 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.094 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:36.095 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.039000000000016
[aiter INFO] 2025-09-25 11:44:36.107 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,581.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.132 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.8924060499314 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.174 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 6}
[aiter INFO] 2025-09-25 11:44:36.174 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000017
[aiter INFO] 2025-09-25 11:44:36.174 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-25 11:44:36.186 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            468.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:36.231 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.06547513618918 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.256 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:36.257 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-09-25 11:44:36.272 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            945.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          945.8              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:36.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:36.332 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.38844535138348 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.391 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110}
[aiter INFO] 2025-09-25 11:44:36.391 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000005
[aiter INFO] 2025-09-25 11:44:36.391 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:44:36.391 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-09-25 11:44:36.391 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000001324
[aiter INFO] 2025-09-25 11:44:36.409 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            877.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,316.1              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.410 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
THREADS_PER_WARP=64
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.037109375
max_diff_thr=0.03431089594960213

Top differences:
Position (np.int64(31), np.int64(1), np.int64(26)): arr1 = 0.361328, arr2 = 0.324219, Diff = 0.037109
Position (np.int64(124), np.int64(1), np.int64(85)): arr1 = 0.574219, arr2 = 0.539062, Diff = 0.035156
Position (np.int64(49), np.int64(3), np.int64(32)): arr1 = 0.030273, arr2 = -0.004181, Diff = 0.034454
Position (np.int64(27), np.int64(2), np.int64(93)): arr1 = 0.259766, arr2 = 0.225586, Diff = 0.034180
Position (np.int64(23), np.int64(4), np.int64(120)): arr1 = 0.138672, arr2 = 0.104980, Diff = 0.033691

Threshold statistics:
[0.0e+00, 1.0e-06): 3520 (4.30%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 38 (0.05%)
[1.0e-04, 1.0e-03): 5981 (7.30%)
[1.0e-03, 1.0e-02): 54400 (66.41%)
[1.0e-02, 1.0e-01): 17981 (21.95%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a964e30650b2e4d4b5a7c39a19f40850
triton_output_md5=d8f98f70eeebfbdd54e2c88e17550f00
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.033203125
max_diff_thr=0.028985507786273956

Top differences:
Position (np.int64(22), np.int64(0), np.int64(38)): arr1 = 0.178711, arr2 = 0.145508, Diff = 0.033203
Position (np.int64(22), np.int64(0), np.int64(117)): arr1 = 0.539062, arr2 = 0.507812, Diff = 0.031250
Position (np.int64(30), np.int64(1), np.int64(66)): arr1 = -0.341797, arr2 = -0.310547, Diff = 0.031250
Position (np.int64(16), np.int64(3), np.int64(54)): arr1 = -0.220703, arr2 = -0.189453, Diff = 0.031250
Position (np.int64(4), np.int64(4), np.int64(35)): arr1 = 0.437500, arr2 = 0.406250, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 858 (4.19%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 8 (0.04%)
[1.0e-04, 1.0e-03): 1412 (6.89%)
[1.0e-03, 1.0e-02): 13525 (66.04%)
[1.0e-02, 1.0e-01): 4677 (22.84%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4fbadaea7ee4f19e3380974787a39cac
triton_output_md5=c542d6671f825341b8247349b41814aa
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.02073214016854763

Top differences:
Position (np.int64(0), np.int64(2), np.int64(82)): arr1 = 0.187500, arr2 = 0.166016, Diff = 0.021484
Position (np.int64(11), np.int64(0), np.int64(80)): arr1 = -0.204102, arr2 = -0.182617, Diff = 0.021484
Position (np.int64(126), np.int64(3), np.int64(59)): arr1 = 0.051758, arr2 = 0.030396, Diff = 0.021362
Position (np.int64(14), np.int64(2), np.int64(6)): arr1 = -0.138672, arr2 = -0.117676, Diff = 0.020996
Position (np.int64(19), np.int64(0), np.int64(13)): arr1 = 0.328125, arr2 = 0.308594, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 3352 (4.09%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 125 (0.15%)
[1.0e-04, 1.0e-03): 13061 (15.94%)
[1.0e-03, 1.0e-02): 62836 (76.70%)
[1.0e-02, 1.0e-01): 2544 (3.11%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d5e415acb91973f33c7dc59e894312c2
triton_output_md5=f2cb4b9da21022c5e1f30712f727ea8e
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01953125
max_diff_thr=0.016173752024769783

Top differences:
Position (np.int64(2), np.int64(1), np.int64(64)): arr1 = -0.312500, arr2 = -0.292969, Diff = 0.019531
Position (np.int64(21), np.int64(1), np.int64(21)): arr1 = -0.365234, arr2 = -0.345703, Diff = 0.019531
Position (np.int64(5), np.int64(4), np.int64(90)): arr1 = 0.218750, arr2 = 0.200195, Diff = 0.018555
Position (np.int64(21), np.int64(1), np.int64(30)): arr1 = -0.184570, arr2 = -0.166016, Diff = 0.018555
Position (np.int64(11), np.int64(4), np.int64(99)): arr1 = 0.355469, arr2 = 0.337891, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 851 (4.16%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 25 (0.12%)
[1.0e-04, 1.0e-03): 3227 (15.76%)
[1.0e-03, 1.0e-02): 15737 (76.84%)
[1.0e-02, 1.0e-01): 640 (3.12%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=bc82429f823206bbb34e8b41fe94e38c
triton_output_md5=4ff770b0c543314bb3491e6a396b5197
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.013505764305591583

Top differences:
Position (np.int64(101), np.int64(4), np.int64(99)): arr1 = 0.326172, arr2 = 0.312500, Diff = 0.013672
Position (np.int64(27), np.int64(3), np.int64(125)): arr1 = 0.002487, arr2 = -0.011169, Diff = 0.013657
Position (np.int64(82), np.int64(4), np.int64(76)): arr1 = 0.129883, arr2 = 0.116699, Diff = 0.013184
Position (np.int64(87), np.int64(2), np.int64(69)): arr1 = -0.156250, arr2 = -0.143555, Diff = 0.012695
Position (np.int64(126), np.int64(1), np.int64(91)): arr1 = -0.164062, arr2 = -0.151367, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 3356 (4.10%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 268 (0.33%)
[1.0e-04, 1.0e-03): 19016 (23.21%)
[1.0e-03, 1.0e-02): 59118 (72.17%)
[1.0e-02, 1.0e-01): 156 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=cbc93d78d3425cd2b9106fbf0c0cf5b9
triton_output_md5=ff64ce942d1641d319a410d632291762
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])[aiter INFO] 2025-09-25 11:44:36.455 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.63076259653167 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 467}
[aiter INFO] 2025-09-25 11:44:36.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.839
[aiter INFO] 2025-09-25 11:44:36.504 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.919999999999618
[aiter INFO] 2025-09-25 11:44:36.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,620.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.539 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.9090987765553 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:36.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-25 11:44:36.762 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            333.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:36.848 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.22089128742124 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.901 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {688, 1312, 12}
[aiter INFO] 2025-09-25 11:44:36.901 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999178
[aiter INFO] 2025-09-25 11:44:36.901 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999214
[aiter INFO] 2025-09-25 11:44:36.901 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-09-25 11:44:36.913 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,389.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:36.939 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.194208009113176 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:36.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:36.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.798999999999978
[aiter INFO] 2025-09-25 11:44:36.999 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:37.000 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:37.037 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.11181188087062 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:37.062 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:37.062 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.560000000000002
[aiter INFO] 2025-09-25 11:44:37.077 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            750.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          750.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.5              7.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:37.078 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:37.079 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:37.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.21218855015121 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:37.268 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {273, 274, 10, 9}
[aiter INFO] 2025-09-25 11:44:37.268 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.398999999999887
[aiter INFO] 2025-09-25 11:44:37.268 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.119000000000142
[aiter INFO] 2025-09-25 11:44:37.268 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:44:37.268 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.158999999999992
[aiter INFO] 2025-09-25 11:44:37.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            460.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,079.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,556.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.6             15.6         NaN          NaN
[aiter INFO] 2025-09-25 11:44:37.287 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:37.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.79080200195312 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:37.385 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:37.385 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.839
[aiter INFO] 2025-09-25 11:44:37.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,064.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.6         NaN          NaN
[aiter INFO] 2025-09-25 11:44:37.420 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.28969298819504 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:37.794 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {643, 181, 6}
[aiter INFO] 2025-09-25 11:44:37.794 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000524
[aiter INFO] 2025-09-25 11:44:37.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.1189999999999145
[aiter INFO] 2025-09-25 11:44:37.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:44:37.807 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            459.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:37.808 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:38.119 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.8965342198268 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:38.170 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:38.170 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.918999999999983
[aiter INFO] 2025-09-25 11:44:38.182 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,591.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:38.207 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.85757432745235 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:38.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:38.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:44:38.670 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            440.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:38.671 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:39.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.900257282032825 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:39.142 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:39.142 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000004
[aiter INFO] 2025-09-25 11:44:39.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            923.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          923.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:39.158 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:39.158 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:39.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 103.83712854420784 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:39.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110}
[aiter INFO] 2025-09-25 11:44:39.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.198999999999984
[aiter INFO] 2025-09-25 11:44:39.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-25 11:44:39.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.078999999999724
[aiter INFO] 2025-09-25 11:44:39.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:44:39.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            427.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            861.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,302.3              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:39.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:39.337 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 93.82957397121014 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:39.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1211}
[aiter INFO] 2025-09-25 11:44:39.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.558999999999997
[aiter INFO] 2025-09-25 11:44:39.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000815
[aiter INFO] 2025-09-25 11:44:39.394 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,613.3        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:39.418 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.45088114390279 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:39.754 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:39.754 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-25 11:44:39.766 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            299.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:39.767 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.29 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:39.846 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.57811870787403 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:40.039 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:44:40.039 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.519000000000233
[aiter INFO] 2025-09-25 11:44:40.039 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-09-25 11:44:40.051 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,377.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:40.077 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.114999784396424 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:40.294 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:40.294 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:44:40.306 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:40.307 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:40.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.036128690632264 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:40.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {304, 139, 4, 399}
[aiter INFO] 2025-09-25 11:44:40.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.95900000000006
[aiter INFO] 2025-09-25 11:44:40.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-25 11:44:40.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.478999999999985
[aiter INFO] 2025-09-25 11:44:40.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.639000000000124
[aiter INFO] 2025-09-25 11:44:40.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0            707.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          730.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:40.382 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:40.382 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:40.945 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.4735939449603 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 176, 177, 22, 23}
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000028
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.43899999999985
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.678999999999974
[aiter INFO] 2025-09-25 11:44:41.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000069
[aiter INFO] 2025-09-25 11:44:41.039 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            461.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,045.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,540.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:41.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:41.089 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.45177221888362 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:41.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:41.139 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.479000000000042
[aiter INFO] 2025-09-25 11:44:41.149 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,070.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:41.174 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.1130396157208 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:41.702 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:44:41.702 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9589999999998327
[aiter INFO] 2025-09-25 11:44:41.702 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:44:41.714 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            434.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:41.715 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:41.984 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.29416875555964 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:42.033 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:42.033 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.718999999999994
[aiter INFO] 2025-09-25 11:44:42.046 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,583.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:44:42.071 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.453989947786425 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:42.570 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {524, 6}
[aiter INFO] 2025-09-25 11:44:42.570 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:44:42.570 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:44:42.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            435.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:42.583 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:42.983 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.58661374995614 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:43.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:43.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000004
[aiter INFO] 2025-09-25 11:44:43.022 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            943.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          943.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:43.023 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:43.023 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:43.080 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 103.86169318220404 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:43.137 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 526, 527, 922, 923, 559, 560, 944, 945, 724, 725, 1109, 1110, 746, 747, 108, 109, 504, 505}
[aiter INFO] 2025-09-25 11:44:43.137 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.158999999999992
[aiter INFO] 2025-09-25 11:44:43.137 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999614
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000597
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999998559
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15900000000056
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.238999999999578
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15900000000056
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3200000000006185
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.359000000000378
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999998559
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999542
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.44000000000051
[aiter INFO] 2025-09-25 11:44:43.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:44:43.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            393.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0            804.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,317.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:43.158 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.16 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:43.202 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.09571335339311 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:43.249 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:43.249 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.91900000000001
[aiter INFO] 2025-09-25 11:44:43.259 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,644.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:43.283 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.62989111702041 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:43.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:43.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:44:43.623 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:43.624 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.42 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:43.704 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.47356467140783 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:43.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 961, 12}
[aiter INFO] 2025-09-25 11:44:43.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-25 11:44:43.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359999999999673
[aiter INFO] 2025-09-25 11:44:43.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719999999999999
[aiter INFO] 2025-09-25 11:44:43.905 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,371.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:43.931 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.11143564056642 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:44.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:44.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:44:44.168 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:44.169 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:44.204 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.40285148670768 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:44.228 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {474, 4}
[aiter INFO] 2025-09-25 11:44:44.228 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000215
[aiter INFO] 2025-09-25 11:44:44.228 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.478999999999985
[aiter INFO] 2025-09-25 11:44:44.243 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            731.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          738.9              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:44.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:44.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:44.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.22326709020257 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:44.877 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 141, 142, 207, 208, 240, 241, 86, 87, 218, 219}
[aiter INFO] 2025-09-25 11:44:44.877 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999978
[aiter INFO] 2025-09-25 11:44:44.877 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999942
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999969
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.518999999999778
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.518999999999778
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999942
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999937
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.67899999999986
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.518999999999778
[aiter INFO] 2025-09-25 11:44:44.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999742
[aiter INFO] 2025-09-25 11:44:44.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            443.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          1,017.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,542.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:44.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01416015625
max_diff_thr=0.013016157783567905

Top differences:
Position (np.int64(22), np.int64(1), np.int64(19)): arr1 = -0.102051, arr2 = -0.087891, Diff = 0.014160
Position (np.int64(10), np.int64(1), np.int64(42)): arr1 = -0.273438, arr2 = -0.259766, Diff = 0.013672
Position (np.int64(6), np.int64(4), np.int64(69)): arr1 = -0.125977, arr2 = -0.113281, Diff = 0.012695
Position (np.int64(28), np.int64(3), np.int64(90)): arr1 = -0.075684, arr2 = -0.063477, Diff = 0.012207
Position (np.int64(25), np.int64(2), np.int64(104)): arr1 = 0.106934, arr2 = 0.094727, Diff = 0.012207

Threshold statistics:
[0.0e+00, 1.0e-06): 872 (4.26%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 58 (0.28%)
[1.0e-04, 1.0e-03): 4787 (23.37%)
[1.0e-03, 1.0e-02): 14726 (71.90%)
[1.0e-02, 1.0e-01): 37 (0.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=460b9514e1cba4777565466c9dd46012
triton_output_md5=7c47c3ab482b34f75005b2b9e0b91509
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013916015625
max_diff_thr=0.013311536982655525

Top differences:
Position (np.int64(43), np.int64(2), np.int64(67)): arr1 = -0.059326, arr2 = -0.045410, Diff = 0.013916
Position (np.int64(93), np.int64(1), np.int64(93)): arr1 = -0.157227, arr2 = -0.144531, Diff = 0.012695
Position (np.int64(125), np.int64(3), np.int64(48)): arr1 = 0.127930, arr2 = 0.115723, Diff = 0.012207
Position (np.int64(29), np.int64(3), np.int64(37)): arr1 = 0.134766, arr2 = 0.123047, Diff = 0.011719
Position (np.int64(112), np.int64(0), np.int64(51)): arr1 = 0.168945, arr2 = 0.157227, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 3354 (4.09%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 304 (0.37%)
[1.0e-04, 1.0e-03): 20334 (24.82%)
[1.0e-03, 1.0e-02): 57853 (70.62%)
[1.0e-02, 1.0e-01): 73 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=98b134f03c17936fac90a3ed2510289e
triton_output_md5=1737a1915286d88d60940a64486221d4
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.01151315774768591

Top differences:
Position (np.int64(29), np.int64(0), np.int64(93)): arr1 = 0.201172, arr2 = 0.187500, Diff = 0.013672
Position (np.int64(4), np.int64(2), np.int64(30)): arr1 = -0.111328, arr2 = -0.099609, Diff = 0.011719
Position (np.int64(1), np.int64(4), np.int64(95)): arr1 = -0.097168, arr2 = -0.085938, Diff = 0.011230
Position (np.int64(6), np.int64(4), np.int64(81)): arr1 = 0.096191, arr2 = 0.085938, Diff = 0.010254
Position (np.int64(6), np.int64(2), np.int64(46)): arr1 = -0.131836, arr2 = -0.121582, Diff = 0.010254

Threshold statistics:
[0.0e+00, 1.0e-06): 871 (4.25%)
[1.0e-06, 1.0e-05): 2 (0.01%)
[1.0e-05, 1.0e-04): 76 (0.37%)
[1.0e-04, 1.0e-03): 5161 (25.20%)
[1.0e-03, 1.0e-02): 14363 (70.13%)
[1.0e-02, 1.0e-01): 7 (0.03%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9208b83e93c90a4bc1fef51b0c720836
triton_output_md5=5ae241faab31dee153934827ab11d5c6
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0113525390625
max_diff_thr=0.011168488301336765

Top differences:
Position (np.int64(71), np.int64(3), np.int64(89)): arr1 = 0.027832, arr2 = 0.016479, Diff = 0.011353
Position (np.int64(41), np.int64(3), np.int64(72)): arr1 = 0.116699, arr2 = 0.106445, Diff = 0.010254
Position (np.int64(71), np.int64(0), np.int64(89)): arr1 = 0.086914, arr2 = 0.076660, Diff = 0.010254
Position (np.int64(82), np.int64(1), np.int64(14)): arr1 = 0.133789, arr2 = 0.124023, Diff = 0.009766
Position (np.int64(24), np.int64(1), np.int64(115)): arr1 = 0.119629, arr2 = 0.109863, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 3443 (4.20%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 483 (0.59%)
[1.0e-04, 1.0e-03): 25751 (31.43%)
[1.0e-03, 1.0e-02): 52239 (63.77%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d36abfe81f84dcc76b5818c1d59332e7
triton_output_md5=ecd4ac2561c949d15846a18404c69c0a
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.009187149815261364

Top differences:
Position (np.int64(15), np.int64(3), np.int64(34)): arr1 = 0.168945, arr2 = 0.159180, Diff = 0.009766
Position (np.int64(11), np.int64(0), np.int64(78)): arr1 = 0.006042, arr2 = -0.003174, Diff = 0.009216
Position (np.int64(11), np.int64(0), np.int64(46)): arr1 = -0.068848, arr2 = -0.059814, Diff = 0.009033
Position (np.int64(11), np.int64(1), np.int64(58)): arr1 = 0.133789, arr2 = 0.125000, Diff = 0.008789
Position (np.int64(15), np.int64(4), np.int64(34)): arr1 = 0.183594, arr2 = 0.174805, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 129 (0.63%)
[1.0e-04, 1.0e-03): 6378 (31.14%)
[1.0e-03, 1.0e-02): 13111 (64.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8d48b773fd3a58177a44cd994439c6f6
triton_output_md5=1a977dca0e8f30dc421eda2f5f769110
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32[aiter INFO] 2025-09-25 11:44:44.945 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.84506897170945 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:44.992 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:44.992 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.478999999999985
[aiter INFO] 2025-09-25 11:44:45.003 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,091.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:45.027 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.33678221289475 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:45.573 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:45.573 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:44:45.585 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            438.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:45.586 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:45.848 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.47718839716202 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:45.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:45.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.558999999999997
[aiter INFO] 2025-09-25 11:44:45.909 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,586.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:45.935 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.229059390797474 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:46.443 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:46.443 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.198999999999984
[aiter INFO] 2025-09-25 11:44:46.455 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            439.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:46.456 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:46.848 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.726821705846504 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:46.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 39}
[aiter INFO] 2025-09-25 11:44:46.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:44:46.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.158999999999992
[aiter INFO] 2025-09-25 11:44:46.889 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            941.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          952.0              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:46.891 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.51 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:46.891 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:46.948 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.43356441389216 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {328, 329, 9, 10, 1109, 1110, 504, 505}
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.038999999999987
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999998632
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999542
[aiter INFO] 2025-09-25 11:44:47.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000415
[aiter INFO] 2025-09-25 11:44:47.026 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            418.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            851.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,308.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:47.027 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:47.072 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.06602968909952 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:47.120 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 479}
[aiter INFO] 2025-09-25 11:44:47.120 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.679000000000002
[aiter INFO] 2025-09-25 11:44:47.121 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.19900000000007
[aiter INFO] 2025-09-25 11:44:47.131 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,633.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:47.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.94552474712381 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:47.492 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:47.492 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-25 11:44:47.504 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            300.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:47.505 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.50 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:47.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.34602969412757 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:47.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:44:47.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.47899999999936
[aiter INFO] 2025-09-25 11:44:47.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599999999999994
[aiter INFO] 2025-09-25 11:44:47.793 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,392.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:47.818 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.38073278211131 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:48.032 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:48.032 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:44:48.044 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:48.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:48.079 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.239712762508063 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:48.103 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {169, 4}
[aiter INFO] 2025-09-25 11:44:48.104 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-25 11:44:48.104 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-09-25 11:44:48.119 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            735.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          743.5              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:48.120 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:48.120 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:48.674 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.32942558338146 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:48.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 10, 22, 9}
[aiter INFO] 2025-09-25 11:44:48.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-25 11:44:48.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-25 11:44:48.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.159000000000049
[aiter INFO] 2025-09-25 11:44:48.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-09-25 11:44:48.769 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            469.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,253.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,743.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           17.4             17.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:48.769 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:49.291 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.74764351797576 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:49.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59, 95}
[aiter INFO] 2025-09-25 11:44:49.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.519000000000005
[aiter INFO] 2025-09-25 11:44:49.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.999000000000024
[aiter INFO] 2025-09-25 11:44:49.340 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.919000000000096
[aiter INFO] 2025-09-25 11:44:49.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          3,132.3        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             32.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:49.374 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.89321790709354 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:49.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:44:49.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.918999999999869
[aiter INFO] 2025-09-25 11:44:49.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:44:49.466 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            433.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:49.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:50.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.07084129057309 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:50.196 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:44:50.196 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.519000000000233
[aiter INFO] 2025-09-25 11:44:50.196 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.399999999999977
[aiter INFO] 2025-09-25 11:44:50.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,610.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:50.233 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.59739603471048 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:50.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 503}
[aiter INFO] 2025-09-25 11:44:50.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:44:50.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:44:50.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            435.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:50.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:50.713 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.427029690382504 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:50.736 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:50.736 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-09-25 11:44:50.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,090.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,090.8              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           10.9             10.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:50.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:50.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:50.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 103.7314059858275 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:50.865 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1065, 1066, 10, 9}
[aiter INFO] 2025-09-25 11:44:50.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999796
[aiter INFO] 2025-09-25 11:44:50.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:44:50.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-09-25 11:44:50.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.35899999999998
[aiter INFO] 2025-09-25 11:44:50.884 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            422.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            880.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,317.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:50.885 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.16 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:50.929 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.32189096259599 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:50.975 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:50.975 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-09-25 11:44:50.985 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,686.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:51.009 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.685316908182486 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:51.333 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:44:51.333 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.558999999999287
[aiter INFO] 2025-09-25 11:44:51.333 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-25 11:44:51.345 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            295.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:51.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:51.564 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.33256498067686 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:51.613 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 129, 428, 12, 441, 766}
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.480000000000018
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999814
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999814
[aiter INFO] 2025-09-25 11:44:51.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000233
[aiter INFO] 2025-09-25 11:44:51.626 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          1,340.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:51.651 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.37797031544223 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:51.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {216, 6}
[aiter INFO] 2025-09-25 11:44:51.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:44:51.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:44:51.899 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            290.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:51.900 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:51.934 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.701445511957203 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:51.958 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 9, 19, 444, 29}
[aiter INFO] 2025-09-25 11:44:51.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-09-25 11:44:51.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.07899999999998
[aiter INFO] 2025-09-25 11:44:51.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.118999999999971
[aiter INFO] 2025-09-25 11:44:51.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-25 11:44:51.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.07899999999995
[aiter INFO] 2025-09-25 11:44:51.974 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            733.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          764.6              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.6              7.6         NaN          NaN
[aiter INFO] 2025-09-25 11:44:51.975 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:51.975 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:52.540 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.09574239737917 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:52.608 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:44:52.608 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.839
[aiter INFO] 2025-09-25 11:44:52.608 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000044
[aiter INFO] 2025-09-25 11:44:52.627 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            474.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,664.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,138.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           21.4             21.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:52.627 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:52.678 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.87329672940888 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:52.725 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 155}
[aiter INFO] 2025-09-25 11:44:52.725 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.52000000000001
[aiter INFO] 2025-09-25 11:44:52.725 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.718999999999994
[aiter INFO] 2025-09-25 11:44:52.725 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.71900000000005
[aiter INFO] 2025-09-25 11:44:52.736 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          5,758.3        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.8         NaN          NaN
[aiter INFO] 2025-09-25 11:44:52.918 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.48010899701921 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:53.300 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:53.300 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000016
[aiter INFO] 2025-09-25 11:44:53.313 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            511.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:53.314 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    63.87 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:53.583 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.27721808806504 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:53.633 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {428, 12}
[aiter INFO] 2025-09-25 11:44:53.633 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.478999999999814
[aiter INFO] 2025-09-25 11:44:53.633 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.559000000000026
[aiter INFO] 2025-09-25 11:44:53.646 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,741.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             47.9         NaN          NaN
[aiter INFO] 2025-09-25 11:44:53.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.72062357197893 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:54.159 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 146}
[aiter INFO] 2025-09-25 11:44:54.159 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.038999999999987
[aiter INFO] 2025-09-25 11:44:54.159 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.078999999999979
[aiter INFO] 2025-09-25 11:44:54.159 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.038999999999987
[aiter INFO] 2025-09-25 11:44:54.171 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            534.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:44:54.172 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.34 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.872168328797464 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:54.604 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:44:54.604 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-09-25 11:44:54.619 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,396.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,396.5              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           14.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:54.620 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:54.620 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:54.677 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.49180213531645 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:54.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {152, 153, 10, 9}
[aiter INFO] 2025-09-25 11:44:54.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000115
[aiter INFO] 2025-09-25 11:44:54.734 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:44:54.734 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7190000000000225
[aiter INFO] 2025-09-25 11:44:54.734 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000012
[aiter INFO] 2025-09-25 11:44:54.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            876.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,315.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:54.753 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.00859266147017479

Top differences:
Position (np.int64(31), np.int64(3), np.int64(45)): arr1 = 0.161133, arr2 = 0.151367, Diff = 0.009766
Position (np.int64(53), np.int64(4), np.int64(119)): arr1 = -0.060303, arr2 = -0.051270, Diff = 0.009033
Position (np.int64(72), np.int64(2), np.int64(34)): arr1 = 0.023926, arr2 = 0.032715, Diff = 0.008789
Position (np.int64(38), np.int64(0), np.int64(38)): arr1 = -0.120117, arr2 = -0.111328, Diff = 0.008789
Position (np.int64(45), np.int64(0), np.int64(61)): arr1 = -0.101562, arr2 = -0.092773, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 3325 (4.06%)
[1.0e-06, 1.0e-05): 11 (0.01%)
[1.0e-05, 1.0e-04): 583 (0.71%)
[1.0e-04, 1.0e-03): 27555 (33.64%)
[1.0e-03, 1.0e-02): 50446 (61.58%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=24da20a107e55363225947e5d0dc0f2a
triton_output_md5=673121874af79e8a7201b60293fe9593
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008966493420302868

Top differences:
Position (np.int64(17), np.int64(2), np.int64(58)): arr1 = -0.153320, arr2 = -0.143555, Diff = 0.009766
Position (np.int64(28), np.int64(4), np.int64(12)): arr1 = 0.088379, arr2 = 0.079102, Diff = 0.009277
Position (np.int64(2), np.int64(1), np.int64(114)): arr1 = 0.043945, arr2 = 0.034668, Diff = 0.009277
Position (np.int64(21), np.int64(0), np.int64(33)): arr1 = 0.063965, arr2 = 0.054932, Diff = 0.009033
Position (np.int64(1), np.int64(4), np.int64(93)): arr1 = 0.070312, arr2 = 0.062012, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 797 (3.89%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 129 (0.63%)
[1.0e-04, 1.0e-03): 6812 (33.26%)
[1.0e-03, 1.0e-02): 12741 (62.21%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=37db4495182fdc07d082e3535139b607
triton_output_md5=ddbc6a32c1489d417b31016f7ba5bbe0
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00640869140625
max_diff_thr=0.006383754778653383

Top differences:
Position (np.int64(42), np.int64(0), np.int64(126)): arr1 = 0.010315, arr2 = 0.003906, Diff = 0.006409
Position (np.int64(26), np.int64(1), np.int64(55)): arr1 = 0.047607, arr2 = 0.041504, Diff = 0.006104
Position (np.int64(126), np.int64(0), np.int64(101)): arr1 = 0.087402, arr2 = 0.081543, Diff = 0.005859
Position (np.int64(75), np.int64(4), np.int64(105)): arr1 = 0.041504, arr2 = 0.035645, Diff = 0.005859
Position (np.int64(38), np.int64(2), np.int64(53)): arr1 = 0.084473, arr2 = 0.078613, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 3240 (3.96%)
[1.0e-06, 1.0e-05): 17 (0.02%)
[1.0e-05, 1.0e-04): 1134 (1.38%)
[1.0e-04, 1.0e-03): 37502 (45.78%)
[1.0e-03, 1.0e-02): 40027 (48.86%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=40036bd8999054b37aecd8c63adec8e6
triton_output_md5=992999c5dbaad5cb98efcf908b36f616
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.00609225407242775

Top differences:
Position (np.int64(22), np.int64(2), np.int64(97)): arr1 = -0.128906, arr2 = -0.122070, Diff = 0.006836
Position (np.int64(8), np.int64(2), np.int64(46)): arr1 = -0.054443, arr2 = -0.048584, Diff = 0.005859
Position (np.int64(3), np.int64(1), np.int64(48)): arr1 = 0.071289, arr2 = 0.065430, Diff = 0.005859
Position (np.int64(6), np.int64(0), np.int64(104)): arr1 = -0.036377, arr2 = -0.030762, Diff = 0.005615
Position (np.int64(15), np.int64(2), np.int64(92)): arr1 = 0.011230, arr2 = 0.005829, Diff = 0.005402

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 283 (1.38%)
[1.0e-04, 1.0e-03): 9234 (45.09%)
[1.0e-03, 1.0e-02): 10097 (49.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=007a3ef0d44a4e4ba3022034dedd4f7a
triton_output_md5=d4a4c5d4af762d2e08f03aafd6e279ee
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.007080078125
max_diff_thr=0.006719184573739767

Top differences:
Position (np.int64(109), np.int64(0), np.int64(58)): arr1 = 0.060791, arr2 = 0.053711, Diff = 0.007080
Position (np.int64(117), np.int64(4), np.int64(108)): arr1 = 0.075684, arr2 = 0.068848, Diff = 0.006836
Position (np.int64(45), np.int64(4), np.int64(8)): arr1 = 0.090820, arr2 = 0.083984, Diff = 0.006836
Position (np.int64(15), np.int64(3), np.int64(14)): arr1 = 0.099121, arr2 = 0.092285, Diff = 0.006836
Position (np.int64(69), np.int64(2), np.int64(56)): arr1 = 0.072266, arr2 = 0.065918, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 3334 (4.07%)
[1.0e-06, 1.0e-05): 14 (0.02%)
[1.0e-05, 1.0e-04): 1034 (1.26%)
[1.0e-04, 1.0e-03): 36969 (45.13%)
[1.0e-03, 1.0e-02): 40569 (49.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a03b3c076aaba7088d247bca4839aa7b
triton_output_md5=a7665398f2ac626829e207e3a0b586cb
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}[aiter INFO] 2025-09-25 11:44:54.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.06953463400944 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:54.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:54.988 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.918999999999983
[aiter INFO] 2025-09-25 11:44:54.998 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,681.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:44:55.023 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.91223787258167 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:55.285 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:55.285 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000002
[aiter INFO] 2025-09-25 11:44:55.297 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:55.298 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:55.379 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.5190786453757 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:55.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1013}
[aiter INFO] 2025-09-25 11:44:55.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-25 11:44:55.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-09-25 11:44:55.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-25 11:44:55.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,387.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:55.466 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.890069262226035 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:55.826 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {489, 202, 6}
[aiter INFO] 2025-09-25 11:44:55.826 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.9989999999997963
[aiter INFO] 2025-09-25 11:44:55.826 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6790000000000873
[aiter INFO] 2025-09-25 11:44:55.826 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:44:55.838 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            327.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:55.839 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:55.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.63214848965111 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:55.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:44:55.898 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000251
[aiter INFO] 2025-09-25 11:44:55.898 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-09-25 11:44:55.913 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            951.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          960.6              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.6              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:44:55.914 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:55.914 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:56.405 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.65574268008223 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:56.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:44:56.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.120000000000005
[aiter INFO] 2025-09-25 11:44:56.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:44:56.519 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            474.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,658.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,132.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           21.3             21.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:56.520 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:56.570 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.0617916584015 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:56.617 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 47, 23}
[aiter INFO] 2025-09-25 11:44:56.617 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.998999999999995
[aiter INFO] 2025-09-25 11:44:56.618 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.0
[aiter INFO] 2025-09-25 11:44:56.618 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.079000000000065
[aiter INFO] 2025-09-25 11:44:56.618 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.959
[aiter INFO] 2025-09-25 11:44:56.628 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          5,721.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             59.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:56.652 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.74668320747885 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:57.197 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:57.197 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079999999999984
[aiter INFO] 2025-09-25 11:44:57.209 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            508.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:57.210 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:57.448 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.60116888981054 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:57.497 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:44:57.497 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.79900000000001
[aiter INFO] 2025-09-25 11:44:57.509 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,803.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             48.0         NaN          NaN
[aiter INFO] 2025-09-25 11:44:57.533 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.85126730445588 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:58.109 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:58.109 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:44:58.121 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            514.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:58.121 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:58.443 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.32524756083984 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:58.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {484, 4}
[aiter INFO] 2025-09-25 11:44:58.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.639000000000124
[aiter INFO] 2025-09-25 11:44:58.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000011
[aiter INFO] 2025-09-25 11:44:58.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,399.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,415.6              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           14.2             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:58.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.14 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:58.484 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:44:58.541 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.91435613372538 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {900, 901, 9, 10, 471, 472}
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999141
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000001324
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.15899999999965
[aiter INFO] 2025-09-25 11:44:58.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:44:58.616 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            422.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            863.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,314.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:44:58.616 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:58.660 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.81056462420095 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:58.707 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:44:58.707 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000001
[aiter INFO] 2025-09-25 11:44:58.717 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,669.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.7         NaN          NaN
[aiter INFO] 2025-09-25 11:44:58.742 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.72174253440139 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:59.330 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {20, 6}
[aiter INFO] 2025-09-25 11:44:59.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.039000000000044
[aiter INFO] 2025-09-25 11:44:59.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:44:59.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            334.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:44:59.344 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:59.427 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.33653466477251 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:59.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {259, 12}
[aiter INFO] 2025-09-25 11:44:59.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.67899999999986
[aiter INFO] 2025-09-25 11:44:59.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:44:59.489 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,403.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:44:59.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.77836639574259 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:59.700 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:44:59.700 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:44:59.712 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            334.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:44:59.713 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:59.748 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.893554449966636 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 9, 14, 79, 19}
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.199000000000012
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119000000000028
[aiter INFO] 2025-09-25 11:44:59.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.118999999999971
[aiter INFO] 2025-09-25 11:44:59.787 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            920.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          961.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.6              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:44:59.788 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.59 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:44:59.788 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:00.271 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.94208892619255 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:00.383 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:45:00.383 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.839000000000027
[aiter INFO] 2025-09-25 11:45:00.383 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:45:00.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            480.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,821.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,302.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           23.0             23.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:00.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    23.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:00.453 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.5417818137915 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:00.500 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35}
[aiter INFO] 2025-09-25 11:45:00.500 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.79899999999998
[aiter INFO] 2025-09-25 11:45:00.500 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.19900000000001
[aiter INFO] 2025-09-25 11:45:00.510 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          5,996.2        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             60.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:00.535 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.80568314011734 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:01.074 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:01.074 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119
[aiter INFO] 2025-09-25 11:45:01.086 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            509.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:01.086 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    65.66 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:01.314 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.9841484634003 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:01.363 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-09-25 11:45:01.363 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.759000000000015
[aiter INFO] 2025-09-25 11:45:01.363 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.278999999999996
[aiter INFO] 2025-09-25 11:45:01.375 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,831.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:01.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.943118873504126 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:01.928 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:01.928 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:45:01.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            513.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:01.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:02.310 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.03531704651247 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:02.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 159}
[aiter INFO] 2025-09-25 11:45:02.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.200000000000017
[aiter INFO] 2025-09-25 11:45:02.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.399
[aiter INFO] 2025-09-25 11:45:02.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,555.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,573.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           15.7             15.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:02.351 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    15.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:02.351 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:02.408 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.49813837462132 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:02.464 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:02.464 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000009
[aiter INFO] 2025-09-25 11:45:02.464 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599000000000018
[aiter INFO] 2025-09-25 11:45:02.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            933.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,363.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.6             13.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:02.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:02.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.20304933337883 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:02.710 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:02.710 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.158999999999992
[aiter INFO] 2025-09-25 11:45:02.721 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,727.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:02.746 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.77124747869992 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:03.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:03.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:45:03.052 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            338.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:03.053 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.66 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:03.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.90405944373349 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:03.184 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:03.184 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-25 11:45:03.196 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,428.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:03.220 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.03737624240394 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:03.566 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:03.566 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000002
[aiter INFO] 2025-09-25 11:45:03.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            335.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:03.579 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:03.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.20486141770783 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 4, 39, 14, 49, 19}
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.999000000000024
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079000000000008
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079000000000008
[aiter INFO] 2025-09-25 11:45:03.638 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999995
[aiter INFO] 2025-09-25 11:45:03.653 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  95.0            0.0            900.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          951.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:03.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:03.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:04.137 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.8799206874158 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:04.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:45:04.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.279000000000025
[aiter INFO] 2025-09-25 11:45:04.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:45:04.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            480.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,122.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,602.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           26.0             26.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:04.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    26.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:04.345 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 153.33432711587093 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 71, 11, 47, 83, 23, 59, 95}
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.03899999999999
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.91999999999996
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.87899999999996
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.27899999999994
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.87900000000002
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.55900000000003
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15899999999999
[aiter INFO] 2025-09-25 11:45:04.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.67899999999997
[aiter INFO] 2025-09-25 11:45:04.406 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 93.0            0.0          6,947.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             74.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:04.600 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.69084147681104 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 552, 265, 489, 650, 181, 118}
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999984
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000287
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.479000000000269
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.838999999999942
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.479000000000042
[aiter INFO] 2025-09-25 11:45:04.941 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-09-25 11:45:04.954 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0            585.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:04.955 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    80.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:05.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 145.85549539268607 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:05.218 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 12, 103}
[aiter INFO] 2025-09-25 11:45:05.218 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.23900000000003
[aiter INFO] 2025-09-25 11:45:05.218 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.238999999999976
[aiter INFO] 2025-09-25 11:45:05.218 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.120000000000005
[aiter INFO] 2025-09-25 11:45:05.231 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          5,907.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             60.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:05.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.41321764547046 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:05.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {685, 6}
[aiter INFO] 2025-09-25 11:45:05.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.518999999999323
[aiter INFO] 2025-09-25 11:45:05.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-25 11:45:05.807 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            614.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:05.808 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    66.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.00634765625
max_diff_thr=0.006049104500561953

Top differences:
Position (np.int64(18), np.int64(4), np.int64(59)): arr1 = -0.117676, arr2 = -0.111328, Diff = 0.006348
Position (np.int64(16), np.int64(4), np.int64(83)): arr1 = -0.035400, arr2 = -0.029175, Diff = 0.006226
Position (np.int64(17), np.int64(2), np.int64(39)): arr1 = 0.113770, arr2 = 0.107910, Diff = 0.005859
Position (np.int64(20), np.int64(2), np.int64(2)): arr1 = -0.070801, arr2 = -0.064941, Diff = 0.005859
Position (np.int64(17), np.int64(1), np.int64(19)): arr1 = 0.087402, arr2 = 0.081543, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 823 (4.02%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 261 (1.27%)
[1.0e-04, 1.0e-03): 9323 (45.52%)
[1.0e-03, 1.0e-02): 10069 (49.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=882ec498d51c7616d3f5540fd214d717
triton_output_md5=dd29061bd03fe1c0ab3d8d171dc18188
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.0061147697269916534

Top differences:
Position (np.int64(100), np.int64(2), np.int64(32)): arr1 = 0.044434, arr2 = 0.038086, Diff = 0.006348
Position (np.int64(85), np.int64(2), np.int64(47)): arr1 = -0.059326, arr2 = -0.052979, Diff = 0.006348
Position (np.int64(78), np.int64(3), np.int64(7)): arr1 = -0.067383, arr2 = -0.061035, Diff = 0.006348
Position (np.int64(37), np.int64(0), np.int64(68)): arr1 = 0.028320, arr2 = 0.022217, Diff = 0.006104
Position (np.int64(46), np.int64(3), np.int64(105)): arr1 = 0.081543, arr2 = 0.075684, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 3364 (4.11%)
[1.0e-06, 1.0e-05): 13 (0.02%)
[1.0e-05, 1.0e-04): 1221 (1.49%)
[1.0e-04, 1.0e-03): 38661 (47.19%)
[1.0e-03, 1.0e-02): 38661 (47.19%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4ede5f576607bac307ff01b11e123eb8
triton_output_md5=54c13ad42e3d3df697665a8d3ee4b8ed
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.005811354611068964

Top differences:
Position (np.int64(8), np.int64(0), np.int64(14)): arr1 = 0.098633, arr2 = 0.092285, Diff = 0.006348
Position (np.int64(13), np.int64(3), np.int64(106)): arr1 = 0.042480, arr2 = 0.036621, Diff = 0.005859
Position (np.int64(26), np.int64(3), np.int64(44)): arr1 = 0.053711, arr2 = 0.048096, Diff = 0.005615
Position (np.int64(15), np.int64(0), np.int64(121)): arr1 = -0.046875, arr2 = -0.041504, Diff = 0.005371
Position (np.int64(24), np.int64(3), np.int64(30)): arr1 = -0.083496, arr2 = -0.078125, Diff = 0.005371

Threshold statistics:
[0.0e+00, 1.0e-06): 850 (4.15%)
[1.0e-06, 1.0e-05): 9 (0.04%)
[1.0e-05, 1.0e-04): 331 (1.62%)
[1.0e-04, 1.0e-03): 9557 (46.67%)
[1.0e-03, 1.0e-02): 9733 (47.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e57e381930620ddfac6ca2005035e1d0
triton_output_md5=47b56f8e3de1a75e89ab0f5c9583848b
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.0050136735662817955

Top differences:
Position (np.int64(112), np.int64(4), np.int64(123)): arr1 = -0.076660, arr2 = -0.071289, Diff = 0.005371
Position (np.int64(112), np.int64(1), np.int64(123)): arr1 = -0.045898, arr2 = -0.040771, Diff = 0.005127
Position (np.int64(117), np.int64(2), np.int64(5)): arr1 = -0.034180, arr2 = -0.029175, Diff = 0.005005
Position (np.int64(83), np.int64(1), np.int64(21)): arr1 = 0.062500, arr2 = 0.057617, Diff = 0.004883
Position (np.int64(90), np.int64(2), np.int64(18)): arr1 = 0.055908, arr2 = 0.051514, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 3382 (4.13%)
[1.0e-06, 1.0e-05): 25 (0.03%)
[1.0e-05, 1.0e-04): 2107 (2.57%)
[1.0e-04, 1.0e-03): 48165 (58.80%)
[1.0e-03, 1.0e-02): 28241 (34.47%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4cb2ea184f66452ddee9ed07cac9638b
triton_output_md5=26aad2b45cd51789d042d11d3160ce60
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00567626953125
max_diff_thr=0.005593984853476286

Top differences:
Position (np.int64(15), np.int64(4), np.int64(97)): arr1 = -0.009033, arr2 = -0.014709, Diff = 0.005676
Position (np.int64(21), np.int64(0), np.int64(55)): arr1 = -0.045654, arr2 = -0.040771, Diff = 0.004883
Position (np.int64(27), np.int64(2), np.int64(126)): arr1 = 0.014771, arr2 = 0.010071, Diff = 0.004700
Position (np.int64(13), np.int64(4), np.int64(88)): arr1 = 0.070312, arr2 = 0.065918, Diff = 0.004395
Position (np.int64(23), np.int64(1), np.int64(35)): arr1 = -0.030151, arr2 = -0.026001, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 816 (3.98%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 542 (2.65%)
[1.0e-04, 1.0e-03): 12041 (58.79%)
[1.0e-03, 1.0e-02): 7077 (34.56%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=30b48dfc40c53117a8ebfade90fc12e6
triton_output_md5=b5ec5d5709c9123ae270ced50dd65e5a
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.0050481874495744705

Top differences:
Position (np.int64(49), np.int64(4), np.int64(36)): arr1 = 0.069336, arr2 = 0.063965, Diff = 0.005371[aiter INFO] 2025-09-25 11:45:06.161 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 37.750603981537395 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:06.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {499, 4}
[aiter INFO] 2025-09-25 11:45:06.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.0
[aiter INFO] 2025-09-25 11:45:06.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.718999999999994
[aiter INFO] 2025-09-25 11:45:06.202 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,823.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,844.8              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           18.4             18.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:06.203 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    18.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:06.203 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:06.262 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.04941612777144 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:06.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {472, 9, 10, 471}
[aiter INFO] 2025-09-25 11:45:06.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000342
[aiter INFO] 2025-09-25 11:45:06.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.15900000000002
[aiter INFO] 2025-09-25 11:45:06.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-25 11:45:06.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999942
[aiter INFO] 2025-09-25 11:45:06.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            424.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,094.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,534.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:06.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:06.385 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.04389096486688 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:06.579 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:06.579 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.15900000000002
[aiter INFO] 2025-09-25 11:45:06.589 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,977.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:06.615 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.004485174866005 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:06.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:06.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.039000000000016
[aiter INFO] 2025-09-25 11:45:06.935 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            391.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:06.936 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:07.020 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.43084128599355 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:07.069 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:45:07.069 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.119000000000597
[aiter INFO] 2025-09-25 11:45:07.070 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.039000000000016
[aiter INFO] 2025-09-25 11:45:07.082 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,465.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             24.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:07.107 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.14235635942752 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:07.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6, 181}
[aiter INFO] 2025-09-25 11:45:07.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999955
[aiter INFO] 2025-09-25 11:45:07.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-25 11:45:07.441 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999842
[aiter INFO] 2025-09-25 11:45:07.453 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            382.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:07.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:07.489 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.629405991570785 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:07.513 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 39, 9, 14, 24, 29}
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000008
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.119000000000028
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999984
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999984
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999971
[aiter INFO] 2025-09-25 11:45:07.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.039000000000044
[aiter INFO] 2025-09-25 11:45:07.529 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  95.0            0.0          1,084.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,145.3              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           11.5             11.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:07.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:07.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:08.002 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.25793082525234 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {768, 776, 9, 779, 17, 787, 405, 413, 416, 424, 427, 435, 53, 61, 64, 72, 75, 83, 1109, 1111, 757, 765}
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.79899999999998
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999833
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.80000000000001
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.31999999999971
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.83899999999994
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.03899999999976
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.03899999999976
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.878999999999905
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.59999999999945
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.71900000000005
[aiter INFO] 2025-09-25 11:45:08.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000065
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.15899999999999
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.879000000000019
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.15899999999999
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.8390000000000555
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.67900000000009
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.838999999999942
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.47900000000027
[aiter INFO] 2025-09-25 11:45:08.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.15900000000056
[aiter INFO] 2025-09-25 11:45:08.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            580.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  90.0            0.0          8,416.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,875.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           98.8            100.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:08.153 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    99.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:08.240 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 484.17733624429985 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:08.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1192, 11, 1190}
[aiter INFO] 2025-09-25 11:45:08.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 411.0
[aiter INFO] 2025-09-25 11:45:08.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 407.48
[aiter INFO] 2025-09-25 11:45:08.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 410.72100000000137
[aiter INFO] 2025-09-25 11:45:08.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         39,959.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            407.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:08.625 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.65523754134037 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:08.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 6, 41, 272, 55}
[aiter INFO] 2025-09-25 11:45:08.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999969
[aiter INFO] 2025-09-25 11:45:08.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999984
[aiter INFO] 2025-09-25 11:45:08.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.91900000000004
[aiter INFO] 2025-09-25 11:45:08.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.638999999999896
[aiter INFO] 2025-09-25 11:45:08.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.95900000000006
[aiter INFO] 2025-09-25 11:45:08.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0          1,178.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:08.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   420.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:09.044 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 405.8396347088389 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:09.117 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1283, 356, 12, 307, 700}
[aiter INFO] 2025-09-25 11:45:09.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.9200000000019
[aiter INFO] 2025-09-25 11:45:09.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.8800000000001
[aiter INFO] 2025-09-25 11:45:09.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.72
[aiter INFO] 2025-09-25 11:45:09.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 324.1199999999999
[aiter INFO] 2025-09-25 11:45:09.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 328.84000000000015
[aiter INFO] 2025-09-25 11:45:09.130 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         31,340.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0            326.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:09.408 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.28335645588318 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:09.631 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {216, 461, 454, 6}
[aiter INFO] 2025-09-25 11:45:09.631 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000087
[aiter INFO] 2025-09-25 11:45:09.631 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.799000000000433
[aiter INFO] 2025-09-25 11:45:09.631 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-09-25 11:45:09.631 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-09-25 11:45:09.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0          1,183.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:09.644 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   338.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:10.002 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 88.25251482205816 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:10.030 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:10.030 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.31899999999999
[aiter INFO] 2025-09-25 11:45:10.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          7,107.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        7,107.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           71.1             71.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:10.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    71.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:10.046 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:10.107 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.20269284862103 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:10.164 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {647, 9, 650, 13, 658, 662, 537, 540, 669, 672, 548, 551, 680, 684, 559, 563, 691, 694, 570, 573, 702, 706, 581, 585, 1098, 1101, 592, 596, 603, 606, 614, 617, 625, 629, 636, 639}
[aiter INFO] 2025-09-25 11:45:10.164 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.559000000000196
[aiter INFO] 2025-09-25 11:45:10.164 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.558999999999997
[aiter INFO] 2025-09-25 11:45:10.164 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.559000000000026
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.679000000000087
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.559000000000196
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.35899999999947
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.519000000000233
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.71900000000005
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.518999999999323
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.559000000000196
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.679000000000087
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.798999999999978
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999396
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.679000000000087
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.479000000000269
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.798999999999978
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000342
[aiter INFO] 2025-09-25 11:45:10.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.59900000000016
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999396
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.318999999999505
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.519000000000233
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.838999999999942
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.639000000000124
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.439000000000306
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.519000000000233
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.559000000000196
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.838999999999942
[aiter INFO] 2025-09-25 11:45:10.166 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:45:10.185 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  83.0            0.0            375.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  83.0            0.0          2,468.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,356.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           33.6             34.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:10.185 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    34.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:10.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 179.57951512077068 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:10.435 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 47}
[aiter INFO] 2025-09-25 11:45:10.435 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.67899999999997
[aiter INFO] 2025-09-25 11:45:10.435 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.39999999999998
[aiter INFO] 2025-09-25 11:45:10.435 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.59899999999993
[aiter INFO] 2025-09-25 11:45:10.446 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         10,134.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:10.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.57323738165421 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:10.698 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:10.698 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-25 11:45:10.711 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            656.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:10.712 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   109.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:10.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.74976308629064 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.15999999999997
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.87900000000002
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.87900000000002
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.95900000000006
[aiter INFO] 2025-09-25 11:45:10.859 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.76000000000005
[aiter INFO] 2025-09-25 11:45:10.870 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,956.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             82.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:10.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.11855422771803 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:11.204 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:11.205 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-25 11:45:11.217 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            656.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:11.218 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    89.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:11.257 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.06236647733367 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:11.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {18, 475, 4, 23}
[aiter INFO] 2025-09-25 11:45:11.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.238999999999976
[aiter INFO] 2025-09-25 11:45:11.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.759000000000015
[aiter INFO] 2025-09-25 11:45:11.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.87899999999999
[aiter INFO] 2025-09-25 11:45:11.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.879999999999995
[aiter INFO] 2025-09-25 11:45:11.301 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          3,695.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,812.4              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           38.1             38.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:11.302 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    38.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:11.303 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:11.846 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 161.5442275115759 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1032, 9, 17, 1044, 1045, 1055}
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.9989999999998
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.44000000000003
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.47899999999936
[aiter INFO] 2025-09-25 11:45:11.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.838999999999942
[aiter INFO] 2025-09-25 11:45:11.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            522.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          8,968.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,731.5              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           97.3             96.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:11.959 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    96.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:12.518 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 455.98274203810365 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:12.598 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {56, 11}
[aiter INFO] 2025-09-25 11:45:12.598 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 378.91999999999996
[aiter INFO] 2025-09-25 11:45:12.598 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 381.32099999999997
[aiter INFO] 2025-09-25 11:45:12.609 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0         37,718.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            381.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:12.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.02037607266171 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:12.852 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {405, 6}
[aiter INFO] 2025-09-25 11:45:12.852 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000306
[aiter INFO] 2025-09-25 11:45:12.852 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000009
[aiter INFO] 2025-09-25 11:45:12.864 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,008.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:12.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   391.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:13.588 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 387.21423751056784 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:13.663 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:13.664 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.24
[aiter INFO] 2025-09-25 11:45:13.676 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         30,536.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0            305.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:13.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.648088891612424 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:13.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:13.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000000013
[aiter INFO] 2025-09-25 11:45:13.935 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,001.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:13.936 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   315.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:13.986 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 87.70836609424931 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:14.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {467, 4}
[aiter INFO] 2025-09-25 11:45:14.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.19999999999982
[aiter INFO] 2025-09-25 11:45:14.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.92000000000002
[aiter INFO] 2025-09-25 11:45:14.030 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          6,799.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        6,872.0              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           68.7             68.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:14.031 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    68.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:14.032 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:14.096 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.95201986969107 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:14.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 13}
[aiter INFO] 2025-09-25 11:45:14.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.798999999999978
[aiter INFO] 2025-09-25 11:45:14.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:45:14.174 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,677.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,105.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           31.1             31.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:14.175 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:14.231 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 179.67536632377323 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:14.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35}
[aiter INFO] 2025-09-25 11:45:14.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.88000000000002
[aiter INFO] 2025-09-25 11:45:14.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.07900000000006
[aiter INFO] 2025-09-25 11:45:14.525 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0         10,248.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:14.551 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.873841561598354 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:14.593 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {251, 6}
[aiter INFO] 2025-09-25 11:45:14.593 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:45:14.593 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:45:14.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            556.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:14.607 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   109.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:14.701 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.34071337586582 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:14.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12, 38}
[aiter INFO] 2025-09-25 11:45:14.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.44
[aiter INFO] 2025-09-25 11:45:14.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.95899999999995
[aiter INFO] 2025-09-25 11:45:14.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.23899999999998
[aiter INFO] 2025-09-25 11:45:14.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.07900000000001
[aiter INFO] 2025-09-25 11:45:14.769 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          8,026.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             82.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:14.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.77161373124264 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:15.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {608, 6}
[aiter INFO] 2025-09-25 11:45:15.042 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.0789999999997235
[aiter INFO] 2025-09-25 11:45:15.042 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999984
[aiter INFO] 2025-09-25 11:45:15.054 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            558.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:15.055 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    88.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(58), np.int64(3), np.int64(25)): arr1 = 0.093750, arr2 = 0.088379, Diff = 0.005371
Position (np.int64(30), np.int64(4), np.int64(53)): arr1 = -0.083984, arr2 = -0.078613, Diff = 0.005371
Position (np.int64(1), np.int64(1), np.int64(90)): arr1 = 0.067871, arr2 = 0.062988, Diff = 0.004883
Position (np.int64(98), np.int64(1), np.int64(120)): arr1 = -0.066406, arr2 = -0.061768, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 3322 (4.06%)
[1.0e-06, 1.0e-05): 30 (0.04%)
[1.0e-05, 1.0e-04): 2167 (2.65%)
[1.0e-04, 1.0e-03): 48332 (59.00%)
[1.0e-03, 1.0e-02): 28069 (34.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=53a5d3a6d12ba111687aeaf5fcaae4b1
triton_output_md5=21fe89acbb6f69339d81601015094588
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00439453125
max_diff_thr=0.004181184805929661

Top differences:
Position (np.int64(3), np.int64(3), np.int64(74)): arr1 = 0.055420, arr2 = 0.051025, Diff = 0.004395
Position (np.int64(14), np.int64(3), np.int64(27)): arr1 = -0.046143, arr2 = -0.041992, Diff = 0.004150
Position (np.int64(6), np.int64(0), np.int64(43)): arr1 = 0.016113, arr2 = 0.012085, Diff = 0.004028
Position (np.int64(22), np.int64(0), np.int64(22)): arr1 = -0.060303, arr2 = -0.056396, Diff = 0.003906
Position (np.int64(6), np.int64(1), np.int64(27)): arr1 = -0.052490, arr2 = -0.048584, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 8 (0.04%)
[1.0e-05, 1.0e-04): 512 (2.50%)
[1.0e-04, 1.0e-03): 12055 (58.86%)
[1.0e-03, 1.0e-02): 7044 (34.39%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9d84c49248c16a87c6d8e495390a4745
triton_output_md5=eabcec4cda35dce52c5df456c2f37b1c
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.0017018690705299377

Top differences:
Position (np.int64(106), np.int64(2), np.int64(121)): arr1 = 0.005890, arr2 = 0.004181, Diff = 0.001709
Position (np.int64(61), np.int64(1), np.int64(115)): arr1 = -0.012939, arr2 = -0.011292, Diff = 0.001648
Position (np.int64(12), np.int64(2), np.int64(73)): arr1 = 0.001633, arr2 = 0.000015, Diff = 0.001617
Position (np.int64(101), np.int64(2), np.int64(81)): arr1 = -0.020386, arr2 = -0.018799, Diff = 0.001587
Position (np.int64(39), np.int64(1), np.int64(85)): arr1 = -0.020386, arr2 = -0.018799, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3393 (4.14%)
[1.0e-06, 1.0e-05): 217 (0.26%)
[1.0e-05, 1.0e-04): 12502 (15.26%)
[1.0e-04, 1.0e-03): 65034 (79.39%)
[1.0e-03, 1.0e-02): 774 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ed6ae46336485a7ae2464462dc92d212
triton_output_md5=8041afc19aa33350ad468a9b4ad44daf
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.0016770483925938606

Top differences:
Position (np.int64(8), np.int64(0), np.int64(83)): arr1 = -0.020752, arr2 = -0.019043, Diff = 0.001709
Position (np.int64(28), np.int64(2), np.int64(76)): arr1 = 0.010559, arr2 = 0.008972, Diff = 0.001587
Position (np.int64(15), np.int64(4), np.int64(56)): arr1 = -0.013550, arr2 = -0.012024, Diff = 0.001526
Position (np.int64(22), np.int64(1), np.int64(4)): arr1 = 0.019775, arr2 = 0.018311, Diff = 0.001465
Position (np.int64(14), np.int64(2), np.int64(50)): arr1 = -0.012634, arr2 = -0.014099, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 919 (4.49%)
[1.0e-06, 1.0e-05): 68 (0.33%)
[1.0e-05, 1.0e-04): 3015 (14.72%)
[1.0e-04, 1.0e-03): 16265 (79.42%)
[1.0e-03, 1.0e-02): 213 (1.04%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8489988a2a110e464b25c214cdac4e34
triton_output_md5=5ac442569234683be9d421b5a5ba9c72
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018007202306762338

Top differences:
Position (np.int64(105), np.int64(3), np.int64(57)): arr1 = 0.018677, arr2 = 0.016846, Diff = 0.001831
Position (np.int64(107), np.int64(4), np.int64(1)): arr1 = 0.015625, arr2 = 0.014099, Diff = 0.001526
Position (np.int64(18), np.int64(0), np.int64(16)): arr1 = -0.006500, arr2 = -0.004974, Diff = 0.001526
Position (np.int64(68), np.int64(4), np.int64(99)): arr1 = -0.015137, arr2 = -0.013611, Diff = 0.001526
Position (np.int64(114), np.int64(1), np.int64(42)): arr1 = 0.014526, arr2 = 0.013000, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 3419 (4.17%)
[1.0e-06, 1.0e-05): 244 (0.30%)
[1.0e-05, 1.0e-04): 12498 (15.26%)
[1.0e-04, 1.0e-03): 65037 (79.39%)
[1.0e-03, 1.0e-02): 722 (0.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=26a2642af9ff60ad6982531637f7ded9
triton_output_md5=22e42bd5bae52b73b35a4fd6e95e5f5b
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0015869140625
max_diff_thr=0.0015728977741673589

Top differences:
Position (np.int64(29), np.int64(4), np.int64(13)): arr1 = 0.010498, arr2 = 0.008911, Diff = 0.001587
Position (np.int64(4), np.int64(1), np.int64(110)): arr1 = 0.000233, arr2 = -0.001328, Diff = 0.001560
Position (np.int64(29), np.int64(0), np.int64(71)): arr1 = -0.012146, arr2 = -0.010681, Diff = 0.001465[aiter INFO] 2025-09-25 11:45:15.094 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.78627721153864 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:15.122 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {65, 4, 37, 102, 325, 136, 10, 427, 17, 246, 23}
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.71899999999994
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.63900000000001
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.87899999999996
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.599000000000046
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.639000000000124
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.79899999999998
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.399
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.759000000000015
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.19900000000001
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.67900000000009
[aiter INFO] 2025-09-25 11:45:15.123 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.63900000000001
[aiter INFO] 2025-09-25 11:45:15.138 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  90.0            0.0          3,253.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,615.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           36.2             36.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:15.139 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    36.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:15.140 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:15.683 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.40031652993495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:15.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:15.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.238999999999976
[aiter INFO] 2025-09-25 11:45:15.752 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-25 11:45:15.771 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            735.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,022.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,757.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           17.6             17.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:15.772 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:16.291 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.59281171371441 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:16.341 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:16.341 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.119
[aiter INFO] 2025-09-25 11:45:16.352 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,940.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:16.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.565693107276864 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:16.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:16.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:45:16.515 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            444.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:16.516 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:17.185 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.03955456703017 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:17.236 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:17.236 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.239000000000004
[aiter INFO] 2025-09-25 11:45:17.248 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,522.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:17.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.99024718911341 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:17.406 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:17.406 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-25 11:45:17.418 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            448.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:17.419 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:17.708 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.151376226160785 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:17.732 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:17.732 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:45:17.747 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            887.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          887.0              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            8.9              8.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:17.748 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     8.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:17.748 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:17.805 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.94526741233203 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110, 119, 120}
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.038999999999987
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.078999999999724
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999969
[aiter INFO] 2025-09-25 11:45:18.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-25 11:45:18.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            422.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            828.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,276.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:18.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:18.086 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.38210898519743 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:18.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:18.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.718999999999994
[aiter INFO] 2025-09-25 11:45:18.144 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,556.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             15.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:18.169 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.07461369096642 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:18.383 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:18.383 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9589999999999748
[aiter INFO] 2025-09-25 11:45:18.395 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:18.396 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    18.58 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:18.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.81177245626355 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:18.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 1039}
[aiter INFO] 2025-09-25 11:45:18.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.078999999999724
[aiter INFO] 2025-09-25 11:45:18.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000004
[aiter INFO] 2025-09-25 11:45:18.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999999905
[aiter INFO] 2025-09-25 11:45:18.539 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,324.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:18.563 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.49202962883628 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:18.939 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:45:18.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.479000000000269
[aiter INFO] 2025-09-25 11:45:18.940 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:45:18.951 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            290.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:18.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:18.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.86542572553205 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:19.011 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:45:19.012 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.398999999999887
[aiter INFO] 2025-09-25 11:45:19.012 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.439000000000021
[aiter INFO] 2025-09-25 11:45:19.027 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            688.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          694.6              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            6.9              7.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:19.028 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     6.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:19.028 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:19.549 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.68904924864816 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:19.653 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:19.653 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.158999999999992
[aiter INFO] 2025-09-25 11:45:19.653 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:45:19.672 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            734.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,025.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,760.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           17.6             17.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:19.673 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.61 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:20.194 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.04547517016383 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:20.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:20.242 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.399
[aiter INFO] 2025-09-25 11:45:20.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,005.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:20.277 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.908287222727694 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:20.323 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 6}
[aiter INFO] 2025-09-25 11:45:20.323 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-25 11:45:20.323 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:45:20.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            438.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:20.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:21.005 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.41972273293108 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:21.056 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:21.056 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.35900000000001
[aiter INFO] 2025-09-25 11:45:21.068 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,554.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:21.093 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.02826757360213 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:21.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:21.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:45:21.145 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            448.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:21.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:21.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.294336640893825 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:21.606 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:21.607 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.799000000000007
[aiter INFO] 2025-09-25 11:45:21.622 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            898.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          898.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.0              9.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:21.622 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     8.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:21.623 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:21.679 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 103.60504952397677 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:21.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 526, 527, 1109, 1110}
[aiter INFO] 2025-09-25 11:45:21.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.87899999999999
[aiter INFO] 2025-09-25 11:45:21.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000002
[aiter INFO] 2025-09-25 11:45:21.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-25 11:45:21.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-25 11:45:21.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.078999999999724
[aiter INFO] 2025-09-25 11:45:21.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:45:21.911 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            420.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            839.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,285.5              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.9             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:21.912 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.86 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:21.957 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.58761381925923 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:22.009 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:22.010 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.278999999999996
[aiter INFO] 2025-09-25 11:45:22.020 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,601.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:22.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.685702897829586 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:22.266 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:22.266 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:45:22.278 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            299.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:22.279 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.01 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:22.361 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.6220788648813 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:22.416 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 935}
[aiter INFO] 2025-09-25 11:45:22.416 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000378
[aiter INFO] 2025-09-25 11:45:22.416 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719999999999999
[aiter INFO] 2025-09-25 11:45:22.416 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.198999999999614
[aiter INFO] 2025-09-25 11:45:22.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,356.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:22.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.002515123327186 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:22.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:45:22.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.519000000000233
[aiter INFO] 2025-09-25 11:45:22.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.7590000000000146
[aiter INFO] 2025-09-25 11:45:22.816 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            291.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:22.817 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:22.854 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.815930610836144 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:22.880 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {264, 4}
[aiter INFO] 2025-09-25 11:45:22.880 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-25 11:45:22.880 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999988
[aiter INFO] 2025-09-25 11:45:22.895 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            705.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          712.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.1              7.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:22.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:22.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:23.418 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.42685139769374 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:23.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:23.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.600000000000023
[aiter INFO] 2025-09-25 11:45:23.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:45:23.512 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            733.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,045.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,778.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           17.8             17.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:23.513 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.79 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:23.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.54685184625116 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:23.612 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:23.612 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.799000000000007
[aiter INFO] 2025-09-25 11:45:23.623 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,021.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:23.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.259554363123264 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:24.192 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {321, 174, 6}
[aiter INFO] 2025-09-25 11:45:24.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:45:24.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:45:24.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:45:24.205 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            436.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:24.206 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.67 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:24.451 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.05618809886498 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:24.504 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:24.504 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.758999999999986
[aiter INFO] 2025-09-25 11:45:24.517 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,567.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:24.542 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.98709894997059 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:25.069 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:25.070 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:45:25.082 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            448.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:25.083 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(11), np.int64(3), np.int64(13)): arr1 = 0.002914, arr2 = 0.001450, Diff = 0.001465
Position (np.int64(4), np.int64(1), np.int64(109)): arr1 = -0.008179, arr2 = -0.006744, Diff = 0.001434

Threshold statistics:
[0.0e+00, 1.0e-06): 876 (4.28%)
[1.0e-06, 1.0e-05): 54 (0.26%)
[1.0e-05, 1.0e-04): 3065 (14.97%)
[1.0e-04, 1.0e-03): 16301 (79.59%)
[1.0e-03, 1.0e-02): 184 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=5ad3309cc512b2b3299153c37ad5cc59
triton_output_md5=1817ea3bbddd435e309afc07621e5775
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.037109375
max_diff_thr=0.03276539966464043

Top differences:
Position (np.int64(56), np.int64(5), np.int64(81)): arr1 = 0.449219, arr2 = 0.412109, Diff = 0.037109
Position (np.int64(88), np.int64(7), np.int64(82)): arr1 = -0.351562, arr2 = -0.316406, Diff = 0.035156
Position (np.int64(51), np.int64(2), np.int64(75)): arr1 = -0.539062, arr2 = -0.503906, Diff = 0.035156
Position (np.int64(71), np.int64(4), np.int64(33)): arr1 = 0.058105, arr2 = 0.024536, Diff = 0.033569
Position (np.int64(1), np.int64(3), np.int64(73)): arr1 = -0.330078, arr2 = -0.296875, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 5766 (4.40%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 48 (0.04%)
[1.0e-04, 1.0e-03): 9338 (7.12%)
[1.0e-03, 1.0e-02): 86745 (66.18%)
[1.0e-02, 1.0e-01): 29174 (22.26%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f5bef4e2327e2ff45c7959edc8131fa5
triton_output_md5=a869e81cefb2a1eb3db1812318b77429
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.03515625
max_diff_thr=0.03230337053537369

Top differences:
Position (np.int64(16), np.int64(5), np.int64(73)): arr1 = 0.177734, arr2 = 0.212891, Diff = 0.035156
Position (np.int64(31), np.int64(7), np.int64(58)): arr1 = 0.076660, arr2 = 0.042969, Diff = 0.033691
Position (np.int64(13), np.int64(1), np.int64(7)): arr1 = -0.253906, arr2 = -0.220703, Diff = 0.033203
Position (np.int64(9), np.int64(0), np.int64(5)): arr1 = -0.462891, arr2 = -0.429688, Diff = 0.033203
Position (np.int64(29), np.int64(2), np.int64(30)): arr1 = 0.449219, arr2 = 0.416016, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 1405 (4.29%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 17 (0.05%)
[1.0e-04, 1.0e-03): 2360 (7.20%)
[1.0e-03, 1.0e-02): 21492 (65.59%)
[1.0e-02, 1.0e-01): 7494 (22.87%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d9f401f1fad59273d04282e91ade1e1c
triton_output_md5=6889991c2256da869aeb6dce5d53cd0f
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0234375
max_diff_thr=0.022008419036865234

Top differences:
Position (np.int64(10), np.int64(2), np.int64(49)): arr1 = -0.273438, arr2 = -0.250000, Diff = 0.023438
Position (np.int64(111), np.int64(1), np.int64(87)): arr1 = 0.037354, arr2 = 0.015015, Diff = 0.022339
Position (np.int64(56), np.int64(0), np.int64(18)): arr1 = 0.255859, arr2 = 0.235352, Diff = 0.020508
Position (np.int64(111), np.int64(1), np.int64(37)): arr1 = 0.273438, arr2 = 0.253906, Diff = 0.019531
Position (np.int64(11), np.int64(2), np.int64(7)): arr1 = 0.390625, arr2 = 0.371094, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 5587 (4.26%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 204 (0.16%)
[1.0e-04, 1.0e-03): 20693 (15.79%)
[1.0e-03, 1.0e-02): 100415 (76.61%)
[1.0e-02, 1.0e-01): 4170 (3.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0b61fec4226ebdc93188dae9a276cddf
triton_output_md5=033323467a37aeed08ccfdc9f92544c1
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.01875532791018486

Top differences:
Position (np.int64(22), np.int64(3), np.int64(6)): arr1 = -0.166992, arr2 = -0.145508, Diff = 0.021484
Position (np.int64(14), np.int64(2), np.int64(25)): arr1 = -0.390625, arr2 = -0.371094, Diff = 0.019531
Position (np.int64(31), np.int64(3), np.int64(93)): arr1 = 0.141602, arr2 = 0.123047, Diff = 0.018555
Position (np.int64(13), np.int64(4), np.int64(121)): arr1 = -0.158203, arr2 = -0.140625, Diff = 0.017578
Position (np.int64(12), np.int64(3), np.int64(60)): arr1 = -0.261719, arr2 = -0.244141, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 1447 (4.42%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 52 (0.16%)
[1.0e-04, 1.0e-03): 5239 (15.99%)
[1.0e-03, 1.0e-02): 25030 (76.39%)
[1.0e-02, 1.0e-01): 1000 (3.05%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2e58bc71a6ce81426f84549eeb02f346
triton_output_md5=14c27e06440a23f02801b893e0b542d6
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.013136094436049461

Top differences:
Position (np.int64(65), np.int64(4), np.int64(95)): arr1 = -0.059082, arr2 = -0.045410, Diff = 0.013672
Position (np.int64(12), np.int64(3), np.int64(110)): arr1 = -0.251953, arr2 = -0.238281, Diff = 0.013672
Position (np.int64(117), np.int64(0), np.int64(8)): arr1 = -0.017944, arr2 = -0.031494, Diff = 0.013550
Position (np.int64(98), np.int64(4), np.int64(112)): arr1 = 0.002823, arr2 = -0.010010, Diff = 0.012833
Position (np.int64(109), np.int64(2), np.int64(84)): arr1 = 0.227539, arr2 = 0.214844, Diff = 0.012695[aiter INFO] 2025-09-25 11:45:25.448 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.665821755434028 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:25.474 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 29}
[aiter INFO] 2025-09-25 11:45:25.474 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.958999999999975
[aiter INFO] 2025-09-25 11:45:25.474 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999994
[aiter INFO] 2025-09-25 11:45:25.489 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            905.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          915.3              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.2              9.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:25.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:25.491 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:25.548 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.08388133332281 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:25.761 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110}
[aiter INFO] 2025-09-25 11:45:25.761 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000033
[aiter INFO] 2025-09-25 11:45:25.761 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.559000000000026
[aiter INFO] 2025-09-25 11:45:25.761 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.15900000000147
[aiter INFO] 2025-09-25 11:45:25.762 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000524
[aiter INFO] 2025-09-25 11:45:25.780 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            424.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            849.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,286.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.9             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:25.781 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.87 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:25.826 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 93.83674261003438 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:25.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:25.874 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.319999999999993
[aiter INFO] 2025-09-25 11:45:25.885 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,605.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:25.909 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.426316872681724 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:26.195 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:45:26.195 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.5590000000001965
[aiter INFO] 2025-09-25 11:45:26.195 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:45:26.207 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            298.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:26.207 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:26.289 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.20503955017222 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 1026, 1286, 12, 142, 1013, 987}
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.398999999999432
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.279000000000451
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.278999999999996
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000487
[aiter INFO] 2025-09-25 11:45:26.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359000000000378
[aiter INFO] 2025-09-25 11:45:26.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0          1,305.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:26.375 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.610445394669426 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:26.720 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:26.720 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-25 11:45:26.732 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:26.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:26.768 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.430564400730745 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:26.792 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:26.792 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000019
[aiter INFO] 2025-09-25 11:45:26.807 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            722.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          722.5              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.2              7.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:26.808 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:26.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:27.283 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.00982201099396 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:27.380 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:27.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.638999999999982
[aiter INFO] 2025-09-25 11:45:27.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-25 11:45:27.399 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            733.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,055.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,788.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           17.9             17.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:27.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:27.448 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.60068306769475 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:27.495 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:27.495 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.07900000000001
[aiter INFO] 2025-09-25 11:45:27.505 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,044.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:27.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.9031584959219 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:28.062 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:28.062 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:45:28.074 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            449.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:28.075 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:28.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.29140636059317 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:28.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:28.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.558999999999997
[aiter INFO] 2025-09-25 11:45:28.377 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,578.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:28.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.64252471776292 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:28.948 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:28.948 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.15900000000002
[aiter INFO] 2025-09-25 11:45:28.960 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            449.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:28.961 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:29.314 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.10781185151917 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:29.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {154, 139, 4}
[aiter INFO] 2025-09-25 11:45:29.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-09-25 11:45:29.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.678999999999974
[aiter INFO] 2025-09-25 11:45:29.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.15900000000002
[aiter INFO] 2025-09-25 11:45:29.353 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0            908.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          927.4              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:29.354 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:29.354 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:29.411 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.43912863082225 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110, 470, 472}
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.959000000000003
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.118999999998778
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:45:29.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.118999999999687
[aiter INFO] 2025-09-25 11:45:29.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:45:29.486 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            419.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            849.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,295.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.0             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:29.487 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.95 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:29.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.44028721882565 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:29.723 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 395}
[aiter INFO] 2025-09-25 11:45:29.723 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.35899999999998
[aiter INFO] 2025-09-25 11:45:29.723 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.679000000000087
[aiter INFO] 2025-09-25 11:45:29.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,602.9        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:29.758 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.804079015361204 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:30.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {328, 6}
[aiter INFO] 2025-09-25 11:45:30.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.438999999999851
[aiter INFO] 2025-09-25 11:45:30.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:45:30.050 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            299.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:30.050 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:30.133 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.11869326145342 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 1026, 38, 168, 12, 1078}
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.319000000000415
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.59899999999999
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000033
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.800000000000011
[aiter INFO] 2025-09-25 11:45:30.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359999999999673
[aiter INFO] 2025-09-25 11:45:30.195 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          1,323.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:30.220 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.409663349685104 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:30.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {104, 706, 440, 6}
[aiter INFO] 2025-09-25 11:45:30.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.31899999999996
[aiter INFO] 2025-09-25 11:45:30.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.638999999999214
[aiter INFO] 2025-09-25 11:45:30.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.5590000000001965
[aiter INFO] 2025-09-25 11:45:30.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.7590000000000146
[aiter INFO] 2025-09-25 11:45:30.583 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            287.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:30.583 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:30.619 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.64919798356472 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:30.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 14}
[aiter INFO] 2025-09-25 11:45:30.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.63900000000001
[aiter INFO] 2025-09-25 11:45:30.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-25 11:45:30.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            719.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          727.5              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:30.659 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:30.660 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:31.150 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.65379169966916 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:31.255 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:31.255 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.67900000000003
[aiter INFO] 2025-09-25 11:45:31.256 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:45:31.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            733.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,064.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,798.1              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           18.0             18.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:31.275 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:31.322 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.20033651649362 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:31.370 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:31.370 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.07900000000001
[aiter INFO] 2025-09-25 11:45:31.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,070.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:31.406 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.554198084786385 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:31.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:31.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5989999999999895
[aiter INFO] 2025-09-25 11:45:31.944 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:31.945 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:32.183 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.10371303086234 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:32.233 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:32.233 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.758999999999986
[aiter INFO] 2025-09-25 11:45:32.245 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,592.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:32.269 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.97361380481484 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:32.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:32.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:45:32.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:32.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:33.180 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.230188172642546 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:33.205 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:33.205 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:45:33.220 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            944.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          944.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:33.221 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:33.221 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:33.278 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.48506983494994 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:33.470 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110}
[aiter INFO] 2025-09-25 11:45:33.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999995
[aiter INFO] 2025-09-25 11:45:33.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:45:33.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-09-25 11:45:33.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:45:33.489 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            423.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            871.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,307.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:33.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:33.536 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.32820813490612 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:33.584 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 515}
[aiter INFO] 2025-09-25 11:45:33.584 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.479000000000013
[aiter INFO] 2025-09-25 11:45:33.584 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.959000000000287
[aiter INFO] 2025-09-25 11:45:33.594 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,618.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:33.619 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.79539598863904 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:33.912 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:33.912 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:45:33.924 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:33.925 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:34.005 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.89772264910216 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:34.055 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:45:34.055 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-25 11:45:34.055 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-09-25 11:45:34.067 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,384.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:34.092 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.58114871589264 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:34.445 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:34.445 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:45:34.456 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            295.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:34.457 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 5364 (4.09%)
[1.0e-06, 1.0e-05): 4 (0.00%)
[1.0e-05, 1.0e-04): 408 (0.31%)
[1.0e-04, 1.0e-03): 30501 (23.27%)
[1.0e-03, 1.0e-02): 94553 (72.14%)
[1.0e-02, 1.0e-01): 242 (0.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d1dd9030e8e9541d12b24dc253df2660
triton_output_md5=f0eaa554882d4dfba800ffd7f125cd79
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.014312744140625
max_diff_thr=0.014140134677290916

Top differences:
Position (np.int64(2), np.int64(7), np.int64(44)): arr1 = -0.002106, arr2 = 0.012207, Diff = 0.014313
Position (np.int64(14), np.int64(2), np.int64(70)): arr1 = -0.248047, arr2 = -0.234375, Diff = 0.013672
Position (np.int64(15), np.int64(0), np.int64(51)): arr1 = 0.225586, arr2 = 0.212891, Diff = 0.012695
Position (np.int64(28), np.int64(6), np.int64(90)): arr1 = 0.160156, arr2 = 0.147461, Diff = 0.012695
Position (np.int64(27), np.int64(4), np.int64(126)): arr1 = 0.166992, arr2 = 0.154297, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1379 (4.21%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 88 (0.27%)
[1.0e-04, 1.0e-03): 7620 (23.25%)
[1.0e-03, 1.0e-02): 23607 (72.04%)
[1.0e-02, 1.0e-01): 73 (0.22%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=37e5e53ae5e0f730d3c6869f39899986
triton_output_md5=57cc3f235697be0982bdaafa86944266
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.012121211737394333

Top differences:
Position (np.int64(126), np.int64(6), np.int64(68)): arr1 = -0.141602, arr2 = -0.127930, Diff = 0.013672
Position (np.int64(61), np.int64(1), np.int64(74)): arr1 = -0.222656, arr2 = -0.208984, Diff = 0.013672
Position (np.int64(15), np.int64(1), np.int64(111)): arr1 = 0.175781, arr2 = 0.163086, Diff = 0.012695
Position (np.int64(56), np.int64(6), np.int64(66)): arr1 = -0.196289, arr2 = -0.183594, Diff = 0.012695
Position (np.int64(38), np.int64(1), np.int64(74)): arr1 = 0.144531, arr2 = 0.131836, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 5392 (4.11%)
[1.0e-06, 1.0e-05): 6 (0.00%)
[1.0e-05, 1.0e-04): 485 (0.37%)
[1.0e-04, 1.0e-03): 32588 (24.86%)
[1.0e-03, 1.0e-02): 92475 (70.55%)
[1.0e-02, 1.0e-01): 126 (0.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=113d12cedac5c98046bacf27521724fe
triton_output_md5=58df55fd4f3ce6f69acde54d5b24ca53
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.012100258842110634

Top differences:
Position (np.int64(0), np.int64(5), np.int64(59)): arr1 = -0.143555, arr2 = -0.129883, Diff = 0.013672
Position (np.int64(6), np.int64(4), np.int64(118)): arr1 = -0.214844, arr2 = -0.202148, Diff = 0.012695
Position (np.int64(7), np.int64(4), np.int64(39)): arr1 = 0.090332, arr2 = 0.078125, Diff = 0.012207
Position (np.int64(20), np.int64(6), np.int64(98)): arr1 = -0.158203, arr2 = -0.146484, Diff = 0.011719
Position (np.int64(14), np.int64(4), np.int64(25)): arr1 = -0.237305, arr2 = -0.225586, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1314 (4.01%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 122 (0.37%)
[1.0e-04, 1.0e-03): 8189 (24.99%)
[1.0e-03, 1.0e-02): 23114 (70.54%)
[1.0e-02, 1.0e-01): 26 (0.08%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6253b8c8e62ac9408173e9190a456b8b
triton_output_md5=406c1a8781c87efe95f88b8e6382023b
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.00958029180765152

Top differences:
Position (np.int64(115), np.int64(4), np.int64(70)): arr1 = 0.150391, arr2 = 0.139648, Diff = 0.010742
Position (np.int64(22), np.int64(5), np.int64(54)): arr1 = 0.080566, arr2 = 0.070312, Diff = 0.010254
Position (np.int64(17), np.int64(7), np.int64(126)): arr1 = 0.092773, arr2 = 0.082520, Diff = 0.010254
Position (np.int64(85), np.int64(5), np.int64(52)): arr1 = -0.129883, arr2 = -0.120117, Diff = 0.009766
Position (np.int64(84), np.int64(1), np.int64(17)): arr1 = 0.204102, arr2 = 0.194336, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 5352 (4.08%)
[1.0e-06, 1.0e-05): 7 (0.01%)
[1.0e-05, 1.0e-04): 781 (0.60%)
[1.0e-04, 1.0e-03): 40447 (30.86%)
[1.0e-03, 1.0e-02): 84482 (64.45%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9fefdb726364218f1f5e43902e7083f7
triton_output_md5=3e27e0e975c8f2da1292b0ba16daf0c5
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.010162353515625
max_diff_thr=0.010027703829109669

Top differences:
Position (np.int64(16), np.int64(7), np.int64(94)): arr1 = -0.003265, arr2 = -0.013428, Diff = 0.010162
Position (np.int64(22), np.int64(0), np.int64(81)): arr1 = 0.187500, arr2 = 0.177734, Diff = 0.009766
Position (np.int64(9), np.int64(6), np.int64(91)): arr1 = 0.036377, arr2 = 0.026978, Diff = 0.009399
Position (np.int64(9), np.int64(3), np.int64(91)): arr1 = 0.061279, arr2 = 0.052490, Diff = 0.008789
Position (np.int64(10), np.int64(7), np.int64(14)): arr1 = -0.170898, arr2 = -0.162109, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1365 (4.17%)
[1.0e-06, 1.0e-05): 2 (0.01%)
[1.0e-05, 1.0e-04): 209 (0.64%)
[1.0e-04, 1.0e-03): 10184 (31.08%)
[1.0e-03, 1.0e-02): 21007 (64.11%)[aiter INFO] 2025-09-25 11:45:34.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.961653387782597 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:34.517 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:45:34.517 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-09-25 11:45:34.517 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-09-25 11:45:34.532 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            731.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          738.9              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:34.533 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:34.533 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:35.016 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.07000016398949 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:35.122 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:35.122 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.560000000000002
[aiter INFO] 2025-09-25 11:45:35.122 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:45:35.141 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            733.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,080.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,814.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           18.1             18.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:35.142 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:35.189 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.09576230651082 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:35.238 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:35.238 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.239000000000004
[aiter INFO] 2025-09-25 11:45:35.248 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,098.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:35.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.519792078155106 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:35.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:35.797 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.439000000000021
[aiter INFO] 2025-09-25 11:45:35.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            446.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:35.810 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:36.049 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.22207948476961 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:36.099 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {857, 12, 1013}
[aiter INFO] 2025-09-25 11:45:36.099 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.399000000000342
[aiter INFO] 2025-09-25 11:45:36.099 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.119
[aiter INFO] 2025-09-25 11:45:36.099 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.47900000000027
[aiter INFO] 2025-09-25 11:45:36.111 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,548.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:36.136 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.644089155267956 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:36.697 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:36.697 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-25 11:45:36.709 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            446.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:36.710 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:37.046 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.03652484390405 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:37.071 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 149}
[aiter INFO] 2025-09-25 11:45:37.071 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.478999999999985
[aiter INFO] 2025-09-25 11:45:37.071 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000074
[aiter INFO] 2025-09-25 11:45:37.086 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            939.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          950.3              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:37.087 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:37.087 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:37.144 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.9615142864756 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {613, 615, 9, 394, 395, 10}
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999505
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000001
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.159000000000106
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:45:37.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:45:37.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            419.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            861.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,309.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:37.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:37.411 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.74040590005346 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:37.459 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 503}
[aiter INFO] 2025-09-25 11:45:37.460 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.678999999999974
[aiter INFO] 2025-09-25 11:45:37.460 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999796
[aiter INFO] 2025-09-25 11:45:37.470 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,628.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:37.495 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.46829720593915 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:37.778 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {426, 6}
[aiter INFO] 2025-09-25 11:45:37.778 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.31899999999996
[aiter INFO] 2025-09-25 11:45:37.778 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:45:37.790 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            296.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:37.791 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.45 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:37.872 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.54090102710346 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:37.922 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12}
[aiter INFO] 2025-09-25 11:45:37.922 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-09-25 11:45:37.922 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-09-25 11:45:37.934 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,385.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:37.958 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.09679203871453 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:38.311 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:38.311 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.7990000000000066
[aiter INFO] 2025-09-25 11:45:38.323 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            294.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:38.324 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:38.360 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.1327425105737 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:38.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 59, 4}
[aiter INFO] 2025-09-25 11:45:38.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.079000000000178
[aiter INFO] 2025-09-25 11:45:38.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.91900000000004
[aiter INFO] 2025-09-25 11:45:38.384 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-09-25 11:45:38.399 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0            727.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          742.8              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:38.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:38.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:38.883 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.4668713471677 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:38.996 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:38.996 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119
[aiter INFO] 2025-09-25 11:45:38.996 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999955
[aiter INFO] 2025-09-25 11:45:39.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            745.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,267.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,013.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           20.1             20.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:39.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    20.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:39.550 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.34331658630089 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:39.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 71, 23}
[aiter INFO] 2025-09-25 11:45:39.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.399
[aiter INFO] 2025-09-25 11:45:39.600 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.47900000000004
[aiter INFO] 2025-09-25 11:45:39.600 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.47900000000004
[aiter INFO] 2025-09-25 11:45:39.610 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          3,147.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             32.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:39.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.06828692053804 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:39.670 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:39.670 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:45:39.682 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            444.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:39.683 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:40.353 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.40232662104144 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:40.403 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:40.403 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.558999999999997
[aiter INFO] 2025-09-25 11:45:40.415 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,644.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             26.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:40.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.78116825872129 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:40.507 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:40.507 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:45:40.518 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            449.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:40.519 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:40.913 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.176712884466248 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:41.088 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:41.088 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.038999999999987
[aiter INFO] 2025-09-25 11:45:41.103 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,081.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,081.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           10.8             10.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:41.104 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:41.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:41.163 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.70209901226629 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:41.222 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:41.222 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.158999999999992
[aiter INFO] 2025-09-25 11:45:41.222 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:45:41.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            893.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,323.9              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:41.242 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.24 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:41.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.88150503021656 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:41.334 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:41.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119
[aiter INFO] 2025-09-25 11:45:41.345 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,690.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:41.369 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.03223773925611 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:41.628 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 20, 6}
[aiter INFO] 2025-09-25 11:45:41.628 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.719000000000051
[aiter INFO] 2025-09-25 11:45:41.629 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.718999999999994
[aiter INFO] 2025-09-25 11:45:41.629 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:45:41.640 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            294.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:41.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:41.722 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.91316825387501 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 974, 1299, 155}
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.59900000000016
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639000000000124
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.679000000000087
[aiter INFO] 2025-09-25 11:45:41.773 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-25 11:45:41.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          1,360.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:41.810 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.3023266689022 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:42.155 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:42.155 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.718999999999994
[aiter INFO] 2025-09-25 11:45:42.167 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            294.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:42.168 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:42.203 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.219881163227676 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:42.229 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:42.229 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-09-25 11:45:42.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            772.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          772.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:42.245 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:42.245 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:42.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.48385106454981 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:42.842 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:42.842 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.038999999999987
[aiter INFO] 2025-09-25 11:45:42.842 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-25 11:45:42.865 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            753.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,657.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,410.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           24.1             24.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:42.866 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:43.460 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.4990100223239 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:43.511 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 23}
[aiter INFO] 2025-09-25 11:45:43.511 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.60000000000002
[aiter INFO] 2025-09-25 11:45:43.512 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.959
[aiter INFO] 2025-09-25 11:45:43.522 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          5,812.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:43.669 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.92296040353208 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:43.704 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:43.704 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:45:43.716 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            513.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:43.717 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    63.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:44.404 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.54298044549355 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:44.610 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:44.610 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.59899999999999
[aiter INFO] 2025-09-25 11:45:44.622 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,811.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             48.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:44.777 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.66273257549446 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:44.819 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:44.819 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-25 11:45:44.831 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            517.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:44.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=68d6d1ab512029bda01630994dbd8ecc
triton_output_md5=e64945ce2faef4d14b57f7c54c02f635
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008845643140375614

Top differences:
Position (np.int64(2), np.int64(1), np.int64(42)): arr1 = 0.113770, arr2 = 0.104004, Diff = 0.009766
Position (np.int64(70), np.int64(7), np.int64(48)): arr1 = 0.123047, arr2 = 0.113770, Diff = 0.009277
Position (np.int64(54), np.int64(0), np.int64(67)): arr1 = 0.139648, arr2 = 0.130859, Diff = 0.008789
Position (np.int64(65), np.int64(1), np.int64(34)): arr1 = -0.137695, arr2 = -0.128906, Diff = 0.008789
Position (np.int64(31), np.int64(4), np.int64(97)): arr1 = 0.081543, arr2 = 0.072754, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 5307 (4.05%)
[1.0e-06, 1.0e-05): 4 (0.00%)
[1.0e-05, 1.0e-04): 977 (0.75%)
[1.0e-04, 1.0e-03): 44141 (33.68%)
[1.0e-03, 1.0e-02): 80643 (61.53%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=04a0e6bc9d60c4f61be69878ec1b8549
triton_output_md5=0dd1c1597716e79a7ec7254946c4f6c7
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008424599654972553

Top differences:
Position (np.int64(15), np.int64(4), np.int64(121)): arr1 = -0.168945, arr2 = -0.159180, Diff = 0.009766
Position (np.int64(20), np.int64(4), np.int64(14)): arr1 = -0.065430, arr2 = -0.056885, Diff = 0.008545
Position (np.int64(10), np.int64(4), np.int64(120)): arr1 = -0.087402, arr2 = -0.079102, Diff = 0.008301
Position (np.int64(11), np.int64(2), np.int64(31)): arr1 = -0.098145, arr2 = -0.089844, Diff = 0.008301
Position (np.int64(31), np.int64(2), np.int64(85)): arr1 = 0.085449, arr2 = 0.077148, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 1369 (4.18%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 269 (0.82%)
[1.0e-04, 1.0e-03): 11077 (33.80%)
[1.0e-03, 1.0e-02): 20048 (61.18%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d63013d3a4b1abe896e41a17dcef026
triton_output_md5=c775f09941b8b916bd9915fbb94767c0
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.007080078125
max_diff_thr=0.006793159991502762

Top differences:
Position (np.int64(122), np.int64(4), np.int64(91)): arr1 = -0.049316, arr2 = -0.042236, Diff = 0.007080
Position (np.int64(77), np.int64(1), np.int64(6)): arr1 = -0.111816, arr2 = -0.104980, Diff = 0.006836
Position (np.int64(78), np.int64(5), np.int64(23)): arr1 = 0.064453, arr2 = 0.057617, Diff = 0.006836
Position (np.int64(122), np.int64(6), np.int64(27)): arr1 = -0.102539, arr2 = -0.095703, Diff = 0.006836
Position (np.int64(93), np.int64(6), np.int64(10)): arr1 = 0.054199, arr2 = 0.047607, Diff = 0.006592

Threshold statistics:
[0.0e+00, 1.0e-06): 5270 (4.02%)
[1.0e-06, 1.0e-05): 27 (0.02%)
[1.0e-05, 1.0e-04): 1689 (1.29%)
[1.0e-04, 1.0e-03): 58880 (44.92%)
[1.0e-03, 1.0e-02): 65206 (49.75%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fc7eb22ff7ff5944f74384f1621c1e65
triton_output_md5=5bac030fecb0a0334abf37be4edfa477
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0060882568359375
max_diff_thr=0.006064843852072954

Top differences:
Position (np.int64(3), np.int64(7), np.int64(51)): arr1 = -0.009949, arr2 = -0.003860, Diff = 0.006088
Position (np.int64(25), np.int64(7), np.int64(37)): arr1 = 0.027832, arr2 = 0.021851, Diff = 0.005981
Position (np.int64(30), np.int64(4), np.int64(127)): arr1 = -0.148438, arr2 = -0.142578, Diff = 0.005859
Position (np.int64(26), np.int64(6), np.int64(103)): arr1 = -0.105469, arr2 = -0.099609, Diff = 0.005859
Position (np.int64(20), np.int64(1), np.int64(69)): arr1 = 0.068848, arr2 = 0.062988, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1359 (4.15%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 433 (1.32%)
[1.0e-04, 1.0e-03): 14923 (45.54%)
[1.0e-03, 1.0e-02): 16050 (48.98%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d39d0ed33e06a80e04832cb1d40ff17
triton_output_md5=ae772a6e1d67f5fe7ac5076d6893e837
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00732421875
max_diff_thr=0.006868131924420595

Top differences:
Position (np.int64(3), np.int64(4), np.int64(37)): arr1 = -0.073730, arr2 = -0.066406, Diff = 0.007324
Position (np.int64(14), np.int64(3), np.int64(106)): arr1 = -0.021851, arr2 = -0.014893, Diff = 0.006958
Position (np.int64(14), np.int64(7), np.int64(89)): arr1 = 0.105469, arr2 = 0.098633, Diff = 0.006836
Position (np.int64(3), np.int64(1), np.int64(37)): arr1 = -0.092773, arr2 = -0.085938, Diff = 0.006836
Position (np.int64(46), np.int64(4), np.int64(63)): arr1 = -0.034912, arr2 = -0.028198, Diff = 0.006714

Threshold statistics:
[0.0e+00, 1.0e-06): 5342 (4.08%)
[1.0e-06, 1.0e-05): 14 (0.01%)
[1.0e-05, 1.0e-04): 1802 (1.37%)
[1.0e-04, 1.0e-03): 59400 (45.32%)
[1.0e-03, 1.0e-02): 64514 (49.22%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1992eb5d762563f39eaafb2adf358114[aiter INFO] 2025-09-25 11:45:44.877 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.024247569760476 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:44.904 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:44.904 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.479000000000013
[aiter INFO] 2025-09-25 11:45:44.919 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,403.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,403.4              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           14.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:44.920 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:44.920 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:44.979 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.0284354751653 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 10, 537, 538}
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.59900000000016
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.399000000000001
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7190000000000225
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.59900000000016
[aiter INFO] 2025-09-25 11:45:45.038 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:45:45.057 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            421.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            878.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,328.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:45.058 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:45.102 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 94.03629711653927 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:45.150 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:45.150 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000001
[aiter INFO] 2025-09-25 11:45:45.161 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,677.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:45.186 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.64848503470421 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:45.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {482, 475, 6}
[aiter INFO] 2025-09-25 11:45:45.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.7590000000000146
[aiter INFO] 2025-09-25 11:45:45.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.798999999999978
[aiter INFO] 2025-09-25 11:45:45.543 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:45:45.555 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            332.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:45.556 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:45.637 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.56782166733599 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:45.689 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 233, 1312, 12}
[aiter INFO] 2025-09-25 11:45:45.689 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-09-25 11:45:45.689 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-25 11:45:45.689 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.47899999999936
[aiter INFO] 2025-09-25 11:45:45.689 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999998
[aiter INFO] 2025-09-25 11:45:45.701 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          1,371.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:45.726 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.99618795750165 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:46.076 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {342, 6}
[aiter INFO] 2025-09-25 11:45:46.076 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6789999999996326
[aiter INFO] 2025-09-25 11:45:46.076 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:45:46.088 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            328.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:46.089 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:46.125 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.291178291386895 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:46.149 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:46.149 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000007
[aiter INFO] 2025-09-25 11:45:46.164 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            959.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          959.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.6              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:46.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.59 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:46.165 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:46.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.82802982790636 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:46.729 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:46.729 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.199000000000012
[aiter INFO] 2025-09-25 11:45:46.729 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-25 11:45:46.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            752.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,653.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,405.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           24.1             24.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:46.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.05 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:46.802 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.19684195400464 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:46.849 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {71, 11, 83, 119, 59}
[aiter INFO] 2025-09-25 11:45:46.849 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.839000000000055
[aiter INFO] 2025-09-25 11:45:46.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.718999999999994
[aiter INFO] 2025-09-25 11:45:46.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.32000000000005
[aiter INFO] 2025-09-25 11:45:46.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.079000000000065
[aiter INFO] 2025-09-25 11:45:46.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.03899999999999
[aiter INFO] 2025-09-25 11:45:46.860 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 96.0            0.0          5,653.3        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:46.885 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.88569293340834 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:47.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {300, 6}
[aiter INFO] 2025-09-25 11:45:47.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.59900000000016
[aiter INFO] 2025-09-25 11:45:47.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:45:47.412 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            508.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:47.413 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:47.621 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.98974248678377 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {961, 935, 12, 493, 51, 636}
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.759000000000015
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.76000000000022
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.19900000000001
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.71900000000005
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.11900000000003
[aiter INFO] 2025-09-25 11:45:47.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.878999999999905
[aiter INFO] 2025-09-25 11:45:47.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          4,586.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:47.861 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.76530693161605 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:48.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {538, 6}
[aiter INFO] 2025-09-25 11:45:48.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.559999999999945
[aiter INFO] 2025-09-25 11:45:48.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:45:48.264 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            509.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:48.264 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:48.615 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.542633628343594 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:48.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 334}
[aiter INFO] 2025-09-25 11:45:48.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-09-25 11:45:48.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.19900000000007
[aiter INFO] 2025-09-25 11:45:48.657 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,388.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,403.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           14.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:48.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:48.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:48.716 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.17615810184196 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:48.775 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:48.775 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000012
[aiter INFO] 2025-09-25 11:45:48.775 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:45:48.795 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            895.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,326.5              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:48.796 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:48.840 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.11513849237177 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:48.890 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:45:48.890 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.31899999999999
[aiter INFO] 2025-09-25 11:45:48.901 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,673.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:48.926 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.48174270072786 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:49.453 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:49.453 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:45:49.465 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            339.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:49.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:49.549 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.65297055598532 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:49.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 285}
[aiter INFO] 2025-09-25 11:45:49.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.679000000000087
[aiter INFO] 2025-09-25 11:45:49.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-09-25 11:45:49.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000087
[aiter INFO] 2025-09-25 11:45:49.615 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,395.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:49.640 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.99065346499481 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:49.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:49.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:45:49.964 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            333.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:49.965 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:50.001 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.651158277203542 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:50.025 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:50.025 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-09-25 11:45:50.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            963.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          963.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.6              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:50.042 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:50.042 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:50.451 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.54172293502505 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:50.660 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:45:50.660 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.67900000000003
[aiter INFO] 2025-09-25 11:45:50.660 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:45:50.682 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            757.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,863.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,620.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           26.2             26.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:50.683 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    26.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:51.224 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.22377255293404 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {107, 11, 83, 23, 119, 59}
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.83899999999994
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.35899999999998
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.278999999999996
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.959
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.07899999999995
[aiter INFO] 2025-09-25 11:45:51.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.999000000000024
[aiter INFO] 2025-09-25 11:45:51.284 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 95.0            0.0          5,794.5        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             61.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:51.310 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.501574258993166 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:51.345 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:51.345 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-25 11:45:51.357 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            549.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:51.358 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    66.49 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:52.263 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.08708911721067 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:52.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12}
[aiter INFO] 2025-09-25 11:45:52.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.55899999999997
[aiter INFO] 2025-09-25 11:45:52.321 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.67900000000003
[aiter INFO] 2025-09-25 11:45:52.333 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,899.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             49.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:52.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.457187904579804 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:52.403 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {216, 6}
[aiter INFO] 2025-09-25 11:45:52.404 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.038999999999987
[aiter INFO] 2025-09-25 11:45:52.404 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:45:52.416 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            545.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:52.417 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    55.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:52.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 36.89316818767255 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:52.495 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:45:52.495 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.558999999999997
[aiter INFO] 2025-09-25 11:45:52.510 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,611.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,611.2              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           16.1             16.1         NaN          NaN
[aiter INFO] 2025-09-25 11:45:52.511 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    16.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:52.512 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:52.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.96189082967173 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {130, 131, 9, 10, 108, 109}
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.319000000000187
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.718999999999994
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.358999999999924
[aiter INFO] 2025-09-25 11:45:52.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:45:52.653 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            423.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            918.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,372.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.7             13.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:52.654 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:52.700 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.24898993909949 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:52.754 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 887}
[aiter INFO] 2025-09-25 11:45:52.754 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-09-25 11:45:52.754 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.239000000000487
[aiter INFO] 2025-09-25 11:45:52.764 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,732.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             17.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:52.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.027891169680224 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:53.240 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {48, 6, 55}
[aiter INFO] 2025-09-25 11:45:53.240 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.319000000000017
[aiter INFO] 2025-09-25 11:45:53.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:45:53.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.319000000000017
[aiter INFO] 2025-09-25 11:45:53.253 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            366.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:53.254 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    21.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:53.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.28070325544564 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:53.387 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:53.387 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000012
[aiter INFO] 2025-09-25 11:45:53.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,436.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:53.424 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.87223747785728 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:53.716 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:53.716 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999976
[aiter INFO] 2025-09-25 11:45:53.728 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:53.729 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:53.764 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.178287114689844 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 39, 44, 14, 114, 19}
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000037
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.238999999999976
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:45:53.789 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:45:53.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  95.0            0.0            915.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          967.0              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN            9.7              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:53.805 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:53.805 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:54.304 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.59001951229453 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:54.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:45:54.400 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.119
[aiter INFO] 2025-09-25 11:45:54.401 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-25 11:45:54.419 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            750.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,082.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,833.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           28.3             28.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:54.420 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

triton_output_md5=a313d47046a98b2b8e2def8fe892dacd
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.005933363921940327

Top differences:
Position (np.int64(25), np.int64(2), np.int64(15)): arr1 = -0.076172, arr2 = -0.069824, Diff = 0.006348
Position (np.int64(5), np.int64(3), np.int64(73)): arr1 = 0.052734, arr2 = 0.046875, Diff = 0.005859
Position (np.int64(24), np.int64(6), np.int64(84)): arr1 = 0.101074, arr2 = 0.095215, Diff = 0.005859
Position (np.int64(6), np.int64(5), np.int64(106)): arr1 = 0.056885, arr2 = 0.051025, Diff = 0.005859
Position (np.int64(26), np.int64(1), np.int64(115)): arr1 = -0.062256, arr2 = -0.056396, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1317 (4.02%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 446 (1.36%)
[1.0e-04, 1.0e-03): 14651 (44.71%)
[1.0e-03, 1.0e-02): 16347 (49.89%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e9bcd0942b8b8d3bcf1207c3deb28e99
triton_output_md5=e3a4a69f48c8e46a40f61bc40d52d5ee
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.00657894741743803

Top differences:
Position (np.int64(115), np.int64(7), np.int64(118)): arr1 = 0.045898, arr2 = 0.039062, Diff = 0.006836
Position (np.int64(124), np.int64(4), np.int64(18)): arr1 = 0.095215, arr2 = 0.088867, Diff = 0.006348
Position (np.int64(54), np.int64(4), np.int64(74)): arr1 = -0.023804, arr2 = -0.017578, Diff = 0.006226
Position (np.int64(106), np.int64(6), np.int64(60)): arr1 = -0.070801, arr2 = -0.064941, Diff = 0.005859
Position (np.int64(69), np.int64(5), np.int64(99)): arr1 = 0.032959, arr2 = 0.027100, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 5332 (4.07%)
[1.0e-06, 1.0e-05): 29 (0.02%)
[1.0e-05, 1.0e-04): 1955 (1.49%)
[1.0e-04, 1.0e-03): 61792 (47.14%)
[1.0e-03, 1.0e-02): 61964 (47.27%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1256430a4670dc34953cffd3db70f7bb
triton_output_md5=456808893d438242fd4a55222af7a0e5
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006103515625
max_diff_thr=0.0058343056589365005

Top differences:
Position (np.int64(20), np.int64(3), np.int64(4)): arr1 = 0.052246, arr2 = 0.046143, Diff = 0.006104
Position (np.int64(3), np.int64(5), np.int64(111)): arr1 = 0.052246, arr2 = 0.046143, Diff = 0.006104
Position (np.int64(3), np.int64(0), np.int64(54)): arr1 = 0.061768, arr2 = 0.055908, Diff = 0.005859
Position (np.int64(26), np.int64(7), np.int64(5)): arr1 = 0.080566, arr2 = 0.074707, Diff = 0.005859
Position (np.int64(25), np.int64(4), np.int64(11)): arr1 = 0.057373, arr2 = 0.051514, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1323 (4.04%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 471 (1.44%)
[1.0e-04, 1.0e-03): 15485 (47.26%)
[1.0e-03, 1.0e-02): 15481 (47.24%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e742280fb7f66c658c29a0810213adae
triton_output_md5=f91072449f0738b52cb17b566980442d
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.005115089472383261

Top differences:
Position (np.int64(112), np.int64(6), np.int64(6)): arr1 = 0.055420, arr2 = 0.050049, Diff = 0.005371
Position (np.int64(9), np.int64(3), np.int64(78)): arr1 = -0.035156, arr2 = -0.030029, Diff = 0.005127
Position (np.int64(98), np.int64(0), np.int64(39)): arr1 = 0.075195, arr2 = 0.070312, Diff = 0.004883
Position (np.int64(91), np.int64(2), np.int64(22)): arr1 = 0.050781, arr2 = 0.045898, Diff = 0.004883
Position (np.int64(102), np.int64(6), np.int64(65)): arr1 = 0.071289, arr2 = 0.066406, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 5447 (4.16%)
[1.0e-06, 1.0e-05): 52 (0.04%)
[1.0e-05, 1.0e-04): 3357 (2.56%)
[1.0e-04, 1.0e-03): 77475 (59.11%)
[1.0e-03, 1.0e-02): 44741 (34.13%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=32026dd8e48597d8731c8f2bbba6a50e
triton_output_md5=7e00c8755362b6733781c11f23096571
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004873520694673061

Top differences:
Position (np.int64(7), np.int64(2), np.int64(75)): arr1 = -0.057129, arr2 = -0.052002, Diff = 0.005127
Position (np.int64(26), np.int64(3), np.int64(37)): arr1 = -0.110352, arr2 = -0.105469, Diff = 0.004883
Position (np.int64(6), np.int64(1), np.int64(63)): arr1 = -0.055176, arr2 = -0.050781, Diff = 0.004395
Position (np.int64(23), np.int64(5), np.int64(119)): arr1 = -0.060547, arr2 = -0.056152, Diff = 0.004395
Position (np.int64(24), np.int64(2), np.int64(73)): arr1 = 0.062988, arr2 = 0.058838, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1345 (4.10%)
[1.0e-06, 1.0e-05): 12 (0.04%)
[1.0e-05, 1.0e-04): 817 (2.49%)
[1.0e-04, 1.0e-03): 19492 (59.48%)
[1.0e-03, 1.0e-02): 11102 (33.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c7f31e53ed49dd552f3a2d4c28b8fcd1
triton_output_md5=77cd629e83e184a5f0e43e011dfc20a0
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])[aiter INFO] 2025-09-25 11:45:54.472 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 152.96835607231253 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:54.520 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 23}
[aiter INFO] 2025-09-25 11:45:54.520 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.439
[aiter INFO] 2025-09-25 11:45:54.520 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.07899999999995
[aiter INFO] 2025-09-25 11:45:54.531 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          7,411.5        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             74.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:54.735 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.76807932216342 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:55.301 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:55.301 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-25 11:45:55.314 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            629.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:55.315 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    81.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:55.479 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 146.30499010038847 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:55.535 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:45:55.535 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.67900000000003
[aiter INFO] 2025-09-25 11:45:55.547 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          6,075.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             60.8         NaN          NaN
[aiter INFO] 2025-09-25 11:45:55.766 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.35619809397376 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:55.957 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:55.957 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000004
[aiter INFO] 2025-09-25 11:45:55.969 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            630.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:55.971 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    67.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:56.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 38.501890837260994 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:56.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {344, 114, 4}
[aiter INFO] 2025-09-25 11:45:56.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.598999999999933
[aiter INFO] 2025-09-25 11:45:56.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.158999999999992
[aiter INFO] 2025-09-25 11:45:56.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.839
[aiter INFO] 2025-09-25 11:45:56.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0          1,791.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,833.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:56.367 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    18.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:56.367 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:56.425 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.42050516487349 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:56.488 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:45:56.488 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.35899999999998
[aiter INFO] 2025-09-25 11:45:56.488 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:45:56.507 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,102.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,534.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:56.508 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:56.554 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.04387093475549 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:56.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 251, 395, 527}
[aiter INFO] 2025-09-25 11:45:56.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.199000000000012
[aiter INFO] 2025-09-25 11:45:56.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.278999999999996
[aiter INFO] 2025-09-25 11:45:56.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.19900000000007
[aiter INFO] 2025-09-25 11:45:56.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.19900000000007
[aiter INFO] 2025-09-25 11:45:56.615 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          2,884.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             29.7         NaN          NaN
[aiter INFO] 2025-09-25 11:45:56.640 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.49124724410548 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:57.144 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:57.144 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000003
[aiter INFO] 2025-09-25 11:45:57.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            394.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:57.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:57.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.63044573351888 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:57.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 1312, 12}
[aiter INFO] 2025-09-25 11:45:57.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839000000000055
[aiter INFO] 2025-09-25 11:45:57.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.318999999999505
[aiter INFO] 2025-09-25 11:45:57.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.23999999999998
[aiter INFO] 2025-09-25 11:45:57.302 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,452.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.0         NaN          NaN
[aiter INFO] 2025-09-25 11:45:57.326 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.133623727772495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:57.646 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:57.646 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000007
[aiter INFO] 2025-09-25 11:45:57.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            389.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:45:57.659 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    28.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:57.694 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.895534792158863 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:57.719 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 4, 29, 14}
[aiter INFO] 2025-09-25 11:45:57.719 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999976
[aiter INFO] 2025-09-25 11:45:57.719 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999988
[aiter INFO] 2025-09-25 11:45:57.719 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999955
[aiter INFO] 2025-09-25 11:45:57.719 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-09-25 11:45:57.734 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          1,113.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,149.5              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           11.5             11.5         NaN          NaN
[aiter INFO] 2025-09-25 11:45:57.735 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:57.735 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:45:58.161 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.63693060851335 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:58.316 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1025, 130, 9, 138, 1036, 1037, 17, 1110, 1049, 1023, 1051, 806, 1062, 1065, 816, 817, 1076, 1077, 826, 828, 445, 1087, 961, 837, 455, 456, 839, 1099, 846, 974, 1103, 465, 849, 467, 1104, 1105, 86, 1106, 856, 1107, 1108, 1109, 476, 477, 94, 990, 1111, 97, 484, 488, 105, 1000, 1002, 108, 494, 116, 1012, 1013, 119, 127}
[aiter INFO] 2025-09-25 11:45:58.316 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.60000000000036
[aiter INFO] 2025-09-25 11:45:58.316 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.55899999999997
[aiter INFO] 2025-09-25 11:45:58.316 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.39899999999997
[aiter INFO] 2025-09-25 11:45:58.316 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.480000000000018
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000378
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.4390000000003
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.63899999999921
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999505
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000306
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 107.15899999999965
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.23900000000049
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999505
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.47999999999956
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000524
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.15999999999985
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119000000000597
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.79899999999907
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999796
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.83899999999994
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.11899999999969
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000378
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.52000000000044
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079000000000633
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999796
[aiter INFO] 2025-09-25 11:45:58.317 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.11999999999989
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.67900000000009
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.19999999999891
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000306
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.639000000001033
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.399000000001251
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.958999999999833
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.67999999999938
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.15899999999965
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.51899999999841
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000378
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.55899999999986
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.3189999999995
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.47900000000027
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.398999999999432
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.23999999999978
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000001179
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.03899999999976
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.47900000000027
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000005
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.04000000000087
[aiter INFO] 2025-09-25 11:45:58.318 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.958999999998923
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.79999999999995
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.198999999999614
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.47999999999956
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999505
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.27900000000045
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.519
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.878999999999905
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999842
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999998632
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.4390000000003
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.07899999999995
[aiter INFO] 2025-09-25 11:45:58.319 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:45:58.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  71.0            0.0            711.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  71.0            0.0          6,789.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,536.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN          105.4            105.6         NaN          NaN
[aiter INFO] 2025-09-25 11:45:58.338 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   105.65 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:58.425 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 482.2391168315812 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:58.652 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1189}
[aiter INFO] 2025-09-25 11:45:58.652 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 409.03999999999996
[aiter INFO] 2025-09-25 11:45:58.652 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 406.6399999999994
[aiter INFO] 2025-09-25 11:45:58.663 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0         40,527.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            409.4         NaN          NaN
[aiter INFO] 2025-09-25 11:45:58.963 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.505920713785855 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:59.001 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:45:59.001 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-09-25 11:45:59.013 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,231.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:59.014 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   421.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:45:59.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 406.1097425989585 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:59.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {49, 1274, 1291, 12}
[aiter INFO] 2025-09-25 11:45:59.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 325.67999999999995
[aiter INFO] 2025-09-25 11:45:59.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.119999999999
[aiter INFO] 2025-09-25 11:45:59.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 330.27999999999884
[aiter INFO] 2025-09-25 11:45:59.290 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 329.44000000000005
[aiter INFO] 2025-09-25 11:45:59.302 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         31,840.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0            328.2         NaN          NaN
[aiter INFO] 2025-09-25 11:45:59.588 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.96095057790822 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:45:59.810 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {601, 6}
[aiter INFO] 2025-09-25 11:45:59.810 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.638999999999669
[aiter INFO] 2025-09-25 11:45:59.810 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999983
[aiter INFO] 2025-09-25 11:45:59.822 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,215.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-09-25 11:45:59.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   340.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:00.162 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 89.35510861401511 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:00.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:00.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.279
[aiter INFO] 2025-09-25 11:46:00.206 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          7,200.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        7,200.1              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           72.0             72.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:00.207 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    72.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:00.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:00.270 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.34490086123495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:00.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:46:00.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.43900000000002
[aiter INFO] 2025-09-25 11:46:00.331 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:46:00.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            484.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,825.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,310.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           33.1             33.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:00.351 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:00.405 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 183.22352489622511 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:00.458 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59, 35, 47}
[aiter INFO] 2025-09-25 11:46:00.458 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.51899999999998
[aiter INFO] 2025-09-25 11:46:00.458 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.95900000000006
[aiter INFO] 2025-09-25 11:46:00.458 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.43999999999994
[aiter INFO] 2025-09-25 11:46:00.458 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.35899999999992
[aiter INFO] 2025-09-25 11:46:00.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0         10,038.2        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:00.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.14311886364871 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:00.998 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:00.998 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-25 11:46:01.010 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            658.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:01.011 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   110.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:01.099 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.39851523625967 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25, 831}
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.71899999999994
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.04000000000002
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.47899999999998
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.23900000000003
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.279
[aiter INFO] 2025-09-25 11:46:01.152 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.9989999999998
[aiter INFO] 2025-09-25 11:46:01.162 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          7,905.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:01.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.328049468522025 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:01.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:01.477 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-25 11:46:01.489 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            658.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:01.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    89.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:01.527 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.77325754118438 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:01.552 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 38, 200, 10, 23}
[aiter INFO] 2025-09-25 11:46:01.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.839
[aiter INFO] 2025-09-25 11:46:01.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.799000000000035
[aiter INFO] 2025-09-25 11:46:01.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.43900000000008
[aiter INFO] 2025-09-25 11:46:01.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.278999999999996
[aiter INFO] 2025-09-25 11:46:01.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.959
[aiter INFO] 2025-09-25 11:46:01.566 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0          3,653.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,805.9              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           38.1             38.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:01.567 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    38.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:01.567 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:01.992 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 164.88206961957536 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:02.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {848, 9, 858, 17}
[aiter INFO] 2025-09-25 11:46:02.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.6800000000003
[aiter INFO] 2025-09-25 11:46:02.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.19900000000001
[aiter INFO] 2025-09-25 11:46:02.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-25 11:46:02.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-25 11:46:02.176 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            826.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          9,283.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,248.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN          102.5            102.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:02.177 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   102.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:02.261 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 456.0877022766831 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:02.499 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:02.499 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 381.12
[aiter INFO] 2025-09-25 11:46:02.510 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0         38,126.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0            381.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:02.721 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.581554293042366 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:02.811 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {629, 6}
[aiter INFO] 2025-09-25 11:46:02.811 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000233
[aiter INFO] 2025-09-25 11:46:02.811 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.478999999999985
[aiter INFO] 2025-09-25 11:46:02.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,000.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:02.824 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   391.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:03.039 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 385.6086825380231 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:03.111 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1205, 1306, 1119, 1279}
[aiter INFO] 2025-09-25 11:46:03.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.88
[aiter INFO] 2025-09-25 11:46:03.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 305.0
[aiter INFO] 2025-09-25 11:46:03.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 305.2000000000007
[aiter INFO] 2025-09-25 11:46:03.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 305.3199999999997
[aiter INFO] 2025-09-25 11:46:03.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 305.1990000000005
[aiter INFO] 2025-09-25 11:46:03.124 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         29,537.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0            307.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:03.328 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.18035623844307 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:03.591 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:03.591 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.479000000000042
[aiter INFO] 2025-09-25 11:46:03.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,010.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:03.603 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   317.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:04.001 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 86.0771090529933 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:04.029 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:04.029 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.799
[aiter INFO] 2025-09-25 11:46:04.044 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          6,865.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        6,865.4              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           68.7             68.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:04.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    68.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:04.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:04.107 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.02213842916017 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:04.167 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:46:04.167 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.079000000000008
[aiter INFO] 2025-09-25 11:46:04.167 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.879000000000019
[aiter INFO] 2025-09-25 11:46:04.186 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            422.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,794.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,216.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           32.2             32.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:04.187 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004914579913020134

Top differences:
Position (np.int64(104), np.int64(2), np.int64(104)): arr1 = 0.048340, arr2 = 0.043213, Diff = 0.005127
Position (np.int64(10), np.int64(2), np.int64(25)): arr1 = 0.034180, arr2 = 0.029175, Diff = 0.005005
Position (np.int64(110), np.int64(0), np.int64(123)): arr1 = -0.084473, arr2 = -0.079590, Diff = 0.004883
Position (np.int64(38), np.int64(2), np.int64(100)): arr1 = 0.054443, arr2 = 0.049561, Diff = 0.004883
Position (np.int64(0), np.int64(0), np.int64(66)): arr1 = -0.068359, arr2 = -0.063477, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 5294 (4.04%)
[1.0e-06, 1.0e-05): 39 (0.03%)
[1.0e-05, 1.0e-04): 3415 (2.61%)
[1.0e-04, 1.0e-03): 77315 (58.99%)
[1.0e-03, 1.0e-02): 45009 (34.34%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6fe74acaefa53ee6657bd0996ff605a2
triton_output_md5=908b0bdd3dbe8dedb14ed66ff918fd5c
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0048828125
max_diff_thr=0.0045744553208351135

Top differences:
Position (np.int64(26), np.int64(4), np.int64(30)): arr1 = -0.101562, arr2 = -0.096680, Diff = 0.004883
Position (np.int64(0), np.int64(7), np.int64(61)): arr1 = -0.018677, arr2 = -0.014038, Diff = 0.004639
Position (np.int64(15), np.int64(6), np.int64(0)): arr1 = -0.021606, arr2 = -0.017090, Diff = 0.004517
Position (np.int64(31), np.int64(2), np.int64(120)): arr1 = -0.016602, arr2 = -0.012268, Diff = 0.004333
Position (np.int64(31), np.int64(2), np.int64(11)): arr1 = -0.013550, arr2 = -0.009338, Diff = 0.004211

Threshold statistics:
[0.0e+00, 1.0e-06): 1304 (3.98%)
[1.0e-06, 1.0e-05): 13 (0.04%)
[1.0e-05, 1.0e-04): 865 (2.64%)
[1.0e-04, 1.0e-03): 19231 (58.69%)
[1.0e-03, 1.0e-02): 11355 (34.65%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2233fac0952bdebd301b32e38d7161ac
triton_output_md5=15093fa50585bba6230605226f33b1c6
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001953125
max_diff_thr=0.0019009148236364126

Top differences:
Position (np.int64(99), np.int64(4), np.int64(10)): arr1 = 0.029419, arr2 = 0.027466, Diff = 0.001953
Position (np.int64(118), np.int64(7), np.int64(125)): arr1 = -0.029297, arr2 = -0.027466, Diff = 0.001831
Position (np.int64(19), np.int64(3), np.int64(27)): arr1 = 0.023804, arr2 = 0.022095, Diff = 0.001709
Position (np.int64(105), np.int64(4), np.int64(79)): arr1 = -0.014160, arr2 = -0.012512, Diff = 0.001648
Position (np.int64(25), np.int64(2), np.int64(73)): arr1 = -0.015991, arr2 = -0.014343, Diff = 0.001648

Threshold statistics:
[0.0e+00, 1.0e-06): 5450 (4.16%)
[1.0e-06, 1.0e-05): 353 (0.27%)
[1.0e-05, 1.0e-04): 19913 (15.19%)
[1.0e-04, 1.0e-03): 104215 (79.51%)
[1.0e-03, 1.0e-02): 1141 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7a92576709c250a9df69d4c15812dfa3
triton_output_md5=c21f24f480538625dcbdbe63277bfed9
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017757783643901348

Top differences:
Position (np.int64(29), np.int64(5), np.int64(98)): arr1 = 0.032959, arr2 = 0.031128, Diff = 0.001831
Position (np.int64(11), np.int64(5), np.int64(83)): arr1 = 0.027832, arr2 = 0.026245, Diff = 0.001587
Position (np.int64(11), np.int64(7), np.int64(125)): arr1 = -0.026733, arr2 = -0.025146, Diff = 0.001587
Position (np.int64(22), np.int64(3), np.int64(61)): arr1 = 0.010132, arr2 = 0.008545, Diff = 0.001587
Position (np.int64(3), np.int64(5), np.int64(81)): arr1 = 0.009583, arr2 = 0.008118, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1302 (3.97%)
[1.0e-06, 1.0e-05): 75 (0.23%)
[1.0e-05, 1.0e-04): 5022 (15.33%)
[1.0e-04, 1.0e-03): 26084 (79.60%)
[1.0e-03, 1.0e-02): 285 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=920c1b3a398c3dc7e454e80f35c5c995
triton_output_md5=f1d30fc35d4d54757210ff399380599b
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017929715104401112

Top differences:
Position (np.int64(18), np.int64(4), np.int64(9)): arr1 = -0.023071, arr2 = -0.021240, Diff = 0.001831
Position (np.int64(93), np.int64(5), np.int64(120)): arr1 = 0.023804, arr2 = 0.021973, Diff = 0.001831
Position (np.int64(18), np.int64(5), np.int64(9)): arr1 = -0.028320, arr2 = -0.026611, Diff = 0.001709
Position (np.int64(40), np.int64(2), np.int64(62)): arr1 = 0.020630, arr2 = 0.018921, Diff = 0.001709
Position (np.int64(12), np.int64(0), np.int64(40)): arr1 = 0.008118, arr2 = 0.006439, Diff = 0.001678

Threshold statistics:
[0.0e+00, 1.0e-06): 5494 (4.19%)
[1.0e-06, 1.0e-05): 364 (0.28%)
[1.0e-05, 1.0e-04): 19951 (15.22%)
[1.0e-04, 1.0e-03): 104129 (79.44%)
[1.0e-03, 1.0e-02): 1134 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=74b1af36ddc4c9724b2d0bf337789006
triton_output_md5=4d59f3a13fdbf377fcfac4a0de506479
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16[aiter INFO] 2025-09-25 11:46:04.242 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 182.8686640699311 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:04.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35}
[aiter INFO] 2025-09-25 11:46:04.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.63900000000001
[aiter INFO] 2025-09-25 11:46:04.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.60000000000002
[aiter INFO] 2025-09-25 11:46:04.306 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0         10,186.2        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            102.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:04.330 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.635415941771896 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:04.737 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:04.737 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:46:04.749 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            522.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:04.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   108.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:04.839 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.12883195546593 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.55899999999997
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.84000000000003
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.519
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.99899999999997
[aiter INFO] 2025-09-25 11:46:04.892 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.43900000000002
[aiter INFO] 2025-09-25 11:46:04.903 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,963.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:04.927 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.86155456245536 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:05.292 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {650, 643, 6}
[aiter INFO] 2025-09-25 11:46:05.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000000124
[aiter INFO] 2025-09-25 11:46:05.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.519000000000233
[aiter INFO] 2025-09-25 11:46:05.293 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:46:05.305 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            514.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:05.305 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    88.20 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:05.344 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.272247640213166 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 10, 299, 16, 372, 23}
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.84
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.119
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.67899999999986
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.239000000000004
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.71900000000028
[aiter INFO] 2025-09-25 11:46:05.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.03899999999999
[aiter INFO] 2025-09-25 11:46:05.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  95.0            0.0          3,434.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,617.7              0.0         CPU        55464
[avg us/iter]                                         NaN   NaN           36.2             36.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:05.389 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    36.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:05.390 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:05.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.36069312308094 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:05.967 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 42, 43, 10, 206, 208, 240, 241, 273, 274, 218, 219}
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000018
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.919000000000096
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.6790000000000305
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.43899999999985
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.03899999999976
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000178
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000433
[aiter INFO] 2025-09-25 11:46:05.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000178
[aiter INFO] 2025-09-25 11:46:05.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            848.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            988.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,936.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.4             19.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:05.987 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:06.683 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.64746526326283 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:06.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:06.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.31899999999999
[aiter INFO] 2025-09-25 11:46:06.744 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,959.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:06.868 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.65800016587323 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:06.903 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:06.903 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-25 11:46:06.915 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            445.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:06.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.05 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:07.662 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.63044551221452 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:07.717 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:07.717 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.678999999999974
[aiter INFO] 2025-09-25 11:46:07.730 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,542.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:07.861 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.62313849147003 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:07.907 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:07.907 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:46:07.919 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            454.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:07.920 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.97 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_2tg_4w.co GetFunction: _ZN5aiter32pa_bf16_pertokenFp8_gqa16_2tg_4wE Success
[aiter INFO] 2025-09-25 11:46:07.966 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.897494977211007 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:07.993 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:07.993 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.399000000000001
[aiter INFO] 2025-09-25 11:46:08.008 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            891.6        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          891.6              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            8.9              8.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:08.009 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     8.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:08.010 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:08.067 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.88584157735994 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:08.128 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 98, 229, 230, 614, 615, 9, 10, 1010, 1011, 504, 505, 988, 989}
[aiter INFO] 2025-09-25 11:46:08.128 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-25 11:46:08.128 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:46:08.128 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000000033
[aiter INFO] 2025-09-25 11:46:08.128 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000142
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000000487
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000597
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.799000000000035
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000001397
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000742
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.71900000000096
[aiter INFO] 2025-09-25 11:46:08.129 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:46:08.148 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            405.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  94.0            0.0            790.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,273.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.7             12.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:08.149 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:08.194 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.08665333466955 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:08.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 407}
[aiter INFO] 2025-09-25 11:46:08.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.95999999999998
[aiter INFO] 2025-09-25 11:46:08.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-09-25 11:46:08.254 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,557.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             15.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:08.279 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.68491081259038 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:08.713 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:08.713 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:46:08.725 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:08.726 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    18.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:08.806 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.37019834069923 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:08.856 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1208, 194, 1312, 12}
[aiter INFO] 2025-09-25 11:46:08.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000378
[aiter INFO] 2025-09-25 11:46:08.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-09-25 11:46:08.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000001543
[aiter INFO] 2025-09-25 11:46:08.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-25 11:46:08.869 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          1,330.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:08.893 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.99264361834762 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:09.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {552, 76, 398, 6}
[aiter INFO] 2025-09-25 11:46:09.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.719000000000051
[aiter INFO] 2025-09-25 11:46:09.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:46:09.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.719000000000051
[aiter INFO] 2025-09-25 11:46:09.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-25 11:46:09.264 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            290.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:09.265 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:09.300 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.39058415901543 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:09.324 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:46:09.324 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.518999999999778
[aiter INFO] 2025-09-25 11:46:09.324 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-09-25 11:46:09.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            691.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          698.4              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.0              7.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:09.340 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     6.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:09.341 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:09.697 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.19556431723113 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {416, 417, 9, 10, 1054, 1055}
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.399000000000342
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.63900000000001
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000306
[aiter INFO] 2025-09-25 11:46:10.041 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-25 11:46:10.060 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            876.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,028.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,941.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.4             19.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:10.061 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:10.616 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.82012863265406 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:10.667 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:10.667 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.798999999999978
[aiter INFO] 2025-09-25 11:46:10.678 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,027.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:10.704 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.85523772416728 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:10.738 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:10.738 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-25 11:46:10.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            445.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:10.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:11.463 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.40270313355002 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:11.516 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:11.516 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.479000000000013
[aiter INFO] 2025-09-25 11:46:11.528 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,578.6        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:11.553 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.42708915117944 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:11.596 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {685, 6}
[aiter INFO] 2025-09-25 11:46:11.596 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.118999999999687
[aiter INFO] 2025-09-25 11:46:11.596 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:46:11.608 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            448.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:11.609 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:11.732 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.91375242276947 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:11.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:11.759 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:46:11.775 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            902.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          902.5              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.0              9.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:11.775 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:11.776 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:11.834 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.14405970762272 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1032, 1033, 9, 10, 493, 494, 207, 208, 405, 406, 1109, 1110}
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000597
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.158999999999992
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-25 11:46:11.896 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000142
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.358999999999924
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000178
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.03899999999885
[aiter INFO] 2025-09-25 11:46:11.897 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:11.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            410.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            806.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,280.5              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:11.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:11.962 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.91553470462856 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:12.012 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 671}
[aiter INFO] 2025-09-25 11:46:12.013 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.399
[aiter INFO] 2025-09-25 11:46:12.013 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.59900000000016
[aiter INFO] 2025-09-25 11:46:12.023 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,602.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:12.048 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.69165358596509 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:12.528 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:12.528 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:46:12.540 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:12.541 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:12.622 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.44111912439365 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:12.672 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:46:12.672 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999505
[aiter INFO] 2025-09-25 11:46:12.672 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:46:12.684 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,381.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:12.709 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.73601976686185 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:13.199 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:13.200 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:46:13.212 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            298.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:13.213 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:13.250 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.10900988068321 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:13.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:46:13.274 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-25 11:46:13.275 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000001
[aiter INFO] 2025-09-25 11:46:13.289 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            708.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          715.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.2              7.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:13.291 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:13.291 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:13.569 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.52228703003118 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:13.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 515, 516}
[aiter INFO] 2025-09-25 11:46:13.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-25 11:46:13.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-25 11:46:13.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000487
[aiter INFO] 2025-09-25 11:46:13.731 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999999833
[aiter INFO] 2025-09-25 11:46:13.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            886.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,044.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,949.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.5             19.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:13.750 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00164794921875
max_diff_thr=0.0016316170804202557

Top differences:
Position (np.int64(26), np.int64(7), np.int64(103)): arr1 = 0.011658, arr2 = 0.010010, Diff = 0.001648
Position (np.int64(3), np.int64(4), np.int64(15)): arr1 = -0.019165, arr2 = -0.017578, Diff = 0.001587
Position (np.int64(1), np.int64(1), np.int64(46)): arr1 = -0.015991, arr2 = -0.014465, Diff = 0.001526
Position (np.int64(24), np.int64(3), np.int64(67)): arr1 = -0.027588, arr2 = -0.026123, Diff = 0.001465
Position (np.int64(29), np.int64(3), np.int64(52)): arr1 = -0.011780, arr2 = -0.010315, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1392 (4.25%)
[1.0e-06, 1.0e-05): 92 (0.28%)
[1.0e-05, 1.0e-04): 5072 (15.48%)
[1.0e-04, 1.0e-03): 25935 (79.15%)
[1.0e-03, 1.0e-02): 277 (0.85%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=904588b83e467379685bef19cd32517a
triton_output_md5=dcde2913501dc2cc03b460fb77ff39b6
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0390625
max_diff_thr=0.03470466658473015

Top differences:
Position (np.int64(119), np.int64(4), np.int64(126)): arr1 = -0.523438, arr2 = -0.484375, Diff = 0.039062
Position (np.int64(2), np.int64(9), np.int64(51)): arr1 = 0.566406, arr2 = 0.527344, Diff = 0.039062
Position (np.int64(68), np.int64(4), np.int64(0)): arr1 = 0.296875, arr2 = 0.259766, Diff = 0.037109
Position (np.int64(40), np.int64(3), np.int64(19)): arr1 = 0.063965, arr2 = 0.101074, Diff = 0.037109
Position (np.int64(116), np.int64(5), np.int64(86)): arr1 = 0.025391, arr2 = 0.062256, Diff = 0.036865

Threshold statistics:
[0.0e+00, 1.0e-06): 6984 (4.26%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 62 (0.04%)
[1.0e-04, 1.0e-03): 11385 (6.95%)
[1.0e-03, 1.0e-02): 108349 (66.13%)
[1.0e-02, 1.0e-01): 37059 (22.62%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=08cbeebd7351e2926dd03be53a28d895
triton_output_md5=8ec781ccb9816146edb059ff57560cec
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.03515625
max_diff_thr=0.029113231226801872

Top differences:
Position (np.int64(4), np.int64(6), np.int64(39)): arr1 = 0.519531, arr2 = 0.484375, Diff = 0.035156
Position (np.int64(4), np.int64(6), np.int64(22)): arr1 = 0.523438, arr2 = 0.490234, Diff = 0.033203
Position (np.int64(6), np.int64(1), np.int64(111)): arr1 = 0.231445, arr2 = 0.199219, Diff = 0.032227
Position (np.int64(12), np.int64(3), np.int64(18)): arr1 = -0.180664, arr2 = -0.148438, Diff = 0.032227
Position (np.int64(1), np.int64(3), np.int64(46)): arr1 = -0.683594, arr2 = -0.652344, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 1671 (4.08%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 15 (0.04%)
[1.0e-04, 1.0e-03): 2823 (6.89%)
[1.0e-03, 1.0e-02): 26923 (65.73%)
[1.0e-02, 1.0e-01): 9528 (23.26%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2ca52d1f387f52bb314e72881939d2e6
triton_output_md5=72a2c93c638dc4341520d6f8683e125d
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.01898454688489437

Top differences:
Position (np.int64(54), np.int64(2), np.int64(75)): arr1 = -0.427734, arr2 = -0.406250, Diff = 0.021484
Position (np.int64(127), np.int64(0), np.int64(61)): arr1 = -0.126953, arr2 = -0.105957, Diff = 0.020996
Position (np.int64(66), np.int64(3), np.int64(103)): arr1 = 0.180664, arr2 = 0.160156, Diff = 0.020508
Position (np.int64(107), np.int64(0), np.int64(31)): arr1 = -0.099121, arr2 = -0.079102, Diff = 0.020020
Position (np.int64(61), np.int64(6), np.int64(29)): arr1 = 0.193359, arr2 = 0.173828, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 6846 (4.18%)
[1.0e-06, 1.0e-05): 7 (0.00%)
[1.0e-05, 1.0e-04): 240 (0.15%)
[1.0e-04, 1.0e-03): 26155 (15.96%)
[1.0e-03, 1.0e-02): 125507 (76.60%)
[1.0e-02, 1.0e-01): 5085 (3.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8c80dfef254903f88640127ab107f239
triton_output_md5=79fb21e451b98b7bc7865263758402b7
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0224609375
max_diff_thr=0.020087337121367455

Top differences:
Position (np.int64(2), np.int64(3), np.int64(119)): arr1 = -0.140625, arr2 = -0.118164, Diff = 0.022461
Position (np.int64(16), np.int64(9), np.int64(18)): arr1 = 0.300781, arr2 = 0.279297, Diff = 0.021484
Position (np.int64(13), np.int64(3), np.int64(71)): arr1 = 0.041016, arr2 = 0.021118, Diff = 0.019897
Position (np.int64(20), np.int64(4), np.int64(10)): arr1 = -0.217773, arr2 = -0.198242, Diff = 0.019531
Position (np.int64(9), np.int64(3), np.int64(124)): arr1 = -0.197266, arr2 = -0.178711, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 1761 (4.30%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 49 (0.12%)
[1.0e-04, 1.0e-03): 6512 (15.90%)
[1.0e-03, 1.0e-02): 31385 (76.62%)
[1.0e-02, 1.0e-01): 1253 (3.06%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=06d807f14b9f991f617bd93448a8fad1
triton_output_md5=f96c5313a58561cbb98bc99d94d9bc8b
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}[aiter INFO] 2025-09-25 11:46:13.799 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.02445560693741 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:13.847 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:13.847 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.87899999999999
[aiter INFO] 2025-09-25 11:46:13.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,036.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:13.882 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.19421778752072 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:14.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:14.365 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-25 11:46:14.376 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:14.377 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:14.604 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.32665347344805 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:14.655 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:14.655 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.839
[aiter INFO] 2025-09-25 11:46:14.667 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,591.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:14.691 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.592643375739016 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:15.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:15.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:46:15.263 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            450.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:15.264 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:15.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.96998031319368 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:15.627 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:15.627 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000004
[aiter INFO] 2025-09-25 11:46:15.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            917.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          917.5              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:15.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:15.644 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:15.701 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.01695058959545 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 999, 1000, 9, 10, 812, 813, 1109, 1110, 31}
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.078999999999951
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.238999999999578
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0790000000015425
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000012
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599000000000046
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.640000000000327
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000669
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:46:15.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000001
[aiter INFO] 2025-09-25 11:46:15.782 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            414.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0            824.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,291.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           12.9             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:15.783 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.90 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:15.828 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.99832632872138 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:15.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 395, 1211}
[aiter INFO] 2025-09-25 11:46:15.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999995
[aiter INFO] 2025-09-25 11:46:15.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.71900000000005
[aiter INFO] 2025-09-25 11:46:15.879 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.878999999998996
[aiter INFO] 2025-09-25 11:46:15.889 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,595.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:15.913 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.516594008644034 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:16.442 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:16.442 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.039000000000016
[aiter INFO] 2025-09-25 11:46:16.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            303.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:16.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:16.535 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.13733693573734 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:16.584 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:46:16.585 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.399000000001251
[aiter INFO] 2025-09-25 11:46:16.585 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-09-25 11:46:16.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,391.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:16.621 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.631039576070144 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:17.110 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 6}
[aiter INFO] 2025-09-25 11:46:17.110 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.438999999999851
[aiter INFO] 2025-09-25 11:46:17.110 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:46:17.122 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            297.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:17.124 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:17.160 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.638495072869972 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:17.184 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 9, 4}
[aiter INFO] 2025-09-25 11:46:17.184 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999869
[aiter INFO] 2025-09-25 11:46:17.184 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-25 11:46:17.185 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-09-25 11:46:17.199 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0            716.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          731.3              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:17.200 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:17.201 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:17.436 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.45138612478087 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:17.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:46:17.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999978
[aiter INFO] 2025-09-25 11:46:17.582 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-25 11:46:17.601 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            898.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,068.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,967.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.7             19.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:17.601 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.67 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:17.650 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.72110886739033 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:17.698 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:17.698 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.920000000000016
[aiter INFO] 2025-09-25 11:46:17.708 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,071.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:17.733 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.55343572810145 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:18.260 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:18.261 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:46:18.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            450.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:18.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:18.471 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.34050484045898 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:18.524 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:18.524 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.959000000000003
[aiter INFO] 2025-09-25 11:46:18.536 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,601.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0             26.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:18.561 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.272633857361164 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:19.190 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {384, 356, 69, 6, 377, 251}
[aiter INFO] 2025-09-25 11:46:19.190 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999869
[aiter INFO] 2025-09-25 11:46:19.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-25 11:46:19.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999992
[aiter INFO] 2025-09-25 11:46:19.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-25 11:46:19.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999905
[aiter INFO] 2025-09-25 11:46:19.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.919000000000096
[aiter INFO] 2025-09-25 11:46:19.203 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 95.0            0.0            429.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:19.204 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:19.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.84680194813426 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:19.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:19.493 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:46:19.508 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            927.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          927.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:19.509 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:19.509 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:19.567 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.893356705066 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:19.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {218, 9, 10, 812, 813, 1109, 1110, 537, 538, 219}
[aiter INFO] 2025-09-25 11:46:19.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999742
[aiter INFO] 2025-09-25 11:46:19.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.198999999999984
[aiter INFO] 2025-09-25 11:46:19.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-25 11:46:19.641 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000051
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000669
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.238999999999578
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000633
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:19.642 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000142
[aiter INFO] 2025-09-25 11:46:19.661 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            414.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0            840.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,310.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:19.661 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:19.706 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.94921785534018 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:19.757 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {671, 11, 383}
[aiter INFO] 2025-09-25 11:46:19.757 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.838999999999942
[aiter INFO] 2025-09-25 11:46:19.757 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.679000000000002
[aiter INFO] 2025-09-25 11:46:19.757 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.838999999999942
[aiter INFO] 2025-09-25 11:46:19.768 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,605.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:19.792 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.71619823693049 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 13, 90, 27, 510}
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.7590000000000146
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.7590000000000146
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.7590000000000146
[aiter INFO] 2025-09-25 11:46:20.295 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:46:20.307 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            289.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:20.307 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:20.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.02842541614382 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:20.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 506, 12}
[aiter INFO] 2025-09-25 11:46:20.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999998705
[aiter INFO] 2025-09-25 11:46:20.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.719000000000051
[aiter INFO] 2025-09-25 11:46:20.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-25 11:46:20.450 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,378.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:20.475 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.427089001577684 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:20.954 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:20.954 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-25 11:46:20.966 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:20.967 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.05 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:21.004 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.495138709792997 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:21.028 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {104, 504, 4}
[aiter INFO] 2025-09-25 11:46:21.028 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-25 11:46:21.029 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-09-25 11:46:21.029 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.87899999999999
[aiter INFO] 2025-09-25 11:46:21.044 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0            712.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          727.3              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:21.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:21.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:21.304 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.46921816733804 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:21.448 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:46:21.449 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-09-25 11:46:21.449 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.879000000000019
[aiter INFO] 2025-09-25 11:46:21.467 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            896.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,082.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,979.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.8             19.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:21.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.79 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:21.516 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.76427763995558 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:21.564 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:21.564 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.119
[aiter INFO] 2025-09-25 11:46:21.575 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,096.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:21.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.699990162755 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:22.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:22.134 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5589999999999975
[aiter INFO] 2025-09-25 11:46:22.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            451.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:22.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:22.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.33736667066518 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:22.390 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:22.390 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.119
[aiter INFO] 2025-09-25 11:46:22.402 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,618.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             26.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:22.427 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.152623556628086 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:23.019 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {699, 6}
[aiter INFO] 2025-09-25 11:46:23.019 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999651
[aiter INFO] 2025-09-25 11:46:23.019 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.599000000000018
[aiter INFO] 2025-09-25 11:46:23.031 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            446.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:23.031 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:23.335 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.60209913005923 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:23.364 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {184, 4, 189}
[aiter INFO] 2025-09-25 11:46:23.364 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000033
[aiter INFO] 2025-09-25 11:46:23.364 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:46:23.364 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.07899999999995
[aiter INFO] 2025-09-25 11:46:23.380 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0            922.4        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          942.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:23.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:23.381 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:23.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.0680295960738 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {745, 9, 747, 10, 493, 494, 955, 956}
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.15899999999965
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.038999999999987
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000415
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.319000000000415
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999796
[aiter INFO] 2025-09-25 11:46:23.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999998632
[aiter INFO] 2025-09-25 11:46:23.520 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            417.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            849.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,310.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:23.521 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:23.566 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.46281153494769 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:23.617 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:23.617 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.63900000000001
[aiter INFO] 2025-09-25 11:46:23.627 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,649.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:23.651 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.340366237234356 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:24.185 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:24.186 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:46:24.197 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:24.198 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:24.280 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.27910868366166 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:24.329 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 1065, 12}
[aiter INFO] 2025-09-25 11:46:24.329 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999287
[aiter INFO] 2025-09-25 11:46:24.329 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59900000000016
[aiter INFO] 2025-09-25 11:46:24.329 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-25 11:46:24.341 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,386.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:24.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.27779213036641 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:24.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:24.857 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:46:24.869 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:24.871 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.0146484375
max_diff_thr=0.013098464347422123

Top differences:
Position (np.int64(104), np.int64(7), np.int64(76)): arr1 = 0.140625, arr2 = 0.125977, Diff = 0.014648
Position (np.int64(93), np.int64(8), np.int64(105)): arr1 = 0.184570, arr2 = 0.169922, Diff = 0.014648
Position (np.int64(119), np.int64(1), np.int64(23)): arr1 = 0.095215, arr2 = 0.081055, Diff = 0.014160
Position (np.int64(32), np.int64(8), np.int64(5)): arr1 = 0.241211, arr2 = 0.227539, Diff = 0.013672
Position (np.int64(30), np.int64(8), np.int64(9)): arr1 = -0.277344, arr2 = -0.263672, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 6737 (4.11%)
[1.0e-06, 1.0e-05): 7 (0.00%)
[1.0e-05, 1.0e-04): 533 (0.33%)
[1.0e-04, 1.0e-03): 38245 (23.34%)
[1.0e-03, 1.0e-02): 118012 (72.03%)
[1.0e-02, 1.0e-01): 306 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f62467b57fefa5967bea8c67301a43a3
triton_output_md5=aaca6ec76273e9634deb198de865b4ea
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0146484375
max_diff_thr=0.012760882265865803

Top differences:
Position (np.int64(4), np.int64(0), np.int64(100)): arr1 = -0.185547, arr2 = -0.170898, Diff = 0.014648
Position (np.int64(9), np.int64(1), np.int64(85)): arr1 = -0.289062, arr2 = -0.275391, Diff = 0.013672
Position (np.int64(21), np.int64(6), np.int64(49)): arr1 = -0.107422, arr2 = -0.094238, Diff = 0.013184
Position (np.int64(26), np.int64(0), np.int64(126)): arr1 = 0.010498, arr2 = 0.023560, Diff = 0.013062
Position (np.int64(11), np.int64(4), np.int64(57)): arr1 = 0.169922, arr2 = 0.157227, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1671 (4.08%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 133 (0.32%)
[1.0e-04, 1.0e-03): 9647 (23.55%)
[1.0e-03, 1.0e-02): 29429 (71.85%)
[1.0e-02, 1.0e-01): 78 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fc4133290180beed22961766a6d368fd
triton_output_md5=ffb97258d29d101b624f00aa5bf55da3
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0146484375
max_diff_thr=0.013036717660725117

Top differences:
Position (np.int64(13), np.int64(9), np.int64(37)): arr1 = 0.180664, arr2 = 0.166016, Diff = 0.014648
Position (np.int64(94), np.int64(2), np.int64(109)): arr1 = -0.172852, arr2 = -0.159180, Diff = 0.013672
Position (np.int64(0), np.int64(4), np.int64(104)): arr1 = 0.214844, arr2 = 0.201172, Diff = 0.013672
Position (np.int64(13), np.int64(6), np.int64(34)): arr1 = -0.033936, arr2 = -0.020630, Diff = 0.013306
Position (np.int64(22), np.int64(8), np.int64(75)): arr1 = -0.205078, arr2 = -0.192383, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 6943 (4.24%)
[1.0e-06, 1.0e-05): 9 (0.01%)
[1.0e-05, 1.0e-04): 617 (0.38%)
[1.0e-04, 1.0e-03): 40742 (24.87%)
[1.0e-03, 1.0e-02): 115374 (70.42%)
[1.0e-02, 1.0e-01): 155 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a52e68d22284e75ad029329a43356ef3
triton_output_md5=5525321882b78698cdb6cca2ba76aa43
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01171875
max_diff_thr=0.011521843262016773

Top differences:
Position (np.int64(4), np.int64(1), np.int64(8)): arr1 = -0.203125, arr2 = -0.191406, Diff = 0.011719
Position (np.int64(12), np.int64(8), np.int64(33)): arr1 = 0.188477, arr2 = 0.176758, Diff = 0.011719
Position (np.int64(23), np.int64(0), np.int64(83)): arr1 = -0.143555, arr2 = -0.131836, Diff = 0.011719
Position (np.int64(1), np.int64(6), np.int64(19)): arr1 = 0.028809, arr2 = 0.017090, Diff = 0.011719
Position (np.int64(12), np.int64(7), np.int64(33)): arr1 = 0.164062, arr2 = 0.152344, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 157 (0.38%)
[1.0e-04, 1.0e-03): 10214 (24.94%)
[1.0e-03, 1.0e-02): 28862 (70.46%)
[1.0e-02, 1.0e-01): 47 (0.11%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e7ac6476152c9ba30f5d70111f701a2e
triton_output_md5=f9780ca77d0c50c79b33465880929257
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.010040640830993652

Top differences:
Position (np.int64(60), np.int64(4), np.int64(102)): arr1 = -0.176758, arr2 = -0.166016, Diff = 0.010742
Position (np.int64(40), np.int64(0), np.int64(5)): arr1 = -0.109863, arr2 = -0.099121, Diff = 0.010742
Position (np.int64(112), np.int64(9), np.int64(18)): arr1 = 0.031494, arr2 = 0.021240, Diff = 0.010254
Position (np.int64(43), np.int64(3), np.int64(102)): arr1 = -0.025391, arr2 = -0.015503, Diff = 0.009888
Position (np.int64(90), np.int64(7), np.int64(122)): arr1 = -0.119141, arr2 = -0.109375, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 6837 (4.17%)
[1.0e-06, 1.0e-05): 13 (0.01%)
[1.0e-05, 1.0e-04): 991 (0.60%)
[1.0e-04, 1.0e-03): 51127 (31.21%)
[1.0e-03, 1.0e-02): 104869 (64.01%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ead456444087294bb00793e21089918d
triton_output_md5=8c512a8a840fb6ce3a35007f5fb32d7b
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01171875
max_diff_thr=0.01001669466495514

Top differences:
Position (np.int64(9), np.int64(8), np.int64(25)): arr1 = 0.181641, arr2 = 0.169922, Diff = 0.011719[aiter INFO] 2025-09-25 11:46:24.907 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.116158343925335 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:24.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 249, 4}
[aiter INFO] 2025-09-25 11:46:24.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.03899999999976
[aiter INFO] 2025-09-25 11:46:24.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999905
[aiter INFO] 2025-09-25 11:46:24.932 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-09-25 11:46:24.947 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0            730.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          745.4              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.5              7.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:24.949 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:24.949 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:25.172 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.98326732203512 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 108, 109, 142, 141, 339, 340}
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999999
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.07899999999995
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.360000000000127
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000142
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.439000000000078
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.278999999999996
[aiter INFO] 2025-09-25 11:46:25.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000178
[aiter INFO] 2025-09-25 11:46:25.407 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            867.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,050.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,979.8              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           19.8             19.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:25.407 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:25.455 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.24503963536556 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:25.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:25.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.43899999999999
[aiter INFO] 2025-09-25 11:46:25.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,121.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:25.540 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.16332668243068 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:26.019 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {286, 6}
[aiter INFO] 2025-09-25 11:46:26.020 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.919000000000096
[aiter INFO] 2025-09-25 11:46:26.020 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:46:26.031 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            443.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:26.032 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:26.207 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.300940595641 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:26.259 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:26.259 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.839
[aiter INFO] 2025-09-25 11:46:26.271 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,620.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             26.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:26.296 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.654019748515424 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:26.910 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:26.910 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:46:26.922 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            453.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:26.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:27.202 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.175524772983966 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:27.229 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:27.229 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000009
[aiter INFO] 2025-09-25 11:46:27.244 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            949.0        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          949.0              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:27.245 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:27.245 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:27.303 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.06763364359884 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 493, 494, 1109, 1110}
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000597
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000342
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-09-25 11:46:27.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:27.392 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            422.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            860.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,308.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:27.392 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:27.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.99041566046157 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:27.486 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 875, 383}
[aiter INFO] 2025-09-25 11:46:27.486 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.599000000000018
[aiter INFO] 2025-09-25 11:46:27.486 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.118999999999687
[aiter INFO] 2025-09-25 11:46:27.486 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.19900000000007
[aiter INFO] 2025-09-25 11:46:27.496 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,627.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:27.521 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.32096031485217 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:28.076 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:28.076 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:46:28.088 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            300.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:28.089 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.60 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:28.169 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.76187134438221 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:28.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 623}
[aiter INFO] 2025-09-25 11:46:28.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.439000000000306
[aiter INFO] 2025-09-25 11:46:28.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-25 11:46:28.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.719000000000051
[aiter INFO] 2025-09-25 11:46:28.371 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,385.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:28.397 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.59264348845671 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:28.594 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 6}
[aiter INFO] 2025-09-25 11:46:28.594 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:46:28.595 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:46:28.606 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            294.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:28.607 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:28.643 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.77553467349251 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:28.668 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {144, 9, 4}
[aiter INFO] 2025-09-25 11:46:28.668 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999983
[aiter INFO] 2025-09-25 11:46:28.668 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.038999999999987
[aiter INFO] 2025-09-25 11:46:28.668 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000011
[aiter INFO] 2025-09-25 11:46:28.683 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0            730.0        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          745.9              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.5              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:28.684 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:28.684 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:29.040 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.92786133761453 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:29.214 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 163, 164}
[aiter INFO] 2025-09-25 11:46:29.214 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-09-25 11:46:29.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.039000000000044
[aiter INFO] 2025-09-25 11:46:29.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-09-25 11:46:29.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.598999999999933
[aiter INFO] 2025-09-25 11:46:29.233 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            904.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,244.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,172.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           21.7             21.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:29.234 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:29.798 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.43160400945361 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:29.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:29.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.119
[aiter INFO] 2025-09-25 11:46:29.861 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,213.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             32.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:29.886 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.89876257753608 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:29.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {699, 69, 6, 447}
[aiter INFO] 2025-09-25 11:46:29.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:46:29.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:46:29.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.63900000000001
[aiter INFO] 2025-09-25 11:46:29.923 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:46:29.935 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            431.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:29.936 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.58 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:30.645 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.85970256352189 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:30.699 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {818, 51, 12}
[aiter INFO] 2025-09-25 11:46:30.699 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.15900000000056
[aiter INFO] 2025-09-25 11:46:30.699 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.359000000000037
[aiter INFO] 2025-09-25 11:46:30.699 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.119
[aiter INFO] 2025-09-25 11:46:30.711 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,627.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:30.736 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.542772285418934 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:30.779 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:30.779 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-25 11:46:30.791 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            454.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:30.792 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    31.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:31.071 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.30146521949532 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:31.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 269}
[aiter INFO] 2025-09-25 11:46:31.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-09-25 11:46:31.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-09-25 11:46:31.112 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          1,079.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,091.9              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           10.9             10.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:31.113 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:31.113 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:31.172 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.19279229345888 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:31.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 1098, 1099}
[aiter INFO] 2025-09-25 11:46:31.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:46:31.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.35899999999998
[aiter INFO] 2025-09-25 11:46:31.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.359000000000378
[aiter INFO] 2025-09-25 11:46:31.241 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:46:31.260 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            424.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            892.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,329.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:31.261 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:31.306 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.28064391931684 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:31.353 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:31.353 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.35900000000001
[aiter INFO] 2025-09-25 11:46:31.364 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,696.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:31.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.76096017968537 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:31.905 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:31.905 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:46:31.917 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            301.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:31.918 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:31.999 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.67791049138154 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:32.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 194, 12}
[aiter INFO] 2025-09-25 11:46:32.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.639000000001033
[aiter INFO] 2025-09-25 11:46:32.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999905
[aiter INFO] 2025-09-25 11:46:32.208 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000009
[aiter INFO] 2025-09-25 11:46:32.220 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,403.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:32.246 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.52848502462453 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 706, 678, 6, 104, 685, 111, 531, 510}
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.238999999999919
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.59900000000016
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.238999999999578
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.238999999999578
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000000327
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6790000000000873
[aiter INFO] 2025-09-25 11:46:32.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.718999999999596
[aiter INFO] 2025-09-25 11:46:32.435 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0            273.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:32.436 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:32.472 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.81355446990174 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:32.497 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:32.497 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.238999999999976
[aiter INFO] 2025-09-25 11:46:32.512 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            766.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          766.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:32.513 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:32.513 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:32.908 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.33497053856897 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:33.061 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:46:33.061 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.038999999999987
[aiter INFO] 2025-09-25 11:46:33.061 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000053
[aiter INFO] 2025-09-25 11:46:33.080 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            919.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,673.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,593.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           25.9             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:33.081 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    25.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:33.132 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.92081151622358 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:33.181 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 95, 23}
[aiter INFO] 2025-09-25 11:46:33.181 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.87900000000002
[aiter INFO] 2025-09-25 11:46:33.181 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.71900000000005
[aiter INFO] 2025-09-25 11:46:33.181 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.79899999999998
[aiter INFO] 2025-09-25 11:46:33.191 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          5,766.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:33.337 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.75899023466771 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:33.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:33.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999984
[aiter INFO] 2025-09-25 11:46:33.764 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            527.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:33.764 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:33.929 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.12872340419506 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:33.983 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:33.983 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.959
[aiter INFO] 2025-09-25 11:46:33.995 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,840.0        CUDA            8
[avg us/iter]               NaN   NaN            0.0             48.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:34.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.26314856746409 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:34.585 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:34.586 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:46:34.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            527.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:34.598 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(29), np.int64(7), np.int64(105)): arr1 = -0.162109, arr2 = -0.152344, Diff = 0.009766
Position (np.int64(23), np.int64(0), np.int64(41)): arr1 = -0.129883, arr2 = -0.120605, Diff = 0.009277
Position (np.int64(8), np.int64(5), np.int64(25)): arr1 = 0.071289, arr2 = 0.062256, Diff = 0.009033
Position (np.int64(11), np.int64(5), np.int64(18)): arr1 = -0.031982, arr2 = -0.023071, Diff = 0.008911

Threshold statistics:
[0.0e+00, 1.0e-06): 1638 (4.00%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 246 (0.60%)
[1.0e-04, 1.0e-03): 12725 (31.07%)
[1.0e-03, 1.0e-02): 26347 (64.32%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f7d9645b5350791574c0704327418b32
triton_output_md5=647450591459724761597bbcea723c26
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.009458297863602638

Top differences:
Position (np.int64(53), np.int64(6), np.int64(18)): arr1 = -0.146484, arr2 = -0.135742, Diff = 0.010742
Position (np.int64(109), np.int64(1), np.int64(40)): arr1 = -0.104980, arr2 = -0.095215, Diff = 0.009766
Position (np.int64(0), np.int64(1), np.int64(79)): arr1 = -0.043457, arr2 = -0.033691, Diff = 0.009766
Position (np.int64(123), np.int64(8), np.int64(91)): arr1 = -0.126953, arr2 = -0.117188, Diff = 0.009766
Position (np.int64(40), np.int64(8), np.int64(125)): arr1 = 0.115234, arr2 = 0.105957, Diff = 0.009277

Threshold statistics:
[0.0e+00, 1.0e-06): 6768 (4.13%)
[1.0e-06, 1.0e-05): 15 (0.01%)
[1.0e-05, 1.0e-04): 1160 (0.71%)
[1.0e-04, 1.0e-03): 54961 (33.55%)
[1.0e-03, 1.0e-02): 100935 (61.61%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=13a8484106a11e5f62f2ce63691a3153
triton_output_md5=da7ea5c9cfd4207e769c42d51428d092
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01123046875
max_diff_thr=0.01019955612719059

Top differences:
Position (np.int64(12), np.int64(5), np.int64(127)): arr1 = -0.112305, arr2 = -0.101074, Diff = 0.011230
Position (np.int64(0), np.int64(3), np.int64(108)): arr1 = 0.138672, arr2 = 0.128906, Diff = 0.009766
Position (np.int64(0), np.int64(9), np.int64(91)): arr1 = 0.060303, arr2 = 0.069336, Diff = 0.009033
Position (np.int64(0), np.int64(6), np.int64(91)): arr1 = 0.053467, arr2 = 0.062256, Diff = 0.008789
Position (np.int64(11), np.int64(3), np.int64(4)): arr1 = 0.088379, arr2 = 0.079590, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1698 (4.15%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 249 (0.61%)
[1.0e-04, 1.0e-03): 13456 (32.85%)
[1.0e-03, 1.0e-02): 25550 (62.38%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=5993922593f1144ee5dae57541fbe773
triton_output_md5=59a412519cb239771303460d7adcab5f
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.006540528032928705

Top differences:
Position (np.int64(90), np.int64(8), np.int64(19)): arr1 = 0.052002, arr2 = 0.045166, Diff = 0.006836
Position (np.int64(54), np.int64(5), np.int64(121)): arr1 = 0.056396, arr2 = 0.049805, Diff = 0.006592
Position (np.int64(96), np.int64(8), np.int64(85)): arr1 = -0.092285, arr2 = -0.085938, Diff = 0.006348
Position (np.int64(30), np.int64(9), np.int64(76)): arr1 = -0.060547, arr2 = -0.054199, Diff = 0.006348
Position (np.int64(76), np.int64(2), np.int64(7)): arr1 = 0.127930, arr2 = 0.121582, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6788 (4.14%)
[1.0e-06, 1.0e-05): 36 (0.02%)
[1.0e-05, 1.0e-04): 2239 (1.37%)
[1.0e-04, 1.0e-03): 74077 (45.21%)
[1.0e-03, 1.0e-02): 80700 (49.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=63f405fe983b95d9d26dd254bd1e060f
triton_output_md5=4c8bc229730fa08ab0b6a4d8e9a8d047
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.006448640953749418

Top differences:
Position (np.int64(7), np.int64(1), np.int64(35)): arr1 = -0.104004, arr2 = -0.097168, Diff = 0.006836
Position (np.int64(8), np.int64(7), np.int64(108)): arr1 = -0.066895, arr2 = -0.060059, Diff = 0.006836
Position (np.int64(19), np.int64(4), np.int64(23)): arr1 = 0.052490, arr2 = 0.046143, Diff = 0.006348
Position (np.int64(13), np.int64(9), np.int64(113)): arr1 = -0.043701, arr2 = -0.037598, Diff = 0.006104
Position (np.int64(13), np.int64(6), np.int64(28)): arr1 = 0.050537, arr2 = 0.044434, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 1626 (3.97%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 552 (1.35%)
[1.0e-04, 1.0e-03): 18385 (44.89%)
[1.0e-03, 1.0e-02): 20391 (49.78%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d73322d5323b4e0bb24d13d20d32aeb
triton_output_md5=a6f55d1c325b551cb86ff71c083a68ba
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00732421875
max_diff_thr=0.006726457271724939

Top differences:
Position (np.int64(1), np.int64(3), np.int64(112)): arr1 = -0.096191, arr2 = -0.088867, Diff = 0.007324
Position (np.int64(0), np.int64(2), np.int64(10)): arr1 = -0.079102, arr2 = -0.072266, Diff = 0.006836
Position (np.int64(76), np.int64(2), np.int64(106)): arr1 = 0.040527, arr2 = 0.033936, Diff = 0.006592[aiter INFO] 2025-09-25 11:46:34.924 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.190950382464 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:34.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 214}
[aiter INFO] 2025-09-25 11:46:34.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.15900000000002
[aiter INFO] 2025-09-25 11:46:34.952 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-09-25 11:46:34.967 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          1,361.3        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,376.3              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           13.8             13.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:34.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:34.968 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:35.027 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.552356761871 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:35.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 815}
[aiter INFO] 2025-09-25 11:46:35.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000037
[aiter INFO] 2025-09-25 11:46:35.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:46:35.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.15900000000056
[aiter INFO] 2025-09-25 11:46:35.105 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.47899999999936
[aiter INFO] 2025-09-25 11:46:35.124 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            904.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,347.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.5             13.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:35.125 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:35.170 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.11001986560255 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:35.219 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:35.219 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.479000000000013
[aiter INFO] 2025-09-25 11:46:35.229 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,689.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:35.253 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.05680197359312 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:35.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:35.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:46:35.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            345.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:35.833 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:35.914 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.97970301030885 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:36.117 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12}
[aiter INFO] 2025-09-25 11:46:36.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-25 11:46:36.118 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:46:36.130 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,414.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:36.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.44807931780815 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:36.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:36.339 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:46:36.351 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            338.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:36.352 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:36.388 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.81235641816465 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:36.413 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:36.413 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.558999999999997
[aiter INFO] 2025-09-25 11:46:36.428 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            946.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          946.5              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:36.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:36.429 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:36.760 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.07161357320182 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:37.016 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:46:37.016 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.878999999999962
[aiter INFO] 2025-09-25 11:46:37.016 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.158999999999992
[aiter INFO] 2025-09-25 11:46:37.035 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            919.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,711.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,630.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           26.3             26.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:37.035 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    26.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:37.086 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.83525664263433 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:37.135 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {167, 11, 95, 71}
[aiter INFO] 2025-09-25 11:46:37.135 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.23900000000003
[aiter INFO] 2025-09-25 11:46:37.135 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.32000000000002
[aiter INFO] 2025-09-25 11:46:37.135 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.24000000000001
[aiter INFO] 2025-09-25 11:46:37.135 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.07899999999995
[aiter INFO] 2025-09-25 11:46:37.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          5,739.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             59.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:37.171 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.94350475249904 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:37.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:37.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-25 11:46:37.670 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            527.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:37.671 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:37.834 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.33745521247977 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:37.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-09-25 11:46:37.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.27900000000005
[aiter INFO] 2025-09-25 11:46:37.887 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.999000000000024
[aiter INFO] 2025-09-25 11:46:37.899 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,811.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:37.925 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.490079343023865 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:38.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 559}
[aiter INFO] 2025-09-25 11:46:38.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:46:38.490 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.719000000000051
[aiter INFO] 2025-09-25 11:46:38.502 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            523.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:38.503 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:38.776 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.87098012717053 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:38.803 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:38.804 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-09-25 11:46:38.819 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,380.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,380.9              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           13.8             13.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:38.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:38.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:38.878 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.75874248766664 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:38.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 284, 285}
[aiter INFO] 2025-09-25 11:46:38.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-09-25 11:46:38.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:46:38.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.47900000000027
[aiter INFO] 2025-09-25 11:46:38.980 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:38.999 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            888.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,327.7              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:39.000 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:39.045 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.61972268442116 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:39.092 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:39.092 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.519000000000005
[aiter INFO] 2025-09-25 11:46:39.103 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,677.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:39.127 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.59978209952317 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:39.898 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:39.898 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999993
[aiter INFO] 2025-09-25 11:46:39.911 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            345.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:39.912 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:39.996 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.12863347731015 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:40.048 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 103}
[aiter INFO] 2025-09-25 11:46:40.048 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999998996
[aiter INFO] 2025-09-25 11:46:40.048 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-09-25 11:46:40.048 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-25 11:46:40.060 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,405.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:40.085 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.923732868515614 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:40.192 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {104, 6, 111}
[aiter INFO] 2025-09-25 11:46:40.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6389999999998963
[aiter INFO] 2025-09-25 11:46:40.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:46:40.193 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-25 11:46:40.204 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            330.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:40.205 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:40.242 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.65631684321578 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:40.267 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:40.267 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.638999999999982
[aiter INFO] 2025-09-25 11:46:40.282 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            947.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          947.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:40.283 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:40.283 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:40.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.3013164094179 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:40.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:46:40.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.959000000000003
[aiter INFO] 2025-09-25 11:46:40.832 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-09-25 11:46:40.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            923.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,922.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,846.0              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           28.5             28.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:40.851 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:40.902 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.46137677088822 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {71, 11, 47, 83, 23}
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.91899999999998
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.84
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.918999999999926
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.99899999999991
[aiter INFO] 2025-09-25 11:46:40.953 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.959
[aiter INFO] 2025-09-25 11:46:40.963 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 96.0            0.0          5,846.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             60.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:40.989 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.32015826885063 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:41.499 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:41.499 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:46:41.511 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            530.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:41.512 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    66.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:41.674 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.80949489551014 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:41.728 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 103}
[aiter INFO] 2025-09-25 11:46:41.728 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.20000000000002
[aiter INFO] 2025-09-25 11:46:41.728 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.639999999999986
[aiter INFO] 2025-09-25 11:46:41.740 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,914.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             49.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:41.765 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.05125752032394 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:42.360 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:42.360 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:46:42.372 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            528.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:42.373 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    54.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:42.630 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.84681208298938 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:42.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {434, 4}
[aiter INFO] 2025-09-25 11:46:42.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.759000000000015
[aiter INFO] 2025-09-25 11:46:42.658 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.35900000000001
[aiter INFO] 2025-09-25 11:46:42.673 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          1,509.6        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,526.3              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           15.3             15.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:42.674 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    15.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:42.674 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:42.732 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.1250496229323 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:42.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 779, 780}
[aiter INFO] 2025-09-25 11:46:42.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.35899999999998
[aiter INFO] 2025-09-25 11:46:42.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:46:42.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.439000000000306
[aiter INFO] 2025-09-25 11:46:42.835 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:46:42.854 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            947.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,390.1              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           13.9             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:42.855 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:42.900 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.89016828501579 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:42.947 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:42.948 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.558999999999997
[aiter INFO] 2025-09-25 11:46:42.958 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,744.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:42.982 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.213613822908684 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:43.573 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 6}
[aiter INFO] 2025-09-25 11:46:43.573 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.0790000000000077
[aiter INFO] 2025-09-25 11:46:43.573 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999993
[aiter INFO] 2025-09-25 11:46:43.585 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            341.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:43.586 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:43.666 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.88782167375678 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:43.867 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:43.868 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000009
[aiter INFO] 2025-09-25 11:46:43.880 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,448.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:43.905 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.11897061189803 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:44.054 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:44.054 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.199000000000012
[aiter INFO] 2025-09-25 11:46:44.065 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            339.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:44.066 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(17), np.int64(7), np.int64(87)): arr1 = 0.105469, arr2 = 0.099121, Diff = 0.006348
Position (np.int64(65), np.int64(0), np.int64(47)): arr1 = -0.075684, arr2 = -0.069336, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6546 (4.00%)
[1.0e-06, 1.0e-05): 37 (0.02%)
[1.0e-05, 1.0e-04): 2263 (1.38%)
[1.0e-04, 1.0e-03): 74228 (45.31%)
[1.0e-03, 1.0e-02): 80766 (49.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=aaa8e6e5a523423ce627433f43116be6
triton_output_md5=215f77d96f1eff5cac6806e72d87be22
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006591796875
max_diff_thr=0.006355931982398033

Top differences:
Position (np.int64(26), np.int64(5), np.int64(112)): arr1 = 0.043701, arr2 = 0.037109, Diff = 0.006592
Position (np.int64(27), np.int64(5), np.int64(75)): arr1 = -0.083008, arr2 = -0.077148, Diff = 0.005859
Position (np.int64(14), np.int64(7), np.int64(126)): arr1 = 0.070312, arr2 = 0.064453, Diff = 0.005859
Position (np.int64(17), np.int64(2), np.int64(66)): arr1 = 0.132812, arr2 = 0.126953, Diff = 0.005859
Position (np.int64(18), np.int64(1), np.int64(27)): arr1 = -0.044678, arr2 = -0.038818, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1699 (4.15%)
[1.0e-06, 1.0e-05): 12 (0.03%)
[1.0e-05, 1.0e-04): 540 (1.32%)
[1.0e-04, 1.0e-03): 18604 (45.42%)
[1.0e-03, 1.0e-02): 20105 (49.08%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=eacb50835612571dbd87f498c4eaa182
triton_output_md5=35b5c3b35fd8e5477f4c0b66b6c88dac
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.006184586323797703

Top differences:
Position (np.int64(30), np.int64(0), np.int64(103)): arr1 = 0.042236, arr2 = 0.035889, Diff = 0.006348
Position (np.int64(35), np.int64(9), np.int64(85)): arr1 = -0.100586, arr2 = -0.094238, Diff = 0.006348
Position (np.int64(55), np.int64(2), np.int64(81)): arr1 = 0.032715, arr2 = 0.026367, Diff = 0.006348
Position (np.int64(106), np.int64(2), np.int64(27)): arr1 = -0.046631, arr2 = -0.040527, Diff = 0.006104
Position (np.int64(120), np.int64(9), np.int64(106)): arr1 = -0.039307, arr2 = -0.033203, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 6559 (4.00%)
[1.0e-06, 1.0e-05): 40 (0.02%)
[1.0e-05, 1.0e-04): 2425 (1.48%)
[1.0e-04, 1.0e-03): 77320 (47.19%)
[1.0e-03, 1.0e-02): 77496 (47.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7797e89bc631b80d132e9af5446972e4
triton_output_md5=d6748a386073f4319eeddbbc0ca9d604
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006103515625
max_diff_thr=0.005847953259944916

Top differences:
Position (np.int64(20), np.int64(0), np.int64(24)): arr1 = 0.049805, arr2 = 0.043701, Diff = 0.006104
Position (np.int64(22), np.int64(4), np.int64(10)): arr1 = -0.062256, arr2 = -0.056152, Diff = 0.006104
Position (np.int64(22), np.int64(4), np.int64(11)): arr1 = 0.080078, arr2 = 0.074219, Diff = 0.005859
Position (np.int64(31), np.int64(8), np.int64(124)): arr1 = 0.046875, arr2 = 0.041016, Diff = 0.005859
Position (np.int64(15), np.int64(6), np.int64(40)): arr1 = -0.140625, arr2 = -0.134766, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 4 (0.01%)
[1.0e-05, 1.0e-04): 625 (1.53%)
[1.0e-04, 1.0e-03): 19321 (47.17%)
[1.0e-03, 1.0e-02): 19331 (47.19%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=528035d2c8186c89c83ab04bafc441b5
triton_output_md5=ca16333feb583ea02e41654cc0d8e486
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005859375
max_diff_thr=0.005576208233833313

Top differences:
Position (np.int64(96), np.int64(3), np.int64(10)): arr1 = -0.056641, arr2 = -0.050781, Diff = 0.005859
Position (np.int64(118), np.int64(5), np.int64(26)): arr1 = 0.054199, arr2 = 0.049316, Diff = 0.004883
Position (np.int64(121), np.int64(0), np.int64(115)): arr1 = -0.097656, arr2 = -0.092773, Diff = 0.004883
Position (np.int64(85), np.int64(2), np.int64(123)): arr1 = -0.071289, arr2 = -0.066406, Diff = 0.004883
Position (np.int64(21), np.int64(8), np.int64(13)): arr1 = 0.040527, arr2 = 0.035889, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 6645 (4.06%)
[1.0e-06, 1.0e-05): 57 (0.03%)
[1.0e-05, 1.0e-04): 4296 (2.62%)
[1.0e-04, 1.0e-03): 96502 (58.90%)
[1.0e-03, 1.0e-02): 56340 (34.39%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8a1e5ce1bc0c570e41e05c2f19a9a2e8
triton_output_md5=2b99f5bf95442f0d9929e28aa2bea068
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004915730562061071

Top differences:
Position (np.int64(10), np.int64(6), np.int64(49)): arr1 = 0.048096, arr2 = 0.042969, Diff = 0.005127
Position (np.int64(19), np.int64(5), np.int64(73)): arr1 = -0.037109, arr2 = -0.032227, Diff = 0.004883
Position (np.int64(16), np.int64(6), np.int64(46)): arr1 = -0.092773, arr2 = -0.087891, Diff = 0.004883
Position (np.int64(7), np.int64(2), np.int64(19)): arr1 = -0.050293, arr2 = -0.045898, Diff = 0.004395
Position (np.int64(15), np.int64(7), np.int64(34)): arr1 = -0.073730, arr2 = -0.069336, Diff = 0.004395[aiter INFO] 2025-09-25 11:46:44.102 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.949009861096297 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:44.127 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 14}
[aiter INFO] 2025-09-25 11:46:44.127 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999997
[aiter INFO] 2025-09-25 11:46:44.127 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.158999999999992
[aiter INFO] 2025-09-25 11:46:44.142 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            929.0        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          939.1              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:44.143 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:44.144 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:44.468 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.96113868161004 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:44.691 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:46:44.691 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.479000000000013
[aiter INFO] 2025-09-25 11:46:44.691 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000003
[aiter INFO] 2025-09-25 11:46:44.710 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            900.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,138.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,039.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           30.4             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:44.710 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    30.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:44.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 151.89743573122686 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:44.812 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 71, 11, 47, 83, 1139, 23, 59}
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.55900000000003
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.67899999999997
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.43900000000002
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.56
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15899999999999
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.15899999999965
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.91899999999998
[aiter INFO] 2025-09-25 11:46:44.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.279
[aiter INFO] 2025-09-25 11:46:44.823 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 93.0            0.0          6,992.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             75.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:45.002 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.57918832591265 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:45.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {538, 6}
[aiter INFO] 2025-09-25 11:46:45.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.1590000000001055
[aiter INFO] 2025-09-25 11:46:45.366 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-25 11:46:45.378 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            668.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:45.379 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    81.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:45.544 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 151.64244514290647 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:45.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:45.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.95999999999998
[aiter INFO] 2025-09-25 11:46:45.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          6,123.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             61.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:45.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 63.78437630315818 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:46.202 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:46.202 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-09-25 11:46:46.214 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            676.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:46.215 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    67.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:46.484 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 36.500307002870166 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:46.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:46:46.514 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.799000000000007
[aiter INFO] 2025-09-25 11:46:46.529 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,750.4        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,750.4              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           17.5             17.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:46.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    17.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:46.530 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:46.588 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.64228718764711 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:46.695 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 815}
[aiter INFO] 2025-09-25 11:46:46.695 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.35899999999998
[aiter INFO] 2025-09-25 11:46:46.695 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:46:46.695 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000001106
[aiter INFO] 2025-09-25 11:46:46.695 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.639000000001033
[aiter INFO] 2025-09-25 11:46:46.714 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,126.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,571.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           15.7             15.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:46.714 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:46.761 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.96072282000344 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:46.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:46.809 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.35899999999998
[aiter INFO] 2025-09-25 11:46:46.820 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,998.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:46.844 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.12097027927342 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:47.602 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:47.602 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999991
[aiter INFO] 2025-09-25 11:46:47.614 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            402.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:47.616 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.01 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:47.701 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.05262373992713 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:47.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:47.751 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.319000000000017
[aiter INFO] 2025-09-25 11:46:47.763 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,519.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:47.788 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.05165347073338 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:47.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {629, 6}
[aiter INFO] 2025-09-25 11:46:47.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-25 11:46:47.916 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000003
[aiter INFO] 2025-09-25 11:46:47.928 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            390.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:47.929 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:47.965 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.484059454633456 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:47.990 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 4, 69, 9, 74, 44, 14, 79, 49, 19, 24, 29}
[aiter INFO] 2025-09-25 11:46:47.990 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-09-25 11:46:47.990 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-09-25 11:46:47.990 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.59899999999999
[aiter INFO] 2025-09-25 11:46:47.990 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.879000000000019
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999937
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999978
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999999
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.67900000000003
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.63900000000001
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-09-25 11:46:47.991 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.67900000000003
[aiter INFO] 2025-09-25 11:46:48.006 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  89.0            0.0            988.6        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,117.5              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           11.2             11.1         NaN          NaN
[aiter INFO] 2025-09-25 11:46:48.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:48.007 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:48.328 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.80841537631383 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:48.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {953, 963, 9, 14}
[aiter INFO] 2025-09-25 11:46:48.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.60000000000036
[aiter INFO] 2025-09-25 11:46:48.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-09-25 11:46:48.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.15900000000005
[aiter INFO] 2025-09-25 11:46:48.611 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.480000000000018
[aiter INFO] 2025-09-25 11:46:48.633 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,214.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          9,077.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,427.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN          104.3            104.0         NaN          NaN
[aiter INFO] 2025-09-25 11:46:48.633 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   103.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:48.720 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 484.9238614044567 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:48.802 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:48.802 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 409.52099999999996
[aiter INFO] 2025-09-25 11:46:48.813 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0         40,956.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0            409.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:49.106 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.915811786557185 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 237, 335, 181, 125}
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000133
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.798999999999978
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.838999999999942
[aiter INFO] 2025-09-25 11:46:49.239 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.799999999999955
[aiter INFO] 2025-09-25 11:46:49.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0          1,202.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:49.252 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   422.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:49.445 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 412.07608816647297 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:49.522 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:46:49.522 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 332.19999999999993
[aiter INFO] 2025-09-25 11:46:49.534 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         33,057.2        CUDA            8
[avg us/iter]               NaN   NaN            0.0            330.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:49.842 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.10473269165153 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:50.022 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:50.022 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.758999999999986
[aiter INFO] 2025-09-25 11:46:50.034 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,254.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             12.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:50.035 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   343.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:50.313 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.89847511702244 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {480, 481, 450, 482, 483, 4, 166, 441, 140, 505, 178, 500, 501, 153, 475, 446, 447}
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.5600000000004
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.5590000000002
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.87999999999965
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.59900000000016
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.19899999999961
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.31899999999999
[aiter INFO] 2025-09-25 11:46:50.342 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.7199999999998
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.8789999999999
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.519
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.3189999999995
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.19899999999984
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.11899999999969
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.88000000000011
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.07899999999995
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.39999999999964
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.1590000000001
[aiter INFO] 2025-09-25 11:46:50.343 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.79899999999998
[aiter INFO] 2025-09-25 11:46:50.358 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  84.0            0.0          5,400.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        6,495.4              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           65.0             64.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:50.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    64.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:50.360 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:50.423 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.67754438608 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1025, 1032, 9, 1036, 13, 526, 530, 1043, 20, 1047, 24, 31, 35, 1065, 1069, 1076, 438, 1080, 442, 1021}
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999998996
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.318999999999505
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.559000000000026
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999869
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.35900000000038
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.39900000000125
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.160000000000025
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959999999999127
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.319000000000017
[aiter INFO] 2025-09-25 11:46:50.482 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.91900000000004
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.518999999998414
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000742
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.35900000000038
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.840000000000146
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999998923
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:46:50.483 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.519000000000233
[aiter INFO] 2025-09-25 11:46:50.501 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            445.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          2,506.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,275.2              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           32.8             32.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:50.502 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:50.555 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 180.3684551822077 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:50.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35}
[aiter INFO] 2025-09-25 11:46:50.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.84
[aiter INFO] 2025-09-25 11:46:50.605 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.35900000000004
[aiter INFO] 2025-09-25 11:46:50.615 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0         10,286.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.9         NaN          NaN
[aiter INFO] 2025-09-25 11:46:50.640 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.944336672525594 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:51.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:51.251 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-09-25 11:46:51.263 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            665.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:51.263 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   110.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:51.510 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.65516893108293 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.15899999999999
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.75999999999999
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.15900000000002
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.71899999999994
[aiter INFO] 2025-09-25 11:46:51.562 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.03899999999999
[aiter INFO] 2025-09-25 11:46:51.574 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          8,030.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:51.599 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.83579211659951 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:51.709 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:51.709 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.799000000000007
[aiter INFO] 2025-09-25 11:46:51.721 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            667.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:51.722 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    90.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:51.760 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.426307022571564 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:51.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 9, 15, 22, 479}
[aiter INFO] 2025-09-25 11:46:51.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.519000000000005
[aiter INFO] 2025-09-25 11:46:51.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.03899999999999
[aiter INFO] 2025-09-25 11:46:51.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.31899999999999
[aiter INFO] 2025-09-25 11:46:51.785 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.079999999999984
[aiter INFO] 2025-09-25 11:46:51.786 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.07900000000018
[aiter INFO] 2025-09-25 11:46:51.799 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  96.0            0.0          3,421.0        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        3,563.5              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           35.6             35.6         NaN          NaN
[aiter INFO] 2025-09-25 11:46:51.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    35.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:51.800 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:52.146 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.94705951567923 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:52.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-09-25 11:46:52.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.75900000000001
[aiter INFO] 2025-09-25 11:46:52.350 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.91900000000004
[aiter INFO] 2025-09-25 11:46:52.368 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,013.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          9,014.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,028.6              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN          100.3            100.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:52.369 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   100.29 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:52.936 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 457.1594052975721 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:53.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {56, 11, 1212}
[aiter INFO] 2025-09-25 11:46:53.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 380.24
[aiter INFO] 2025-09-25 11:46:53.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.24
[aiter INFO] 2025-09-25 11:46:53.017 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 380.59999999999854
[aiter INFO] 2025-09-25 11:46:53.027 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         37,458.3        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            382.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:53.236 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.76965345398034 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:53.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:53.273 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.758999999999986
[aiter INFO] 2025-09-25 11:46:53.285 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,033.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:53.286 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   392.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:54.021 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 389.75759396458614 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:54.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {492, 1261, 12, 49, 1276, 920, 1244}
[aiter INFO] 2025-09-25 11:46:54.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 310.0799999999999
[aiter INFO] 2025-09-25 11:46:54.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 310.0400000000009
[aiter INFO] 2025-09-25 11:46:54.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 312.119
[aiter INFO] 2025-09-25 11:46:54.097 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 305.9200000000001
[aiter INFO] 2025-09-25 11:46:54.098 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.72000000000116
[aiter INFO] 2025-09-25 11:46:54.098 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 310.0799999999999
[aiter INFO] 2025-09-25 11:46:54.098 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 309.8799999999992
[aiter INFO] 2025-09-25 11:46:54.110 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0         28,996.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0            308.5         NaN          NaN
[aiter INFO] 2025-09-25 11:46:54.303 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.30355438767093 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:54.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:54.346 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.63900000000001
[aiter INFO] 2025-09-25 11:46:54.358 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,036.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.4         NaN          NaN
[aiter INFO] 2025-09-25 11:46:54.359 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   318.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 1677 (4.09%)
[1.0e-06, 1.0e-05): 18 (0.04%)
[1.0e-05, 1.0e-04): 1125 (2.75%)
[1.0e-04, 1.0e-03): 24133 (58.92%)
[1.0e-03, 1.0e-02): 14007 (34.20%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e2d9644e6044b47679d091a5d675208c
triton_output_md5=a184ae6326351137ae1c6fbb2b3b3a7d
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.004638671875
max_diff_thr=0.004587709903717041

Top differences:
Position (np.int64(33), np.int64(8), np.int64(84)): arr1 = -0.038574, arr2 = -0.033936, Diff = 0.004639
Position (np.int64(61), np.int64(8), np.int64(123)): arr1 = -0.015747, arr2 = -0.011108, Diff = 0.004639
Position (np.int64(118), np.int64(7), np.int64(83)): arr1 = 0.034668, arr2 = 0.030029, Diff = 0.004639
Position (np.int64(125), np.int64(7), np.int64(9)): arr1 = -0.021973, arr2 = -0.017456, Diff = 0.004517
Position (np.int64(100), np.int64(3), np.int64(63)): arr1 = 0.026245, arr2 = 0.021729, Diff = 0.004517

Threshold statistics:
[0.0e+00, 1.0e-06): 6599 (4.03%)
[1.0e-06, 1.0e-05): 46 (0.03%)
[1.0e-05, 1.0e-04): 4398 (2.68%)
[1.0e-04, 1.0e-03): 96564 (58.94%)
[1.0e-03, 1.0e-02): 56233 (34.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=535d9c04f547b56a7a5ac0960a2709e1
triton_output_md5=402fac52df3aa16c2bad48a8b1a83462
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00439453125
max_diff_thr=0.004296455532312393

Top differences:
Position (np.int64(1), np.int64(0), np.int64(108)): arr1 = -0.079590, arr2 = -0.075195, Diff = 0.004395
Position (np.int64(5), np.int64(8), np.int64(20)): arr1 = 0.069336, arr2 = 0.064941, Diff = 0.004395
Position (np.int64(31), np.int64(0), np.int64(125)): arr1 = -0.027222, arr2 = -0.022827, Diff = 0.004395
Position (np.int64(5), np.int64(8), np.int64(99)): arr1 = -0.036133, arr2 = -0.031738, Diff = 0.004395
Position (np.int64(19), np.int64(8), np.int64(66)): arr1 = 0.028687, arr2 = 0.024414, Diff = 0.004272

Threshold statistics:
[0.0e+00, 1.0e-06): 1554 (3.79%)
[1.0e-06, 1.0e-05): 12 (0.03%)
[1.0e-05, 1.0e-04): 1064 (2.60%)
[1.0e-04, 1.0e-03): 24332 (59.40%)
[1.0e-03, 1.0e-02): 13998 (34.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a5a3450cd6027bbe0bf1796f7a9cce3a
triton_output_md5=f24eac2488795f348012d8f737838930
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018130174139514565

Top differences:
Position (np.int64(98), np.int64(4), np.int64(43)): arr1 = 0.016357, arr2 = 0.014526, Diff = 0.001831
Position (np.int64(17), np.int64(4), np.int64(10)): arr1 = -0.023926, arr2 = -0.022095, Diff = 0.001831
Position (np.int64(63), np.int64(8), np.int64(100)): arr1 = 0.011780, arr2 = 0.009949, Diff = 0.001831
Position (np.int64(12), np.int64(9), np.int64(91)): arr1 = 0.027100, arr2 = 0.025391, Diff = 0.001709
Position (np.int64(99), np.int64(9), np.int64(51)): arr1 = 0.008301, arr2 = 0.006622, Diff = 0.001678

Threshold statistics:
[0.0e+00, 1.0e-06): 6814 (4.16%)
[1.0e-06, 1.0e-05): 442 (0.27%)
[1.0e-05, 1.0e-04): 24936 (15.22%)
[1.0e-04, 1.0e-03): 130151 (79.44%)
[1.0e-03, 1.0e-02): 1497 (0.91%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b9196fde8ec8c24fc9e3630b38df8d6d
triton_output_md5=732de90dd63b80dc6cd788d693ea8d1e
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0015869140625
max_diff_thr=0.00157696264795959

Top differences:
Position (np.int64(13), np.int64(5), np.int64(73)): arr1 = 0.011658, arr2 = 0.010071, Diff = 0.001587
Position (np.int64(7), np.int64(4), np.int64(113)): arr1 = 0.003052, arr2 = 0.001472, Diff = 0.001579
Position (np.int64(24), np.int64(9), np.int64(35)): arr1 = 0.013123, arr2 = 0.011597, Diff = 0.001526
Position (np.int64(3), np.int64(8), np.int64(56)): arr1 = -0.008240, arr2 = -0.006744, Diff = 0.001495
Position (np.int64(20), np.int64(7), np.int64(40)): arr1 = 0.022705, arr2 = 0.021240, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1708 (4.17%)
[1.0e-06, 1.0e-05): 117 (0.29%)
[1.0e-05, 1.0e-04): 6210 (15.16%)
[1.0e-04, 1.0e-03): 32544 (79.45%)
[1.0e-03, 1.0e-02): 381 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1615d5439783903d966d227312d3397a
triton_output_md5=7cfa6c5d99d49ad7e0e0384e4e44a3a7
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017535373335704207

Top differences:
Position (np.int64(34), np.int64(2), np.int64(42)): arr1 = -0.011169, arr2 = -0.009399, Diff = 0.001770
Position (np.int64(72), np.int64(7), np.int64(84)): arr1 = 0.013672, arr2 = 0.011963, Diff = 0.001709
Position (np.int64(79), np.int64(5), np.int64(104)): arr1 = 0.017944, arr2 = 0.016235, Diff = 0.001709
Position (np.int64(121), np.int64(9), np.int64(78)): arr1 = -0.010071, arr2 = -0.008362, Diff = 0.001709
Position (np.int64(101), np.int64(6), np.int64(116)): arr1 = -0.026245, arr2 = -0.024536, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 6974 (4.26%)
[1.0e-06, 1.0e-05): 479 (0.29%)
[1.0e-05, 1.0e-04): 24680 (15.06%)[aiter INFO] 2025-09-25 11:46:54.409 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 82.08539587731408 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {258, 4, 268, 281, 159, 294, 447, 194, 206, 219, 482, 485, 486, 487, 232, 488, 489, 490, 491, 492, 493, 245}
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.67999999999984
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.71900000000002
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.31900000000019
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.95899999999983
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.79899999999998
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.279
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.19900000000007
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.24000000000001
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.67899999999986
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.63900000000012
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.4390000000003
[aiter INFO] 2025-09-25 11:46:54.438 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.63900000000012
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.03999999999996
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.47899999999936
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.95900000000006
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.5590000000002
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.8789999999999
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.83899999999994
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.28000000000065
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.19900000000052
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.3189999999995
[aiter INFO] 2025-09-25 11:46:54.439 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.47899999999981
[aiter INFO] 2025-09-25 11:46:54.454 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  79.0            0.0          4,878.8        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        6,279.7              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           62.8             61.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:54.455 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    61.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:54.456 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:46:54.518 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.08785129183589 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 13, 20, 24, 31}
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.438999999999965
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999946
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.839
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119000000000028
[aiter INFO] 2025-09-25 11:46:54.578 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.478999999999985
[aiter INFO] 2025-09-25 11:46:54.597 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            414.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          2,706.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,194.4              0.0         CPU        55464
[avg us/iter]                                                                                        NaN   NaN           31.9             31.8         NaN          NaN
[aiter INFO] 2025-09-25 11:46:54.598 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:54.650 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 179.31299973832498 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:54.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:46:54.850 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.399
[aiter INFO] 2025-09-25 11:46:54.861 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0         10,368.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0            103.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:54.886 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.804118774314915 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:55.003 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:55.003 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-25 11:46:55.015 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            527.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:55.016 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   108.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:55.106 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.46584200623013 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:55.156 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:46:55.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.32000000000005
[aiter INFO] 2025-09-25 11:46:55.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.11900000000003
[aiter INFO] 2025-09-25 11:46:55.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.75899999999999
[aiter INFO] 2025-09-25 11:46:55.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.23899999999998
[aiter INFO] 2025-09-25 11:46:55.157 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.44
[aiter INFO] 2025-09-25 11:46:55.169 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,985.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.2         NaN          NaN
[aiter INFO] 2025-09-25 11:46:55.194 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.338376120765616 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:55.559 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:46:55.559 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.359000000000009
[aiter INFO] 2025-09-25 11:46:55.571 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            529.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:46:55.572 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    88.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:55.609 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.7331684833706 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:46:55.634 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 486, 9, 14, 28}
[aiter INFO] 2025-09-25 11:46:55.634 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.839
[aiter INFO] 2025-09-25 11:46:55.634 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.159000000000106
[aiter INFO] 2025-09-25 11:46:55.634 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.63899999999998
[aiter INFO] 2025-09-25 11:46:55.634 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.63899999999998
[aiter INFO] 2025-09-25 11:46:55.635 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.31899999999996
[aiter INFO] 2025-09-25 11:46:55.648 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  96.0            0.0          3,239.2        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        3,374.9              0.0         CPU        55464
[avg us/iter]                                      NaN   NaN           33.7             33.7         NaN          NaN
[aiter INFO] 2025-09-25 11:46:55.649 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    33.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:46:55.656 - MainProcess:55464 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:914 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  us_hip_bf16  err_hip_bf16  us_triton_bf16  err_triton_bf16  us_triton_fp8  err_triton_fp8  us_asm_fp8  err fp8
0          7         128    (5, 1)        128          16  torch.bfloat16     1         15.2             0            33.7                0           30.0               0         9.2        0
1          7          32    (5, 1)        128          16  torch.bfloat16     1         13.0             0            19.2                0           17.1               0         7.3        0
2         26         128    (5, 1)        128          16  torch.bfloat16     1         15.3             0            35.0                0           30.4               0         9.3        0
3         26          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            19.6                0           17.3               0         7.4        0
4         57         128    (5, 1)        128          16  torch.bfloat16     1         15.4             0            35.1                0           30.5               0         9.5        0
5         57          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            19.7                0           17.5               0         7.5        0
6         66         128    (5, 1)        128          16  torch.bfloat16     1         15.6             0            35.3                0           30.3               0         9.2        0
7         66          32    (5, 1)        128          16  torch.bfloat16     1         13.0             0            19.3                0           16.9               0         7.3        0
8        109         128    (5, 1)        128          16  torch.bfloat16     1         15.4             0            35.1                0           30.2               0         9.4        0
9        109          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            19.4                0           17.0               0         7.4        0
10       128         128    (5, 1)        128          16  torch.bfloat16     1         15.4             0            35.3                0           30.3               0         9.5        0
11       128          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            19.5                0           17.0               0         7.4        0
12       256         128    (5, 1)        128          16  torch.bfloat16     1         17.4             0            36.3                0           30.8               0        10.9        0
13       256          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            19.8                0           17.0               0         7.6        0
14       257         128    (5, 1)        128          16  torch.bfloat16     1         21.4             0            63.9                0           53.3               0        14.0        0
15       257          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            20.2                0           17.5               0         9.6        0
16       282         128    (5, 1)        128          16  torch.bfloat16     1         21.3             0            64.1                0           53.2               0        14.1        0
17       282          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            20.1                0           17.5               0         9.6        0
18       512         128    (5, 1)        128          16  torch.bfloat16     1         23.0             0            65.7                0           53.9               0        15.7        0
19       512          32    (5, 1)        128          16  torch.bfloat16     1         13.6             0            20.7                0           17.6               0         9.5        0
20       513         128    (5, 1)        128          16  torch.bfloat16     1         26.0             0            80.9                0           66.5               0        18.4        0
21       513          32    (5, 1)        128          16  torch.bfloat16     1         15.3             0            33.7                0           28.8               0        11.4        0
22      4097         128    (5, 1)        128          16  torch.bfloat16     1        100.0             0           420.0                0          338.7               0        71.1        0
23      4097          32    (5, 1)        128          16  torch.bfloat16     1         34.3             0           110.0                0           89.5               0        38.1        0
24      4096         128    (5, 1)        128          16  torch.bfloat16     1         96.8             0           391.2                0          315.4               0        68.7        0
25      4096          32    (5, 1)        128          16  torch.bfloat16     1         31.1             0           109.1                0           88.4               0        36.2        0
26         7         128    (8, 1)        128          16  torch.bfloat16     1         17.6             0            33.9                0           29.7               0         8.9        0
27         7          32    (8, 1)        128          16  torch.bfloat16     1         12.8             0            18.6                0           16.5               0         7.0        0
28        26         128    (8, 1)        128          16  torch.bfloat16     1         17.6             0            34.5                0           30.0               0         9.0        0
29        26          32    (8, 1)        128          16  torch.bfloat16     1         12.9             0            19.0                0           16.8               0         7.1        0
30        57         128    (8, 1)        128          16  torch.bfloat16     1         17.8             0            34.7                0           30.2               0         9.1        0
31        57          32    (8, 1)        128          16  torch.bfloat16     1         12.9             0            19.1                0           16.8               0         7.2        0
32        66         128    (8, 1)        128          16  torch.bfloat16     1         17.9             0            34.9                0           30.3               0         9.3        0
33        66          32    (8, 1)        128          16  torch.bfloat16     1         12.9             0            19.2                0           16.9               0         7.3        0
34       109         128    (8, 1)        128          16  torch.bfloat16     1         18.0             0            35.2                0           30.4               0         9.4        0
35       109          32    (8, 1)        128          16  torch.bfloat16     1         13.1             0            19.4                0           16.9               0         7.4        0
36       128         128    (8, 1)        128          16  torch.bfloat16     1         18.1             0            35.5                0           30.5               0         9.5        0
37       128          32    (8, 1)        128          16  torch.bfloat16     1         13.1             0            19.4                0           16.9               0         7.4        0
38       256         128    (8, 1)        128          16  torch.bfloat16     1         20.1             0            36.6                0           30.9               0        10.8        0
39       256          32    (8, 1)        128          16  torch.bfloat16     1         13.2             0            19.9                0           17.1               0         7.7        0
40       257         128    (8, 1)        128          16  torch.bfloat16     1         24.1             0            63.8                0           53.3               0        14.0        0
41       257          32    (8, 1)        128          16  torch.bfloat16     1         13.3             0            20.2                0           17.5               0         9.6        0
42       282         128    (8, 1)        128          16  torch.bfloat16     1         24.1             0            64.0                0           53.4               0        14.0        0
43       282          32    (8, 1)        128          16  torch.bfloat16     1         13.3             0            20.1                0           17.6               0         9.6        0
44       512         128    (8, 1)        128          16  torch.bfloat16     1         26.2             0            66.5                0           55.0               0        16.1        0
45       512          32    (8, 1)        128          16  torch.bfloat16     1         13.7             0            21.2                0           17.7               0         9.6        0
46       513         128    (8, 1)        128          16  torch.bfloat16     1         28.3             0            81.2                0           67.1               0        18.3        0
47       513          32    (8, 1)        128          16  torch.bfloat16     1         15.3             0            33.7                0           28.9               0        11.5        0
48      4097         128    (8, 1)        128          16  torch.bfloat16     1        105.6             0           421.7                0          340.5               0        72.0        0
49      4097          32    (8, 1)        128          16  torch.bfloat16     1         33.1             0           110.1                0           89.8               0        38.1        0
50      4096         128    (8, 1)        128          16  torch.bfloat16     1        102.1             0           391.4                0          317.8               0        68.7        0
51      4096          32    (8, 1)        128          16  torch.bfloat16     1         32.2             0           108.1                0           88.2               0        36.2        0
52         7         128   (10, 1)        128          16  torch.bfloat16     1         19.3             0            34.0                0           30.0               0         8.9        0
53         7          32   (10, 1)        128          16  torch.bfloat16     1         12.7             0            18.7                0           16.7               0         7.0        0
54        26         128   (10, 1)        128          16  torch.bfloat16     1         19.4             0            34.7                0           30.3               0         9.0        0
55        26          32   (10, 1)        128          16  torch.bfloat16     1         12.8             0            19.2                0           16.9               0         7.2        0
56        57         128   (10, 1)        128          16  torch.bfloat16     1         19.5             0            34.8                0           30.4               0         9.2        0
57        57          32   (10, 1)        128          16  torch.bfloat16     1         12.9             0            19.3                0           17.1               0         7.3        0
58        66         128   (10, 1)        128          16  torch.bfloat16     1         19.7             0            35.2                0           30.5               0         9.3        0
59        66          32   (10, 1)        128          16  torch.bfloat16     1         13.1             0            19.4                0           17.0               0         7.3        0
60       109         128   (10, 1)        128          16  torch.bfloat16     1         19.8             0            35.5                0           30.7               0         9.4        0
61       109          32   (10, 1)        128          16  torch.bfloat16     1         13.1             0            19.5                0           17.1               0         7.5        0
62       128         128   (10, 1)        128          16  torch.bfloat16     1         19.8             0            35.7                0           30.7               0         9.5        0
63       128          32   (10, 1)        128          16  torch.bfloat16     1         13.1             0            19.6                0           17.1               0         7.4        0
64       256         128   (10, 1)        128          16  torch.bfloat16     1         21.7             0            36.6                0           31.4               0        10.9        0
65       256          32   (10, 1)        128          16  torch.bfloat16     1         13.3             0            20.0                0           17.3               0         7.7        0
66       257         128   (10, 1)        128          16  torch.bfloat16     1         25.9             0            64.1                0           53.7               0        13.8        0
67       257          32   (10, 1)        128          16  torch.bfloat16     1         13.4             0            20.3                0           17.7               0         9.5        0
68       282         128   (10, 1)        128          16  torch.bfloat16     1         26.3             0            64.4                0           53.9               0        13.8        0
69       282          32   (10, 1)        128          16  torch.bfloat16     1         13.3             0            20.2                0           17.7               0         9.5        0
70       512         128   (10, 1)        128          16  torch.bfloat16     1         28.5             0            66.2                0           54.9               0        15.2        0
71       512          32   (10, 1)        128          16  torch.bfloat16     1         13.9             0            20.9                0           17.9               0         9.4        0
72       513         128   (10, 1)        128          16  torch.bfloat16     1         30.4             0            81.9                0           68.0               0        17.5        0
73       513          32   (10, 1)        128          16  torch.bfloat16     1         15.7             0            34.0                0           29.1               0        11.1        0
74      4097         128   (10, 1)        128          16  torch.bfloat16     1        104.0             0           422.1                0          343.1               0        64.3        0
75      4097          32   (10, 1)        128          16  torch.bfloat16     1         32.4             0           110.6                0           90.3               0        35.6        0
76      4096         128   (10, 1)        128          16  torch.bfloat16     1        100.3             0           392.6                0          318.8               0        61.8        0
77      4096          32   (10, 1)        128          16  torch.bfloat16     1         31.8             0           109.0                0           88.5               0        33.7        0

[1.0e-04, 1.0e-03): 130223 (79.48%)
[1.0e-03, 1.0e-02): 1484 (0.91%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=736c54023a66bcf169bf71e813d107c5
triton_output_md5=e993d4428135df82cd375525085b6c6f
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.001700680237263441

Top differences:
Position (np.int64(0), np.int64(4), np.int64(73)): arr1 = 0.006592, arr2 = 0.004883, Diff = 0.001709
Position (np.int64(7), np.int64(8), np.int64(80)): arr1 = 0.013306, arr2 = 0.011780, Diff = 0.001526
Position (np.int64(19), np.int64(5), np.int64(25)): arr1 = -0.003937, arr2 = -0.002426, Diff = 0.001511
Position (np.int64(5), np.int64(0), np.int64(125)): arr1 = 0.025635, arr2 = 0.024170, Diff = 0.001465
Position (np.int64(10), np.int64(4), np.int64(68)): arr1 = 0.015747, arr2 = 0.014282, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 123 (0.30%)
[1.0e-05, 1.0e-04): 6102 (14.90%)
[1.0e-04, 1.0e-03): 32650 (79.71%)
[1.0e-03, 1.0e-02): 406 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b6da0bbb57db729f3f4fc370efd952aa
triton_output_md5=36a0ae968bb3c5f67c378670628e048a
++ set +x
++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=6
++ HIP_VISIBLE_DEVICES=6
++ run_triton_op
++ rm -rf /root/.triton/cache
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py -q 1
[aiter INFO] 2025-09-25 11:50:23.350 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:24.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.56902931291278 us/iter from cuda.Event
[W925 11:50:24.464467229 collection.cpp:1110] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-09-25 11:50:24.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:24.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.678999999999974
[aiter INFO] 2025-09-25 11:50:24.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.719000000000051
[aiter INFO] 2025-09-25 11:50:24.896 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            473.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,077.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,550.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:24.937 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:26.310 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 128.98020800387505 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:26.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:26.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.59899999999999
[aiter INFO] 2025-09-25 11:50:26.379 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,957.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:26.765 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 64.53403992818134 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:26.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {188, 6}
[aiter INFO] 2025-09-25 11:50:26.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.199000000000069
[aiter INFO] 2025-09-25 11:50:26.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:50:26.817 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            463.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:26.818 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:27.726 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 129.24351550564907 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:27.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:27.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.479000000000042
[aiter INFO] 2025-09-25 11:50:27.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,522.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:27.937 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 66.03425744884085 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:27.984 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {419, 6}
[aiter INFO] 2025-09-25 11:50:27.984 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.079000000000178
[aiter INFO] 2025-09-25 11:50:27.984 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-25 11:50:27.998 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            462.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:27.999 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp.co GetFunction: _ZN5aiter35pa_bf16_pertokenFp8_gqa8_2tg_4w_uhpE Success
[aiter INFO] 2025-09-25 11:50:28.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.104653514257755 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.087 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 174}
[aiter INFO] 2025-09-25 11:50:28.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000000013
[aiter INFO] 2025-09-25 11:50:28.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.598999999999933
[aiter INFO] 2025-09-25 11:50:28.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            912.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          921.4              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:28.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:28.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 121.47522754598373 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {867, 868, 9, 42, 43, 10, 878, 879, 1109, 1110}
[aiter INFO] 2025-09-25 11:50:28.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.679000000000087
[aiter INFO] 2025-09-25 11:50:28.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:50:28.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.918999999999983
[aiter INFO] 2025-09-25 11:50:28.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.599000000000046
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.559000000001106
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999998632
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.199000000000524
[aiter INFO] 2025-09-25 11:50:28.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999651
[aiter INFO] 2025-09-25 11:50:28.254 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            412.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0            837.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,303.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.255 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:28.305 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.08225773584724 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:28.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999995
[aiter INFO] 2025-09-25 11:50:28.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,583.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             15.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.399 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 64.71023786038455 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.440 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:28.440 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.039000000000016
[aiter INFO] 2025-09-25 11:50:28.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            327.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:28.546 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.23200988946574 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.766 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 246}
[aiter INFO] 2025-09-25 11:50:28.767 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-09-25 11:50:28.767 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000013
[aiter INFO] 2025-09-25 11:50:28.767 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000178
[aiter INFO] 2025-09-25 11:50:28.781 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,347.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.810 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 62.215633874777524 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:28.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:50:28.879 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            328.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:28.926 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 37.0167228623782 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:28.955 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:28.955 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-25 11:50:28.974 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            721.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          721.3              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.2              7.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:28.976 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.21 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:28.976 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:29.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.60985124465262 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:29.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:29.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-09-25 11:50:29.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:29.194 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            467.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,064.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,531.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.3             15.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:29.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.32 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:29.892 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.72545576272624 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:29.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:29.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.31899999999999
[aiter INFO] 2025-09-25 11:50:29.954 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,028.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:29.979 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.617554648087754 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:30.013 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:30.013 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.439000000000021
[aiter INFO] 2025-09-25 11:50:30.025 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            471.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:30.026 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:30.878 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.14648500881573 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:30.928 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:30.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.079000000000008
[aiter INFO] 2025-09-25 11:50:30.941 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,551.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:30.966 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.16887120533698 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {153, 83, 13, 6}
[aiter INFO] 2025-09-25 11:50:31.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.1590000000001055
[aiter INFO] 2025-09-25 11:50:31.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.1590000000001055
[aiter INFO] 2025-09-25 11:50:31.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-25 11:50:31.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.479000000000013
[aiter INFO] 2025-09-25 11:50:31.019 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            455.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.020 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.21 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.8072377074473 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:31.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:50:31.103 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            928.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          928.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:31.161 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.18010875376143 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110, 922, 923}
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.879000000000019
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.359000000000378
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999998705
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.238999999999578
[aiter INFO] 2025-09-25 11:50:31.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:50:31.237 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            420.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            864.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,311.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.282 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.38047546797459 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1103, 551}
[aiter INFO] 2025-09-25 11:50:31.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.438999999999993
[aiter INFO] 2025-09-25 11:50:31.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999942
[aiter INFO] 2025-09-25 11:50:31.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.759000000000015
[aiter INFO] 2025-09-25 11:50:31.340 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,595.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.371 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.37448498223087 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 83, 6}
[aiter INFO] 2025-09-25 11:50:31.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.918999999999869
[aiter INFO] 2025-09-25 11:50:31.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.9190000000000964
[aiter INFO] 2025-09-25 11:50:31.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9990000000000236
[aiter INFO] 2025-09-25 11:50:31.421 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            322.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.422 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.670 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.555554774138 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.721 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:31.722 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-25 11:50:31.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,398.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.759 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.45165345308804 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.804 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:31.804 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:50:31.816 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            329.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.817 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.853 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.316514728387986 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:31.877 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:31.877 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.359000000000009
[aiter INFO] 2025-09-25 11:50:31.892 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            728.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          728.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:31.893 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:31.893 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:32.002 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.54842580190979 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 130, 131}
[aiter INFO] 2025-09-25 11:50:32.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-25 11:50:32.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.638999999999982
[aiter INFO] 2025-09-25 11:50:32.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-09-25 11:50:32.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.639000000000124
[aiter INFO] 2025-09-25 11:50:32.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            463.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,064.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,545.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.5             15.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.092 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:32.139 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.46843592188146 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:32.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.15899999999999
[aiter INFO] 2025-09-25 11:50:32.197 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,044.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.222 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.991831652598805 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {153, 6}
[aiter INFO] 2025-09-25 11:50:32.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-09-25 11:50:32.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:50:32.268 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            465.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.269 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:32.426 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.51400013194227 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:32.476 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.079000000000008
[aiter INFO] 2025-09-25 11:50:32.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,568.5        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.513 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.67221767890571 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.554 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:32.554 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.439000000000021
[aiter INFO] 2025-09-25 11:50:32.566 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            471.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.566 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:32.610 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.115712821336075 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.634 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:32.634 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.879000000000019
[aiter INFO] 2025-09-25 11:50:32.649 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            947.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          947.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.650 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:32.650 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:32.707 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.58208933856228 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 141, 142, 1109, 1110, 1021, 1022}
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.919000000000096
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999878
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999287
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.158999999999651
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999505
[aiter INFO] 2025-09-25 11:50:32.764 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:50:32.783 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            416.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            861.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,320.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
THREADS_PER_WARP=64
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.037109375
max_diff_thr=0.03431089594960213

Top differences:
Position (np.int64(31), np.int64(1), np.int64(26)): arr1 = 0.361328, arr2 = 0.324219, Diff = 0.037109
Position (np.int64(124), np.int64(1), np.int64(85)): arr1 = 0.574219, arr2 = 0.539062, Diff = 0.035156
Position (np.int64(49), np.int64(3), np.int64(32)): arr1 = 0.030273, arr2 = -0.004181, Diff = 0.034454
Position (np.int64(27), np.int64(2), np.int64(93)): arr1 = 0.259766, arr2 = 0.225586, Diff = 0.034180
Position (np.int64(23), np.int64(4), np.int64(120)): arr1 = 0.138672, arr2 = 0.104980, Diff = 0.033691

Threshold statistics:
[0.0e+00, 1.0e-06): 3520 (4.30%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 38 (0.05%)
[1.0e-04, 1.0e-03): 5981 (7.30%)
[1.0e-03, 1.0e-02): 54400 (66.41%)
[1.0e-02, 1.0e-01): 17981 (21.95%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a964e30650b2e4d4b5a7c39a19f40850
triton_output_md5=d8f98f70eeebfbdd54e2c88e17550f00
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.033203125
max_diff_thr=0.028985507786273956

Top differences:
Position (np.int64(22), np.int64(0), np.int64(38)): arr1 = 0.178711, arr2 = 0.145508, Diff = 0.033203
Position (np.int64(22), np.int64(0), np.int64(117)): arr1 = 0.539062, arr2 = 0.507812, Diff = 0.031250
Position (np.int64(30), np.int64(1), np.int64(66)): arr1 = -0.341797, arr2 = -0.310547, Diff = 0.031250
Position (np.int64(16), np.int64(3), np.int64(54)): arr1 = -0.220703, arr2 = -0.189453, Diff = 0.031250
Position (np.int64(4), np.int64(4), np.int64(35)): arr1 = 0.437500, arr2 = 0.406250, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 858 (4.19%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 8 (0.04%)
[1.0e-04, 1.0e-03): 1412 (6.89%)
[1.0e-03, 1.0e-02): 13525 (66.04%)
[1.0e-02, 1.0e-01): 4677 (22.84%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4fbadaea7ee4f19e3380974787a39cac
triton_output_md5=c542d6671f825341b8247349b41814aa
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.02073214016854763

Top differences:
Position (np.int64(0), np.int64(2), np.int64(82)): arr1 = 0.187500, arr2 = 0.166016, Diff = 0.021484
Position (np.int64(11), np.int64(0), np.int64(80)): arr1 = -0.204102, arr2 = -0.182617, Diff = 0.021484
Position (np.int64(126), np.int64(3), np.int64(59)): arr1 = 0.051758, arr2 = 0.030396, Diff = 0.021362
Position (np.int64(14), np.int64(2), np.int64(6)): arr1 = -0.138672, arr2 = -0.117676, Diff = 0.020996
Position (np.int64(19), np.int64(0), np.int64(13)): arr1 = 0.328125, arr2 = 0.308594, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 3352 (4.09%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 125 (0.15%)
[1.0e-04, 1.0e-03): 13061 (15.94%)
[1.0e-03, 1.0e-02): 62836 (76.70%)
[1.0e-02, 1.0e-01): 2544 (3.11%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d5e415acb91973f33c7dc59e894312c2
triton_output_md5=f2cb4b9da21022c5e1f30712f727ea8e
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01953125
max_diff_thr=0.016173752024769783

Top differences:
Position (np.int64(2), np.int64(1), np.int64(64)): arr1 = -0.312500, arr2 = -0.292969, Diff = 0.019531
Position (np.int64(21), np.int64(1), np.int64(21)): arr1 = -0.365234, arr2 = -0.345703, Diff = 0.019531
Position (np.int64(5), np.int64(4), np.int64(90)): arr1 = 0.218750, arr2 = 0.200195, Diff = 0.018555
Position (np.int64(21), np.int64(1), np.int64(30)): arr1 = -0.184570, arr2 = -0.166016, Diff = 0.018555
Position (np.int64(11), np.int64(4), np.int64(99)): arr1 = 0.355469, arr2 = 0.337891, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 851 (4.16%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 25 (0.12%)
[1.0e-04, 1.0e-03): 3227 (15.76%)
[1.0e-03, 1.0e-02): 15737 (76.84%)
[1.0e-02, 1.0e-01): 640 (3.12%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=bc82429f823206bbb34e8b41fe94e38c
triton_output_md5=4ff770b0c543314bb3491e6a396b5197
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.013505764305591583

Top differences:
Position (np.int64(101), np.int64(4), np.int64(99)): arr1 = 0.326172, arr2 = 0.312500, Diff = 0.013672
Position (np.int64(27), np.int64(3), np.int64(125)): arr1 = 0.002487, arr2 = -0.011169, Diff = 0.013657
Position (np.int64(82), np.int64(4), np.int64(76)): arr1 = 0.129883, arr2 = 0.116699, Diff = 0.013184
Position (np.int64(87), np.int64(2), np.int64(69)): arr1 = -0.156250, arr2 = -0.143555, Diff = 0.012695
Position (np.int64(126), np.int64(1), np.int64(91)): arr1 = -0.164062, arr2 = -0.151367, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 3356 (4.10%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 268 (0.33%)
[1.0e-04, 1.0e-03): 19016 (23.21%)
[1.0e-03, 1.0e-02): 59118 (72.17%)
[1.0e-02, 1.0e-01): 156 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=cbc93d78d3425cd2b9106fbf0c0cf5b9
triton_output_md5=ff64ce942d1641d319a410d632291762
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])[aiter INFO] 2025-09-25 11:50:32.828 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.49375276754398 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:32.874 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:32.874 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.478999999999985
[aiter INFO] 2025-09-25 11:50:32.885 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,634.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:32.909 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.81165341368997 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.126 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6}
[aiter INFO] 2025-09-25 11:50:33.126 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6790000000000873
[aiter INFO] 2025-09-25 11:50:33.126 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:50:33.138 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            327.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.140 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:33.221 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.68385159379186 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.271 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:50:33.271 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.679000000000087
[aiter INFO] 2025-09-25 11:50:33.271 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.039000000000016
[aiter INFO] 2025-09-25 11:50:33.283 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,395.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.51700039517762 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.353 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:33.353 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:50:33.365 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.365 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:33.400 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.96442570249633 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.424 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:33.424 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799000000000007
[aiter INFO] 2025-09-25 11:50:33.439 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            743.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          743.0              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.440 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:33.440 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:33.550 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.56188070833093 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:33.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.198999999999984
[aiter INFO] 2025-09-25 11:50:33.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.239000000000033
[aiter INFO] 2025-09-25 11:50:33.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            467.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,087.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,555.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.6             15.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:33.687 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.5116135507527 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:33.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:33.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.119
[aiter INFO] 2025-09-25 11:50:33.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,065.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:33.769 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.12889109478138 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:34.232 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:34.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:50:34.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            472.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:34.246 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:34.558 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.3884159361962 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:34.609 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:34.609 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.35900000000001
[aiter INFO] 2025-09-25 11:50:34.621 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,581.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:34.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.647683171057466 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 48, 496, 314}
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000009
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-25 11:50:35.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.598999999999705
[aiter INFO] 2025-09-25 11:50:35.100 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            417.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:35.101 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:35.556 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.18860383892414 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:35.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:35.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:50:35.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            923.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          923.6              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:35.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:35.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:35.655 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.95793051825892 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1109, 1110, 504, 505}
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.318999999999988
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999796
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000415
[aiter INFO] 2025-09-25 11:50:35.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000415
[aiter INFO] 2025-09-25 11:50:35.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            423.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            850.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,298.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:35.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.99 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:35.778 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.05612918705043 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:35.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 371, 1211, 623}
[aiter INFO] 2025-09-25 11:50:35.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.558999999999997
[aiter INFO] 2025-09-25 11:50:35.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.679999999999836
[aiter INFO] 2025-09-25 11:50:35.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999942
[aiter INFO] 2025-09-25 11:50:35.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.71900000000005
[aiter INFO] 2025-09-25 11:50:35.836 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          1,578.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:35.860 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.396999829771495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:36.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6, 615}
[aiter INFO] 2025-09-25 11:50:36.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6390000000001237
[aiter INFO] 2025-09-25 11:50:36.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:50:36.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.238999999999578
[aiter INFO] 2025-09-25 11:50:36.196 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            289.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:36.197 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.22 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:36.278 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.19553481824327 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:36.476 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:50:36.476 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999505
[aiter INFO] 2025-09-25 11:50:36.477 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-09-25 11:50:36.489 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,372.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:36.514 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.12372275242711 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:36.730 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:36.730 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:50:36.742 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:36.743 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.83 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:36.779 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.990574230209436 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:36.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {504, 4}
[aiter INFO] 2025-09-25 11:50:36.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-09-25 11:50:36.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.518999999999977
[aiter INFO] 2025-09-25 11:50:36.818 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            721.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          728.7              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:36.819 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:36.820 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:37.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.1713959964195 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:37.451 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {66, 67, 9, 10, 22, 23}
[aiter INFO] 2025-09-25 11:50:37.451 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.07899999999995
[aiter INFO] 2025-09-25 11:50:37.451 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.638999999999896
[aiter INFO] 2025-09-25 11:50:37.451 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000002
[aiter INFO] 2025-09-25 11:50:37.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:50:37.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.518999999999949
[aiter INFO] 2025-09-25 11:50:37.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999976
[aiter INFO] 2025-09-25 11:50:37.473 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            459.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,043.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,537.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.4             15.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:37.474 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:37.522 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.10012871558123 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:37.570 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:37.570 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.07900000000001
[aiter INFO] 2025-09-25 11:50:37.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,068.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:37.605 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.96807934093003 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:38.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:38.137 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:50:38.148 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            437.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:38.149 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:38.422 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.93577232337233 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:38.474 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:38.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.599000000000018
[aiter INFO] 2025-09-25 11:50:38.487 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,568.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:38.512 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.75819789124007 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:39.010 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:39.011 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.319000000000017
[aiter INFO] 2025-09-25 11:50:39.023 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            434.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:39.024 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:39.421 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.05120788912962 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:39.445 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:39.445 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:50:39.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            973.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          973.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.7              9.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:39.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:39.462 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:39.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.57890063760304 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 20, 21, 1109, 1110, 284, 285}
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119000000000028
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999969
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000001324
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000233
[aiter INFO] 2025-09-25 11:50:39.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:50:39.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            418.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            880.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,338.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.4             13.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:39.598 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:39.642 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.27475217191301 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:39.690 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 179}
[aiter INFO] 2025-09-25 11:50:39.690 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.63900000000001
[aiter INFO] 2025-09-25 11:50:39.690 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.07900000000018
[aiter INFO] 2025-09-25 11:50:39.700 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,645.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:39.724 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.79305934846992 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:40.057 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:40.057 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.078999999999979
[aiter INFO] 2025-09-25 11:50:40.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            326.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:40.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:40.150 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.52425720668074 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:40.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:50:40.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.679000000000087
[aiter INFO] 2025-09-25 11:50:40.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-09-25 11:50:40.379 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,406.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:40.405 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.19542570161347 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:40.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:40.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:50:40.608 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            328.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:40.609 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:40.644 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.67850484027721 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:40.668 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:40.668 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-09-25 11:50:40.683 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            763.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          763.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.6              7.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:40.684 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:40.684 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:41.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.77731697571159 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:41.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 108, 109}
[aiter INFO] 2025-09-25 11:50:41.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.960000000000036
[aiter INFO] 2025-09-25 11:50:41.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:41.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.95900000000006
[aiter INFO] 2025-09-25 11:50:41.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:50:41.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            462.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,098.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,577.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.8             15.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:41.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01416015625
max_diff_thr=0.013016157783567905

Top differences:
Position (np.int64(22), np.int64(1), np.int64(19)): arr1 = -0.102051, arr2 = -0.087891, Diff = 0.014160
Position (np.int64(10), np.int64(1), np.int64(42)): arr1 = -0.273438, arr2 = -0.259766, Diff = 0.013672
Position (np.int64(6), np.int64(4), np.int64(69)): arr1 = -0.125977, arr2 = -0.113281, Diff = 0.012695
Position (np.int64(28), np.int64(3), np.int64(90)): arr1 = -0.075684, arr2 = -0.063477, Diff = 0.012207
Position (np.int64(25), np.int64(2), np.int64(104)): arr1 = 0.106934, arr2 = 0.094727, Diff = 0.012207

Threshold statistics:
[0.0e+00, 1.0e-06): 872 (4.26%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 58 (0.28%)
[1.0e-04, 1.0e-03): 4787 (23.37%)
[1.0e-03, 1.0e-02): 14726 (71.90%)
[1.0e-02, 1.0e-01): 37 (0.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=460b9514e1cba4777565466c9dd46012
triton_output_md5=7c47c3ab482b34f75005b2b9e0b91509
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013916015625
max_diff_thr=0.013311536982655525

Top differences:
Position (np.int64(43), np.int64(2), np.int64(67)): arr1 = -0.059326, arr2 = -0.045410, Diff = 0.013916
Position (np.int64(93), np.int64(1), np.int64(93)): arr1 = -0.157227, arr2 = -0.144531, Diff = 0.012695
Position (np.int64(125), np.int64(3), np.int64(48)): arr1 = 0.127930, arr2 = 0.115723, Diff = 0.012207
Position (np.int64(29), np.int64(3), np.int64(37)): arr1 = 0.134766, arr2 = 0.123047, Diff = 0.011719
Position (np.int64(112), np.int64(0), np.int64(51)): arr1 = 0.168945, arr2 = 0.157227, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 3354 (4.09%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 304 (0.37%)
[1.0e-04, 1.0e-03): 20334 (24.82%)
[1.0e-03, 1.0e-02): 57853 (70.62%)
[1.0e-02, 1.0e-01): 73 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=98b134f03c17936fac90a3ed2510289e
triton_output_md5=1737a1915286d88d60940a64486221d4
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.01151315774768591

Top differences:
Position (np.int64(29), np.int64(0), np.int64(93)): arr1 = 0.201172, arr2 = 0.187500, Diff = 0.013672
Position (np.int64(4), np.int64(2), np.int64(30)): arr1 = -0.111328, arr2 = -0.099609, Diff = 0.011719
Position (np.int64(1), np.int64(4), np.int64(95)): arr1 = -0.097168, arr2 = -0.085938, Diff = 0.011230
Position (np.int64(6), np.int64(4), np.int64(81)): arr1 = 0.096191, arr2 = 0.085938, Diff = 0.010254
Position (np.int64(6), np.int64(2), np.int64(46)): arr1 = -0.131836, arr2 = -0.121582, Diff = 0.010254

Threshold statistics:
[0.0e+00, 1.0e-06): 871 (4.25%)
[1.0e-06, 1.0e-05): 2 (0.01%)
[1.0e-05, 1.0e-04): 76 (0.37%)
[1.0e-04, 1.0e-03): 5161 (25.20%)
[1.0e-03, 1.0e-02): 14363 (70.13%)
[1.0e-02, 1.0e-01): 7 (0.03%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9208b83e93c90a4bc1fef51b0c720836
triton_output_md5=5ae241faab31dee153934827ab11d5c6
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0113525390625
max_diff_thr=0.011168488301336765

Top differences:
Position (np.int64(71), np.int64(3), np.int64(89)): arr1 = 0.027832, arr2 = 0.016479, Diff = 0.011353
Position (np.int64(41), np.int64(3), np.int64(72)): arr1 = 0.116699, arr2 = 0.106445, Diff = 0.010254
Position (np.int64(71), np.int64(0), np.int64(89)): arr1 = 0.086914, arr2 = 0.076660, Diff = 0.010254
Position (np.int64(82), np.int64(1), np.int64(14)): arr1 = 0.133789, arr2 = 0.124023, Diff = 0.009766
Position (np.int64(24), np.int64(1), np.int64(115)): arr1 = 0.119629, arr2 = 0.109863, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 3443 (4.20%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 483 (0.59%)
[1.0e-04, 1.0e-03): 25751 (31.43%)
[1.0e-03, 1.0e-02): 52239 (63.77%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d36abfe81f84dcc76b5818c1d59332e7
triton_output_md5=ecd4ac2561c949d15846a18404c69c0a
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.009187149815261364

Top differences:
Position (np.int64(15), np.int64(3), np.int64(34)): arr1 = 0.168945, arr2 = 0.159180, Diff = 0.009766
Position (np.int64(11), np.int64(0), np.int64(78)): arr1 = 0.006042, arr2 = -0.003174, Diff = 0.009216
Position (np.int64(11), np.int64(0), np.int64(46)): arr1 = -0.068848, arr2 = -0.059814, Diff = 0.009033
Position (np.int64(11), np.int64(1), np.int64(58)): arr1 = 0.133789, arr2 = 0.125000, Diff = 0.008789
Position (np.int64(15), np.int64(4), np.int64(34)): arr1 = 0.183594, arr2 = 0.174805, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 129 (0.63%)
[1.0e-04, 1.0e-03): 6378 (31.14%)
[1.0e-03, 1.0e-02): 13111 (64.02%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8d48b773fd3a58177a44cd994439c6f6
triton_output_md5=1a977dca0e8f30dc421eda2f5f769110
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32[aiter INFO] 2025-09-25 11:50:41.384 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.78841593714043 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:41.431 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:41.431 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.039000000000016
[aiter INFO] 2025-09-25 11:50:41.441 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,116.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:41.465 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.14630682692669 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:42.003 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:42.003 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.479000000000013
[aiter INFO] 2025-09-25 11:50:42.014 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            473.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:42.015 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.90 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:42.286 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.6149899446138 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:42.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:50:42.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.838999999999942
[aiter INFO] 2025-09-25 11:50:42.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.438999999999993
[aiter INFO] 2025-09-25 11:50:42.347 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,566.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:42.372 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.374415867989605 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:42.864 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {20, 6, 55}
[aiter INFO] 2025-09-25 11:50:42.864 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-25 11:50:42.864 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5589999999999975
[aiter INFO] 2025-09-25 11:50:42.864 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:50:42.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            458.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:42.877 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:43.286 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.388613789831055 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:43.312 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:43.312 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:50:43.327 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            948.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          948.6              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:43.328 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:43.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:43.388 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.26763318906916 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 306, 339, 307, 53, 54, 340, 1109, 1110, 955, 956}
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000023
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000016
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.19900000000007
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000037
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.238999999999578
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.35899999999856
[aiter INFO] 2025-09-25 11:50:43.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:50:43.466 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            409.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            835.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,312.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:43.467 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:43.512 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.59356439467703 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:43.559 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1211}
[aiter INFO] 2025-09-25 11:50:43.559 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.999000000000024
[aiter INFO] 2025-09-25 11:50:43.559 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.078999999999724
[aiter INFO] 2025-09-25 11:50:43.569 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,633.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:43.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.65997021121554 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:43.908 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:43.908 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.079000000000008
[aiter INFO] 2025-09-25 11:50:43.920 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            292.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              2.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:43.921 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:44.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.67831658903916 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 1091, 168, 12, 207}
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639999999999418
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:50:44.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-09-25 11:50:44.239 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          1,363.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:44.264 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.53639595520379 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:44.458 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:44.458 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:50:44.471 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:44.472 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.51 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:44.507 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.581871344754013 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:44.531 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {304, 504, 4, 174}
[aiter INFO] 2025-09-25 11:50:44.531 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.118999999999915
[aiter INFO] 2025-09-25 11:50:44.532 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999614
[aiter INFO] 2025-09-25 11:50:44.532 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.718999999999994
[aiter INFO] 2025-09-25 11:50:44.532 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-25 11:50:44.547 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0            746.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          768.7              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:44.548 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:44.548 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:45.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.91837630177488 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:45.189 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 22, 23}
[aiter INFO] 2025-09-25 11:50:45.190 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999976
[aiter INFO] 2025-09-25 11:50:45.190 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:50:45.190 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.158999999999992
[aiter INFO] 2025-09-25 11:50:45.190 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.2000000000000455
[aiter INFO] 2025-09-25 11:50:45.212 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            468.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,266.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,755.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           17.6             17.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:45.213 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.53 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:45.747 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.83200971855975 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 167, 107, 11, 143, 179, 23, 59}
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.799000000000035
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.03899999999999
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.19999999999993
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.559
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.71900000000005
[aiter INFO] 2025-09-25 11:50:45.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.878999999999905
[aiter INFO] 2025-09-25 11:50:45.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.75899999999996
[aiter INFO] 2025-09-25 11:50:45.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.27999999999997
[aiter INFO] 2025-09-25 11:50:45.808 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 93.0            0.0          2,966.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             31.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:45.834 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.84809906382372 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:45.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:45.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:50:45.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            435.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:45.881 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:46.569 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.95916850909148 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:46.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {285, 12, 181}
[aiter INFO] 2025-09-25 11:50:46.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.91899999999987
[aiter INFO] 2025-09-25 11:50:46.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.87899999999999
[aiter INFO] 2025-09-25 11:50:46.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.838999999999942
[aiter INFO] 2025-09-25 11:50:46.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,569.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:46.657 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.01005930947785 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:46.698 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {363, 6}
[aiter INFO] 2025-09-25 11:50:46.698 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:50:46.698 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.199000000000012
[aiter INFO] 2025-09-25 11:50:46.710 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            429.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:46.711 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:47.151 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.7244455750921 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:47.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:47.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-09-25 11:50:47.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,079.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,079.7              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           10.8             10.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:47.192 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:47.192 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:47.250 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.3179208848736 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:47.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:47.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.63900000000001
[aiter INFO] 2025-09-25 11:50:47.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:50:47.326 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            427.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            877.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,305.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:47.327 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:47.371 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.16702953423604 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:47.418 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:47.419 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.199000000000012
[aiter INFO] 2025-09-25 11:50:47.429 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,684.1        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:47.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.44806931809623 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:47.741 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:50:47.741 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.59900000000016
[aiter INFO] 2025-09-25 11:50:47.741 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:50:47.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            293.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:47.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.80 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:48.018 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.03196975736336 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:48.068 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:48.068 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:50:48.080 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,432.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:48.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.27780205011368 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:48.318 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:48.318 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:50:48.330 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            332.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:48.331 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:48.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.207623792166757 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:48.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 9, 14, 19, 29}
[aiter INFO] 2025-09-25 11:50:48.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000009
[aiter INFO] 2025-09-25 11:50:48.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000002
[aiter INFO] 2025-09-25 11:50:48.392 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.63900000000001
[aiter INFO] 2025-09-25 11:50:48.392 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:50:48.392 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-09-25 11:50:48.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            761.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          796.4              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            8.0              7.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:48.408 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:48.408 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:48.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.34881180347783 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:49.049 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:49.049 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.198999999999955
[aiter INFO] 2025-09-25 11:50:49.049 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:49.068 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            471.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,684.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,155.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           21.6             21.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:49.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.55 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:49.120 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.75916829321645 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:49.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59, 35}
[aiter INFO] 2025-09-25 11:50:49.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.91900000000001
[aiter INFO] 2025-09-25 11:50:49.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.15899999999999
[aiter INFO] 2025-09-25 11:50:49.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.07900000000001
[aiter INFO] 2025-09-25 11:50:49.178 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          5,783.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             59.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:49.319 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.890049492368604 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:49.705 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 559}
[aiter INFO] 2025-09-25 11:50:49.705 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-25 11:50:49.705 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999999833
[aiter INFO] 2025-09-25 11:50:49.717 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            540.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:49.718 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:50.019 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.44713879339764 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:50.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 350}
[aiter INFO] 2025-09-25 11:50:50.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.239000000000004
[aiter INFO] 2025-09-25 11:50:50.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.51999999999998
[aiter INFO] 2025-09-25 11:50:50.081 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,746.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             47.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:50.279 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.37877235524726 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:50.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {356, 6}
[aiter INFO] 2025-09-25 11:50:50.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000215
[aiter INFO] 2025-09-25 11:50:50.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            542.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:50.595 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:51.016 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 35.75850490222473 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:51.045 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 494}
[aiter INFO] 2025-09-25 11:50:51.045 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-25 11:50:51.045 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.958999999999833
[aiter INFO] 2025-09-25 11:50:51.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,401.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,417.3              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           14.2             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:51.062 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:51.062 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:51.122 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.3028912196065 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:51.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:51.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000037
[aiter INFO] 2025-09-25 11:50:51.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:50:51.203 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            425.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            892.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,318.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:51.205 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.00859266147017479

Top differences:
Position (np.int64(31), np.int64(3), np.int64(45)): arr1 = 0.161133, arr2 = 0.151367, Diff = 0.009766
Position (np.int64(53), np.int64(4), np.int64(119)): arr1 = -0.060303, arr2 = -0.051270, Diff = 0.009033
Position (np.int64(72), np.int64(2), np.int64(34)): arr1 = 0.023926, arr2 = 0.032715, Diff = 0.008789
Position (np.int64(38), np.int64(0), np.int64(38)): arr1 = -0.120117, arr2 = -0.111328, Diff = 0.008789
Position (np.int64(45), np.int64(0), np.int64(61)): arr1 = -0.101562, arr2 = -0.092773, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 3325 (4.06%)
[1.0e-06, 1.0e-05): 11 (0.01%)
[1.0e-05, 1.0e-04): 583 (0.71%)
[1.0e-04, 1.0e-03): 27555 (33.64%)
[1.0e-03, 1.0e-02): 50446 (61.58%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=24da20a107e55363225947e5d0dc0f2a
triton_output_md5=673121874af79e8a7201b60293fe9593
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008966493420302868

Top differences:
Position (np.int64(17), np.int64(2), np.int64(58)): arr1 = -0.153320, arr2 = -0.143555, Diff = 0.009766
Position (np.int64(28), np.int64(4), np.int64(12)): arr1 = 0.088379, arr2 = 0.079102, Diff = 0.009277
Position (np.int64(2), np.int64(1), np.int64(114)): arr1 = 0.043945, arr2 = 0.034668, Diff = 0.009277
Position (np.int64(21), np.int64(0), np.int64(33)): arr1 = 0.063965, arr2 = 0.054932, Diff = 0.009033
Position (np.int64(1), np.int64(4), np.int64(93)): arr1 = 0.070312, arr2 = 0.062012, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 797 (3.89%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 129 (0.63%)
[1.0e-04, 1.0e-03): 6812 (33.26%)
[1.0e-03, 1.0e-02): 12741 (62.21%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=37db4495182fdc07d082e3535139b607
triton_output_md5=ddbc6a32c1489d417b31016f7ba5bbe0
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00640869140625
max_diff_thr=0.006383754778653383

Top differences:
Position (np.int64(42), np.int64(0), np.int64(126)): arr1 = 0.010315, arr2 = 0.003906, Diff = 0.006409
Position (np.int64(26), np.int64(1), np.int64(55)): arr1 = 0.047607, arr2 = 0.041504, Diff = 0.006104
Position (np.int64(126), np.int64(0), np.int64(101)): arr1 = 0.087402, arr2 = 0.081543, Diff = 0.005859
Position (np.int64(75), np.int64(4), np.int64(105)): arr1 = 0.041504, arr2 = 0.035645, Diff = 0.005859
Position (np.int64(38), np.int64(2), np.int64(53)): arr1 = 0.084473, arr2 = 0.078613, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 3240 (3.96%)
[1.0e-06, 1.0e-05): 17 (0.02%)
[1.0e-05, 1.0e-04): 1134 (1.38%)
[1.0e-04, 1.0e-03): 37502 (45.78%)
[1.0e-03, 1.0e-02): 40027 (48.86%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=40036bd8999054b37aecd8c63adec8e6
triton_output_md5=992999c5dbaad5cb98efcf908b36f616
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.00609225407242775

Top differences:
Position (np.int64(22), np.int64(2), np.int64(97)): arr1 = -0.128906, arr2 = -0.122070, Diff = 0.006836
Position (np.int64(8), np.int64(2), np.int64(46)): arr1 = -0.054443, arr2 = -0.048584, Diff = 0.005859
Position (np.int64(3), np.int64(1), np.int64(48)): arr1 = 0.071289, arr2 = 0.065430, Diff = 0.005859
Position (np.int64(6), np.int64(0), np.int64(104)): arr1 = -0.036377, arr2 = -0.030762, Diff = 0.005615
Position (np.int64(15), np.int64(2), np.int64(92)): arr1 = 0.011230, arr2 = 0.005829, Diff = 0.005402

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 283 (1.38%)
[1.0e-04, 1.0e-03): 9234 (45.09%)
[1.0e-03, 1.0e-02): 10097 (49.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=007a3ef0d44a4e4ba3022034dedd4f7a
triton_output_md5=d4a4c5d4af762d2e08f03aafd6e279ee
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.007080078125
max_diff_thr=0.006719184573739767

Top differences:
Position (np.int64(109), np.int64(0), np.int64(58)): arr1 = 0.060791, arr2 = 0.053711, Diff = 0.007080
Position (np.int64(117), np.int64(4), np.int64(108)): arr1 = 0.075684, arr2 = 0.068848, Diff = 0.006836
Position (np.int64(45), np.int64(4), np.int64(8)): arr1 = 0.090820, arr2 = 0.083984, Diff = 0.006836
Position (np.int64(15), np.int64(3), np.int64(14)): arr1 = 0.099121, arr2 = 0.092285, Diff = 0.006836
Position (np.int64(69), np.int64(2), np.int64(56)): arr1 = 0.072266, arr2 = 0.065918, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 3334 (4.07%)
[1.0e-06, 1.0e-05): 14 (0.02%)
[1.0e-05, 1.0e-04): 1034 (1.26%)
[1.0e-04, 1.0e-03): 36969 (45.13%)
[1.0e-03, 1.0e-02): 40569 (49.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a03b3c076aaba7088d247bca4839aa7b
triton_output_md5=a7665398f2ac626829e207e3a0b586cb
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}[aiter INFO] 2025-09-25 11:50:51.250 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.41894030334926 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:51.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 179}
[aiter INFO] 2025-09-25 11:50:51.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.59899999999999
[aiter INFO] 2025-09-25 11:50:51.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.358999999999924
[aiter INFO] 2025-09-25 11:50:51.498 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,664.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:51.525 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.58747550668103 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:51.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {118, 6}
[aiter INFO] 2025-09-25 11:50:51.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.0389999999999873
[aiter INFO] 2025-09-25 11:50:51.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:50:51.716 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            332.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:51.718 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:51.805 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.25850513784013 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:51.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 415}
[aiter INFO] 2025-09-25 11:50:51.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-09-25 11:50:51.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.639000000000124
[aiter INFO] 2025-09-25 11:50:51.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,398.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:51.902 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.68294053561616 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:52.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:52.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:50:52.257 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            340.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:52.258 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:52.295 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.674148496424795 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:52.320 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:52.320 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-09-25 11:50:52.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            989.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          989.6              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.9              9.9         NaN          NaN
[aiter INFO] 2025-09-25 11:50:52.336 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:52.337 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:52.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.5143764969146 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:52.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:50:52.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.559000000000026
[aiter INFO] 2025-09-25 11:50:52.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:52.962 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            476.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,658.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,135.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           21.4             21.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:52.963 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:53.015 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.9972373199935 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:53.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59, 23}
[aiter INFO] 2025-09-25 11:50:53.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.039000000000016
[aiter INFO] 2025-09-25 11:50:53.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.15899999999999
[aiter INFO] 2025-09-25 11:50:53.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.91899999999998
[aiter INFO] 2025-09-25 11:50:53.074 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          5,784.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             59.0         NaN          NaN
[aiter INFO] 2025-09-25 11:50:53.099 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.738752392258974 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:53.631 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:53.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:50:53.644 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            514.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:53.645 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:53.885 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.57228748869187 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:53.936 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 103}
[aiter INFO] 2025-09-25 11:50:53.936 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.678999999999974
[aiter INFO] 2025-09-25 11:50:53.936 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.63900000000001
[aiter INFO] 2025-09-25 11:50:53.948 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,758.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:53.973 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.66988114732327 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:54.517 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:54.517 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:50:54.529 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            548.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:54.531 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:54.881 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.80166333294151 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:54.906 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {464, 139, 4}
[aiter INFO] 2025-09-25 11:50:54.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.19900000000007
[aiter INFO] 2025-09-25 11:50:54.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999928
[aiter INFO] 2025-09-25 11:50:54.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999997
[aiter INFO] 2025-09-25 11:50:54.922 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0          1,387.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,419.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           14.2             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:54.923 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:54.923 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:54.982 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.59358410492982 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 944, 945, 856, 857}
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.238999999999976
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.678999999999974
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.879000000000815
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999998705
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.439000000000306
[aiter INFO] 2025-09-25 11:50:55.040 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999998705
[aiter INFO] 2025-09-25 11:50:55.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            416.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            870.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,313.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:55.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.13 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:55.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.65652482521415 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:55.152 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:55.152 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.799000000000007
[aiter INFO] 2025-09-25 11:50:55.162 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,676.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:55.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.51815825759774 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 139, 48, 496, 594, 20, 118, 699, 447}
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.119000000000142
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.1189999999999714
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6390000000001237
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6390000000001237
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.119000000000028
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.1189999999999145
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6790000000000873
[aiter INFO] 2025-09-25 11:50:55.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.6399999999998727
[aiter INFO] 2025-09-25 11:50:55.773 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0            310.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:55.774 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:55.857 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.58088132414487 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:55.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:50:55.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.638999999999982
[aiter INFO] 2025-09-25 11:50:55.919 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,436.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:55.944 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.80451490914467 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:56.090 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {685, 6}
[aiter INFO] 2025-09-25 11:50:56.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000004875
[aiter INFO] 2025-09-25 11:50:56.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000017
[aiter INFO] 2025-09-25 11:50:56.103 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            371.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:56.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:56.139 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.59412874650247 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:56.163 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 14}
[aiter INFO] 2025-09-25 11:50:56.163 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-09-25 11:50:56.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.438999999999993
[aiter INFO] 2025-09-25 11:50:56.179 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            971.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          981.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.8              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:56.180 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:56.180 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:56.709 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.6082380650067 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:56.793 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12, 1043, 20, 21, 1046, 31, 33, 933, 936, 42, 45, 53, 56, 64, 67, 339, 342, 757, 760}
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.798999999999978
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.039000000000044
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.519000000000233
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.839
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000003
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999141
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.839000000000055
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.59899999999834
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000815
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.798999999999978
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.31899999999996
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.918999999999983
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:50:56.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.43899999999985
[aiter INFO] 2025-09-25 11:50:56.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:50:56.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.438999999999396
[aiter INFO] 2025-09-25 11:50:56.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:50:56.813 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            436.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  91.0            0.0          1,628.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,294.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           22.9             22.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:56.814 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    22.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:56.865 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.83923713169474 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 11, 275, 23, 59}
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.03899999999999
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.879999999999995
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.759000000000015
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.79899999999998
[aiter INFO] 2025-09-25 11:50:56.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.719999999999914
[aiter INFO] 2025-09-25 11:50:56.924 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 96.0            0.0          5,818.9        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             60.6         NaN          NaN
[aiter INFO] 2025-09-25 11:50:56.950 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.92650481025771 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:57.495 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:57.495 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119
[aiter INFO] 2025-09-25 11:50:57.508 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            513.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:50:57.509 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    65.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:57.752 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.56792048534544 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:57.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 51, 12, 38}
[aiter INFO] 2025-09-25 11:50:57.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.919000000000096
[aiter INFO] 2025-09-25 11:50:57.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.87900000000002
[aiter INFO] 2025-09-25 11:50:57.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.23900000000003
[aiter INFO] 2025-09-25 11:50:57.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.718999999999994
[aiter INFO] 2025-09-25 11:50:57.816 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          4,738.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.8         NaN          NaN
[aiter INFO] 2025-09-25 11:50:57.841 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.13798014126202 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:58.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 223}
[aiter INFO] 2025-09-25 11:50:58.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-25 11:50:58.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-09-25 11:50:58.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            539.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:58.372 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    54.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:58.748 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 36.40800021072425 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:58.776 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:50:58.776 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.998999999999995
[aiter INFO] 2025-09-25 11:50:58.791 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,548.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,548.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-25 11:50:58.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    15.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:58.793 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:50:58.852 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.32784177761266 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:58.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {713, 714, 10, 9}
[aiter INFO] 2025-09-25 11:50:58.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.919000000000779
[aiter INFO] 2025-09-25 11:50:58.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:50:58.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:50:58.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:50:58.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            423.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            928.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,367.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.7             13.7         NaN          NaN
[aiter INFO] 2025-09-25 11:50:58.931 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.66 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:58.975 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.40903944072157 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:59.180 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:50:59.180 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.519999999999982
[aiter INFO] 2025-09-25 11:50:59.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,724.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.2         NaN          NaN
[aiter INFO] 2025-09-25 11:50:59.216 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.67579200067142 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:59.439 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:59.440 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.478999999999985
[aiter INFO] 2025-09-25 11:50:59.451 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:59.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.61 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:50:59.536 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.94484185228254 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:59.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 103}
[aiter INFO] 2025-09-25 11:50:59.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119
[aiter INFO] 2025-09-25 11:50:59.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-09-25 11:50:59.599 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,410.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.3         NaN          NaN
[aiter INFO] 2025-09-25 11:50:59.625 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.864712831997636 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:50:59.964 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:50:59.964 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:50:59.976 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            339.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:50:59.977 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:00.013 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.65476237665309 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:00.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:00.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.758999999999986
[aiter INFO] 2025-09-25 11:51:00.053 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            958.0        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          958.0              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.6              9.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:00.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:00.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:00.575 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.0383271822835 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:00.675 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:51:00.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.799000000000035
[aiter INFO] 2025-09-25 11:51:00.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:51:00.695 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            474.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,050.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,525.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           25.3             25.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:00.695 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    25.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:00.748 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 152.4963364152625 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:00.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 83, 71, 23}
[aiter INFO] 2025-09-25 11:51:00.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.47899999999998
[aiter INFO] 2025-09-25 11:51:00.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.19899999999996
[aiter INFO] 2025-09-25 11:51:00.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.95899999999995
[aiter INFO] 2025-09-25 11:51:00.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.91899999999998
[aiter INFO] 2025-09-25 11:51:00.807 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          7,248.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             74.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:00.991 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.40335642494777 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:01.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:01.368 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999984
[aiter INFO] 2025-09-25 11:51:01.380 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            626.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:01.381 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    80.99 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:01.603 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 144.89825748571076 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:01.654 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12, 103}
[aiter INFO] 2025-09-25 11:51:01.654 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.079000000000065
[aiter INFO] 2025-09-25 11:51:01.654 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.91999999999996
[aiter INFO] 2025-09-25 11:51:01.654 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.520000000000095
[aiter INFO] 2025-09-25 11:51:01.666 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          5,902.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             60.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:01.828 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.60767333814413 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:02.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {258, 685, 510, 6}
[aiter INFO] 2025-09-25 11:51:02.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.95900000000006
[aiter INFO] 2025-09-25 11:51:02.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999905
[aiter INFO] 2025-09-25 11:51:02.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.919000000000324
[aiter INFO] 2025-09-25 11:51:02.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.119
[aiter INFO] 2025-09-25 11:51:02.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            633.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:02.246 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    66.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.00634765625
max_diff_thr=0.006049104500561953

Top differences:
Position (np.int64(18), np.int64(4), np.int64(59)): arr1 = -0.117676, arr2 = -0.111328, Diff = 0.006348
Position (np.int64(16), np.int64(4), np.int64(83)): arr1 = -0.035400, arr2 = -0.029175, Diff = 0.006226
Position (np.int64(17), np.int64(2), np.int64(39)): arr1 = 0.113770, arr2 = 0.107910, Diff = 0.005859
Position (np.int64(20), np.int64(2), np.int64(2)): arr1 = -0.070801, arr2 = -0.064941, Diff = 0.005859
Position (np.int64(17), np.int64(1), np.int64(19)): arr1 = 0.087402, arr2 = 0.081543, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 823 (4.02%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 261 (1.27%)
[1.0e-04, 1.0e-03): 9323 (45.52%)
[1.0e-03, 1.0e-02): 10069 (49.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=882ec498d51c7616d3f5540fd214d717
triton_output_md5=dd29061bd03fe1c0ab3d8d171dc18188
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.0061147697269916534

Top differences:
Position (np.int64(100), np.int64(2), np.int64(32)): arr1 = 0.044434, arr2 = 0.038086, Diff = 0.006348
Position (np.int64(85), np.int64(2), np.int64(47)): arr1 = -0.059326, arr2 = -0.052979, Diff = 0.006348
Position (np.int64(78), np.int64(3), np.int64(7)): arr1 = -0.067383, arr2 = -0.061035, Diff = 0.006348
Position (np.int64(37), np.int64(0), np.int64(68)): arr1 = 0.028320, arr2 = 0.022217, Diff = 0.006104
Position (np.int64(46), np.int64(3), np.int64(105)): arr1 = 0.081543, arr2 = 0.075684, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 3364 (4.11%)
[1.0e-06, 1.0e-05): 13 (0.02%)
[1.0e-05, 1.0e-04): 1221 (1.49%)
[1.0e-04, 1.0e-03): 38661 (47.19%)
[1.0e-03, 1.0e-02): 38661 (47.19%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4ede5f576607bac307ff01b11e123eb8
triton_output_md5=54c13ad42e3d3df697665a8d3ee4b8ed
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.005811354611068964

Top differences:
Position (np.int64(8), np.int64(0), np.int64(14)): arr1 = 0.098633, arr2 = 0.092285, Diff = 0.006348
Position (np.int64(13), np.int64(3), np.int64(106)): arr1 = 0.042480, arr2 = 0.036621, Diff = 0.005859
Position (np.int64(26), np.int64(3), np.int64(44)): arr1 = 0.053711, arr2 = 0.048096, Diff = 0.005615
Position (np.int64(15), np.int64(0), np.int64(121)): arr1 = -0.046875, arr2 = -0.041504, Diff = 0.005371
Position (np.int64(24), np.int64(3), np.int64(30)): arr1 = -0.083496, arr2 = -0.078125, Diff = 0.005371

Threshold statistics:
[0.0e+00, 1.0e-06): 850 (4.15%)
[1.0e-06, 1.0e-05): 9 (0.04%)
[1.0e-05, 1.0e-04): 331 (1.62%)
[1.0e-04, 1.0e-03): 9557 (46.67%)
[1.0e-03, 1.0e-02): 9733 (47.52%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e57e381930620ddfac6ca2005035e1d0
triton_output_md5=47b56f8e3de1a75e89ab0f5c9583848b
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.0050136735662817955

Top differences:
Position (np.int64(112), np.int64(4), np.int64(123)): arr1 = -0.076660, arr2 = -0.071289, Diff = 0.005371
Position (np.int64(112), np.int64(1), np.int64(123)): arr1 = -0.045898, arr2 = -0.040771, Diff = 0.005127
Position (np.int64(117), np.int64(2), np.int64(5)): arr1 = -0.034180, arr2 = -0.029175, Diff = 0.005005
Position (np.int64(83), np.int64(1), np.int64(21)): arr1 = 0.062500, arr2 = 0.057617, Diff = 0.004883
Position (np.int64(90), np.int64(2), np.int64(18)): arr1 = 0.055908, arr2 = 0.051514, Diff = 0.004395

Threshold statistics:
[0.0e+00, 1.0e-06): 3382 (4.13%)
[1.0e-06, 1.0e-05): 25 (0.03%)
[1.0e-05, 1.0e-04): 2107 (2.57%)
[1.0e-04, 1.0e-03): 48165 (58.80%)
[1.0e-03, 1.0e-02): 28241 (34.47%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4cb2ea184f66452ddee9ed07cac9638b
triton_output_md5=26aad2b45cd51789d042d11d3160ce60
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00567626953125
max_diff_thr=0.005593984853476286

Top differences:
Position (np.int64(15), np.int64(4), np.int64(97)): arr1 = -0.009033, arr2 = -0.014709, Diff = 0.005676
Position (np.int64(21), np.int64(0), np.int64(55)): arr1 = -0.045654, arr2 = -0.040771, Diff = 0.004883
Position (np.int64(27), np.int64(2), np.int64(126)): arr1 = 0.014771, arr2 = 0.010071, Diff = 0.004700
Position (np.int64(13), np.int64(4), np.int64(88)): arr1 = 0.070312, arr2 = 0.065918, Diff = 0.004395
Position (np.int64(23), np.int64(1), np.int64(35)): arr1 = -0.030151, arr2 = -0.026001, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 816 (3.98%)
[1.0e-06, 1.0e-05): 4 (0.02%)
[1.0e-05, 1.0e-04): 542 (2.65%)
[1.0e-04, 1.0e-03): 12041 (58.79%)
[1.0e-03, 1.0e-02): 7077 (34.56%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=30b48dfc40c53117a8ebfade90fc12e6
triton_output_md5=b5ec5d5709c9123ae270ced50dd65e5a
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.0050481874495744705

Top differences:
Position (np.int64(49), np.int64(4), np.int64(36)): arr1 = 0.069336, arr2 = 0.063965, Diff = 0.005371[aiter INFO] 2025-09-25 11:51:02.598 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 37.857920945723464 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:02.625 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {384, 459, 4}
[aiter INFO] 2025-09-25 11:51:02.625 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.439000000000078
[aiter INFO] 2025-09-25 11:51:02.625 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.83999999999969
[aiter INFO] 2025-09-25 11:51:02.625 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.07899999999998
[aiter INFO] 2025-09-25 11:51:02.640 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0          1,791.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,834.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           18.3             18.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:02.641 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    18.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:02.642 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:02.699 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 104.55475253338861 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:02.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 1054, 1055}
[aiter INFO] 2025-09-25 11:51:02.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-25 11:51:02.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:51:02.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.678999999998268
[aiter INFO] 2025-09-25 11:51:02.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.639000000001033
[aiter INFO] 2025-09-25 11:51:02.775 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            424.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,113.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,559.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.6             15.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:02.776 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:02.821 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.09615866677595 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:03.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 263}
[aiter INFO] 2025-09-25 11:51:03.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.119
[aiter INFO] 2025-09-25 11:51:03.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.639000000000124
[aiter INFO] 2025-09-25 11:51:03.065 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          2,982.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             30.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:03.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.45638608814466 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:03.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:03.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.878999999999991
[aiter INFO] 2025-09-25 11:51:03.382 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            425.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:03.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:03.466 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.10248486948485 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:03.517 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 38}
[aiter INFO] 2025-09-25 11:51:03.517 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.718999999999994
[aiter INFO] 2025-09-25 11:51:03.517 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839999999999975
[aiter INFO] 2025-09-25 11:51:03.529 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,482.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:03.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.50233661980912 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:03.888 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {370, 6}
[aiter INFO] 2025-09-25 11:51:03.888 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999742
[aiter INFO] 2025-09-25 11:51:03.888 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000007
[aiter INFO] 2025-09-25 11:51:03.900 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            423.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:03.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:03.937 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.673752416921136 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:03.962 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 4}
[aiter INFO] 2025-09-25 11:51:03.962 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.518999999999977
[aiter INFO] 2025-09-25 11:51:03.962 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000009
[aiter INFO] 2025-09-25 11:51:03.977 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,159.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,172.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           11.7             11.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:03.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:03.979 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:04.431 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.33909848302898 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:04.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-09-25 11:51:04.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.43899999999996
[aiter INFO] 2025-09-25 11:51:04.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-25 11:51:04.615 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            641.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          8,667.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,309.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           93.1             93.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:04.616 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    93.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:04.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 482.68025611886884 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:04.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {56, 11, 1204, 1160}
[aiter INFO] 2025-09-25 11:51:04.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 404.36
[aiter INFO] 2025-09-25 11:51:04.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 409.081
[aiter INFO] 2025-09-25 11:51:04.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 411.11999999999534
[aiter INFO] 2025-09-25 11:51:04.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 412.2400000000016
[aiter INFO] 2025-09-25 11:51:04.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0         39,559.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            407.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:05.075 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.701544596417115 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:05.266 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:05.267 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-09-25 11:51:05.279 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,255.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             12.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:05.280 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   420.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:05.481 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 405.37227793495254 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1283, 135, 12, 307, 344, 221}
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.0400000000009
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 322.8399999999999
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.99999999999994
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.1999999999998
[aiter INFO] 2025-09-25 11:51:05.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.03999999999996
[aiter INFO] 2025-09-25 11:51:05.556 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.03999999999996
[aiter INFO] 2025-09-25 11:51:05.568 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0         30,861.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0            324.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:05.854 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.760574108008115 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:06.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {328, 6}
[aiter INFO] 2025-09-25 11:51:06.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.03899999999976
[aiter INFO] 2025-09-25 11:51:06.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000004
[aiter INFO] 2025-09-25 11:51:06.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,239.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:06.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   337.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:06.439 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 91.69726730278222 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:06.469 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 70, 80, 501, 504, 473}
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.839
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.15899999999999
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.31899999999996
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.83899999999994
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.80000000000018
[aiter INFO] 2025-09-25 11:51:06.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.07900000000063
[aiter INFO] 2025-09-25 11:51:06.485 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  95.0            0.0          6,690.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        7,061.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           70.6             70.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:06.487 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    70.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:06.487 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:06.551 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.24826701324766 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:06.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {387, 9, 394, 12, 398, 20, 405, 24, 409, 31, 416, 35, 420, 42, 427, 46, 430, 53, 56, 64, 449, 67, 453, 966, 970, 75, 78, 977, 981, 856, 860, 988, 992, 867, 871, 999, 361, 1003, 365, 878, 882, 372, 376, 889, 893, 383}
[aiter INFO] 2025-09-25 11:51:06.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999851
[aiter INFO] 2025-09-25 11:51:06.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.438999999999965
[aiter INFO] 2025-09-25 11:51:06.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.039000000000215
[aiter INFO] 2025-09-25 11:51:06.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.519000000000233
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.839
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.47900000000027
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000021
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.519000000000233
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.158999999999992
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.71900000000005
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.479000000000042
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.119000000000028
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.639000000000124
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000078
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.158999999999992
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.599000000000046
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.759000000000015
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.878999999999905
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:51:06.612 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.559000000001106
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.87900000000002
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.559000000000083
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.759000000000015
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999287
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.998999999999796
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.47899999999936
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.398999999999432
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.559000000001106
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.79899999999907
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.59900000000016
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.59900000000016
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.11999999999989
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.679000000000087
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.678999999999633
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.59900000000016
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.558999999999287
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.839000000000397
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.838999999999942
[aiter INFO] 2025-09-25 11:51:06.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.559000000001106
[aiter INFO] 2025-09-25 11:51:06.614 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.798999999999978
[aiter INFO] 2025-09-25 11:51:06.633 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  78.0            0.0            354.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  78.0            0.0          2,005.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,105.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           31.1             30.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:06.634 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    30.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:06.688 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 184.5419110343008 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {66, 35, 11, 685, 47, 23}
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.03999999999996
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.43900000000002
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.75899999999999
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.47900000000027
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.71900000000005
[aiter INFO] 2025-09-25 11:51:06.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.92000000000002
[aiter INFO] 2025-09-25 11:51:06.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 95.0            0.0          9,822.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:06.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.91817808564346 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:07.156 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {195, 643, 678, 6, 685}
[aiter INFO] 2025-09-25 11:51:07.156 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:51:07.156 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-09-25 11:51:07.156 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999869
[aiter INFO] 2025-09-25 11:51:07.156 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-25 11:51:07.157 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-09-25 11:51:07.168 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            631.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:07.169 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   109.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:07.261 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.94663368711377 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.55899999999997
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.55899999999997
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.99899999999997
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.959
[aiter INFO] 2025-09-25 11:51:07.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.36000000000001
[aiter INFO] 2025-09-25 11:51:07.324 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,922.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             82.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:07.349 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.59619799934992 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:07.652 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:07.652 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-25 11:51:07.664 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            661.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:07.664 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    89.14 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:07.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.50392070825737 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:07.732 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {505, 10, 18, 4}
[aiter INFO] 2025-09-25 11:51:07.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.47900000000027
[aiter INFO] 2025-09-25 11:51:07.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.31899999999999
[aiter INFO] 2025-09-25 11:51:07.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.758999999999986
[aiter INFO] 2025-09-25 11:51:07.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.120000000000005
[aiter INFO] 2025-09-25 11:51:07.748 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          3,690.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,803.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           38.0             38.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:07.749 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    38.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:07.749 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:08.283 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.84681118950985 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {391, 9, 911, 17, 20, 790, 919, 28, 798, 31, 1054, 1062, 39, 1065, 559, 1073, 1076, 437, 567, 1084, 446, 702, 1087, 710, 713, 1097, 207, 721, 724, 86, 215, 732, 350, 94, 735, 358, 743, 361, 369, 372, 380, 383}
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999999833
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.24000000000004
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.1190000000006
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.55900000000003
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.27999999999975
[aiter INFO] 2025-09-25 11:51:08.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000742
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000003
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.238999999999578
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.91900000000004
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.4390000000003
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.279000000000451
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.95900000000074
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.79899999999998
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.119000000000597
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.8799999999992
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.83899999999994
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.118999999999687
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.039000000000669
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.118999999999687
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.79899999999998
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 114.83899999999994
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.199000000000524
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.15899999999965
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.7590000000000146
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.83899999999994
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999999833
[aiter INFO] 2025-09-25 11:51:08.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.35899999999947
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.23900000000003
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999999833
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.279000000000451
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.9989999999998
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.1590000000001055
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.59900000000016
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.0789999999997235
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999505
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.0
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.87900000000036
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.9989999999998
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:51:08.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.31900000000041
[aiter INFO] 2025-09-25 11:51:08.406 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  80.0            0.0            420.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  80.0            0.0          7,344.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,489.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           94.9             97.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:08.406 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    97.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:08.977 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 456.5352171954542 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1188, 103, 11, 1200, 56, 1183}
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 382.96099999999933
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 379.6400000000001
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 380.961
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.0400000000009
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 378.68000000000006
[aiter INFO] 2025-09-25 11:51:09.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 382.59999999999854
[aiter INFO] 2025-09-25 11:51:09.070 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 95.0            0.0         36,210.9        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            381.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:09.262 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.65401003561398 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {356, 6, 552, 41, 363, 370, 664, 377, 349}
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.398999999999887
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.35899999999998
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.43899999999985
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999396
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.319000000000415
[aiter INFO] 2025-09-25 11:51:09.298 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-25 11:51:09.310 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0            912.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:09.311 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   391.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:10.020 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 385.4446933411135 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {320, 1281, 12, 209, 246, 123, 1278}
[aiter INFO] 2025-09-25 11:51:10.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 302.1999999999998
[aiter INFO] 2025-09-25 11:51:10.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 302.0
[aiter INFO] 2025-09-25 11:51:10.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.28
[aiter INFO] 2025-09-25 11:51:10.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 301.7199999999998
[aiter INFO] 2025-09-25 11:51:10.094 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 302.3600000000001
[aiter INFO] 2025-09-25 11:51:10.094 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 301.8800000000001
[aiter INFO] 2025-09-25 11:51:10.094 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 302.2400000000016
[aiter INFO] 2025-09-25 11:51:10.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0         28,601.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0            304.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.317 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.87067303209022 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {573, 6}
[aiter INFO] 2025-09-25 11:51:10.358 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-25 11:51:10.359 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.15900000000002
[aiter INFO] 2025-09-25 11:51:10.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            970.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.371 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   314.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:10.421 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 88.55350485237517 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.449 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:10.449 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.999
[aiter INFO] 2025-09-25 11:51:10.465 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          6,811.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        6,811.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           68.1             68.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.465 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    68.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:10.466 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    5
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:10.530 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.03320821736118 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {768, 772, 9, 779, 12, 783, 1043, 20, 21, 790, 1047, 794, 31, 801, 34, 803, 42, 812, 45, 816, 53, 56, 64, 67, 75, 78, 735, 739, 746, 750, 757, 760}
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.559000000000196
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.519000000000005
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.239000000000487
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.2390000000004875
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.078999999999724
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.999000000000024
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000017
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.439000000000306
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.478999999999928
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.88000000000011
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:51:10.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.99899999999991
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.47900000000027
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999505
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.91999999999996
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.918999999999983
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000033
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.63900000000001
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.71900000000005
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.439000000000306
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.559000000000196
[aiter INFO] 2025-09-25 11:51:10.589 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-25 11:51:10.608 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  85.0            0.0            362.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  85.0            0.0          2,167.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,028.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           30.3             29.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.609 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    29.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:10.663 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.72725710538353 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 742, 11, 47, 1040}
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.19899999999996
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.4389999999994
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.559
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.87900000000002
[aiter INFO] 2025-09-25 11:51:10.873 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.31999999999971
[aiter INFO] 2025-09-25 11:51:10.884 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 96.0            0.0          9,922.5        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.909 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.47817822287578 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:10.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:10.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999984
[aiter INFO] 2025-09-25 11:51:10.959 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            527.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:10.960 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   108.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:11.052 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 168.53356435157286 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:11.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 25, 12, 38}
[aiter INFO] 2025-09-25 11:51:11.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.47900000000004
[aiter INFO] 2025-09-25 11:51:11.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.48000000000002
[aiter INFO] 2025-09-25 11:51:11.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.559
[aiter INFO] 2025-09-25 11:51:11.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.67900000000003
[aiter INFO] 2025-09-25 11:51:11.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          7,967.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             82.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:11.140 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.59580204894047 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:11.477 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {83, 6}
[aiter INFO] 2025-09-25 11:51:11.477 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-09-25 11:51:11.477 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.318999999999988
[aiter INFO] 2025-09-25 11:51:11.489 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            526.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:11.490 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    87.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(58), np.int64(3), np.int64(25)): arr1 = 0.093750, arr2 = 0.088379, Diff = 0.005371
Position (np.int64(30), np.int64(4), np.int64(53)): arr1 = -0.083984, arr2 = -0.078613, Diff = 0.005371
Position (np.int64(1), np.int64(1), np.int64(90)): arr1 = 0.067871, arr2 = 0.062988, Diff = 0.004883
Position (np.int64(98), np.int64(1), np.int64(120)): arr1 = -0.066406, arr2 = -0.061768, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 3322 (4.06%)
[1.0e-06, 1.0e-05): 30 (0.04%)
[1.0e-05, 1.0e-04): 2167 (2.65%)
[1.0e-04, 1.0e-03): 48332 (59.00%)
[1.0e-03, 1.0e-02): 28069 (34.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=53a5d3a6d12ba111687aeaf5fcaae4b1
triton_output_md5=21fe89acbb6f69339d81601015094588
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00439453125
max_diff_thr=0.004181184805929661

Top differences:
Position (np.int64(3), np.int64(3), np.int64(74)): arr1 = 0.055420, arr2 = 0.051025, Diff = 0.004395
Position (np.int64(14), np.int64(3), np.int64(27)): arr1 = -0.046143, arr2 = -0.041992, Diff = 0.004150
Position (np.int64(6), np.int64(0), np.int64(43)): arr1 = 0.016113, arr2 = 0.012085, Diff = 0.004028
Position (np.int64(22), np.int64(0), np.int64(22)): arr1 = -0.060303, arr2 = -0.056396, Diff = 0.003906
Position (np.int64(6), np.int64(1), np.int64(27)): arr1 = -0.052490, arr2 = -0.048584, Diff = 0.003906

Threshold statistics:
[0.0e+00, 1.0e-06): 861 (4.20%)
[1.0e-06, 1.0e-05): 8 (0.04%)
[1.0e-05, 1.0e-04): 512 (2.50%)
[1.0e-04, 1.0e-03): 12055 (58.86%)
[1.0e-03, 1.0e-02): 7044 (34.39%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9d84c49248c16a87c6d8e495390a4745
triton_output_md5=eabcec4cda35dce52c5df456c2f37b1c
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.0017018690705299377

Top differences:
Position (np.int64(106), np.int64(2), np.int64(121)): arr1 = 0.005890, arr2 = 0.004181, Diff = 0.001709
Position (np.int64(61), np.int64(1), np.int64(115)): arr1 = -0.012939, arr2 = -0.011292, Diff = 0.001648
Position (np.int64(12), np.int64(2), np.int64(73)): arr1 = 0.001633, arr2 = 0.000015, Diff = 0.001617
Position (np.int64(101), np.int64(2), np.int64(81)): arr1 = -0.020386, arr2 = -0.018799, Diff = 0.001587
Position (np.int64(39), np.int64(1), np.int64(85)): arr1 = -0.020386, arr2 = -0.018799, Diff = 0.001587

Threshold statistics:
[0.0e+00, 1.0e-06): 3393 (4.14%)
[1.0e-06, 1.0e-05): 217 (0.26%)
[1.0e-05, 1.0e-04): 12502 (15.26%)
[1.0e-04, 1.0e-03): 65034 (79.39%)
[1.0e-03, 1.0e-02): 774 (0.94%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ed6ae46336485a7ae2464462dc92d212
triton_output_md5=8041afc19aa33350ad468a9b4ad44daf
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.0016770483925938606

Top differences:
Position (np.int64(8), np.int64(0), np.int64(83)): arr1 = -0.020752, arr2 = -0.019043, Diff = 0.001709
Position (np.int64(28), np.int64(2), np.int64(76)): arr1 = 0.010559, arr2 = 0.008972, Diff = 0.001587
Position (np.int64(15), np.int64(4), np.int64(56)): arr1 = -0.013550, arr2 = -0.012024, Diff = 0.001526
Position (np.int64(22), np.int64(1), np.int64(4)): arr1 = 0.019775, arr2 = 0.018311, Diff = 0.001465
Position (np.int64(14), np.int64(2), np.int64(50)): arr1 = -0.012634, arr2 = -0.014099, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 919 (4.49%)
[1.0e-06, 1.0e-05): 68 (0.33%)
[1.0e-05, 1.0e-04): 3015 (14.72%)
[1.0e-04, 1.0e-03): 16265 (79.42%)
[1.0e-03, 1.0e-02): 213 (1.04%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8489988a2a110e464b25c214cdac4e34
triton_output_md5=5ac442569234683be9d421b5a5ba9c72
query.shape=torch.Size([128, 5, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 5, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018007202306762338

Top differences:
Position (np.int64(105), np.int64(3), np.int64(57)): arr1 = 0.018677, arr2 = 0.016846, Diff = 0.001831
Position (np.int64(107), np.int64(4), np.int64(1)): arr1 = 0.015625, arr2 = 0.014099, Diff = 0.001526
Position (np.int64(18), np.int64(0), np.int64(16)): arr1 = -0.006500, arr2 = -0.004974, Diff = 0.001526
Position (np.int64(68), np.int64(4), np.int64(99)): arr1 = -0.015137, arr2 = -0.013611, Diff = 0.001526
Position (np.int64(114), np.int64(1), np.int64(42)): arr1 = 0.014526, arr2 = 0.013000, Diff = 0.001526

Threshold statistics:
[0.0e+00, 1.0e-06): 3419 (4.17%)
[1.0e-06, 1.0e-05): 244 (0.30%)
[1.0e-05, 1.0e-04): 12498 (15.26%)
[1.0e-04, 1.0e-03): 65037 (79.39%)
[1.0e-03, 1.0e-02): 722 (0.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=26a2642af9ff60ad6982531637f7ded9
triton_output_md5=22e42bd5bae52b73b35a4fd6e95e5f5b
query.shape=torch.Size([32, 5, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 5, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 5, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0015869140625
max_diff_thr=0.0015728977741673589

Top differences:
Position (np.int64(29), np.int64(4), np.int64(13)): arr1 = 0.010498, arr2 = 0.008911, Diff = 0.001587
Position (np.int64(4), np.int64(1), np.int64(110)): arr1 = 0.000233, arr2 = -0.001328, Diff = 0.001560
Position (np.int64(29), np.int64(0), np.int64(71)): arr1 = -0.012146, arr2 = -0.010681, Diff = 0.001465[aiter INFO] 2025-09-25 11:51:11.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.659584141603794 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:11.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {18, 4, 30, 23}
[aiter INFO] 2025-09-25 11:51:11.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.91899999999998
[aiter INFO] 2025-09-25 11:51:11.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.679
[aiter INFO] 2025-09-25 11:51:11.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.79899999999998
[aiter INFO] 2025-09-25 11:51:11.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.71999999999997
[aiter INFO] 2025-09-25 11:51:11.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          3,501.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,611.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           36.1             36.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:11.574 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    36.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:11.574 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:12.120 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.65537608732092 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:12.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 42, 43}
[aiter INFO] 2025-09-25 11:51:12.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:51:12.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.279000000000053
[aiter INFO] 2025-09-25 11:51:12.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:51:12.191 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-25 11:51:12.210 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            729.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,009.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,756.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           17.6             17.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:12.210 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:12.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.04505914449692 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:12.785 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:12.785 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.519000000000005
[aiter INFO] 2025-09-25 11:51:12.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,937.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:12.912 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.62592101480701 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:12.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {125, 118, 6}
[aiter INFO] 2025-09-25 11:51:12.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000092
[aiter INFO] 2025-09-25 11:51:12.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:51:12.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:51:12.960 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            435.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:12.960 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:13.641 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.76826726800145 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:13.692 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:13.692 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.31899999999999
[aiter INFO] 2025-09-25 11:51:13.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,511.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:13.825 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.82711871248661 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:13.867 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:13.867 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000001
[aiter INFO] 2025-09-25 11:51:13.879 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            445.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:13.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.57 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:14.145 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.10859402719111 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:14.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 189}
[aiter INFO] 2025-09-25 11:51:14.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:51:14.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.240000000000009
[aiter INFO] 2025-09-25 11:51:14.186 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            878.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          887.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            8.9              8.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:14.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     8.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:14.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:14.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.09059397241857 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:14.458 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 691, 692}
[aiter INFO] 2025-09-25 11:51:14.459 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.039000000000016
[aiter INFO] 2025-09-25 11:51:14.459 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-09-25 11:51:14.459 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-25 11:51:14.459 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000415
[aiter INFO] 2025-09-25 11:51:14.477 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            839.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,277.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:14.479 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:14.524 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.13572301014815 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:14.577 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:14.577 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.07899999999998
[aiter INFO] 2025-09-25 11:51:14.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,557.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             15.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:14.614 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.97006909268917 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:14.811 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 6}
[aiter INFO] 2025-09-25 11:51:14.811 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6790000000000873
[aiter INFO] 2025-09-25 11:51:14.811 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-25 11:51:14.823 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            294.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:14.824 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    18.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:14.908 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.3555541876519 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:14.963 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:14.964 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.319000000000017
[aiter INFO] 2025-09-25 11:51:14.975 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,348.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0             13.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:15.001 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.70986144023367 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:15.363 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:15.363 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:51:15.375 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:15.376 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:15.411 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.244049436827694 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:15.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {464, 4}
[aiter INFO] 2025-09-25 11:51:15.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000069
[aiter INFO] 2025-09-25 11:51:15.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.718999999999994
[aiter INFO] 2025-09-25 11:51:15.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            685.7        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          692.9              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            6.9              6.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:15.453 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     6.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:15.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:15.987 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.62844592686926 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:16.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 9, 10, 31}
[aiter INFO] 2025-09-25 11:51:16.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999985
[aiter INFO] 2025-09-25 11:51:16.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.439000000000021
[aiter INFO] 2025-09-25 11:51:16.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:51:16.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999978
[aiter INFO] 2025-09-25 11:51:16.096 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            727.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,013.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,759.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           17.6             17.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:16.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.58 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:16.617 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.2327723609339 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:16.665 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:16.666 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.87900000000002
[aiter INFO] 2025-09-25 11:51:16.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,998.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:16.701 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.370059300767316 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:16.760 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {398, 6}
[aiter INFO] 2025-09-25 11:51:16.760 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:51:16.760 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.479000000000013
[aiter INFO] 2025-09-25 11:51:16.772 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            440.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:16.773 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.43 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:17.442 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.21695067799918 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:17.493 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:17.493 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.43900000000002
[aiter INFO] 2025-09-25 11:51:17.505 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,545.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:17.530 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.71858399840865 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:17.571 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 223}
[aiter INFO] 2025-09-25 11:51:17.571 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:51:17.571 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.1189999999999145
[aiter INFO] 2025-09-25 11:51:17.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            440.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:17.584 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:18.020 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.95573286048257 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:18.045 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:18.045 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.07899999999998
[aiter INFO] 2025-09-25 11:51:18.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            900.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          900.3              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.0              9.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:18.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:18.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:18.119 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.93023785152057 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 75, 76, 405, 406}
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.479000000000042
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000028
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000000042
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.679000000000087
[aiter INFO] 2025-09-25 11:51:18.341 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:51:18.360 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            420.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            834.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,283.7              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:18.361 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.81 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:18.406 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.4415146425219 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:18.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:18.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.758999999999986
[aiter INFO] 2025-09-25 11:51:18.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,600.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:18.495 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.43541572412642 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:18.696 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:18.696 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:51:18.708 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:18.709 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    18.98 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:18.791 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.73970265612745 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:18.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:51:18.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-09-25 11:51:18.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000011
[aiter INFO] 2025-09-25 11:51:18.855 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,361.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:18.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.94394049668076 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:19.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:19.235 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-25 11:51:19.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:19.248 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:19.285 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.379495076318776 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:19.311 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 4}
[aiter INFO] 2025-09-25 11:51:19.311 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-25 11:51:19.311 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.719000000000023
[aiter INFO] 2025-09-25 11:51:19.327 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            725.3        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          733.0              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:19.328 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:19.328 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:19.848 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.1547920456027 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:19.924 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:19.924 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-25 11:51:19.924 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-25 11:51:19.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            731.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,072.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,804.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           18.0             18.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:19.944 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.05 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:19.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.30528698286207 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:20.041 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:20.041 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.519000000000005
[aiter INFO] 2025-09-25 11:51:20.052 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,043.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:20.076 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.2266929114219 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:20.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 678, 503}
[aiter INFO] 2025-09-25 11:51:20.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.478999999999985
[aiter INFO] 2025-09-25 11:51:20.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999396
[aiter INFO] 2025-09-25 11:51:20.638 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:51:20.650 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            475.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:20.651 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.29 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:20.889 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.95677197746711 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:20.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:20.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.758999999999986
[aiter INFO] 2025-09-25 11:51:20.953 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,584.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:20.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.589079047488696 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:21.522 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:21.523 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:51:21.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            481.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:21.536 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(11), np.int64(3), np.int64(13)): arr1 = 0.002914, arr2 = 0.001450, Diff = 0.001465
Position (np.int64(4), np.int64(1), np.int64(109)): arr1 = -0.008179, arr2 = -0.006744, Diff = 0.001434

Threshold statistics:
[0.0e+00, 1.0e-06): 876 (4.28%)
[1.0e-06, 1.0e-05): 54 (0.26%)
[1.0e-05, 1.0e-04): 3065 (14.97%)
[1.0e-04, 1.0e-03): 16301 (79.59%)
[1.0e-03, 1.0e-02): 184 (0.90%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=5ad3309cc512b2b3299153c37ad5cc59
triton_output_md5=1817ea3bbddd435e309afc07621e5775
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.037109375
max_diff_thr=0.03276539966464043

Top differences:
Position (np.int64(56), np.int64(5), np.int64(81)): arr1 = 0.449219, arr2 = 0.412109, Diff = 0.037109
Position (np.int64(88), np.int64(7), np.int64(82)): arr1 = -0.351562, arr2 = -0.316406, Diff = 0.035156
Position (np.int64(51), np.int64(2), np.int64(75)): arr1 = -0.539062, arr2 = -0.503906, Diff = 0.035156
Position (np.int64(71), np.int64(4), np.int64(33)): arr1 = 0.058105, arr2 = 0.024536, Diff = 0.033569
Position (np.int64(1), np.int64(3), np.int64(73)): arr1 = -0.330078, arr2 = -0.296875, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 5766 (4.40%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 48 (0.04%)
[1.0e-04, 1.0e-03): 9338 (7.12%)
[1.0e-03, 1.0e-02): 86745 (66.18%)
[1.0e-02, 1.0e-01): 29174 (22.26%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f5bef4e2327e2ff45c7959edc8131fa5
triton_output_md5=a869e81cefb2a1eb3db1812318b77429
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.03515625
max_diff_thr=0.03230337053537369

Top differences:
Position (np.int64(16), np.int64(5), np.int64(73)): arr1 = 0.177734, arr2 = 0.212891, Diff = 0.035156
Position (np.int64(31), np.int64(7), np.int64(58)): arr1 = 0.076660, arr2 = 0.042969, Diff = 0.033691
Position (np.int64(13), np.int64(1), np.int64(7)): arr1 = -0.253906, arr2 = -0.220703, Diff = 0.033203
Position (np.int64(9), np.int64(0), np.int64(5)): arr1 = -0.462891, arr2 = -0.429688, Diff = 0.033203
Position (np.int64(29), np.int64(2), np.int64(30)): arr1 = 0.449219, arr2 = 0.416016, Diff = 0.033203

Threshold statistics:
[0.0e+00, 1.0e-06): 1405 (4.29%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 17 (0.05%)
[1.0e-04, 1.0e-03): 2360 (7.20%)
[1.0e-03, 1.0e-02): 21492 (65.59%)
[1.0e-02, 1.0e-01): 7494 (22.87%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d9f401f1fad59273d04282e91ade1e1c
triton_output_md5=6889991c2256da869aeb6dce5d53cd0f
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0234375
max_diff_thr=0.022008419036865234

Top differences:
Position (np.int64(10), np.int64(2), np.int64(49)): arr1 = -0.273438, arr2 = -0.250000, Diff = 0.023438
Position (np.int64(111), np.int64(1), np.int64(87)): arr1 = 0.037354, arr2 = 0.015015, Diff = 0.022339
Position (np.int64(56), np.int64(0), np.int64(18)): arr1 = 0.255859, arr2 = 0.235352, Diff = 0.020508
Position (np.int64(111), np.int64(1), np.int64(37)): arr1 = 0.273438, arr2 = 0.253906, Diff = 0.019531
Position (np.int64(11), np.int64(2), np.int64(7)): arr1 = 0.390625, arr2 = 0.371094, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 5587 (4.26%)
[1.0e-06, 1.0e-05): 3 (0.00%)
[1.0e-05, 1.0e-04): 204 (0.16%)
[1.0e-04, 1.0e-03): 20693 (15.79%)
[1.0e-03, 1.0e-02): 100415 (76.61%)
[1.0e-02, 1.0e-01): 4170 (3.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=0b61fec4226ebdc93188dae9a276cddf
triton_output_md5=033323467a37aeed08ccfdc9f92544c1
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.01875532791018486

Top differences:
Position (np.int64(22), np.int64(3), np.int64(6)): arr1 = -0.166992, arr2 = -0.145508, Diff = 0.021484
Position (np.int64(14), np.int64(2), np.int64(25)): arr1 = -0.390625, arr2 = -0.371094, Diff = 0.019531
Position (np.int64(31), np.int64(3), np.int64(93)): arr1 = 0.141602, arr2 = 0.123047, Diff = 0.018555
Position (np.int64(13), np.int64(4), np.int64(121)): arr1 = -0.158203, arr2 = -0.140625, Diff = 0.017578
Position (np.int64(12), np.int64(3), np.int64(60)): arr1 = -0.261719, arr2 = -0.244141, Diff = 0.017578

Threshold statistics:
[0.0e+00, 1.0e-06): 1447 (4.42%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 52 (0.16%)
[1.0e-04, 1.0e-03): 5239 (15.99%)
[1.0e-03, 1.0e-02): 25030 (76.39%)
[1.0e-02, 1.0e-01): 1000 (3.05%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2e58bc71a6ce81426f84549eeb02f346
triton_output_md5=14c27e06440a23f02801b893e0b542d6
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.013136094436049461

Top differences:
Position (np.int64(65), np.int64(4), np.int64(95)): arr1 = -0.059082, arr2 = -0.045410, Diff = 0.013672
Position (np.int64(12), np.int64(3), np.int64(110)): arr1 = -0.251953, arr2 = -0.238281, Diff = 0.013672
Position (np.int64(117), np.int64(0), np.int64(8)): arr1 = -0.017944, arr2 = -0.031494, Diff = 0.013550
Position (np.int64(98), np.int64(4), np.int64(112)): arr1 = 0.002823, arr2 = -0.010010, Diff = 0.012833
Position (np.int64(109), np.int64(2), np.int64(84)): arr1 = 0.227539, arr2 = 0.214844, Diff = 0.012695[aiter INFO] 2025-09-25 11:51:21.886 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.57473267009943 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:21.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:21.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.07899999999998
[aiter INFO] 2025-09-25 11:51:21.926 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            913.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          913.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.1              9.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:21.927 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.14 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:21.927 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:21.986 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.53140605912351 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:22.203 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 394, 395, 10, 20, 21}
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.439000000000021
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.039000000000215
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:51:22.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.4389999999999645
[aiter INFO] 2025-09-25 11:51:22.222 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            420.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            837.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,284.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:22.224 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:22.269 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.59632689823019 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:22.319 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:22.319 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.038999999999987
[aiter INFO] 2025-09-25 11:51:22.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,601.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:22.355 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.46352466026155 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:22.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:22.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:51:22.658 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            299.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:22.660 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:22.745 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.04740599358436 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:22.797 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {532, 12}
[aiter INFO] 2025-09-25 11:51:22.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.559000000000196
[aiter INFO] 2025-09-25 11:51:22.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-25 11:51:22.810 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,399.6        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:22.836 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.795396025523104 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:23.170 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:23.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.919000000000011
[aiter INFO] 2025-09-25 11:51:23.183 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            327.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:23.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:23.221 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.1248514911916 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:23.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 174}
[aiter INFO] 2025-09-25 11:51:23.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:51:23.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999905
[aiter INFO] 2025-09-25 11:51:23.263 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            737.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          745.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.5              7.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:23.264 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:23.264 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:23.713 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.01258421121257 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:23.829 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:23.829 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-09-25 11:51:23.829 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:51:23.848 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            733.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,052.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,785.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           17.9             17.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:23.849 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.86 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:23.897 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.71597047076368 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:23.946 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:23.946 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.07900000000001
[aiter INFO] 2025-09-25 11:51:23.956 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,043.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:23.982 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.81324742395099 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:24.531 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:24.531 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:51:24.543 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            448.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:24.544 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.92 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:24.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.57143579910297 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:24.805 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:24.805 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.718999999999994
[aiter INFO] 2025-09-25 11:51:24.818 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,566.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:24.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.28054452355545 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:25.389 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 335}
[aiter INFO] 2025-09-25 11:51:25.389 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.438999999999993
[aiter INFO] 2025-09-25 11:51:25.389 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:51:25.402 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            439.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:25.403 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:25.752 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.373950604607565 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:25.779 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:25.779 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000009
[aiter INFO] 2025-09-25 11:51:25.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            927.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          927.6              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:25.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:25.796 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:25.854 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.97455431270127 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:25.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:25.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000004
[aiter INFO] 2025-09-25 11:51:25.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:51:25.933 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            857.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,285.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           12.9             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:25.934 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.86 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:25.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.22601969466352 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:26.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1199, 11, 239}
[aiter INFO] 2025-09-25 11:51:26.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.640000000001237
[aiter INFO] 2025-09-25 11:51:26.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000001
[aiter INFO] 2025-09-25 11:51:26.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.71900000000005
[aiter INFO] 2025-09-25 11:51:26.206 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,585.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:26.231 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.256405675175166 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:26.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 6}
[aiter INFO] 2025-09-25 11:51:26.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.63900000000001
[aiter INFO] 2025-09-25 11:51:26.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999984
[aiter INFO] 2025-09-25 11:51:26.540 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            293.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:26.542 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:26.627 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.0858217772871 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:26.682 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:26.682 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-09-25 11:51:26.694 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,417.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:26.720 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.17481182618897 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:27.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:27.059 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.758999999999986
[aiter INFO] 2025-09-25 11:51:27.072 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:27.073 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:27.110 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.53633656610947 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:27.137 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 319}
[aiter INFO] 2025-09-25 11:51:27.137 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:51:27.137 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.95900000000006
[aiter INFO] 2025-09-25 11:51:27.152 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            737.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          745.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.5              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:27.154 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:27.154 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:27.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.0973564008675 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 1031, 1033, 9, 10, 20, 21, 31}
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.559000000000083
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.838999999999942
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999998923
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999969
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.118999999999971
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.31899999999996
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999985
[aiter INFO] 2025-09-25 11:51:27.761 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.118999999999915
[aiter INFO] 2025-09-25 11:51:27.780 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            708.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,030.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,796.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           18.0             17.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:27.780 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    17.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:27.829 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.84188073991548 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:27.879 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:27.879 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.63900000000001
[aiter INFO] 2025-09-25 11:51:27.890 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,074.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:27.915 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.03386136535371 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:28.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:28.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.319000000000017
[aiter INFO] 2025-09-25 11:51:28.428 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            448.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:28.430 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.24 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:28.620 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.95793083988794 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:28.673 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:51:28.673 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.35900000000038
[aiter INFO] 2025-09-25 11:51:28.673 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.91900000000001
[aiter INFO] 2025-09-25 11:51:28.685 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,583.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:28.710 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.778000098053774 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:29.262 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:29.262 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.319000000000017
[aiter INFO] 2025-09-25 11:51:29.274 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            479.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:29.275 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:29.619 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.843267325865163 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:29.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {179, 4}
[aiter INFO] 2025-09-25 11:51:29.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.118999999999915
[aiter INFO] 2025-09-25 11:51:29.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:51:29.661 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            931.9        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          942.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:29.662 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:29.663 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:29.722 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.67001979362846 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:29.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 97, 98, 515, 196, 197, 516, 9, 10, 790, 791, 31}
[aiter INFO] 2025-09-25 11:51:29.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-25 11:51:29.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.118999999999915
[aiter INFO] 2025-09-25 11:51:29.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000115
[aiter INFO] 2025-09-25 11:51:29.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159999999999854
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999993
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999975
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.199000000000524
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999614
[aiter INFO] 2025-09-25 11:51:29.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.038999999999987
[aiter INFO] 2025-09-25 11:51:29.958 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            406.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            828.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,300.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:29.959 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.01 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:30.005 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.46765330994484 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:30.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1139}
[aiter INFO] 2025-09-25 11:51:30.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000001
[aiter INFO] 2025-09-25 11:51:30.054 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.838999999999942
[aiter INFO] 2025-09-25 11:51:30.065 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,614.5        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:30.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.7981782599841 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:30.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:30.386 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:51:30.398 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:30.399 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:30.482 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.51513839476179 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:30.534 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:51:30.534 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.519000000000233
[aiter INFO] 2025-09-25 11:51:30.534 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-09-25 11:51:30.546 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,406.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:30.571 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.0714554541772 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:30.893 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:30.893 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-25 11:51:30.905 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            329.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:30.906 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 5364 (4.09%)
[1.0e-06, 1.0e-05): 4 (0.00%)
[1.0e-05, 1.0e-04): 408 (0.31%)
[1.0e-04, 1.0e-03): 30501 (23.27%)
[1.0e-03, 1.0e-02): 94553 (72.14%)
[1.0e-02, 1.0e-01): 242 (0.18%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=d1dd9030e8e9541d12b24dc253df2660
triton_output_md5=f0eaa554882d4dfba800ffd7f125cd79
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.014312744140625
max_diff_thr=0.014140134677290916

Top differences:
Position (np.int64(2), np.int64(7), np.int64(44)): arr1 = -0.002106, arr2 = 0.012207, Diff = 0.014313
Position (np.int64(14), np.int64(2), np.int64(70)): arr1 = -0.248047, arr2 = -0.234375, Diff = 0.013672
Position (np.int64(15), np.int64(0), np.int64(51)): arr1 = 0.225586, arr2 = 0.212891, Diff = 0.012695
Position (np.int64(28), np.int64(6), np.int64(90)): arr1 = 0.160156, arr2 = 0.147461, Diff = 0.012695
Position (np.int64(27), np.int64(4), np.int64(126)): arr1 = 0.166992, arr2 = 0.154297, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1379 (4.21%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 88 (0.27%)
[1.0e-04, 1.0e-03): 7620 (23.25%)
[1.0e-03, 1.0e-02): 23607 (72.04%)
[1.0e-02, 1.0e-01): 73 (0.22%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=37e5e53ae5e0f730d3c6869f39899986
triton_output_md5=57cc3f235697be0982bdaafa86944266
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.012121211737394333

Top differences:
Position (np.int64(126), np.int64(6), np.int64(68)): arr1 = -0.141602, arr2 = -0.127930, Diff = 0.013672
Position (np.int64(61), np.int64(1), np.int64(74)): arr1 = -0.222656, arr2 = -0.208984, Diff = 0.013672
Position (np.int64(15), np.int64(1), np.int64(111)): arr1 = 0.175781, arr2 = 0.163086, Diff = 0.012695
Position (np.int64(56), np.int64(6), np.int64(66)): arr1 = -0.196289, arr2 = -0.183594, Diff = 0.012695
Position (np.int64(38), np.int64(1), np.int64(74)): arr1 = 0.144531, arr2 = 0.131836, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 5392 (4.11%)
[1.0e-06, 1.0e-05): 6 (0.00%)
[1.0e-05, 1.0e-04): 485 (0.37%)
[1.0e-04, 1.0e-03): 32588 (24.86%)
[1.0e-03, 1.0e-02): 92475 (70.55%)
[1.0e-02, 1.0e-01): 126 (0.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=113d12cedac5c98046bacf27521724fe
triton_output_md5=58df55fd4f3ce6f69acde54d5b24ca53
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.013671875
max_diff_thr=0.012100258842110634

Top differences:
Position (np.int64(0), np.int64(5), np.int64(59)): arr1 = -0.143555, arr2 = -0.129883, Diff = 0.013672
Position (np.int64(6), np.int64(4), np.int64(118)): arr1 = -0.214844, arr2 = -0.202148, Diff = 0.012695
Position (np.int64(7), np.int64(4), np.int64(39)): arr1 = 0.090332, arr2 = 0.078125, Diff = 0.012207
Position (np.int64(20), np.int64(6), np.int64(98)): arr1 = -0.158203, arr2 = -0.146484, Diff = 0.011719
Position (np.int64(14), np.int64(4), np.int64(25)): arr1 = -0.237305, arr2 = -0.225586, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1314 (4.01%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 122 (0.37%)
[1.0e-04, 1.0e-03): 8189 (24.99%)
[1.0e-03, 1.0e-02): 23114 (70.54%)
[1.0e-02, 1.0e-01): 26 (0.08%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6253b8c8e62ac9408173e9190a456b8b
triton_output_md5=406c1a8781c87efe95f88b8e6382023b
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.00958029180765152

Top differences:
Position (np.int64(115), np.int64(4), np.int64(70)): arr1 = 0.150391, arr2 = 0.139648, Diff = 0.010742
Position (np.int64(22), np.int64(5), np.int64(54)): arr1 = 0.080566, arr2 = 0.070312, Diff = 0.010254
Position (np.int64(17), np.int64(7), np.int64(126)): arr1 = 0.092773, arr2 = 0.082520, Diff = 0.010254
Position (np.int64(85), np.int64(5), np.int64(52)): arr1 = -0.129883, arr2 = -0.120117, Diff = 0.009766
Position (np.int64(84), np.int64(1), np.int64(17)): arr1 = 0.204102, arr2 = 0.194336, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 5352 (4.08%)
[1.0e-06, 1.0e-05): 7 (0.01%)
[1.0e-05, 1.0e-04): 781 (0.60%)
[1.0e-04, 1.0e-03): 40447 (30.86%)
[1.0e-03, 1.0e-02): 84482 (64.45%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=9fefdb726364218f1f5e43902e7083f7
triton_output_md5=3e27e0e975c8f2da1292b0ba16daf0c5
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.010162353515625
max_diff_thr=0.010027703829109669

Top differences:
Position (np.int64(16), np.int64(7), np.int64(94)): arr1 = -0.003265, arr2 = -0.013428, Diff = 0.010162
Position (np.int64(22), np.int64(0), np.int64(81)): arr1 = 0.187500, arr2 = 0.177734, Diff = 0.009766
Position (np.int64(9), np.int64(6), np.int64(91)): arr1 = 0.036377, arr2 = 0.026978, Diff = 0.009399
Position (np.int64(9), np.int64(3), np.int64(91)): arr1 = 0.061279, arr2 = 0.052490, Diff = 0.008789
Position (np.int64(10), np.int64(7), np.int64(14)): arr1 = -0.170898, arr2 = -0.162109, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1365 (4.17%)
[1.0e-06, 1.0e-05): 2 (0.01%)
[1.0e-05, 1.0e-04): 209 (0.64%)
[1.0e-04, 1.0e-03): 10184 (31.08%)
[1.0e-03, 1.0e-02): 21007 (64.11%)[aiter INFO] 2025-09-25 11:51:30.942 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.511376364986496 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:30.967 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:30.967 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:51:30.982 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            753.1        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          753.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.5              7.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:30.983 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:30.983 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:31.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.72983157929808 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 196, 197, 9, 10, 207, 208, 306, 307, 53, 54, 31}
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.319000000000074
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000233
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.959000000000003
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.919000000000324
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.358999999999924
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.319000000000415
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519000000000233
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.479000000000042
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000078
[aiter INFO] 2025-09-25 11:51:31.573 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.478999999999985
[aiter INFO] 2025-09-25 11:51:31.592 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            699.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0          1,021.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,815.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           18.2             18.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:31.593 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    18.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:31.641 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.04706918249036 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:31.691 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:31.691 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.31900000000002
[aiter INFO] 2025-09-25 11:51:31.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,091.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:31.727 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.12412861845281 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:32.275 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {195, 6}
[aiter INFO] 2025-09-25 11:51:32.275 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-25 11:51:32.275 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:51:32.287 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            442.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:32.288 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:32.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 117.67995047687303 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:32.539 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 857, 12}
[aiter INFO] 2025-09-25 11:51:32.539 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.878999999998996
[aiter INFO] 2025-09-25 11:51:32.540 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.319000000000415
[aiter INFO] 2025-09-25 11:51:32.540 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.998999999999995
[aiter INFO] 2025-09-25 11:51:32.552 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,536.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:32.576 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.04807917965521 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:33.146 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {321, 475, 244, 6}
[aiter INFO] 2025-09-25 11:51:33.146 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:51:33.146 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-09-25 11:51:33.146 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999824
[aiter INFO] 2025-09-25 11:51:33.146 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:51:33.158 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            430.4        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:33.160 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:33.485 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.380673188089148 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:33.512 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {284, 4}
[aiter INFO] 2025-09-25 11:51:33.512 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000033
[aiter INFO] 2025-09-25 11:51:33.512 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000021
[aiter INFO] 2025-09-25 11:51:33.527 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            935.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          945.6              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.5              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:33.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:33.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:33.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.40110934665887 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:33.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 9, 306, 307}
[aiter INFO] 2025-09-25 11:51:33.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999953
[aiter INFO] 2025-09-25 11:51:33.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:51:33.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:51:33.795 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:51:33.814 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            425.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            867.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,306.7              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:33.815 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:33.861 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.39067346860867 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:33.910 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1139}
[aiter INFO] 2025-09-25 11:51:33.910 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.998999999999995
[aiter INFO] 2025-09-25 11:51:33.910 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.878999999999905
[aiter INFO] 2025-09-25 11:51:33.921 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,627.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:33.946 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.78748534900127 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:34.260 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {398, 412, 230, 6}
[aiter INFO] 2025-09-25 11:51:34.260 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:51:34.261 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000000327
[aiter INFO] 2025-09-25 11:51:34.261 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6790000000000873
[aiter INFO] 2025-09-25 11:51:34.261 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:51:34.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            288.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:34.274 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.42 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:34.357 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.1626734096225 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:34.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:34.409 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-09-25 11:51:34.421 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,424.0        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:34.446 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.1146039056896 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:34.786 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:34.786 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8389999999999986
[aiter INFO] 2025-09-25 11:51:34.798 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            329.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:34.799 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.54 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:34.836 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.83454457500783 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:34.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {249, 4}
[aiter INFO] 2025-09-25 11:51:34.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000024
[aiter INFO] 2025-09-25 11:51:34.863 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:51:34.878 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0            732.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          739.4              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:34.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:34.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:35.313 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.87200016491484 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:35.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:35.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.319000000000017
[aiter INFO] 2025-09-25 11:51:35.460 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:51:35.479 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            748.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,236.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,985.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           19.9             19.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:35.479 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:36.028 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.95995075867908 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:36.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 131, 167}
[aiter INFO] 2025-09-25 11:51:36.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.279000000000025
[aiter INFO] 2025-09-25 11:51:36.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.40000000000009
[aiter INFO] 2025-09-25 11:51:36.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.31899999999996
[aiter INFO] 2025-09-25 11:51:36.089 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          3,164.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             32.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:36.114 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.96413862115085 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:36.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:36.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.15900000000002
[aiter INFO] 2025-09-25 11:51:36.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            477.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:36.177 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    37.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:36.856 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.26213837968241 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:36.906 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:51:36.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.59900000000016
[aiter INFO] 2025-09-25 11:51:36.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.278999999999968
[aiter INFO] 2025-09-25 11:51:36.919 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,632.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:36.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.429079267648184 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:36.986 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 6}
[aiter INFO] 2025-09-25 11:51:36.986 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.91900000000004
[aiter INFO] 2025-09-25 11:51:36.986 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.319000000000017
[aiter INFO] 2025-09-25 11:51:36.998 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            473.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:36.999 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    31.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:37.352 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.306207846001822 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:37.541 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:37.541 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.15900000000002
[aiter INFO] 2025-09-25 11:51:37.556 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,074.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,074.4              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           10.7             10.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:37.558 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:37.558 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:37.617 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.44544542602974 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:37.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:37.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.238999999999976
[aiter INFO] 2025-09-25 11:51:37.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999969
[aiter INFO] 2025-09-25 11:51:37.697 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            893.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,322.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:37.698 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.22 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:37.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.79317784191359 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:37.793 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:37.793 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.558999999999997
[aiter INFO] 2025-09-25 11:51:37.804 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,685.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:37.829 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.002940722326244 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:38.154 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:38.154 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.960000000000008
[aiter INFO] 2025-09-25 11:51:38.166 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:38.167 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:38.250 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.59516791896064 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:38.302 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 1299, 181, 246, 415}
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999141
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999975
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999141
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.518999999999778
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.638999999999896
[aiter INFO] 2025-09-25 11:51:38.303 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-25 11:51:38.315 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0          1,344.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:38.340 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.288861365306495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:38.680 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:38.680 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-25 11:51:38.692 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            297.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:38.693 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:38.729 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.417910911216595 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 39, 9, 504, 29}
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000001
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000215
[aiter INFO] 2025-09-25 11:51:38.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.199000000000012
[aiter INFO] 2025-09-25 11:51:38.770 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            736.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          768.7              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:38.771 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:38.772 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:39.180 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.33377236186868 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:39.373 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 22, 9}
[aiter INFO] 2025-09-25 11:51:39.373 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5190000000000055
[aiter INFO] 2025-09-25 11:51:39.373 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:51:39.373 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-09-25 11:51:39.373 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.839000000000027
[aiter INFO] 2025-09-25 11:51:39.395 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            743.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,644.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,418.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           24.2             24.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:39.396 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:39.935 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.02576219563437 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:39.983 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 23}
[aiter INFO] 2025-09-25 11:51:39.983 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 58.959
[aiter INFO] 2025-09-25 11:51:39.984 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.718999999999994
[aiter INFO] 2025-09-25 11:51:39.994 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          5,819.2        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:40.130 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.81481186765255 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:40.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:40.165 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.079000000000008
[aiter INFO] 2025-09-25 11:51:40.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            518.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:40.177 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    63.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:40.865 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.66296042546188 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 90, 12}
[aiter INFO] 2025-09-25 11:51:41.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.599000000000046
[aiter INFO] 2025-09-25 11:51:41.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.63900000000001
[aiter INFO] 2025-09-25 11:51:41.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.19900000000004
[aiter INFO] 2025-09-25 11:51:41.090 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          4,698.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             47.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.250 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.432623785026 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.296 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:41.296 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-09-25 11:51:41.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            515.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.309 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=68d6d1ab512029bda01630994dbd8ecc
triton_output_md5=e64945ce2faef4d14b57f7c54c02f635
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008845643140375614

Top differences:
Position (np.int64(2), np.int64(1), np.int64(42)): arr1 = 0.113770, arr2 = 0.104004, Diff = 0.009766
Position (np.int64(70), np.int64(7), np.int64(48)): arr1 = 0.123047, arr2 = 0.113770, Diff = 0.009277
Position (np.int64(54), np.int64(0), np.int64(67)): arr1 = 0.139648, arr2 = 0.130859, Diff = 0.008789
Position (np.int64(65), np.int64(1), np.int64(34)): arr1 = -0.137695, arr2 = -0.128906, Diff = 0.008789
Position (np.int64(31), np.int64(4), np.int64(97)): arr1 = 0.081543, arr2 = 0.072754, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 5307 (4.05%)
[1.0e-06, 1.0e-05): 4 (0.00%)
[1.0e-05, 1.0e-04): 977 (0.75%)
[1.0e-04, 1.0e-03): 44141 (33.68%)
[1.0e-03, 1.0e-02): 80643 (61.53%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=04a0e6bc9d60c4f61be69878ec1b8549
triton_output_md5=0dd1c1597716e79a7ec7254946c4f6c7
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.009765625
max_diff_thr=0.008424599654972553

Top differences:
Position (np.int64(15), np.int64(4), np.int64(121)): arr1 = -0.168945, arr2 = -0.159180, Diff = 0.009766
Position (np.int64(20), np.int64(4), np.int64(14)): arr1 = -0.065430, arr2 = -0.056885, Diff = 0.008545
Position (np.int64(10), np.int64(4), np.int64(120)): arr1 = -0.087402, arr2 = -0.079102, Diff = 0.008301
Position (np.int64(11), np.int64(2), np.int64(31)): arr1 = -0.098145, arr2 = -0.089844, Diff = 0.008301
Position (np.int64(31), np.int64(2), np.int64(85)): arr1 = 0.085449, arr2 = 0.077148, Diff = 0.008301

Threshold statistics:
[0.0e+00, 1.0e-06): 1369 (4.18%)
[1.0e-06, 1.0e-05): 5 (0.02%)
[1.0e-05, 1.0e-04): 269 (0.82%)
[1.0e-04, 1.0e-03): 11077 (33.80%)
[1.0e-03, 1.0e-02): 20048 (61.18%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d63013d3a4b1abe896e41a17dcef026
triton_output_md5=c775f09941b8b916bd9915fbb94767c0
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.007080078125
max_diff_thr=0.006793159991502762

Top differences:
Position (np.int64(122), np.int64(4), np.int64(91)): arr1 = -0.049316, arr2 = -0.042236, Diff = 0.007080
Position (np.int64(77), np.int64(1), np.int64(6)): arr1 = -0.111816, arr2 = -0.104980, Diff = 0.006836
Position (np.int64(78), np.int64(5), np.int64(23)): arr1 = 0.064453, arr2 = 0.057617, Diff = 0.006836
Position (np.int64(122), np.int64(6), np.int64(27)): arr1 = -0.102539, arr2 = -0.095703, Diff = 0.006836
Position (np.int64(93), np.int64(6), np.int64(10)): arr1 = 0.054199, arr2 = 0.047607, Diff = 0.006592

Threshold statistics:
[0.0e+00, 1.0e-06): 5270 (4.02%)
[1.0e-06, 1.0e-05): 27 (0.02%)
[1.0e-05, 1.0e-04): 1689 (1.29%)
[1.0e-04, 1.0e-03): 58880 (44.92%)
[1.0e-03, 1.0e-02): 65206 (49.75%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fc7eb22ff7ff5944f74384f1621c1e65
triton_output_md5=5bac030fecb0a0334abf37be4edfa477
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0060882568359375
max_diff_thr=0.006064843852072954

Top differences:
Position (np.int64(3), np.int64(7), np.int64(51)): arr1 = -0.009949, arr2 = -0.003860, Diff = 0.006088
Position (np.int64(25), np.int64(7), np.int64(37)): arr1 = 0.027832, arr2 = 0.021851, Diff = 0.005981
Position (np.int64(30), np.int64(4), np.int64(127)): arr1 = -0.148438, arr2 = -0.142578, Diff = 0.005859
Position (np.int64(26), np.int64(6), np.int64(103)): arr1 = -0.105469, arr2 = -0.099609, Diff = 0.005859
Position (np.int64(20), np.int64(1), np.int64(69)): arr1 = 0.068848, arr2 = 0.062988, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1359 (4.15%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 433 (1.32%)
[1.0e-04, 1.0e-03): 14923 (45.54%)
[1.0e-03, 1.0e-02): 16050 (48.98%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d39d0ed33e06a80e04832cb1d40ff17
triton_output_md5=ae772a6e1d67f5fe7ac5076d6893e837
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00732421875
max_diff_thr=0.006868131924420595

Top differences:
Position (np.int64(3), np.int64(4), np.int64(37)): arr1 = -0.073730, arr2 = -0.066406, Diff = 0.007324
Position (np.int64(14), np.int64(3), np.int64(106)): arr1 = -0.021851, arr2 = -0.014893, Diff = 0.006958
Position (np.int64(14), np.int64(7), np.int64(89)): arr1 = 0.105469, arr2 = 0.098633, Diff = 0.006836
Position (np.int64(3), np.int64(1), np.int64(37)): arr1 = -0.092773, arr2 = -0.085938, Diff = 0.006836
Position (np.int64(46), np.int64(4), np.int64(63)): arr1 = -0.034912, arr2 = -0.028198, Diff = 0.006714

Threshold statistics:
[0.0e+00, 1.0e-06): 5342 (4.08%)
[1.0e-06, 1.0e-05): 14 (0.01%)
[1.0e-05, 1.0e-04): 1802 (1.37%)
[1.0e-04, 1.0e-03): 59400 (45.32%)
[1.0e-03, 1.0e-02): 64514 (49.22%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1992eb5d762563f39eaafb2adf358114[aiter INFO] 2025-09-25 11:51:41.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 35.102277238032606 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.382 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:41.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999984
[aiter INFO] 2025-09-25 11:51:41.398 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,395.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,395.4              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           14.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.399 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:41.399 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:41.458 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.26129709730054 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {515, 516, 966, 967, 9, 10, 493, 494, 339, 372, 340, 373}
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000487
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.518999999998414
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239999999999782
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000002
[aiter INFO] 2025-09-25 11:51:41.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.279000000000451
[aiter INFO] 2025-09-25 11:51:41.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999469
[aiter INFO] 2025-09-25 11:51:41.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.43899999999985
[aiter INFO] 2025-09-25 11:51:41.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.319000000000415
[aiter INFO] 2025-09-25 11:51:41.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999996
[aiter INFO] 2025-09-25 11:51:41.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.31899999999996
[aiter INFO] 2025-09-25 11:51:41.539 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            406.9        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            845.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,320.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.2             13.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.540 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:41.586 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.62328700854046 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.636 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:41.636 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.239000000000004
[aiter INFO] 2025-09-25 11:51:41.646 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,666.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.671 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.47104945365746 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:41.979 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:41.979 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:51:41.991 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:41.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:42.076 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.02485142426916 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:42.130 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:51:42.130 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999869
[aiter INFO] 2025-09-25 11:51:42.130 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-25 11:51:42.142 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,427.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:42.167 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.99105941098515 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:42.508 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:42.508 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.15900000000002
[aiter INFO] 2025-09-25 11:51:42.520 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            367.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:42.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:42.557 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.524059410880106 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 44, 109, 14, 24}
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000007
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.279999999999973
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000037
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.319000000000017
[aiter INFO] 2025-09-25 11:51:42.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000021
[aiter INFO] 2025-09-25 11:51:42.598 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            939.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          981.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.8              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:42.599 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:42.600 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:43.039 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.15713841903329 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:43.147 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:43.147 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.319000000000017
[aiter INFO] 2025-09-25 11:51:43.147 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-25 11:51:43.169 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            754.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,652.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,406.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           24.1             24.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:43.170 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    24.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:43.221 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.6273169871604 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:43.269 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 23}
[aiter INFO] 2025-09-25 11:51:43.270 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.59899999999999
[aiter INFO] 2025-09-25 11:51:43.270 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.198999999999955
[aiter INFO] 2025-09-25 11:51:43.280 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          5,839.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             59.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:43.305 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.164108806907535 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:43.836 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:43.837 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999975
[aiter INFO] 2025-09-25 11:51:43.849 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            519.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:43.850 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:44.058 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.73229715139558 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:44.297 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1000, 155, 12}
[aiter INFO] 2025-09-25 11:51:44.297 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.59900000000016
[aiter INFO] 2025-09-25 11:51:44.297 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.72000000000003
[aiter INFO] 2025-09-25 11:51:44.297 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.999000000000024
[aiter INFO] 2025-09-25 11:51:44.309 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          4,736.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:44.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.85916827427278 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:44.667 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:44.667 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:51:44.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            551.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:44.680 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    53.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:45.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 36.41554438462942 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:45.086 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:45.086 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-09-25 11:51:45.101 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          1,413.2        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,413.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           14.1             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:45.103 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    14.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:45.103 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:45.163 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.32468298343149 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:45.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:45.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.959000000000003
[aiter INFO] 2025-09-25 11:51:45.227 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:51:45.246 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            428.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            901.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,329.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:45.247 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:45.293 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 98.26760392377872 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:45.344 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {407, 11, 335}
[aiter INFO] 2025-09-25 11:51:45.344 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.358999999999924
[aiter INFO] 2025-09-25 11:51:45.344 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.879999999999995
[aiter INFO] 2025-09-25 11:51:45.344 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.358999999999924
[aiter INFO] 2025-09-25 11:51:45.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,639.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:45.379 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.34153479190156 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:45.853 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:45.853 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5589999999999975
[aiter INFO] 2025-09-25 11:51:45.865 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            336.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:45.866 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:45.949 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.61298030024709 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:46.002 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 90, 12}
[aiter INFO] 2025-09-25 11:51:46.002 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000142
[aiter INFO] 2025-09-25 11:51:46.002 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-09-25 11:51:46.002 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999995
[aiter INFO] 2025-09-25 11:51:46.014 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,411.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:46.039 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.54471272112119 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:46.352 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:46.352 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-25 11:51:46.365 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            367.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:46.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:46.402 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.256326799050417 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:46.427 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:46.427 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000007
[aiter INFO] 2025-09-25 11:51:46.442 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0            975.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          975.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.8              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:46.443 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:46.443 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:46.891 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.57617806503089 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:47.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:47.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.718999999999994
[aiter INFO] 2025-09-25 11:51:47.065 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.319000000000017
[aiter INFO] 2025-09-25 11:51:47.087 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            755.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,912.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,667.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           26.7             26.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:47.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    26.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:47.652 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.61427710433998 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:47.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 71, 107, 11, 47, 23, 59}
[aiter INFO] 2025-09-25 11:51:47.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.51999999999998
[aiter INFO] 2025-09-25 11:51:47.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.678999999999974
[aiter INFO] 2025-09-25 11:51:47.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.999000000000024
[aiter INFO] 2025-09-25 11:51:47.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.63900000000001
[aiter INFO] 2025-09-25 11:51:47.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.91899999999998
[aiter INFO] 2025-09-25 11:51:47.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.07900000000001
[aiter INFO] 2025-09-25 11:51:47.703 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.599000000000046
[aiter INFO] 2025-09-25 11:51:47.713 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 94.0            0.0          5,716.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             60.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:47.739 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.0821386584551 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:47.774 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:47.774 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:51:47.786 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            514.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:47.787 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    65.95 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:48.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.7492869832728 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:48.735 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 12}
[aiter INFO] 2025-09-25 11:51:48.735 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.319000000000074
[aiter INFO] 2025-09-25 11:51:48.735 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.998999999999995
[aiter INFO] 2025-09-25 11:51:48.747 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,859.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             49.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:48.773 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.70195054653848 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:48.818 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:48.819 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.15900000000002
[aiter INFO] 2025-09-25 11:51:48.831 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            516.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:48.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    54.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:48.906 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 37.744277516509044 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:48.935 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 389}
[aiter INFO] 2025-09-25 11:51:48.935 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.998999999999995
[aiter INFO] 2025-09-25 11:51:48.935 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.15899999999965
[aiter INFO] 2025-09-25 11:51:48.951 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,526.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,544.9              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           15.4             15.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:48.952 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    15.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:48.952 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:49.012 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.35992076255307 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:49.076 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:49.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.559000000000026
[aiter INFO] 2025-09-25 11:51:49.077 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-25 11:51:49.096 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            432.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            919.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,352.1              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.5             13.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:49.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:49.142 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 97.98723761693086 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:49.198 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:49.198 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.07899999999998
[aiter INFO] 2025-09-25 11:51:49.209 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,716.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:49.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.01401992009418 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:49.682 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:49.682 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:51:49.694 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            334.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:49.696 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:49.778 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.71198011329858 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:49.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 181, 38, 207}
[aiter INFO] 2025-09-25 11:51:49.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000009
[aiter INFO] 2025-09-25 11:51:49.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.440000000000055
[aiter INFO] 2025-09-25 11:51:49.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999976
[aiter INFO] 2025-09-25 11:51:49.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.31899999999996
[aiter INFO] 2025-09-25 11:51:49.844 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0          1,408.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:49.869 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.89916826533799 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:50.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:50.164 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.239000000000004
[aiter INFO] 2025-09-25 11:51:50.176 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            368.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:50.178 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.20 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:50.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.516128712508937 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 4, 14, 24, 29}
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.559000000000026
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.079000000000008
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.63900000000001
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.718999999999994
[aiter INFO] 2025-09-25 11:51:50.238 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.63900000000001
[aiter INFO] 2025-09-25 11:51:50.253 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0            947.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0          990.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN            9.9              9.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:50.255 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:50.255 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:50.743 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.75872278331529 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:50.859 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:51:50.859 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.878999999999962
[aiter INFO] 2025-09-25 11:51:50.859 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:51:50.878 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            750.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,084.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,835.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           28.4             28.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:50.878 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    28.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

triton_output_md5=a313d47046a98b2b8e2def8fe892dacd
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.005933363921940327

Top differences:
Position (np.int64(25), np.int64(2), np.int64(15)): arr1 = -0.076172, arr2 = -0.069824, Diff = 0.006348
Position (np.int64(5), np.int64(3), np.int64(73)): arr1 = 0.052734, arr2 = 0.046875, Diff = 0.005859
Position (np.int64(24), np.int64(6), np.int64(84)): arr1 = 0.101074, arr2 = 0.095215, Diff = 0.005859
Position (np.int64(6), np.int64(5), np.int64(106)): arr1 = 0.056885, arr2 = 0.051025, Diff = 0.005859
Position (np.int64(26), np.int64(1), np.int64(115)): arr1 = -0.062256, arr2 = -0.056396, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1317 (4.02%)
[1.0e-06, 1.0e-05): 7 (0.02%)
[1.0e-05, 1.0e-04): 446 (1.36%)
[1.0e-04, 1.0e-03): 14651 (44.71%)
[1.0e-03, 1.0e-02): 16347 (49.89%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e9bcd0942b8b8d3bcf1207c3deb28e99
triton_output_md5=e3a4a69f48c8e46a40f61bc40d52d5ee
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.00657894741743803

Top differences:
Position (np.int64(115), np.int64(7), np.int64(118)): arr1 = 0.045898, arr2 = 0.039062, Diff = 0.006836
Position (np.int64(124), np.int64(4), np.int64(18)): arr1 = 0.095215, arr2 = 0.088867, Diff = 0.006348
Position (np.int64(54), np.int64(4), np.int64(74)): arr1 = -0.023804, arr2 = -0.017578, Diff = 0.006226
Position (np.int64(106), np.int64(6), np.int64(60)): arr1 = -0.070801, arr2 = -0.064941, Diff = 0.005859
Position (np.int64(69), np.int64(5), np.int64(99)): arr1 = 0.032959, arr2 = 0.027100, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 5332 (4.07%)
[1.0e-06, 1.0e-05): 29 (0.02%)
[1.0e-05, 1.0e-04): 1955 (1.49%)
[1.0e-04, 1.0e-03): 61792 (47.14%)
[1.0e-03, 1.0e-02): 61964 (47.27%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1256430a4670dc34953cffd3db70f7bb
triton_output_md5=456808893d438242fd4a55222af7a0e5
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006103515625
max_diff_thr=0.0058343056589365005

Top differences:
Position (np.int64(20), np.int64(3), np.int64(4)): arr1 = 0.052246, arr2 = 0.046143, Diff = 0.006104
Position (np.int64(3), np.int64(5), np.int64(111)): arr1 = 0.052246, arr2 = 0.046143, Diff = 0.006104
Position (np.int64(3), np.int64(0), np.int64(54)): arr1 = 0.061768, arr2 = 0.055908, Diff = 0.005859
Position (np.int64(26), np.int64(7), np.int64(5)): arr1 = 0.080566, arr2 = 0.074707, Diff = 0.005859
Position (np.int64(25), np.int64(4), np.int64(11)): arr1 = 0.057373, arr2 = 0.051514, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1323 (4.04%)
[1.0e-06, 1.0e-05): 8 (0.02%)
[1.0e-05, 1.0e-04): 471 (1.44%)
[1.0e-04, 1.0e-03): 15485 (47.26%)
[1.0e-03, 1.0e-02): 15481 (47.24%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e742280fb7f66c658c29a0810213adae
triton_output_md5=f91072449f0738b52cb17b566980442d
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00537109375
max_diff_thr=0.005115089472383261

Top differences:
Position (np.int64(112), np.int64(6), np.int64(6)): arr1 = 0.055420, arr2 = 0.050049, Diff = 0.005371
Position (np.int64(9), np.int64(3), np.int64(78)): arr1 = -0.035156, arr2 = -0.030029, Diff = 0.005127
Position (np.int64(98), np.int64(0), np.int64(39)): arr1 = 0.075195, arr2 = 0.070312, Diff = 0.004883
Position (np.int64(91), np.int64(2), np.int64(22)): arr1 = 0.050781, arr2 = 0.045898, Diff = 0.004883
Position (np.int64(102), np.int64(6), np.int64(65)): arr1 = 0.071289, arr2 = 0.066406, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 5447 (4.16%)
[1.0e-06, 1.0e-05): 52 (0.04%)
[1.0e-05, 1.0e-04): 3357 (2.56%)
[1.0e-04, 1.0e-03): 77475 (59.11%)
[1.0e-03, 1.0e-02): 44741 (34.13%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=32026dd8e48597d8731c8f2bbba6a50e
triton_output_md5=7e00c8755362b6733781c11f23096571
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004873520694673061

Top differences:
Position (np.int64(7), np.int64(2), np.int64(75)): arr1 = -0.057129, arr2 = -0.052002, Diff = 0.005127
Position (np.int64(26), np.int64(3), np.int64(37)): arr1 = -0.110352, arr2 = -0.105469, Diff = 0.004883
Position (np.int64(6), np.int64(1), np.int64(63)): arr1 = -0.055176, arr2 = -0.050781, Diff = 0.004395
Position (np.int64(23), np.int64(5), np.int64(119)): arr1 = -0.060547, arr2 = -0.056152, Diff = 0.004395
Position (np.int64(24), np.int64(2), np.int64(73)): arr1 = 0.062988, arr2 = 0.058838, Diff = 0.004150

Threshold statistics:
[0.0e+00, 1.0e-06): 1345 (4.10%)
[1.0e-06, 1.0e-05): 12 (0.04%)
[1.0e-05, 1.0e-04): 817 (2.49%)
[1.0e-04, 1.0e-03): 19492 (59.48%)
[1.0e-03, 1.0e-02): 11102 (33.88%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=c7f31e53ed49dd552f3a2d4c28b8fcd1
triton_output_md5=77cd629e83e184a5f0e43e011dfc20a0
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])[aiter INFO] 2025-09-25 11:51:50.931 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 156.1022182502369 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 1187, 71, 107, 11, 47, 83, 1043, 1079, 23, 59, 1055}
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.95899999999995
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.92000000000007
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.0
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.95899999999995
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.75900000000001
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.399
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.99900000000002
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.72000000000025
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.39899999999943
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.48000000000002
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.279
[aiter INFO] 2025-09-25 11:51:50.980 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.3189999999995
[aiter INFO] 2025-09-25 11:51:50.991 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 89.0            0.0          6,674.4        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             75.0         NaN          NaN
[aiter INFO] 2025-09-25 11:51:51.165 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.06274236694421 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:51.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:51.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-09-25 11:51:51.750 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            636.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:51.751 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    81.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:51.913 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 145.6855839431876 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:51.965 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {129, 12}
[aiter INFO] 2025-09-25 11:51:51.965 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.638999999999896
[aiter INFO] 2025-09-25 11:51:51.965 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.839
[aiter INFO] 2025-09-25 11:51:51.977 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          6,018.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             60.8         NaN          NaN
[aiter INFO] 2025-09-25 11:51:52.140 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.738356591451286 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:52.378 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:52.379 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.318999999999988
[aiter INFO] 2025-09-25 11:51:52.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            661.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:52.392 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    67.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:52.758 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 40.476534773807714 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:52.790 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {394, 4}
[aiter INFO] 2025-09-25 11:51:52.790 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.43899999999985
[aiter INFO] 2025-09-25 11:51:52.790 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.63899999999998
[aiter INFO] 2025-09-25 11:51:52.806 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          1,817.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,838.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           18.4             18.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:52.807 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    18.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:52.807 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:52.867 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.31122775125031 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:52.934 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:51:52.934 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.118999999999971
[aiter INFO] 2025-09-25 11:51:52.934 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.958999999999946
[aiter INFO] 2025-09-25 11:51:52.953 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            427.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,123.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,550.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-25 11:51:52.953 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:53.000 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.72391057663624 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:53.053 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:53.053 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.278999999999996
[aiter INFO] 2025-09-25 11:51:53.063 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,988.6        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:53.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.534029541334306 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:53.563 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:51:53.563 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-09-25 11:51:53.575 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            392.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:53.576 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    33.81 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:53.660 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.9536236276721 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:53.712 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {129, 12}
[aiter INFO] 2025-09-25 11:51:53.712 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.95900000000006
[aiter INFO] 2025-09-25 11:51:53.712 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.278999999999996
[aiter INFO] 2025-09-25 11:51:53.724 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,500.7        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:53.750 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.5296731319758 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:54.062 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 503}
[aiter INFO] 2025-09-25 11:51:54.062 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.959000000000003
[aiter INFO] 2025-09-25 11:51:54.062 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.719000000000051
[aiter INFO] 2025-09-25 11:51:54.074 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            421.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:54.075 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:54.112 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 31.063049515285115 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:54.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 9, 4, 29}
[aiter INFO] 2025-09-25 11:51:54.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.67900000000003
[aiter INFO] 2025-09-25 11:51:54.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000005
[aiter INFO] 2025-09-25 11:51:54.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.87899999999999
[aiter INFO] 2025-09-25 11:51:54.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000037
[aiter INFO] 2025-09-25 11:51:54.152 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          1,135.5        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        1,173.1              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           11.7             11.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:54.153 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:54.153 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:54.600 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.34505023460576 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 449, 105, 457, 9, 108, 17, 116, 119, 127}
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.79999999999995
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.75900000000001
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000115
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999542
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.59899999999999
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.31899999999996
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.43900000000008
[aiter INFO] 2025-09-25 11:51:54.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-09-25 11:51:54.753 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            933.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          8,889.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,186.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN          101.9            102.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:54.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   102.32 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:54.841 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 486.2330974918781 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:55.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:51:55.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 409.67999999999995
[aiter INFO] 2025-09-25 11:51:55.099 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0         40,872.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0            408.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:55.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.13044553050901 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {482, 6, 139, 118, 377, 125}
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000196
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.800000000000011
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000196
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.678999999999974
[aiter INFO] 2025-09-25 11:51:55.433 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.639000000000124
[aiter INFO] 2025-09-25 11:51:55.434 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.679000000000087
[aiter INFO] 2025-09-25 11:51:55.446 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 95.0            0.0          1,162.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:55.447 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   420.95 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:55.654 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 405.6819898657279 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:55.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {49, 1275, 12}
[aiter INFO] 2025-09-25 11:51:55.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 324.76
[aiter INFO] 2025-09-25 11:51:55.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 324.7999999999993
[aiter INFO] 2025-09-25 11:51:55.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 327.28
[aiter INFO] 2025-09-25 11:51:55.750 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         32,064.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0            327.2         NaN          NaN
[aiter INFO] 2025-09-25 11:51:56.049 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.68534651575702 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:56.250 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {524, 622, 6}
[aiter INFO] 2025-09-25 11:51:56.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.518999999999778
[aiter INFO] 2025-09-25 11:51:56.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.558999999999287
[aiter INFO] 2025-09-25 11:51:56.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999982
[aiter INFO] 2025-09-25 11:51:56.263 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0          1,200.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:56.264 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   339.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:56.600 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 91.12185166023745 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:56.633 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:51:56.633 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.71900000000002
[aiter INFO] 2025-09-25 11:51:56.648 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          7,134.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        7,134.8              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           71.3             71.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:56.649 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    71.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:56.650 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:56.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.46253468081503 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:56.781 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 13}
[aiter INFO] 2025-09-25 11:51:56.781 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.759000000000015
[aiter INFO] 2025-09-25 11:51:56.781 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:51:56.800 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            486.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,777.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,263.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           32.6             32.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:56.801 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:56.856 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 188.8670791493784 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:56.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 61, 47}
[aiter INFO] 2025-09-25 11:51:56.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.07900000000004
[aiter INFO] 2025-09-25 11:51:56.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.12
[aiter INFO] 2025-09-25 11:51:56.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.35899999999992
[aiter INFO] 2025-09-25 11:51:56.911 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.71900000000005
[aiter INFO] 2025-09-25 11:51:56.922 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0         10,024.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:56.947 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.12688124120826 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:57.424 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {594, 6}
[aiter INFO] 2025-09-25 11:51:57.425 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.880000000000109
[aiter INFO] 2025-09-25 11:51:57.425 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-09-25 11:51:57.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            650.0        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.6         NaN          NaN
[aiter INFO] 2025-09-25 11:51:57.438 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   109.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:57.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.08208952091707 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:57.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 298, 441, 12, 77, 51, 25}
[aiter INFO] 2025-09-25 11:51:57.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.59900000000005
[aiter INFO] 2025-09-25 11:51:57.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.28000000000003
[aiter INFO] 2025-09-25 11:51:57.582 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.75900000000001
[aiter INFO] 2025-09-25 11:51:57.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.35899999999992
[aiter INFO] 2025-09-25 11:51:57.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.99899999999997
[aiter INFO] 2025-09-25 11:51:57.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.67899999999997
[aiter INFO] 2025-09-25 11:51:57.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.07900000000006
[aiter INFO] 2025-09-25 11:51:57.583 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.99900000000002
[aiter INFO] 2025-09-25 11:51:57.593 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 93.0            0.0          7,747.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.3         NaN          NaN
[aiter INFO] 2025-09-25 11:51:57.618 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.10156420935498 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:57.900 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6}
[aiter INFO] 2025-09-25 11:51:57.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-25 11:51:57.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-09-25 11:51:57.913 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            684.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-09-25 11:51:57.914 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    90.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:57.952 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.65999031096402 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:57.977 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 212, 4}
[aiter INFO] 2025-09-25 11:51:57.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.278999999999996
[aiter INFO] 2025-09-25 11:51:57.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.67900000000009
[aiter INFO] 2025-09-25 11:51:57.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.998999999999995
[aiter INFO] 2025-09-25 11:51:57.991 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  98.0            0.0          3,732.6        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,808.5              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           38.1             38.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:57.992 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    38.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:57.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:51:58.430 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.87456411654406 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1026, 1028, 9, 1038, 1039, 17, 1049, 1050, 1060, 427, 944, 435, 952, 1096, 592, 1106, 1107, 1109, 1110, 1111, 600, 1016, 999, 240, 1015, 248}
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.718999999999141
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.67900000000009
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.72000000000003
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000087
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.67900000000009
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999942
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.95999999999913
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000087
[aiter INFO] 2025-09-25 11:51:58.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.84000000000015
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.47899999999936
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999905
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.39899999999943
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.07899999999972
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.27900000000045
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999287
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.92000000000007
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999905
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.39999999999964
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.47899999999936
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.67900000000009
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.71900000000096
[aiter INFO] 2025-09-25 11:51:58.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000087
[aiter INFO] 2025-09-25 11:51:58.600 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  88.0            0.0            726.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  88.0            0.0          7,962.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,940.1              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           99.4             98.7         NaN          NaN
[aiter INFO] 2025-09-25 11:51:58.601 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    98.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:58.685 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 458.17484212393805 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:58.932 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {56, 11, 1187}
[aiter INFO] 2025-09-25 11:51:58.932 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 379.0
[aiter INFO] 2025-09-25 11:51:58.933 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 382.44000000000005
[aiter INFO] 2025-09-25 11:51:58.933 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 379.76000000000204
[aiter INFO] 2025-09-25 11:51:58.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         37,381.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            381.4         NaN          NaN
[aiter INFO] 2025-09-25 11:51:59.142 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.930851486354776 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:59.253 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {237, 6}
[aiter INFO] 2025-09-25 11:51:59.254 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-09-25 11:51:59.254 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-09-25 11:51:59.266 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,000.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             10.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:59.267 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   391.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:51:59.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 385.3096826241748 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:51:59.548 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:51:59.548 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 308.28000000000003
[aiter INFO] 2025-09-25 11:51:59.560 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         30,613.8        CUDA            8
[avg us/iter]               NaN   NaN            0.0            306.1         NaN          NaN
[aiter INFO] 2025-09-25 11:51:59.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.59265325653671 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:00.036 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:00.036 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.960000000000036
[aiter INFO] 2025-09-25 11:52:00.049 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,012.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:00.050 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   316.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:00.439 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 88.87789110736091 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:00.469 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 494}
[aiter INFO] 2025-09-25 11:52:00.469 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.119
[aiter INFO] 2025-09-25 11:52:00.470 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.79899999999998
[aiter INFO] 2025-09-25 11:52:00.485 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          6,748.4        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        6,821.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           68.2             68.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:00.486 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    68.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:00.487 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:00.550 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.3753762439926 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:00.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:52:00.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.879999999999995
[aiter INFO] 2025-09-25 11:52:00.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000003
[aiter INFO] 2025-09-25 11:52:00.633 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            419.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,763.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,182.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           31.8             31.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:00.634 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    31.83 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004914579913020134

Top differences:
Position (np.int64(104), np.int64(2), np.int64(104)): arr1 = 0.048340, arr2 = 0.043213, Diff = 0.005127
Position (np.int64(10), np.int64(2), np.int64(25)): arr1 = 0.034180, arr2 = 0.029175, Diff = 0.005005
Position (np.int64(110), np.int64(0), np.int64(123)): arr1 = -0.084473, arr2 = -0.079590, Diff = 0.004883
Position (np.int64(38), np.int64(2), np.int64(100)): arr1 = 0.054443, arr2 = 0.049561, Diff = 0.004883
Position (np.int64(0), np.int64(0), np.int64(66)): arr1 = -0.068359, arr2 = -0.063477, Diff = 0.004883

Threshold statistics:
[0.0e+00, 1.0e-06): 5294 (4.04%)
[1.0e-06, 1.0e-05): 39 (0.03%)
[1.0e-05, 1.0e-04): 3415 (2.61%)
[1.0e-04, 1.0e-03): 77315 (58.99%)
[1.0e-03, 1.0e-02): 45009 (34.34%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=6fe74acaefa53ee6657bd0996ff605a2
triton_output_md5=908b0bdd3dbe8dedb14ed66ff918fd5c
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0048828125
max_diff_thr=0.0045744553208351135

Top differences:
Position (np.int64(26), np.int64(4), np.int64(30)): arr1 = -0.101562, arr2 = -0.096680, Diff = 0.004883
Position (np.int64(0), np.int64(7), np.int64(61)): arr1 = -0.018677, arr2 = -0.014038, Diff = 0.004639
Position (np.int64(15), np.int64(6), np.int64(0)): arr1 = -0.021606, arr2 = -0.017090, Diff = 0.004517
Position (np.int64(31), np.int64(2), np.int64(120)): arr1 = -0.016602, arr2 = -0.012268, Diff = 0.004333
Position (np.int64(31), np.int64(2), np.int64(11)): arr1 = -0.013550, arr2 = -0.009338, Diff = 0.004211

Threshold statistics:
[0.0e+00, 1.0e-06): 1304 (3.98%)
[1.0e-06, 1.0e-05): 13 (0.04%)
[1.0e-05, 1.0e-04): 865 (2.64%)
[1.0e-04, 1.0e-03): 19231 (58.69%)
[1.0e-03, 1.0e-02): 11355 (34.65%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2233fac0952bdebd301b32e38d7161ac
triton_output_md5=15093fa50585bba6230605226f33b1c6
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001953125
max_diff_thr=0.0019009148236364126

Top differences:
Position (np.int64(99), np.int64(4), np.int64(10)): arr1 = 0.029419, arr2 = 0.027466, Diff = 0.001953
Position (np.int64(118), np.int64(7), np.int64(125)): arr1 = -0.029297, arr2 = -0.027466, Diff = 0.001831
Position (np.int64(19), np.int64(3), np.int64(27)): arr1 = 0.023804, arr2 = 0.022095, Diff = 0.001709
Position (np.int64(105), np.int64(4), np.int64(79)): arr1 = -0.014160, arr2 = -0.012512, Diff = 0.001648
Position (np.int64(25), np.int64(2), np.int64(73)): arr1 = -0.015991, arr2 = -0.014343, Diff = 0.001648

Threshold statistics:
[0.0e+00, 1.0e-06): 5450 (4.16%)
[1.0e-06, 1.0e-05): 353 (0.27%)
[1.0e-05, 1.0e-04): 19913 (15.19%)
[1.0e-04, 1.0e-03): 104215 (79.51%)
[1.0e-03, 1.0e-02): 1141 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7a92576709c250a9df69d4c15812dfa3
triton_output_md5=c21f24f480538625dcbdbe63277bfed9
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017757783643901348

Top differences:
Position (np.int64(29), np.int64(5), np.int64(98)): arr1 = 0.032959, arr2 = 0.031128, Diff = 0.001831
Position (np.int64(11), np.int64(5), np.int64(83)): arr1 = 0.027832, arr2 = 0.026245, Diff = 0.001587
Position (np.int64(11), np.int64(7), np.int64(125)): arr1 = -0.026733, arr2 = -0.025146, Diff = 0.001587
Position (np.int64(22), np.int64(3), np.int64(61)): arr1 = 0.010132, arr2 = 0.008545, Diff = 0.001587
Position (np.int64(3), np.int64(5), np.int64(81)): arr1 = 0.009583, arr2 = 0.008118, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1302 (3.97%)
[1.0e-06, 1.0e-05): 75 (0.23%)
[1.0e-05, 1.0e-04): 5022 (15.33%)
[1.0e-04, 1.0e-03): 26084 (79.60%)
[1.0e-03, 1.0e-02): 285 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=920c1b3a398c3dc7e454e80f35c5c995
triton_output_md5=f1d30fc35d4d54757210ff399380599b
query.shape=torch.Size([128, 8, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 8, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017929715104401112

Top differences:
Position (np.int64(18), np.int64(4), np.int64(9)): arr1 = -0.023071, arr2 = -0.021240, Diff = 0.001831
Position (np.int64(93), np.int64(5), np.int64(120)): arr1 = 0.023804, arr2 = 0.021973, Diff = 0.001831
Position (np.int64(18), np.int64(5), np.int64(9)): arr1 = -0.028320, arr2 = -0.026611, Diff = 0.001709
Position (np.int64(40), np.int64(2), np.int64(62)): arr1 = 0.020630, arr2 = 0.018921, Diff = 0.001709
Position (np.int64(12), np.int64(0), np.int64(40)): arr1 = 0.008118, arr2 = 0.006439, Diff = 0.001678

Threshold statistics:
[0.0e+00, 1.0e-06): 5494 (4.19%)
[1.0e-06, 1.0e-05): 364 (0.28%)
[1.0e-05, 1.0e-04): 19951 (15.22%)
[1.0e-04, 1.0e-03): 104129 (79.44%)
[1.0e-03, 1.0e-02): 1134 (0.87%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=74b1af36ddc4c9724b2d0bf337789006
triton_output_md5=4d59f3a13fdbf377fcfac4a0de506479
query.shape=torch.Size([32, 8, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 8, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16[aiter INFO] 2025-09-25 11:52:00.689 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 187.2864852447321 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:00.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 914, 35, 23}
[aiter INFO] 2025-09-25 11:52:00.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.23899999999998
[aiter INFO] 2025-09-25 11:52:00.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.03899999999976
[aiter INFO] 2025-09-25 11:52:00.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.47900000000004
[aiter INFO] 2025-09-25 11:52:00.744 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.32
[aiter INFO] 2025-09-25 11:52:00.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          9,988.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:00.779 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.566098942615014 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:01.211 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {650, 6}
[aiter INFO] 2025-09-25 11:52:01.211 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5590000000001965
[aiter INFO] 2025-09-25 11:52:01.211 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.199000000000012
[aiter INFO] 2025-09-25 11:52:01.223 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            518.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:01.225 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   108.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:01.315 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.91098033319605 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:01.369 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:52:01.369 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.43899999999996
[aiter INFO] 2025-09-25 11:52:01.369 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.55900000000003
[aiter INFO] 2025-09-25 11:52:01.369 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.63899999999998
[aiter INFO] 2025-09-25 11:52:01.369 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.07900000000006
[aiter INFO] 2025-09-25 11:52:01.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.04000000000002
[aiter INFO] 2025-09-25 11:52:01.380 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,962.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             82.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:01.405 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.60253472021311 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:01.740 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {573, 6}
[aiter INFO] 2025-09-25 11:52:01.740 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.959000000000287
[aiter INFO] 2025-09-25 11:52:01.740 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.158999999999992
[aiter INFO] 2025-09-25 11:52:01.752 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            553.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:01.753 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    88.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:01.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.45916817713492 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:01.821 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {17, 4}
[aiter INFO] 2025-09-25 11:52:01.821 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.478999999999985
[aiter INFO] 2025-09-25 11:52:01.821 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.96000000000001
[aiter INFO] 2025-09-25 11:52:01.836 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          3,583.8        CUDA            8
1                               aiter::wrapper_pa_fwd_asm 100.0        3,621.2              0.0         CPU        56149
[avg us/iter]                                         NaN   NaN           36.2             36.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:01.837 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    36.20 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:01.838 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:02.270 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.30846506121135 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:02.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:02.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-09-25 11:52:02.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.359000000000037
[aiter INFO] 2025-09-25 11:52:02.473 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            893.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,044.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,938.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           19.4             19.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:02.474 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.38 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:03.183 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.330999786901 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:03.237 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:03.237 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.31899999999999
[aiter INFO] 2025-09-25 11:52:03.248 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          2,961.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             29.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:03.370 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.6318613857326 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:03.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:03.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5989999999999895
[aiter INFO] 2025-09-25 11:52:03.419 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            446.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:03.420 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:04.118 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.72863346810388 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:04.172 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:04.172 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.038999999999987
[aiter INFO] 2025-09-25 11:52:04.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,534.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:04.309 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.9478713070402 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:04.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:04.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.479000000000013
[aiter INFO] 2025-09-25 11:52:04.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            446.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:04.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_2tg_4w.co GetFunction: _ZN5aiter32pa_bf16_pertokenFp8_gqa16_2tg_4wE Success
[aiter INFO] 2025-09-25 11:52:04.413 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.460693140873815 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:04.441 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:04.441 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.478999999999985
[aiter INFO] 2025-09-25 11:52:04.456 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            891.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          891.7              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            8.9              8.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:04.457 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     8.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:04.457 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 7,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:04.516 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.17813872877915 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:04.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:04.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.999000000000024
[aiter INFO] 2025-09-25 11:52:04.578 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.6790000000000305
[aiter INFO] 2025-09-25 11:52:04.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            431.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            843.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,275.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           12.8             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:04.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:04.643 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.07789162598034 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:04.694 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:04.694 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.599000000000018
[aiter INFO] 2025-09-25 11:52:04.705 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,574.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             15.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:04.730 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.50868318458595 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:05.161 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 6}
[aiter INFO] 2025-09-25 11:52:05.162 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6789999999999736
[aiter INFO] 2025-09-25 11:52:05.162 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:52:05.174 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            295.8        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:05.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    18.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:05.257 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.66207911413495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:05.307 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:52:05.307 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000597
[aiter INFO] 2025-09-25 11:52:05.307 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-09-25 11:52:05.319 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,374.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:05.344 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.50627727821322 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:05.683 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:05.683 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.8789999999999907
[aiter INFO] 2025-09-25 11:52:05.695 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            330.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:05.696 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.19 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:05.732 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 28.650762513279915 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:05.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:05.756 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.478999999999985
[aiter INFO] 2025-09-25 11:52:05.771 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            724.1        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          724.1              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.2              7.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:05.772 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:05.772 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:06.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.59080220035987 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:06.509 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:06.509 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.59899999999999
[aiter INFO] 2025-09-25 11:52:06.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-09-25 11:52:06.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            895.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,073.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,968.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           19.7             19.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:06.529 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:07.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.72861352002266 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:07.116 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:07.116 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.878999999999962
[aiter INFO] 2025-09-25 11:52:07.127 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,054.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:07.152 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.819178352556605 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:07.188 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {216, 587, 6}
[aiter INFO] 2025-09-25 11:52:07.188 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.31899999999996
[aiter INFO] 2025-09-25 11:52:07.188 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:52:07.188 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-25 11:52:07.200 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            471.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:07.201 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:07.890 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.79121782874117 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:07.944 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:07.944 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.278999999999996
[aiter INFO] 2025-09-25 11:52:07.956 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,588.1        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:07.982 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.7415449256354 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:08.026 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {384, 6}
[aiter INFO] 2025-09-25 11:52:08.026 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.118999999999687
[aiter INFO] 2025-09-25 11:52:08.026 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.318999999999988
[aiter INFO] 2025-09-25 11:52:08.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            476.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:08.039 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:08.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.00562388663835 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:08.199 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:08.199 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-09-25 11:52:08.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            936.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          936.7              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:08.215 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:08.215 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 26,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:08.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.08623766958124 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 813, 790, 791}
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.879000000000019
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.599000000000046
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000342
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000233
[aiter INFO] 2025-09-25 11:52:08.335 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:08.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            419.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            865.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,317.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.2             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:08.355 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:08.401 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.1658221672077 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:08.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 395}
[aiter INFO] 2025-09-25 11:52:08.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.799000000000007
[aiter INFO] 2025-09-25 11:52:08.452 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.878999999999905
[aiter INFO] 2025-09-25 11:52:08.463 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,623.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:08.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.46907903327801 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:08.961 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:08.961 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:52:08.973 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            330.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:08.975 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:09.056 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.40544559695932 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:09.107 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:52:09.107 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.59900000000016
[aiter INFO] 2025-09-25 11:52:09.107 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-09-25 11:52:09.119 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,404.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:09.144 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.894811962500654 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:09.666 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:09.666 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9189999999999827
[aiter INFO] 2025-09-25 11:52:09.678 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            330.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:09.680 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:09.717 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.364841646929776 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:09.742 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {164, 4}
[aiter INFO] 2025-09-25 11:52:09.742 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-09-25 11:52:09.742 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000002
[aiter INFO] 2025-09-25 11:52:09.757 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            731.4        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          738.3              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.4              7.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:09.758 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:09.759 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:10.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.59711837060381 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:10.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 65, 10, 9}
[aiter INFO] 2025-09-25 11:52:10.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.839000000000055
[aiter INFO] 2025-09-25 11:52:10.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-09-25 11:52:10.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-09-25 11:52:10.175 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.758999999999958
[aiter INFO] 2025-09-25 11:52:10.194 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            886.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,081.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,989.7              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           19.9             19.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:10.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 8, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00164794921875
max_diff_thr=0.0016316170804202557

Top differences:
Position (np.int64(26), np.int64(7), np.int64(103)): arr1 = 0.011658, arr2 = 0.010010, Diff = 0.001648
Position (np.int64(3), np.int64(4), np.int64(15)): arr1 = -0.019165, arr2 = -0.017578, Diff = 0.001587
Position (np.int64(1), np.int64(1), np.int64(46)): arr1 = -0.015991, arr2 = -0.014465, Diff = 0.001526
Position (np.int64(24), np.int64(3), np.int64(67)): arr1 = -0.027588, arr2 = -0.026123, Diff = 0.001465
Position (np.int64(29), np.int64(3), np.int64(52)): arr1 = -0.011780, arr2 = -0.010315, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1392 (4.25%)
[1.0e-06, 1.0e-05): 92 (0.28%)
[1.0e-05, 1.0e-04): 5072 (15.48%)
[1.0e-04, 1.0e-03): 25935 (79.15%)
[1.0e-03, 1.0e-02): 277 (0.85%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=904588b83e467379685bef19cd32517a
triton_output_md5=dcde2913501dc2cc03b460fb77ff39b6
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0390625
max_diff_thr=0.03470466658473015

Top differences:
Position (np.int64(119), np.int64(4), np.int64(126)): arr1 = -0.523438, arr2 = -0.484375, Diff = 0.039062
Position (np.int64(2), np.int64(9), np.int64(51)): arr1 = 0.566406, arr2 = 0.527344, Diff = 0.039062
Position (np.int64(68), np.int64(4), np.int64(0)): arr1 = 0.296875, arr2 = 0.259766, Diff = 0.037109
Position (np.int64(40), np.int64(3), np.int64(19)): arr1 = 0.063965, arr2 = 0.101074, Diff = 0.037109
Position (np.int64(116), np.int64(5), np.int64(86)): arr1 = 0.025391, arr2 = 0.062256, Diff = 0.036865

Threshold statistics:
[0.0e+00, 1.0e-06): 6984 (4.26%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 62 (0.04%)
[1.0e-04, 1.0e-03): 11385 (6.95%)
[1.0e-03, 1.0e-02): 108349 (66.13%)
[1.0e-02, 1.0e-01): 37059 (22.62%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=08cbeebd7351e2926dd03be53a28d895
triton_output_md5=8ec781ccb9816146edb059ff57560cec
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 1])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.03515625
max_diff_thr=0.029113231226801872

Top differences:
Position (np.int64(4), np.int64(6), np.int64(39)): arr1 = 0.519531, arr2 = 0.484375, Diff = 0.035156
Position (np.int64(4), np.int64(6), np.int64(22)): arr1 = 0.523438, arr2 = 0.490234, Diff = 0.033203
Position (np.int64(6), np.int64(1), np.int64(111)): arr1 = 0.231445, arr2 = 0.199219, Diff = 0.032227
Position (np.int64(12), np.int64(3), np.int64(18)): arr1 = -0.180664, arr2 = -0.148438, Diff = 0.032227
Position (np.int64(1), np.int64(3), np.int64(46)): arr1 = -0.683594, arr2 = -0.652344, Diff = 0.031250

Threshold statistics:
[0.0e+00, 1.0e-06): 1671 (4.08%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 15 (0.04%)
[1.0e-04, 1.0e-03): 2823 (6.89%)
[1.0e-03, 1.0e-02): 26923 (65.73%)
[1.0e-02, 1.0e-01): 9528 (23.26%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=2ca52d1f387f52bb314e72881939d2e6
triton_output_md5=72a2c93c638dc4341520d6f8683e125d
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.021484375
max_diff_thr=0.01898454688489437

Top differences:
Position (np.int64(54), np.int64(2), np.int64(75)): arr1 = -0.427734, arr2 = -0.406250, Diff = 0.021484
Position (np.int64(127), np.int64(0), np.int64(61)): arr1 = -0.126953, arr2 = -0.105957, Diff = 0.020996
Position (np.int64(66), np.int64(3), np.int64(103)): arr1 = 0.180664, arr2 = 0.160156, Diff = 0.020508
Position (np.int64(107), np.int64(0), np.int64(31)): arr1 = -0.099121, arr2 = -0.079102, Diff = 0.020020
Position (np.int64(61), np.int64(6), np.int64(29)): arr1 = 0.193359, arr2 = 0.173828, Diff = 0.019531

Threshold statistics:
[0.0e+00, 1.0e-06): 6846 (4.18%)
[1.0e-06, 1.0e-05): 7 (0.00%)
[1.0e-05, 1.0e-04): 240 (0.15%)
[1.0e-04, 1.0e-03): 26155 (15.96%)
[1.0e-03, 1.0e-02): 125507 (76.60%)
[1.0e-02, 1.0e-01): 5085 (3.10%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8c80dfef254903f88640127ab107f239
triton_output_md5=79fb21e451b98b7bc7865263758402b7
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 2])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0224609375
max_diff_thr=0.020087337121367455

Top differences:
Position (np.int64(2), np.int64(3), np.int64(119)): arr1 = -0.140625, arr2 = -0.118164, Diff = 0.022461
Position (np.int64(16), np.int64(9), np.int64(18)): arr1 = 0.300781, arr2 = 0.279297, Diff = 0.021484
Position (np.int64(13), np.int64(3), np.int64(71)): arr1 = 0.041016, arr2 = 0.021118, Diff = 0.019897
Position (np.int64(20), np.int64(4), np.int64(10)): arr1 = -0.217773, arr2 = -0.198242, Diff = 0.019531
Position (np.int64(9), np.int64(3), np.int64(124)): arr1 = -0.197266, arr2 = -0.178711, Diff = 0.018555

Threshold statistics:
[0.0e+00, 1.0e-06): 1761 (4.30%)
[1.0e-06, 1.0e-05): 0 (0.00%)
[1.0e-05, 1.0e-04): 49 (0.12%)
[1.0e-04, 1.0e-03): 6512 (15.90%)
[1.0e-03, 1.0e-02): 31385 (76.62%)
[1.0e-02, 1.0e-01): 1253 (3.06%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=06d807f14b9f991f617bd93448a8fad1
triton_output_md5=f96c5313a58561cbb98bc99d94d9bc8b
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}[aiter INFO] 2025-09-25 11:52:10.243 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.62802994428294 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:10.294 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:10.294 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.23900000000003
[aiter INFO] 2025-09-25 11:52:10.305 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,066.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:10.331 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.68531675651522 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:10.819 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:10.819 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.439000000000021
[aiter INFO] 2025-09-25 11:52:10.831 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            481.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:10.833 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.49 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:11.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.05418810159853 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:11.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:11.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.59899999999999
[aiter INFO] 2025-09-25 11:52:11.109 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,602.7        CUDA            8
[avg us/iter]               NaN   NaN            0.0             26.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:11.135 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.01199997268101 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:11.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:11.702 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-25 11:52:11.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            480.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:11.716 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:12.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 34.19968319853934 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:12.071 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:12.071 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079000000000008
[aiter INFO] 2025-09-25 11:52:12.087 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            920.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          920.9              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.2              9.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:12.088 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.21 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:12.089 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 57,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:12.148 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.85495039437076 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {834, 835, 9, 10, 75, 428, 493, 76, 427, 494, 625, 626, 812, 813, 1109, 1110}
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000342
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.478999999999985
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.078999999999951
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.958999999999946
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.998999999999796
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000342
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999999542
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59900000000016
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000378
[aiter INFO] 2025-09-25 11:52:12.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-09-25 11:52:12.215 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.278999999998632
[aiter INFO] 2025-09-25 11:52:12.233 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0            400.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  93.0            0.0            801.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,299.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             12.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:12.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    12.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:12.280 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 103.17100953347612 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:12.332 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:12.332 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.998999999999995
[aiter INFO] 2025-09-25 11:52:12.342 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,625.5        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:12.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.046891291542806 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {356, 6, 363, 76, 83}
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2390000000000327
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.2789999999999964
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.7189999999999372
[aiter INFO] 2025-09-25 11:52:12.901 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.63900000000001
[aiter INFO] 2025-09-25 11:52:12.913 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            285.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:12.915 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:12.997 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.11435653785668 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:13.048 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {376, 1312, 12}
[aiter INFO] 2025-09-25 11:52:13.048 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999633
[aiter INFO] 2025-09-25 11:52:13.048 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999287
[aiter INFO] 2025-09-25 11:52:13.048 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000023
[aiter INFO] 2025-09-25 11:52:13.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,396.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:13.086 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.67026732139068 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:13.575 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:13.575 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:52:13.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            330.3        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:13.588 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:13.626 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.71413852672766 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:13.652 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:13.652 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.638999999999982
[aiter INFO] 2025-09-25 11:52:13.667 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            734.1        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          734.1              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.3              7.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:13.668 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.34 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:13.668 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:13.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.99753474126948 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {515, 516, 9, 10, 152, 153}
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.47900000000027
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999796
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.678999999999974
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399999999999864
[aiter INFO] 2025-09-25 11:52:14.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-09-25 11:52:14.083 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            877.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,051.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,968.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           19.7             19.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:14.084 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    19.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:14.132 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.66605936536695 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:14.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:14.184 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.039000000000016
[aiter INFO] 2025-09-25 11:52:14.195 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,086.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             30.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:14.220 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.57362399833037 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:14.711 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:14.711 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.518999999999977
[aiter INFO] 2025-09-25 11:52:14.724 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            485.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:14.725 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    35.72 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:14.910 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.09537634342024 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:14.965 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:14.965 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.839
[aiter INFO] 2025-09-25 11:52:14.978 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          2,587.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             25.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:15.003 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.45442587845397 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:15.620 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:15.620 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.278999999999996
[aiter INFO] 2025-09-25 11:52:15.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            450.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:15.633 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    30.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:15.905 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.14702950491764 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:15.933 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:15.933 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000004
[aiter INFO] 2025-09-25 11:52:15.948 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            926.0        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          926.0              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.3              9.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:15.949 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:15.949 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 66,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:16.008 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.04823778230364 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1098, 1099, 10, 493, 494, 372, 373, 1109, 1110, 185, 186}
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.999000000000024
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000597
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-09-25 11:52:16.078 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.119000000000597
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.238999999999578
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.958999999999833
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.238999999999578
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.358999999999924
[aiter INFO] 2025-09-25 11:52:16.079 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-25 11:52:16.098 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            409.0        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  95.0            0.0            825.9        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,299.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:16.099 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:16.145 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.44583157147511 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:16.196 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:16.196 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.278999999999996
[aiter INFO] 2025-09-25 11:52:16.206 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,636.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:16.231 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.74827725875495 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:16.721 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:16.721 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.119
[aiter INFO] 2025-09-25 11:52:16.733 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            299.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:16.734 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:16.817 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.92029675870839 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:16.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 467, 12}
[aiter INFO] 2025-09-25 11:52:16.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000001397
[aiter INFO] 2025-09-25 11:52:16.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.518999999999778
[aiter INFO] 2025-09-25 11:52:16.868 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-09-25 11:52:16.880 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,373.1        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:16.905 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.57044558389352 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:17.429 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 335}
[aiter INFO] 2025-09-25 11:52:17.430 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.9989999999999952
[aiter INFO] 2025-09-25 11:52:17.430 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.3589999999999236
[aiter INFO] 2025-09-25 11:52:17.442 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            294.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:17.443 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    16.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:17.481 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.97436633632324 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:17.506 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:17.506 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000000004
[aiter INFO] 2025-09-25 11:52:17.521 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            757.6        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          757.6              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.6              7.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:17.522 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:17.523 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:17.743 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.41223759816425 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:17.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {328, 329, 10, 9}
[aiter INFO] 2025-09-25 11:52:17.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.19900000000007
[aiter INFO] 2025-09-25 11:52:17.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-25 11:52:17.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-25 11:52:17.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-09-25 11:52:17.895 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            891.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,105.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,016.1              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           20.2             20.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:17.895 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    20.17 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:17.944 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.43871231008285 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:17.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:17.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.15899999999999
[aiter INFO] 2025-09-25 11:52:18.004 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,122.3        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:18.029 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.221544597113486 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:18.564 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:18.564 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.5190000000000055
[aiter INFO] 2025-09-25 11:52:18.576 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            488.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:18.577 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:18.778 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.07118800075926 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:18.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:52:18.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.438999999998487
[aiter INFO] 2025-09-25 11:52:18.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.918999999999983
[aiter INFO] 2025-09-25 11:52:18.844 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,603.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:18.869 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.82747523796441 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:19.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {440, 433, 419, 6}
[aiter INFO] 2025-09-25 11:52:19.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000033
[aiter INFO] 2025-09-25 11:52:19.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.1599999999998545
[aiter INFO] 2025-09-25 11:52:19.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999651
[aiter INFO] 2025-09-25 11:52:19.455 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.239000000000004
[aiter INFO] 2025-09-25 11:52:19.467 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            464.6        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:19.468 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    31.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:19.774 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.86664348353844 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:19.801 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 214}
[aiter INFO] 2025-09-25 11:52:19.801 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.198999999999984
[aiter INFO] 2025-09-25 11:52:19.801 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079999999999927
[aiter INFO] 2025-09-25 11:52:19.816 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            930.8        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          940.9              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.4              9.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:19.817 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:19.817 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 109,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:19.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.42093054256817 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:19.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:19.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999969
[aiter INFO] 2025-09-25 11:52:19.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:52:19.958 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            874.1        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,304.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.0             13.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:19.959 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.04 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:20.004 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 102.90802978348023 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:20.056 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:20.056 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.479000000000013
[aiter INFO] 2025-09-25 11:52:20.067 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,645.9        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             16.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:20.092 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.43976199036777 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:20.608 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:20.609 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.039000000000016
[aiter INFO] 2025-09-25 11:52:20.620 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            298.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:20.621 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:20.704 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.9135443585934 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:20.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 1299, 12}
[aiter INFO] 2025-09-25 11:52:20.754 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.398999999999432
[aiter INFO] 2025-09-25 11:52:20.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.639000000001033
[aiter INFO] 2025-09-25 11:52:20.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-09-25 11:52:20.767 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,378.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:20.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.80172274460887 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:21.315 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:21.315 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.839000000000027
[aiter INFO] 2025-09-25 11:52:21.328 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            296.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:21.329 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.0146484375
max_diff_thr=0.013098464347422123

Top differences:
Position (np.int64(104), np.int64(7), np.int64(76)): arr1 = 0.140625, arr2 = 0.125977, Diff = 0.014648
Position (np.int64(93), np.int64(8), np.int64(105)): arr1 = 0.184570, arr2 = 0.169922, Diff = 0.014648
Position (np.int64(119), np.int64(1), np.int64(23)): arr1 = 0.095215, arr2 = 0.081055, Diff = 0.014160
Position (np.int64(32), np.int64(8), np.int64(5)): arr1 = 0.241211, arr2 = 0.227539, Diff = 0.013672
Position (np.int64(30), np.int64(8), np.int64(9)): arr1 = -0.277344, arr2 = -0.263672, Diff = 0.013672

Threshold statistics:
[0.0e+00, 1.0e-06): 6737 (4.11%)
[1.0e-06, 1.0e-05): 7 (0.00%)
[1.0e-05, 1.0e-04): 533 (0.33%)
[1.0e-04, 1.0e-03): 38245 (23.34%)
[1.0e-03, 1.0e-02): 118012 (72.03%)
[1.0e-02, 1.0e-01): 306 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f62467b57fefa5967bea8c67301a43a3
triton_output_md5=aaca6ec76273e9634deb198de865b4ea
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 4])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0146484375
max_diff_thr=0.012760882265865803

Top differences:
Position (np.int64(4), np.int64(0), np.int64(100)): arr1 = -0.185547, arr2 = -0.170898, Diff = 0.014648
Position (np.int64(9), np.int64(1), np.int64(85)): arr1 = -0.289062, arr2 = -0.275391, Diff = 0.013672
Position (np.int64(21), np.int64(6), np.int64(49)): arr1 = -0.107422, arr2 = -0.094238, Diff = 0.013184
Position (np.int64(26), np.int64(0), np.int64(126)): arr1 = 0.010498, arr2 = 0.023560, Diff = 0.013062
Position (np.int64(11), np.int64(4), np.int64(57)): arr1 = 0.169922, arr2 = 0.157227, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 1671 (4.08%)
[1.0e-06, 1.0e-05): 2 (0.00%)
[1.0e-05, 1.0e-04): 133 (0.32%)
[1.0e-04, 1.0e-03): 9647 (23.55%)
[1.0e-03, 1.0e-02): 29429 (71.85%)
[1.0e-02, 1.0e-01): 78 (0.19%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=fc4133290180beed22961766a6d368fd
triton_output_md5=ffb97258d29d101b624f00aa5bf55da3
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0146484375
max_diff_thr=0.013036717660725117

Top differences:
Position (np.int64(13), np.int64(9), np.int64(37)): arr1 = 0.180664, arr2 = 0.166016, Diff = 0.014648
Position (np.int64(94), np.int64(2), np.int64(109)): arr1 = -0.172852, arr2 = -0.159180, Diff = 0.013672
Position (np.int64(0), np.int64(4), np.int64(104)): arr1 = 0.214844, arr2 = 0.201172, Diff = 0.013672
Position (np.int64(13), np.int64(6), np.int64(34)): arr1 = -0.033936, arr2 = -0.020630, Diff = 0.013306
Position (np.int64(22), np.int64(8), np.int64(75)): arr1 = -0.205078, arr2 = -0.192383, Diff = 0.012695

Threshold statistics:
[0.0e+00, 1.0e-06): 6943 (4.24%)
[1.0e-06, 1.0e-05): 9 (0.01%)
[1.0e-05, 1.0e-04): 617 (0.38%)
[1.0e-04, 1.0e-03): 40742 (24.87%)
[1.0e-03, 1.0e-02): 115374 (70.42%)
[1.0e-02, 1.0e-01): 155 (0.09%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a52e68d22284e75ad029329a43356ef3
triton_output_md5=5525321882b78698cdb6cca2ba76aa43
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 5])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01171875
max_diff_thr=0.011521843262016773

Top differences:
Position (np.int64(4), np.int64(1), np.int64(8)): arr1 = -0.203125, arr2 = -0.191406, Diff = 0.011719
Position (np.int64(12), np.int64(8), np.int64(33)): arr1 = 0.188477, arr2 = 0.176758, Diff = 0.011719
Position (np.int64(23), np.int64(0), np.int64(83)): arr1 = -0.143555, arr2 = -0.131836, Diff = 0.011719
Position (np.int64(1), np.int64(6), np.int64(19)): arr1 = 0.028809, arr2 = 0.017090, Diff = 0.011719
Position (np.int64(12), np.int64(7), np.int64(33)): arr1 = 0.164062, arr2 = 0.152344, Diff = 0.011719

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 1 (0.00%)
[1.0e-05, 1.0e-04): 157 (0.38%)
[1.0e-04, 1.0e-03): 10214 (24.94%)
[1.0e-03, 1.0e-02): 28862 (70.46%)
[1.0e-02, 1.0e-01): 47 (0.11%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e7ac6476152c9ba30f5d70111f701a2e
triton_output_md5=f9780ca77d0c50c79b33465880929257
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.010040640830993652

Top differences:
Position (np.int64(60), np.int64(4), np.int64(102)): arr1 = -0.176758, arr2 = -0.166016, Diff = 0.010742
Position (np.int64(40), np.int64(0), np.int64(5)): arr1 = -0.109863, arr2 = -0.099121, Diff = 0.010742
Position (np.int64(112), np.int64(9), np.int64(18)): arr1 = 0.031494, arr2 = 0.021240, Diff = 0.010254
Position (np.int64(43), np.int64(3), np.int64(102)): arr1 = -0.025391, arr2 = -0.015503, Diff = 0.009888
Position (np.int64(90), np.int64(7), np.int64(122)): arr1 = -0.119141, arr2 = -0.109375, Diff = 0.009766

Threshold statistics:
[0.0e+00, 1.0e-06): 6837 (4.17%)
[1.0e-06, 1.0e-05): 13 (0.01%)
[1.0e-05, 1.0e-04): 991 (0.60%)
[1.0e-04, 1.0e-03): 51127 (31.21%)
[1.0e-03, 1.0e-02): 104869 (64.01%)
[1.0e-02, 1.0e-01): 3 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=ead456444087294bb00793e21089918d
triton_output_md5=8c512a8a840fb6ce3a35007f5fb32d7b
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 7])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01171875
max_diff_thr=0.01001669466495514

Top differences:
Position (np.int64(9), np.int64(8), np.int64(25)): arr1 = 0.181641, arr2 = 0.169922, Diff = 0.011719[aiter INFO] 2025-09-25 11:52:21.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.1878217861499 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:21.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 119}
[aiter INFO] 2025-09-25 11:52:21.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.758999999999986
[aiter INFO] 2025-09-25 11:52:21.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-09-25 11:52:21.406 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0            758.3        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          765.5              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:21.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:21.408 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:21.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.54687117349982 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:21.807 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 284, 285}
[aiter INFO] 2025-09-25 11:52:21.808 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.959000000000003
[aiter INFO] 2025-09-25 11:52:21.808 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-09-25 11:52:21.808 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-09-25 11:52:21.808 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000178
[aiter INFO] 2025-09-25 11:52:21.826 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            883.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          1,126.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,031.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           20.3             20.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:21.827 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    20.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:21.875 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 109.10247524481008 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:21.924 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:21.925 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.19999999999999
[aiter INFO] 2025-09-25 11:52:21.935 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,139.7        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             31.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:21.961 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.646891161651894 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:22.445 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:22.445 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.599000000000018
[aiter INFO] 2025-09-25 11:52:22.457 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            486.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:22.458 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:22.645 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.1785844316577 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:22.700 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:52:22.700 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.079000000001543
[aiter INFO] 2025-09-25 11:52:22.700 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.039000000000016
[aiter INFO] 2025-09-25 11:52:22.712 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,604.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:22.737 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.352643613768095 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:23.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {293, 174, 6}
[aiter INFO] 2025-09-25 11:52:23.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.1590000000001055
[aiter INFO] 2025-09-25 11:52:23.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.5190000000000055
[aiter INFO] 2025-09-25 11:52:23.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.479000000000013
[aiter INFO] 2025-09-25 11:52:23.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            473.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              4.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:23.367 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    31.14 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:23.641 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.04166335929738 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:23.670 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:23.670 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000000013
[aiter INFO] 2025-09-25 11:52:23.685 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            954.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          954.9              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.5              9.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:23.686 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:23.686 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 128,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:23.746 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.36701962086234 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {228, 230, 9, 10, 977, 978, 372, 373}
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000233
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-09-25 11:52:23.812 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.358999999999924
[aiter INFO] 2025-09-25 11:52:23.831 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            417.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            855.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,311.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.1             13.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:23.832 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:23.878 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 101.54290069447886 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:23.928 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 1115, 671}
[aiter INFO] 2025-09-25 11:52:23.928 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.478999999999985
[aiter INFO] 2025-09-25 11:52:23.928 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.03899999999976
[aiter INFO] 2025-09-25 11:52:23.928 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.119000000000597
[aiter INFO] 2025-09-25 11:52:23.939 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,623.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:23.964 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.676197905646696 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:24.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 62, 6}
[aiter INFO] 2025-09-25 11:52:24.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6390000000001237
[aiter INFO] 2025-09-25 11:52:24.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2.6789999999999736
[aiter INFO] 2025-09-25 11:52:24.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.318999999999988
[aiter INFO] 2025-09-25 11:52:24.522 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            293.2        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:24.523 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:24.605 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.26286107183684 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 610, 12, 623, 116}
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000815
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.03899999999976
[aiter INFO] 2025-09-25 11:52:24.839 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-09-25 11:52:24.851 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          1,381.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:24.877 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.787871381728955 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:25.025 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:25.025 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.879000000000019
[aiter INFO] 2025-09-25 11:52:25.037 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            330.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:25.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:25.074 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 29.257910768731985 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:25.098 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:25.098 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-09-25 11:52:25.114 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            771.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          771.9              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            7.7              7.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:25.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:25.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:25.479 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.4707921495532 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:25.669 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:25.669 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.35899999999998
[aiter INFO] 2025-09-25 11:52:25.669 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000003
[aiter INFO] 2025-09-25 11:52:25.688 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            905.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,266.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,172.1              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           21.7             21.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:25.689 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    21.72 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:26.226 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.37576238530697 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:26.279 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:26.279 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.87899999999999
[aiter INFO] 2025-09-25 11:52:26.290 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          3,223.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             32.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:26.316 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.22748502941415 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:26.353 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:26.353 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.478999999999985
[aiter INFO] 2025-09-25 11:52:26.365 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.2        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:26.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    36.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:27.080 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 119.58328737775878 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:27.135 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {363, 51, 12}
[aiter INFO] 2025-09-25 11:52:27.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.43899999999985
[aiter INFO] 2025-09-25 11:52:27.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.31899999999996
[aiter INFO] 2025-09-25 11:52:27.136 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.558999999999997
[aiter INFO] 2025-09-25 11:52:27.148 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          2,621.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             26.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:27.173 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.224316801175036 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:27.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:27.218 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3589999999999804
[aiter INFO] 2025-09-25 11:52:27.230 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            447.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:27.231 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    31.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:27.510 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.74543557574253 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:27.537 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:27.537 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.158999999999992
[aiter INFO] 2025-09-25 11:52:27.552 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,094.8        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,094.8              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           10.9             10.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:27.553 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    10.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:27.554 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 256,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:27.613 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 110.96665336944089 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:27.678 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10}
[aiter INFO] 2025-09-25 11:52:27.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.959000000000003
[aiter INFO] 2025-09-25 11:52:27.679 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-25 11:52:27.697 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            430.2        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0            897.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,327.6              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.3             13.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:27.698 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:27.743 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.60627714242085 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:27.791 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 611, 431}
[aiter INFO] 2025-09-25 11:52:27.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.279000000000025
[aiter INFO] 2025-09-25 11:52:27.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.35900000000038
[aiter INFO] 2025-09-25 11:52:27.792 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.43899999999985
[aiter INFO] 2025-09-25 11:52:27.802 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          1,654.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             16.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:27.827 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.052811956051556 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:28.314 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:28.314 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.038999999999987
[aiter INFO] 2025-09-25 11:52:28.327 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            300.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:28.328 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    19.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:28.410 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.58760421700997 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:28.657 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12, 389}
[aiter INFO] 2025-09-25 11:52:28.657 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-09-25 11:52:28.658 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999998
[aiter INFO] 2025-09-25 11:52:28.658 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.03899999999976
[aiter INFO] 2025-09-25 11:52:28.670 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,419.5        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:28.696 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.241346394071485 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:28.830 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:28.830 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.959000000000003
[aiter INFO] 2025-09-25 11:52:28.842 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            331.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:28.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    17.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:28.879 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.16524745317379 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:28.903 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:28.904 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.0
[aiter INFO] 2025-09-25 11:52:28.919 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            796.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          796.7              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            8.0              8.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:28.920 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     7.97 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:28.920 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:29.348 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.60150502282794 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:29.473 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 11}
[aiter INFO] 2025-09-25 11:52:29.474 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.198999999999955
[aiter INFO] 2025-09-25 11:52:29.474 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999967
[aiter INFO] 2025-09-25 11:52:29.492 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            914.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,653.8        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,567.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           25.7             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:29.493 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    25.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:29.544 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.32751477118765 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:29.596 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 155, 47}
[aiter INFO] 2025-09-25 11:52:29.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.519000000000005
[aiter INFO] 2025-09-25 11:52:29.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.79899999999998
[aiter INFO] 2025-09-25 11:52:29.597 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 59.75899999999996
[aiter INFO] 2025-09-25 11:52:29.607 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          5,772.2        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             58.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:29.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.32691106849378 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:30.174 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:30.174 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:52:30.186 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            529.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:30.187 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:30.368 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.6130686821324 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:30.423 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:30.423 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.839
[aiter INFO] 2025-09-25 11:52:30.435 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          4,849.4        CUDA            8
[avg us/iter]               NaN   NaN            0.0             48.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:30.587 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.908267454935775 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:31.025 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:31.025 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:52:31.037 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            558.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:31.038 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    54.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(29), np.int64(7), np.int64(105)): arr1 = -0.162109, arr2 = -0.152344, Diff = 0.009766
Position (np.int64(23), np.int64(0), np.int64(41)): arr1 = -0.129883, arr2 = -0.120605, Diff = 0.009277
Position (np.int64(8), np.int64(5), np.int64(25)): arr1 = 0.071289, arr2 = 0.062256, Diff = 0.009033
Position (np.int64(11), np.int64(5), np.int64(18)): arr1 = -0.031982, arr2 = -0.023071, Diff = 0.008911

Threshold statistics:
[0.0e+00, 1.0e-06): 1638 (4.00%)
[1.0e-06, 1.0e-05): 3 (0.01%)
[1.0e-05, 1.0e-04): 246 (0.60%)
[1.0e-04, 1.0e-03): 12725 (31.07%)
[1.0e-03, 1.0e-02): 26347 (64.32%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=f7d9645b5350791574c0704327418b32
triton_output_md5=647450591459724761597bbcea723c26
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0107421875
max_diff_thr=0.009458297863602638

Top differences:
Position (np.int64(53), np.int64(6), np.int64(18)): arr1 = -0.146484, arr2 = -0.135742, Diff = 0.010742
Position (np.int64(109), np.int64(1), np.int64(40)): arr1 = -0.104980, arr2 = -0.095215, Diff = 0.009766
Position (np.int64(0), np.int64(1), np.int64(79)): arr1 = -0.043457, arr2 = -0.033691, Diff = 0.009766
Position (np.int64(123), np.int64(8), np.int64(91)): arr1 = -0.126953, arr2 = -0.117188, Diff = 0.009766
Position (np.int64(40), np.int64(8), np.int64(125)): arr1 = 0.115234, arr2 = 0.105957, Diff = 0.009277

Threshold statistics:
[0.0e+00, 1.0e-06): 6768 (4.13%)
[1.0e-06, 1.0e-05): 15 (0.01%)
[1.0e-05, 1.0e-04): 1160 (0.71%)
[1.0e-04, 1.0e-03): 54961 (33.55%)
[1.0e-03, 1.0e-02): 100935 (61.61%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=13a8484106a11e5f62f2ce63691a3153
triton_output_md5=da7ea5c9cfd4207e769c42d51428d092
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 8])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.01123046875
max_diff_thr=0.01019955612719059

Top differences:
Position (np.int64(12), np.int64(5), np.int64(127)): arr1 = -0.112305, arr2 = -0.101074, Diff = 0.011230
Position (np.int64(0), np.int64(3), np.int64(108)): arr1 = 0.138672, arr2 = 0.128906, Diff = 0.009766
Position (np.int64(0), np.int64(9), np.int64(91)): arr1 = 0.060303, arr2 = 0.069336, Diff = 0.009033
Position (np.int64(0), np.int64(6), np.int64(91)): arr1 = 0.053467, arr2 = 0.062256, Diff = 0.008789
Position (np.int64(11), np.int64(3), np.int64(4)): arr1 = 0.088379, arr2 = 0.079590, Diff = 0.008789

Threshold statistics:
[0.0e+00, 1.0e-06): 1698 (4.15%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 249 (0.61%)
[1.0e-04, 1.0e-03): 13456 (32.85%)
[1.0e-03, 1.0e-02): 25550 (62.38%)
[1.0e-02, 1.0e-01): 1 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=5993922593f1144ee5dae57541fbe773
triton_output_md5=59a412519cb239771303460d7adcab5f
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.006540528032928705

Top differences:
Position (np.int64(90), np.int64(8), np.int64(19)): arr1 = 0.052002, arr2 = 0.045166, Diff = 0.006836
Position (np.int64(54), np.int64(5), np.int64(121)): arr1 = 0.056396, arr2 = 0.049805, Diff = 0.006592
Position (np.int64(96), np.int64(8), np.int64(85)): arr1 = -0.092285, arr2 = -0.085938, Diff = 0.006348
Position (np.int64(30), np.int64(9), np.int64(76)): arr1 = -0.060547, arr2 = -0.054199, Diff = 0.006348
Position (np.int64(76), np.int64(2), np.int64(7)): arr1 = 0.127930, arr2 = 0.121582, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6788 (4.14%)
[1.0e-06, 1.0e-05): 36 (0.02%)
[1.0e-05, 1.0e-04): 2239 (1.37%)
[1.0e-04, 1.0e-03): 74077 (45.21%)
[1.0e-03, 1.0e-02): 80700 (49.26%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=63f405fe983b95d9d26dd254bd1e060f
triton_output_md5=4c8bc229730fa08ab0b6a4d8e9a8d047
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 16])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0068359375
max_diff_thr=0.006448640953749418

Top differences:
Position (np.int64(7), np.int64(1), np.int64(35)): arr1 = -0.104004, arr2 = -0.097168, Diff = 0.006836
Position (np.int64(8), np.int64(7), np.int64(108)): arr1 = -0.066895, arr2 = -0.060059, Diff = 0.006836
Position (np.int64(19), np.int64(4), np.int64(23)): arr1 = 0.052490, arr2 = 0.046143, Diff = 0.006348
Position (np.int64(13), np.int64(9), np.int64(113)): arr1 = -0.043701, arr2 = -0.037598, Diff = 0.006104
Position (np.int64(13), np.int64(6), np.int64(28)): arr1 = 0.050537, arr2 = 0.044434, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 1626 (3.97%)
[1.0e-06, 1.0e-05): 6 (0.01%)
[1.0e-05, 1.0e-04): 552 (1.35%)
[1.0e-04, 1.0e-03): 18385 (44.89%)
[1.0e-03, 1.0e-02): 20391 (49.78%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=4d73322d5323b4e0bb24d13d20d32aeb
triton_output_md5=a6f55d1c325b551cb86ff71c083a68ba
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00732421875
max_diff_thr=0.006726457271724939

Top differences:
Position (np.int64(1), np.int64(3), np.int64(112)): arr1 = -0.096191, arr2 = -0.088867, Diff = 0.007324
Position (np.int64(0), np.int64(2), np.int64(10)): arr1 = -0.079102, arr2 = -0.072266, Diff = 0.006836
Position (np.int64(76), np.int64(2), np.int64(106)): arr1 = 0.040527, arr2 = 0.033936, Diff = 0.006592[aiter INFO] 2025-09-25 11:52:31.362 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 33.32168300921964 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:31.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:31.391 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359000000000009
[aiter INFO] 2025-09-25 11:52:31.406 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,385.9        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,385.9              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           13.9             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:31.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:31.407 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 257,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:31.465 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.32903936416795 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 812, 813, 1043, 1044}
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.558999999999969
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.639999999999986
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.0789999999997235
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-09-25 11:52:31.535 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:52:31.554 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            419.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0            909.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,355.1              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.6             13.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:31.555 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:31.600 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.1096236180551 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:31.649 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:31.649 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.479000000000013
[aiter INFO] 2025-09-25 11:52:31.660 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,700.4        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:31.684 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.67856450187097 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:32.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {48, 6}
[aiter INFO] 2025-09-25 11:52:32.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.63900000000001
[aiter INFO] 2025-09-25 11:52:32.251 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.359000000000009
[aiter INFO] 2025-09-25 11:52:32.263 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            369.9        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:32.264 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:32.345 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.87316852099825 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:32.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 1312, 12}
[aiter INFO] 2025-09-25 11:52:32.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-09-25 11:52:32.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000742
[aiter INFO] 2025-09-25 11:52:32.580 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-09-25 11:52:32.592 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          1,423.2        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:32.618 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.72015829222037 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:32.769 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {461, 6}
[aiter INFO] 2025-09-25 11:52:32.769 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 3.1989999999996144
[aiter INFO] 2025-09-25 11:52:32.769 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:52:32.781 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            368.1        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:32.782 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:32.818 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.13433674627011 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:32.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:32.843 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.758999999999986
[aiter INFO] 2025-09-25 11:52:32.858 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            977.3        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          977.3              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.8              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:32.859 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:32.860 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:33.199 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.05417795641588 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {713, 9, 10, 716, 273, 274}
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.679000000000087
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.119000000000028
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.6790000000000305
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.318999999999505
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.679000000000087
[aiter INFO] 2025-09-25 11:52:33.461 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.358999999999924
[aiter INFO] 2025-09-25 11:52:33.480 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            896.7        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          1,625.0        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,577.7              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           25.8             25.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:33.481 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    25.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:33.532 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.54852451546355 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:33.584 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:33.585 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.11900000000003
[aiter INFO] 2025-09-25 11:52:33.595 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          5,918.2        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             59.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:33.621 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.2179801171959 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:34.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:34.093 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.439000000000021
[aiter INFO] 2025-09-25 11:52:34.105 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            529.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:34.106 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    64.48 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:34.267 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 135.56512777167973 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:34.321 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 103}
[aiter INFO] 2025-09-25 11:52:34.321 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.87899999999999
[aiter INFO] 2025-09-25 11:52:34.321 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.399
[aiter INFO] 2025-09-25 11:52:34.333 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          4,815.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             48.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:34.359 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.46669311393605 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:34.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:34.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000002
[aiter INFO] 2025-09-25 11:52:34.941 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            557.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:34.942 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    54.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:35.214 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 32.67811880548402 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:35.242 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:35.243 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.35899999999998
[aiter INFO] 2025-09-25 11:52:35.258 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,394.3        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,394.3              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           13.9             13.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:35.259 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    13.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:35.259 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 282,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:35.317 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.56941619190839 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 10, 526, 527, 273, 274, 603, 604}
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.239000000000487
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.279000000000451
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000378
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.078999999999724
[aiter INFO] 2025-09-25 11:52:35.416 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.319000000000415
[aiter INFO] 2025-09-25 11:52:35.435 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            418.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0            899.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,362.5              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           13.6             13.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:35.436 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    13.59 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:35.480 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.67275241105864 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:35.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 635}
[aiter INFO] 2025-09-25 11:52:35.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119
[aiter INFO] 2025-09-25 11:52:35.528 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.798999999999978
[aiter INFO] 2025-09-25 11:52:35.539 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          1,690.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             17.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:35.563 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.915009822585795 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:36.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:36.308 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.399000000000001
[aiter INFO] 2025-09-25 11:52:36.320 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            375.7        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:36.321 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    20.83 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:36.403 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 99.71514853215453 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:36.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:36.454 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-09-25 11:52:36.466 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0          1,454.3        CUDA            8
[avg us/iter]               NaN   NaN            0.0             14.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:36.491 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.86036623173421 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:36.598 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:36.598 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.198999999999984
[aiter INFO] 2025-09-25 11:52:36.610 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            373.5        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:36.611 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:36.648 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.43770294009459 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:36.672 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:36.672 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.679000000000002
[aiter INFO] 2025-09-25 11:52:36.688 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            982.3        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          982.3              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.8              9.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:36.689 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:36.689 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:37.053 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.23912880857392 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:37.258 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:52:37.258 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.35899999999998
[aiter INFO] 2025-09-25 11:52:37.258 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000003
[aiter INFO] 2025-09-25 11:52:37.277 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            922.4        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          1,870.6        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        2,793.0              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           27.9             27.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:37.278 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    27.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:37.330 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.9263559981148 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:37.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59}
[aiter INFO] 2025-09-25 11:52:37.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.679
[aiter INFO] 2025-09-25 11:52:37.383 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.278999999999996
[aiter INFO] 2025-09-25 11:52:37.393 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 99.0            0.0          6,021.6        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             60.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:37.419 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.69206926521688 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:37.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 195, 6, 139, 251}
[aiter INFO] 2025-09-25 11:52:37.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000000124
[aiter INFO] 2025-09-25 11:52:37.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999896
[aiter INFO] 2025-09-25 11:52:37.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.279000000000025
[aiter INFO] 2025-09-25 11:52:37.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999896
[aiter INFO] 2025-09-25 11:52:37.930 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.638999999999896
[aiter INFO] 2025-09-25 11:52:37.942 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            506.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:37.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    66.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:38.104 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.03093020396656 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:38.159 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {818, 12, 103}
[aiter INFO] 2025-09-25 11:52:38.159 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.91899999999987
[aiter INFO] 2025-09-25 11:52:38.159 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.679
[aiter INFO] 2025-09-25 11:52:38.159 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.71900000000005
[aiter INFO] 2025-09-25 11:52:38.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0          4,873.4        CUDA            8
[avg us/iter]               NaN  NaN            0.0             49.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:38.197 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.292029821046505 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:38.791 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:38.791 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.3589999999999804
[aiter INFO] 2025-09-25 11:52:38.803 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            559.0        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:38.804 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    55.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:39.068 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 35.12763364775346 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:39.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 254}
[aiter INFO] 2025-09-25 11:52:39.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.959000000000003
[aiter INFO] 2025-09-25 11:52:39.097 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.679000000000087
[aiter INFO] 2025-09-25 11:52:39.112 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          1,532.4        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,550.1              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           15.5             15.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:39.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    15.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:39.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 512,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:39.171 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.75001011626554 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:39.272 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 98, 10, 9}
[aiter INFO] 2025-09-25 11:52:39.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.398999999999887
[aiter INFO] 2025-09-25 11:52:39.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000078
[aiter INFO] 2025-09-25 11:52:39.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.119000000000028
[aiter INFO] 2025-09-25 11:52:39.273 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-09-25 11:52:39.291 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            426.1        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0            998.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,442.7              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           14.4             14.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:39.292 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    14.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:39.337 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 96.94121778011322 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:39.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:39.385 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-09-25 11:52:39.396 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0          1,756.8        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0             17.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:39.420 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.802930699716704 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:39.996 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:39.996 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.438999999999993
[aiter INFO] 2025-09-25 11:52:40.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            373.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:40.008 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    21.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:40.089 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 100.00544528264811 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:40.325 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12}
[aiter INFO] 2025-09-25 11:52:40.325 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000005
[aiter INFO] 2025-09-25 11:52:40.325 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.518999999999977
[aiter INFO] 2025-09-25 11:52:40.337 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          1,444.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             14.6         NaN          NaN
[aiter INFO] 2025-09-25 11:52:40.364 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.251653313341706 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:40.476 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:40.476 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3589999999999804
[aiter INFO] 2025-09-25 11:52:40.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            372.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              3.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:40.489 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    18.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

Position (np.int64(17), np.int64(7), np.int64(87)): arr1 = 0.105469, arr2 = 0.099121, Diff = 0.006348
Position (np.int64(65), np.int64(0), np.int64(47)): arr1 = -0.075684, arr2 = -0.069336, Diff = 0.006348

Threshold statistics:
[0.0e+00, 1.0e-06): 6546 (4.00%)
[1.0e-06, 1.0e-05): 37 (0.02%)
[1.0e-05, 1.0e-04): 2263 (1.38%)
[1.0e-04, 1.0e-03): 74228 (45.31%)
[1.0e-03, 1.0e-02): 80766 (49.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=aaa8e6e5a523423ce627433f43116be6
triton_output_md5=215f77d96f1eff5cac6806e72d87be22
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 17])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006591796875
max_diff_thr=0.006355931982398033

Top differences:
Position (np.int64(26), np.int64(5), np.int64(112)): arr1 = 0.043701, arr2 = 0.037109, Diff = 0.006592
Position (np.int64(27), np.int64(5), np.int64(75)): arr1 = -0.083008, arr2 = -0.077148, Diff = 0.005859
Position (np.int64(14), np.int64(7), np.int64(126)): arr1 = 0.070312, arr2 = 0.064453, Diff = 0.005859
Position (np.int64(17), np.int64(2), np.int64(66)): arr1 = 0.132812, arr2 = 0.126953, Diff = 0.005859
Position (np.int64(18), np.int64(1), np.int64(27)): arr1 = -0.044678, arr2 = -0.038818, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1699 (4.15%)
[1.0e-06, 1.0e-05): 12 (0.03%)
[1.0e-05, 1.0e-04): 540 (1.32%)
[1.0e-04, 1.0e-03): 18604 (45.42%)
[1.0e-03, 1.0e-02): 20105 (49.08%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=eacb50835612571dbd87f498c4eaa182
triton_output_md5=35b5c3b35fd8e5477f4c0b66b6c88dac
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00634765625
max_diff_thr=0.006184586323797703

Top differences:
Position (np.int64(30), np.int64(0), np.int64(103)): arr1 = 0.042236, arr2 = 0.035889, Diff = 0.006348
Position (np.int64(35), np.int64(9), np.int64(85)): arr1 = -0.100586, arr2 = -0.094238, Diff = 0.006348
Position (np.int64(55), np.int64(2), np.int64(81)): arr1 = 0.032715, arr2 = 0.026367, Diff = 0.006348
Position (np.int64(106), np.int64(2), np.int64(27)): arr1 = -0.046631, arr2 = -0.040527, Diff = 0.006104
Position (np.int64(120), np.int64(9), np.int64(106)): arr1 = -0.039307, arr2 = -0.033203, Diff = 0.006104

Threshold statistics:
[0.0e+00, 1.0e-06): 6559 (4.00%)
[1.0e-06, 1.0e-05): 40 (0.02%)
[1.0e-05, 1.0e-04): 2425 (1.48%)
[1.0e-04, 1.0e-03): 77320 (47.19%)
[1.0e-03, 1.0e-02): 77496 (47.30%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=7797e89bc631b80d132e9af5446972e4
triton_output_md5=d6748a386073f4319eeddbbc0ca9d604
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 18])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.006103515625
max_diff_thr=0.005847953259944916

Top differences:
Position (np.int64(20), np.int64(0), np.int64(24)): arr1 = 0.049805, arr2 = 0.043701, Diff = 0.006104
Position (np.int64(22), np.int64(4), np.int64(10)): arr1 = -0.062256, arr2 = -0.056152, Diff = 0.006104
Position (np.int64(22), np.int64(4), np.int64(11)): arr1 = 0.080078, arr2 = 0.074219, Diff = 0.005859
Position (np.int64(31), np.int64(8), np.int64(124)): arr1 = 0.046875, arr2 = 0.041016, Diff = 0.005859
Position (np.int64(15), np.int64(6), np.int64(40)): arr1 = -0.140625, arr2 = -0.134766, Diff = 0.005859

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 4 (0.01%)
[1.0e-05, 1.0e-04): 625 (1.53%)
[1.0e-04, 1.0e-03): 19321 (47.17%)
[1.0e-03, 1.0e-02): 19331 (47.19%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=528035d2c8186c89c83ab04bafc441b5
triton_output_md5=ca16333feb583ea02e41654cc0d8e486
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005859375
max_diff_thr=0.005576208233833313

Top differences:
Position (np.int64(96), np.int64(3), np.int64(10)): arr1 = -0.056641, arr2 = -0.050781, Diff = 0.005859
Position (np.int64(118), np.int64(5), np.int64(26)): arr1 = 0.054199, arr2 = 0.049316, Diff = 0.004883
Position (np.int64(121), np.int64(0), np.int64(115)): arr1 = -0.097656, arr2 = -0.092773, Diff = 0.004883
Position (np.int64(85), np.int64(2), np.int64(123)): arr1 = -0.071289, arr2 = -0.066406, Diff = 0.004883
Position (np.int64(21), np.int64(8), np.int64(13)): arr1 = 0.040527, arr2 = 0.035889, Diff = 0.004639

Threshold statistics:
[0.0e+00, 1.0e-06): 6645 (4.06%)
[1.0e-06, 1.0e-05): 57 (0.03%)
[1.0e-05, 1.0e-04): 4296 (2.62%)
[1.0e-04, 1.0e-03): 96502 (58.90%)
[1.0e-03, 1.0e-02): 56340 (34.39%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=8a1e5ce1bc0c570e41e05c2f19a9a2e8
triton_output_md5=2b99f5bf95442f0d9929e28aa2bea068
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 32])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.005126953125
max_diff_thr=0.004915730562061071

Top differences:
Position (np.int64(10), np.int64(6), np.int64(49)): arr1 = 0.048096, arr2 = 0.042969, Diff = 0.005127
Position (np.int64(19), np.int64(5), np.int64(73)): arr1 = -0.037109, arr2 = -0.032227, Diff = 0.004883
Position (np.int64(16), np.int64(6), np.int64(46)): arr1 = -0.092773, arr2 = -0.087891, Diff = 0.004883
Position (np.int64(7), np.int64(2), np.int64(19)): arr1 = -0.050293, arr2 = -0.045898, Diff = 0.004395
Position (np.int64(15), np.int64(7), np.int64(34)): arr1 = -0.073730, arr2 = -0.069336, Diff = 0.004395[aiter INFO] 2025-09-25 11:52:40.525 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.07770294673962 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:40.550 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:40.550 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-09-25 11:52:40.565 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0            967.5        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0          967.5              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN            9.7              9.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:40.566 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:     9.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:40.566 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:40.907 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.2371779326165 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:41.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 12}
[aiter INFO] 2025-09-25 11:52:41.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.11899999999997
[aiter INFO] 2025-09-25 11:52:41.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999983
[aiter INFO] 2025-09-25 11:52:41.147 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            906.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,111.7        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,018.2              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           30.2             30.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:41.148 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    30.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:41.201 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 154.48638619762835 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:41.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 59, 35, 47}
[aiter INFO] 2025-09-25 11:52:41.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.03999999999999
[aiter INFO] 2025-09-25 11:52:41.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.12
[aiter INFO] 2025-09-25 11:52:41.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.35900000000004
[aiter INFO] 2025-09-25 11:52:41.256 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.399
[aiter INFO] 2025-09-25 11:52:41.266 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0          7,285.1        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             75.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:41.464 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.26155450792596 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:41.793 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:41.794 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-09-25 11:52:41.806 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            642.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:41.807 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    81.53 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:41.968 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 149.54377209195997 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:42.022 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {116, 12}
[aiter INFO] 2025-09-25 11:52:42.022 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.03899999999999
[aiter INFO] 2025-09-25 11:52:42.022 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.640000000000015
[aiter INFO] 2025-09-25 11:52:42.035 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          6,051.8        CUDA            8
[avg us/iter]               NaN  NaN            0.0             61.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:42.226 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.05045532885165 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:42.615 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:42.615 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519999999999982
[aiter INFO] 2025-09-25 11:52:42.627 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            671.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:42.628 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    67.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:42.922 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 36.23336645783765 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:42.952 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {5}
[aiter INFO] 2025-09-25 11:52:42.953 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.558999999999997
[aiter INFO] 2025-09-25 11:52:42.968 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          1,734.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,734.7              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           17.3             17.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:42.969 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    17.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:42.969 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 513,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:43.027 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.65773250147848 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {900, 901, 9, 10, 812, 815, 977, 978}
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.71900000000096
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.3989999999994325
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.079000000000008
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.038999999999987
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999542
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.59900000000016
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.03899999999885
[aiter INFO] 2025-09-25 11:52:43.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.439000000000306
[aiter INFO] 2025-09-25 11:52:43.147 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            415.6        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  97.0            0.0          1,120.2        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        1,589.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           15.9             15.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:43.148 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    15.83 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:43.194 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.43874251606441 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:43.242 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 383, 239}
[aiter INFO] 2025-09-25 11:52:43.242 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.998999999999995
[aiter INFO] 2025-09-25 11:52:43.243 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.838999999999942
[aiter INFO] 2025-09-25 11:52:43.243 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.879000000000133
[aiter INFO] 2025-09-25 11:52:43.253 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0          2,966.5        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0             30.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:43.277 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.71817813238295 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:44.056 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:44.057 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.039000000000016
[aiter INFO] 2025-09-25 11:52:44.069 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            432.1        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:44.070 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:    34.59 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:44.154 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.01576250673521 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:44.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 12}
[aiter INFO] 2025-09-25 11:52:44.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.518999999998414
[aiter INFO] 2025-09-25 11:52:44.204 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.799000000000007
[aiter INFO] 2025-09-25 11:52:44.216 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0          2,515.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             25.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:44.241 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.13322740645692 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:44.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:44.354 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-09-25 11:52:44.365 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            429.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              4.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:44.366 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    29.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:44.403 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 30.802059457591263 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:44.427 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 4, 14}
[aiter INFO] 2025-09-25 11:52:44.427 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000004
[aiter INFO] 2025-09-25 11:52:44.428 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.799999999999983
[aiter INFO] 2025-09-25 11:52:44.428 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.199000000000012
[aiter INFO] 2025-09-25 11:52:44.443 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  98.0            0.0          1,120.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        1,145.2              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           11.5             11.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:44.444 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    11.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:44.444 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:44.767 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.3284254380972 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:45.041 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1060, 9, 1098, 1035, 14, 1071, 1073, 1045, 1084, 1087}
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.71899999999914
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.83999999999997
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000233
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.51999999999862
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999994
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.238999999999578
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.63999999999942
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 44.71900000000096
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.519000000000233
[aiter INFO] 2025-09-25 11:52:45.042 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 107.3189999999995
[aiter INFO] 2025-09-25 11:52:45.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,128.8        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  96.0            0.0          9,158.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0       10,780.4              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN          107.8            107.2         NaN          NaN
[aiter INFO] 2025-09-25 11:52:45.064 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   107.16 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:45.151 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 484.1871757318478 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:45.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1184, 11, 1179}
[aiter INFO] 2025-09-25 11:52:45.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 412.7999999999993
[aiter INFO] 2025-09-25 11:52:45.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 409.48
[aiter INFO] 2025-09-25 11:52:45.234 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 413.2000000000007
[aiter INFO] 2025-09-25 11:52:45.245 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         40,108.0        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            409.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:45.549 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.37640604996445 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:45.663 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:45.664 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-09-25 11:52:45.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,280.9        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:45.676 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   422.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:45.867 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 410.7505150950781 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:45.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-09-25 11:52:45.943 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 329.24
[aiter INFO] 2025-09-25 11:52:45.956 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         32,872.9        CUDA            8
[avg us/iter]               NaN   NaN            0.0            328.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:46.260 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.21481188482577 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:46.436 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {706, 524, 6}
[aiter INFO] 2025-09-25 11:52:46.436 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000378
[aiter INFO] 2025-09-25 11:52:46.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.358999999999924
[aiter INFO] 2025-09-25 11:52:46.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000003
[aiter INFO] 2025-09-25 11:52:46.449 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0          1,252.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0             12.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:46.450 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   341.51 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:46.751 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 86.58837637688855 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:46.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 455}
[aiter INFO] 2025-09-25 11:52:46.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.39900000000003
[aiter INFO] 2025-09-25 11:52:46.784 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.43899999999985
[aiter INFO] 2025-09-25 11:52:46.799 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          6,522.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        6,596.2              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           66.0             65.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:46.801 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    65.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:46.802 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4097,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:46.867 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 118.08390155582146 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 13, 20, 24, 31}
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.07900000000001
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.999000000000024
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.959
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999983
[aiter INFO] 2025-09-25 11:52:46.929 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.47899999999993
[aiter INFO] 2025-09-25 11:52:46.949 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            477.5        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  98.0            0.0          2,767.3        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,319.9              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           33.2             33.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:46.949 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    33.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:47.004 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 184.08767274110625 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:47.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 567, 47}
[aiter INFO] 2025-09-25 11:52:47.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.91900000000001
[aiter INFO] 2025-09-25 11:52:47.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.43900000000002
[aiter INFO] 2025-09-25 11:52:47.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.75900000000001
[aiter INFO] 2025-09-25 11:52:47.055 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.07899999999995
[aiter INFO] 2025-09-25 11:52:47.065 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 97.0            0.0         10,066.8        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:47.091 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 58.828693030789346 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:47.659 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {657, 643, 685, 6}
[aiter INFO] 2025-09-25 11:52:47.659 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.9190000000007785
[aiter INFO] 2025-09-25 11:52:47.659 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999869
[aiter INFO] 2025-09-25 11:52:47.659 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999869
[aiter INFO] 2025-09-25 11:52:47.659 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.799000000000007
[aiter INFO] 2025-09-25 11:52:47.671 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            645.5        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              6.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:47.672 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   110.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:47.955 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 167.97792985297667 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 1208, 25, 766}
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.23900000000003
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.75899999999996
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.95999999999998
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.27999999999997
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.4390000000003
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.19900000000001
[aiter INFO] 2025-09-25 11:52:48.007 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.40000000000055
[aiter INFO] 2025-09-25 11:52:48.019 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0          7,852.3        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:48.044 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 54.9803564306533 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:48.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {62, 6}
[aiter INFO] 2025-09-25 11:52:48.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.358999999999924
[aiter INFO] 2025-09-25 11:52:48.115 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-09-25 11:52:48.127 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            695.7        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:48.128 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    90.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:48.167 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 56.39381190337757 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:48.192 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {10, 4}
[aiter INFO] 2025-09-25 11:52:48.192 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.16
[aiter INFO] 2025-09-25 11:52:48.192 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.43899999999999
[aiter INFO] 2025-09-25 11:52:48.205 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          3,529.7        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        3,563.8              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           35.6             35.7         NaN          NaN
[aiter INFO] 2025-09-25 11:52:48.206 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    35.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:48.207 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:48.584 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.8591297510827 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:48.763 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 834, 17, 847}
[aiter INFO] 2025-09-25 11:52:48.763 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.47899999999998
[aiter INFO] 2025-09-25 11:52:48.763 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.9990000000007
[aiter INFO] 2025-09-25 11:52:48.763 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-09-25 11:52:48.763 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.59900000000016
[aiter INFO] 2025-09-25 11:52:48.782 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            995.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp...  99.0            0.0          8,600.4        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        9,739.3              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           97.4             96.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:48.783 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    96.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:49.387 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 459.83343549294045 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:49.473 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11}
[aiter INFO] 2025-09-25 11:52:49.473 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 382.64
[aiter INFO] 2025-09-25 11:52:49.484 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 100.0            0.0         38,194.0        CUDA            8
[avg us/iter]                                                   NaN   NaN            0.0            381.9         NaN          NaN
[aiter INFO] 2025-09-25 11:52:49.714 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 62.06235632595449 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:49.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:49.755 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.998999999999995
[aiter INFO] 2025-09-25 11:52:49.768 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,032.4        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:49.769 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   392.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:50.515 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 392.52394201731914 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {320, 1282, 1283, 1252, 677, 714, 12, 1275, 49, 276, 1270, 123, 1276}
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.15999999999985
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.0400000000009
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.08000000000175
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 309.0799999999999
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.4400000000005
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.0799999999999
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 308.72
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.3600000000006
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 304.91999999999996
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.8800000000001
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 308.76000000000204
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 307.31999999999994
[aiter INFO] 2025-09-25 11:52:50.594 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 306.59999999999854
[aiter INFO] 2025-09-25 11:52:50.607 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 88.0            0.0         27,111.9        CUDA            8
[avg us/iter]               NaN  NaN            0.0            308.1         NaN          NaN
[aiter INFO] 2025-09-25 11:52:50.830 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.46393056317132 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:50.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:50.876 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-09-25 11:52:50.888 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,035.6        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0             10.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:50.889 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   318.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]


Threshold statistics:
[0.0e+00, 1.0e-06): 1677 (4.09%)
[1.0e-06, 1.0e-05): 18 (0.04%)
[1.0e-05, 1.0e-04): 1125 (2.75%)
[1.0e-04, 1.0e-03): 24133 (58.92%)
[1.0e-03, 1.0e-02): 14007 (34.20%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=e2d9644e6044b47679d091a5d675208c
triton_output_md5=a184ae6326351137ae1c6fbb2b3b3a7d
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.004638671875
max_diff_thr=0.004587709903717041

Top differences:
Position (np.int64(33), np.int64(8), np.int64(84)): arr1 = -0.038574, arr2 = -0.033936, Diff = 0.004639
Position (np.int64(61), np.int64(8), np.int64(123)): arr1 = -0.015747, arr2 = -0.011108, Diff = 0.004639
Position (np.int64(118), np.int64(7), np.int64(83)): arr1 = 0.034668, arr2 = 0.030029, Diff = 0.004639
Position (np.int64(125), np.int64(7), np.int64(9)): arr1 = -0.021973, arr2 = -0.017456, Diff = 0.004517
Position (np.int64(100), np.int64(3), np.int64(63)): arr1 = 0.026245, arr2 = 0.021729, Diff = 0.004517

Threshold statistics:
[0.0e+00, 1.0e-06): 6599 (4.03%)
[1.0e-06, 1.0e-05): 46 (0.03%)
[1.0e-05, 1.0e-04): 4398 (2.68%)
[1.0e-04, 1.0e-03): 96564 (58.94%)
[1.0e-03, 1.0e-02): 56233 (34.32%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=535d9c04f547b56a7a5ac0960a2709e1
triton_output_md5=402fac52df3aa16c2bad48a8b1a83462
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 33])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00439453125
max_diff_thr=0.004296455532312393

Top differences:
Position (np.int64(1), np.int64(0), np.int64(108)): arr1 = -0.079590, arr2 = -0.075195, Diff = 0.004395
Position (np.int64(5), np.int64(8), np.int64(20)): arr1 = 0.069336, arr2 = 0.064941, Diff = 0.004395
Position (np.int64(31), np.int64(0), np.int64(125)): arr1 = -0.027222, arr2 = -0.022827, Diff = 0.004395
Position (np.int64(5), np.int64(8), np.int64(99)): arr1 = -0.036133, arr2 = -0.031738, Diff = 0.004395
Position (np.int64(19), np.int64(8), np.int64(66)): arr1 = 0.028687, arr2 = 0.024414, Diff = 0.004272

Threshold statistics:
[0.0e+00, 1.0e-06): 1554 (3.79%)
[1.0e-06, 1.0e-05): 12 (0.03%)
[1.0e-05, 1.0e-04): 1064 (2.60%)
[1.0e-04, 1.0e-03): 24332 (59.40%)
[1.0e-03, 1.0e-02): 13998 (34.17%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=a5a3450cd6027bbe0bf1796f7a9cce3a
triton_output_md5=f24eac2488795f348012d8f737838930
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018130174139514565

Top differences:
Position (np.int64(98), np.int64(4), np.int64(43)): arr1 = 0.016357, arr2 = 0.014526, Diff = 0.001831
Position (np.int64(17), np.int64(4), np.int64(10)): arr1 = -0.023926, arr2 = -0.022095, Diff = 0.001831
Position (np.int64(63), np.int64(8), np.int64(100)): arr1 = 0.011780, arr2 = 0.009949, Diff = 0.001831
Position (np.int64(12), np.int64(9), np.int64(91)): arr1 = 0.027100, arr2 = 0.025391, Diff = 0.001709
Position (np.int64(99), np.int64(9), np.int64(51)): arr1 = 0.008301, arr2 = 0.006622, Diff = 0.001678

Threshold statistics:
[0.0e+00, 1.0e-06): 6814 (4.16%)
[1.0e-06, 1.0e-05): 442 (0.27%)
[1.0e-05, 1.0e-04): 24936 (15.22%)
[1.0e-04, 1.0e-03): 130151 (79.44%)
[1.0e-03, 1.0e-02): 1497 (0.91%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b9196fde8ec8c24fc9e3630b38df8d6d
triton_output_md5=732de90dd63b80dc6cd788d693ea8d1e
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 257])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.0015869140625
max_diff_thr=0.00157696264795959

Top differences:
Position (np.int64(13), np.int64(5), np.int64(73)): arr1 = 0.011658, arr2 = 0.010071, Diff = 0.001587
Position (np.int64(7), np.int64(4), np.int64(113)): arr1 = 0.003052, arr2 = 0.001472, Diff = 0.001579
Position (np.int64(24), np.int64(9), np.int64(35)): arr1 = 0.013123, arr2 = 0.011597, Diff = 0.001526
Position (np.int64(3), np.int64(8), np.int64(56)): arr1 = -0.008240, arr2 = -0.006744, Diff = 0.001495
Position (np.int64(20), np.int64(7), np.int64(40)): arr1 = 0.022705, arr2 = 0.021240, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1708 (4.17%)
[1.0e-06, 1.0e-05): 117 (0.29%)
[1.0e-05, 1.0e-04): 6210 (15.16%)
[1.0e-04, 1.0e-03): 32544 (79.45%)
[1.0e-03, 1.0e-02): 381 (0.93%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=1615d5439783903d966d227312d3397a
triton_output_md5=7cfa6c5d99d49ad7e0e0384e4e44a3a7
query.shape=torch.Size([128, 10, 128])
key_cache.shape=torch.Size([131072, 1, 16, 16, 8])
value_cache.shape=torch.Size([131072, 1, 128, 16])
output.shape=torch.Size([128, 10, 128])
block_tables.shape=torch.Size([128, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017535373335704207

Top differences:
Position (np.int64(34), np.int64(2), np.int64(42)): arr1 = -0.011169, arr2 = -0.009399, Diff = 0.001770
Position (np.int64(72), np.int64(7), np.int64(84)): arr1 = 0.013672, arr2 = 0.011963, Diff = 0.001709
Position (np.int64(79), np.int64(5), np.int64(104)): arr1 = 0.017944, arr2 = 0.016235, Diff = 0.001709
Position (np.int64(121), np.int64(9), np.int64(78)): arr1 = -0.010071, arr2 = -0.008362, Diff = 0.001709
Position (np.int64(101), np.int64(6), np.int64(116)): arr1 = -0.026245, arr2 = -0.024536, Diff = 0.001709

Threshold statistics:
[0.0e+00, 1.0e-06): 6974 (4.26%)
[1.0e-06, 1.0e-05): 479 (0.29%)
[1.0e-05, 1.0e-04): 24680 (15.06%)[aiter INFO] 2025-09-25 11:52:50.940 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.37726702194402 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:50.970 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-09-25 11:52:50.970 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.07899999999998
[aiter INFO] 2025-09-25 11:52:50.985 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w 100.0            0.0          6,335.1        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        6,335.1              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           63.4             63.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:50.986 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    63.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:50.987 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 32,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1)
[aiter INFO] 2025-09-25 11:52:51.051 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 116.39559394357228 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:51.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 13}
[aiter INFO] 2025-09-25 11:52:51.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.718999999999994
[aiter INFO] 2025-09-25 11:52:51.113 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999967
[aiter INFO] 2025-09-25 11:52:51.132 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            423.3        CUDA            8
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, (vllm::Fp... 100.0            0.0          2,780.5        CUDA            8
2                                                                            aiter::paged_attention_rocm 100.0        3,203.8              0.0         CPU        56149
[avg us/iter]                                                                                        NaN   NaN           32.0             32.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:51.133 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    32.04 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:51.186 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 184.06824811850444 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:51.400 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {11, 35, 1197}
[aiter INFO] 2025-09-25 11:52:51.401 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.71899999999997
[aiter INFO] 2025-09-25 11:52:51.401 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.719
[aiter INFO] 2025-09-25 11:52:51.401 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.63899999999921
[aiter INFO] 2025-09-25 11:52:51.411 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                               name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_kernel_reshape_noloop_qk 98.0            0.0         10,143.7        CUDA            8
[avg us/iter]                                                   NaN  NaN            0.0            103.5         NaN          NaN
[aiter INFO] 2025-09-25 11:52:51.437 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.309465206200535 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:51.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {699, 6}
[aiter INFO] 2025-09-25 11:52:51.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.719000000000051
[aiter INFO] 2025-09-25 11:52:51.475 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.399000000000001
[aiter INFO] 2025-09-25 11:52:51.487 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            526.3        CUDA            8
[avg us/iter]                                        NaN  NaN            0.0              5.3         NaN          NaN
[aiter INFO] 2025-09-25 11:52:51.488 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton][No Quant]:   108.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:51.581 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.05314906634908 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 38, 12, 51, 25}
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.07899999999995
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.19900000000001
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.32
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.88
[aiter INFO] 2025-09-25 11:52:51.632 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.79899999999998
[aiter INFO] 2025-09-25 11:52:51.644 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0          7,970.0        CUDA            8
[avg us/iter]               NaN  NaN            0.0             83.0         NaN          NaN
[aiter INFO] 2025-09-25 11:52:51.670 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.33201003605777 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:51.981 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-09-25 11:52:51.981 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.278999999999996
[aiter INFO] 2025-09-25 11:52:51.993 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            536.8        CUDA            8
[avg us/iter]                                        NaN   NaN            0.0              5.4         NaN          NaN
[aiter INFO] 2025-09-25 11:52:51.994 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:    88.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:52.032 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 55.96216845482883 us/iter from cuda.Event
[aiter INFO] 2025-09-25 11:52:52.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 9, 15, 23, 28}
[aiter INFO] 2025-09-25 11:52:52.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.47900000000001
[aiter INFO] 2025-09-25 11:52:52.060 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.559
[aiter INFO] 2025-09-25 11:52:52.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.319999999999965
[aiter INFO] 2025-09-25 11:52:52.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.399
[aiter INFO] 2025-09-25 11:52:52.061 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.278999999999996
[aiter INFO] 2025-09-25 11:52:52.074 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  96.0            0.0          3,240.2        CUDA            8
1                            aiter::wrapper_pa_fwd_asm 100.0        3,375.8              0.0         CPU        56149
[avg us/iter]                                      NaN   NaN           33.8             33.8         NaN          NaN
[aiter INFO] 2025-09-25 11:52:52.075 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs  aiter_asm][   Quant]:    33.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-09-25 11:52:52.083 - MainProcess:56149 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:914 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  us_hip_bf16  err_hip_bf16  us_triton_bf16  err_triton_bf16  us_triton_fp8  err_triton_fp8  us_asm_fp8  err fp8
0          7         128    (5, 1)        128          16  torch.bfloat16     1         15.5             0            34.3                0           29.9               0         9.2        0
1          7          32    (5, 1)        128          16  torch.bfloat16     1         13.0             0            19.1                0           17.0               0         7.2        0
2         26         128    (5, 1)        128          16  torch.bfloat16     1         15.3             0            35.0                0           30.2               0         9.3        0
3         26          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            19.6                0           17.3               0         7.3        0
4         57         128    (5, 1)        128          16  torch.bfloat16     1         15.4             0            35.1                0           30.4               0         9.5        0
5         57          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            19.6                0           17.4               0         7.4        0
6         66         128    (5, 1)        128          16  torch.bfloat16     1         15.6             0            35.4                0           30.2               0         9.2        0
7         66          32    (5, 1)        128          16  torch.bfloat16     1         13.0             0            19.2                0           16.8               0         7.3        0
8        109         128    (5, 1)        128          16  torch.bfloat16     1         15.3             0            35.1                0           30.0               0         9.7        0
9        109          32    (5, 1)        128          16  torch.bfloat16     1         13.4             0            19.9                0           17.5               0         7.6        0
10       128         128    (5, 1)        128          16  torch.bfloat16     1         15.8             0            35.9                0           30.6               0         9.5        0
11       128          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            19.4                0           17.5               0         7.7        0
12       256         128    (5, 1)        128          16  torch.bfloat16     1         17.5             0            36.3                0           30.6               0        10.8        0
13       256          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            19.8                0           17.6               0         7.9        0
14       257         128    (5, 1)        128          16  torch.bfloat16     1         21.6             0            64.5                0           53.4               0        14.2        0
15       257          32    (5, 1)        128          16  torch.bfloat16     1         13.2             0            20.2                0           17.5               0         9.9        0
16       282         128    (5, 1)        128          16  torch.bfloat16     1         21.4             0            64.2                0           53.5               0        14.2        0
17       282          32    (5, 1)        128          16  torch.bfloat16     1         13.1             0            20.1                0           18.1               0         9.8        0
18       512         128    (5, 1)        128          16  torch.bfloat16     1         22.7             0            65.7                0           54.3               0        15.5        0
19       512          32    (5, 1)        128          16  torch.bfloat16     1         13.7             0            20.6                0           17.6               0         9.6        0
20       513         128    (5, 1)        128          16  torch.bfloat16     1         25.3             0            81.0                0           66.8               0        18.3        0
21       513          32    (5, 1)        128          16  torch.bfloat16     1         15.5             0            34.4                0           29.4               0        11.7        0
22      4097         128    (5, 1)        128          16  torch.bfloat16     1         93.1             0           420.4                0          337.4               0        70.4        0
23      4097          32    (5, 1)        128          16  torch.bfloat16     1         30.3             0           110.0                0           89.1               0        38.0        0
24      4096         128    (5, 1)        128          16  torch.bfloat16     1         97.1             0           391.1                0          314.1               0        68.1        0
25      4096          32    (5, 1)        128          16  torch.bfloat16     1         29.8             0           108.6                0           87.5               0        36.1        0
26         7         128    (8, 1)        128          16  torch.bfloat16     1         17.6             0            33.8                0           29.6               0         8.9        0
27         7          32    (8, 1)        128          16  torch.bfloat16     1         12.8             0            18.5                0           16.5               0         6.9        0
28        26         128    (8, 1)        128          16  torch.bfloat16     1         17.6             0            34.4                0           29.9               0         9.0        0
29        26          32    (8, 1)        128          16  torch.bfloat16     1         12.8             0            19.0                0           16.7               0         7.3        0
30        57         128    (8, 1)        128          16  torch.bfloat16     1         18.0             0            35.3                0           30.7               0         9.1        0
31        57          32    (8, 1)        128          16  torch.bfloat16     1         12.8             0            19.0                0           17.4               0         7.5        0
32        66         128    (8, 1)        128          16  torch.bfloat16     1         17.9             0            34.9                0           30.1               0         9.3        0
33        66          32    (8, 1)        128          16  torch.bfloat16     1         12.9             0            19.1                0           17.5               0         7.4        0
34       109         128    (8, 1)        128          16  torch.bfloat16     1         17.9             0            35.2                0           30.9               0         9.4        0
35       109          32    (8, 1)        128          16  torch.bfloat16     1         13.0             0            19.3                0           17.5               0         7.5        0
36       128         128    (8, 1)        128          16  torch.bfloat16     1         18.1             0            35.4                0           30.3               0         9.4        0
37       128          32    (8, 1)        128          16  torch.bfloat16     1         13.1             0            19.4                0           17.5               0         7.4        0
38       256         128    (8, 1)        128          16  torch.bfloat16     1         19.9             0            37.1                0           31.4               0        10.7        0
39       256          32    (8, 1)        128          16  torch.bfloat16     1         13.2             0            19.8                0           17.1               0         7.7        0
40       257         128    (8, 1)        128          16  torch.bfloat16     1         24.1             0            64.0                0           53.1               0        14.0        0
41       257          32    (8, 1)        128          16  torch.bfloat16     1         13.2             0            20.0                0           18.1               0         9.8        0
42       282         128    (8, 1)        128          16  torch.bfloat16     1         24.1             0            64.2                0           53.8               0        14.1        0
43       282          32    (8, 1)        128          16  torch.bfloat16     1         13.3             0            20.1                0           18.1               0         9.8        0
44       512         128    (8, 1)        128          16  torch.bfloat16     1         26.7             0            66.0                0           54.2               0        15.4        0
45       512          32    (8, 1)        128          16  torch.bfloat16     1         13.5             0            20.5                0           18.2               0         9.9        0
46       513         128    (8, 1)        128          16  torch.bfloat16     1         28.4             0            81.4                0           67.4               0        18.4        0
47       513          32    (8, 1)        128          16  torch.bfloat16     1         15.5             0            33.8                0           29.5               0        11.7        0
48      4097         128    (8, 1)        128          16  torch.bfloat16     1        102.3             0           421.0                0          339.4               0        71.3        0
49      4097          32    (8, 1)        128          16  torch.bfloat16     1         32.6             0           109.9                0           90.2               0        38.1        0
50      4096         128    (8, 1)        128          16  torch.bfloat16     1         98.7             0           391.5                0          316.3               0        68.2        0
51      4096          32    (8, 1)        128          16  torch.bfloat16     1         31.8             0           108.2                0           88.5               0        36.2        0
52         7         128   (10, 1)        128          16  torch.bfloat16     1         19.4             0            34.1                0           29.8               0         8.9        0
53         7          32   (10, 1)        128          16  torch.bfloat16     1         12.8             0            18.7                0           17.2               0         7.2        0
54        26         128   (10, 1)        128          16  torch.bfloat16     1         19.7             0            35.4                0           30.7               0         9.4        0
55        26          32   (10, 1)        128          16  torch.bfloat16     1         13.1             0            19.7                0           17.5               0         7.4        0
56        57         128   (10, 1)        128          16  torch.bfloat16     1         19.9             0            35.5                0           30.8               0         9.2        0
57        57          32   (10, 1)        128          16  torch.bfloat16     1         12.9             0            19.2                0           17.5               0         7.3        0
58        66         128   (10, 1)        128          16  torch.bfloat16     1         19.7             0            35.7                0           30.4               0         9.3        0
59        66          32   (10, 1)        128          16  torch.bfloat16     1         13.0             0            19.4                0           17.0               0         7.6        0
60       109         128   (10, 1)        128          16  torch.bfloat16     1         20.2             0            36.1                0           31.1               0         9.4        0
61       109          32   (10, 1)        128          16  torch.bfloat16     1         13.0             0            19.4                0           17.0               0         7.7        0
62       128         128   (10, 1)        128          16  torch.bfloat16     1         20.3             0            36.3                0           31.1               0         9.5        0
63       128          32   (10, 1)        128          16  torch.bfloat16     1         13.1             0            19.6                0           17.7               0         7.7        0
64       256         128   (10, 1)        128          16  torch.bfloat16     1         21.7             0            36.7                0           31.2               0        10.9        0
65       256          32   (10, 1)        128          16  torch.bfloat16     1         13.3             0            19.9                0           17.8               0         8.0        0
66       257         128   (10, 1)        128          16  torch.bfloat16     1         25.7             0            64.2                0           54.1               0        13.9        0
67       257          32   (10, 1)        128          16  torch.bfloat16     1         13.6             0            20.7                0           18.2               0         9.8        0
68       282         128   (10, 1)        128          16  torch.bfloat16     1         25.7             0            64.5                0           54.2               0        13.9        0
69       282          32   (10, 1)        128          16  torch.bfloat16     1         13.6             0            20.8                0           18.3               0         9.8        0
70       512         128   (10, 1)        128          16  torch.bfloat16     1         27.9             0            66.1                0           55.3               0        15.5        0
71       512          32   (10, 1)        128          16  torch.bfloat16     1         14.4             0            21.3                0           18.3               0         9.7        0
72       513         128   (10, 1)        128          16  torch.bfloat16     1         30.2             0            81.5                0           67.8               0        17.3        0
73       513          32   (10, 1)        128          16  torch.bfloat16     1         15.8             0            34.6                0           29.7               0        11.4        0
74      4097         128   (10, 1)        128          16  torch.bfloat16     1        107.2             0           422.1                0          341.5               0        65.9        0
75      4097          32   (10, 1)        128          16  torch.bfloat16     1         33.1             0           110.4                0           90.6               0        35.7        0
76      4096         128   (10, 1)        128          16  torch.bfloat16     1         96.9             0           392.3                0          318.4               0        63.4        0
77      4096          32   (10, 1)        128          16  torch.bfloat16     1         32.0             0           108.8                0           88.4               0        33.8        0

[1.0e-04, 1.0e-03): 130223 (79.48%)
[1.0e-03, 1.0e-02): 1484 (0.91%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=736c54023a66bcf169bf71e813d107c5
triton_output_md5=e993d4428135df82cd375525085b6c6f
query.shape=torch.Size([32, 10, 128])
key_cache.shape=torch.Size([32768, 1, 16, 16, 8])
value_cache.shape=torch.Size([32768, 1, 128, 16])
output.shape=torch.Size([32, 10, 128])
block_tables.shape=torch.Size([32, 256])
query.dtype=torch.bfloat16
key_cache.dtype=torch.bfloat16
value_cache.dtype=torch.bfloat16
output.dtype=torch.bfloat16
block_tables.dtype=torch.int32
{'qlen': 1, 'kv_type': triton.language.bfloat16, 'compute_type': triton.language.bfloat16, 'HEAD_SZ': 128, 'HEAD_SZ_POW2': 128, 'QUERY_GRP_SZ': 10, 'QUERY_GRP_SZ_POW2': 16, 'KV_BLK_SZ': 16, 'KV_BLK_SZ_POW2': 16, 'SEQ_PARTITION_SZ': 256}
diff.abs.max=0.001708984375
max_diff_thr=0.001700680237263441

Top differences:
Position (np.int64(0), np.int64(4), np.int64(73)): arr1 = 0.006592, arr2 = 0.004883, Diff = 0.001709
Position (np.int64(7), np.int64(8), np.int64(80)): arr1 = 0.013306, arr2 = 0.011780, Diff = 0.001526
Position (np.int64(19), np.int64(5), np.int64(25)): arr1 = -0.003937, arr2 = -0.002426, Diff = 0.001511
Position (np.int64(5), np.int64(0), np.int64(125)): arr1 = 0.025635, arr2 = 0.024170, Diff = 0.001465
Position (np.int64(10), np.int64(4), np.int64(68)): arr1 = 0.015747, arr2 = 0.014282, Diff = 0.001465

Threshold statistics:
[0.0e+00, 1.0e-06): 1679 (4.10%)
[1.0e-06, 1.0e-05): 123 (0.30%)
[1.0e-05, 1.0e-04): 6102 (14.90%)
[1.0e-04, 1.0e-03): 32650 (79.71%)
[1.0e-03, 1.0e-02): 406 (0.99%)
[1.0e-02, 1.0e-01): 0 (0.00%)
[1.0e-01, 1.0e+00): 0 (0.00%)
[1.0e+00, 1.0e+01): 0 (0.00%)
>=1.0e+01: 0 (0.00%)

NaN info:
{}
out_ref_md5=b6da0bbb57db729f3f4fc370efd952aa
triton_output_md5=36a0ae968bb3c5f67c378670628e048a
++ set +x
