++ shopt -s expand_aliases
++ alias 'l.=ls -d .* --color=auto'
++ alias 'll=ls -l --color=auto'
++ alias 'ls=ls --color=auto'
++ alias 'bk=/opt/rocm/llvm/bin/clang++ -x assembler -target amdgcn--amdhsa --offload-arch=gfx942'
++ alias 'bt=/opt/rocm/bin/hipcc --offload-arch=gfx942  -g mla.cpp -o mla.exe'
++ export HIP_VISIBLE_DEVICES=3
++ HIP_VISIBLE_DEVICES=3
++ rocm-smi
++ egrep '3    |Device'
Device  Node  IDs              Temp        Power     Partitions          SCLK     MCLK    Fan  Perf  PwrCap  VRAM%  GPU%  
1       3     0x74a2,   61531  49.0Â°C      172.0W    NPS1, SPX, 0        1420Mhz  900Mhz  0%   auto  650.0W  87%    0%    
3       5     0x74a2,   50797  45.0Â°C      163.0W    NPS1, SPX, 0        1420Mhz  900Mhz  0%   auto  650.0W  87%    0%    
++ run_triton_op
++ rm -rf /root/.triton/cache
++ export AITER_LOG_MORE=1
++ AITER_LOG_MORE=1
++ export TRITON_PRINT_AUTOTUNING=1
++ TRITON_PRINT_AUTOTUNING=1
++ python ./test_pa_mtp.py
[aiter INFO] 2025-10-23 03:31:00.676 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/core.py:351 - get_module_custom_op
import [module_aiter_enum] under /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/module_aiter_enum.so
[aiter INFO] 2025-10-23 03:31:03.584 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:04.746 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.27175207893447 us/iter from cuda.Event
[W1023 03:31:04.483740292 collection.cpp:1100] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-10-23 03:31:04.892 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 9}
[aiter INFO] 2025-10-23 03:31:04.892 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.079000000000008
[aiter INFO] 2025-10-23 03:31:04.892 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.35900000000004
[aiter INFO] 2025-10-23 03:31:04.913 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            487.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          5,888.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,375.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           63.8             63.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:04.946 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    63.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:06.519 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 326.5480493554975 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:06.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1145, 138, 12, 50, 629, 25, 893}
[aiter INFO] 2025-10-23 03:31:06.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.16100000000006
[aiter INFO] 2025-10-23 03:31:06.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 211.75900000000001
[aiter INFO] 2025-10-23 03:31:06.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.43900000000002
[aiter INFO] 2025-10-23 03:31:06.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.519
[aiter INFO] 2025-10-23 03:31:06.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.39899999999943
[aiter INFO] 2025-10-23 03:31:06.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.83900000000006
[aiter INFO] 2025-10-23 03:31:06.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.4390000000003
[aiter INFO] 2025-10-23 03:31:06.599 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 94.0            0.0         20,022.7        CUDA            5
[avg us/iter]               NaN  NaN            0.0            213.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:06.935 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.86400967600322 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:06.967 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:06.967 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.559000000000026
[aiter INFO] 2025-10-23 03:31:06.979 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            578.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:06.987 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   218.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:07.496 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 177.98000028227816 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:07.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 12, 77, 1143}
[aiter INFO] 2025-10-23 03:31:07.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.11900000000014
[aiter INFO] 2025-10-23 03:31:07.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.438999999999965
[aiter INFO] 2025-10-23 03:31:07.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.999000000000024
[aiter INFO] 2025-10-23 03:31:07.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.83900000000176
[aiter INFO] 2025-10-23 03:31:07.656 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          4,617.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             47.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:07.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 115.18850465222161 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:07.899 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {643, 69, 6}
[aiter INFO] 2025-10-23 03:31:07.899 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.3989999999994325
[aiter INFO] 2025-10-23 03:31:07.899 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.238999999999919
[aiter INFO] 2025-10-23 03:31:07.899 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5190000000000055
[aiter INFO] 2025-10-23 03:31:07.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            570.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:07.912 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    53.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:07.917 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/core.py:351 - get_module_custom_op
import [module_attention_asm] under /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/module_attention_asm.so
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp.co GetFunction: _ZN5aiter35pa_bf16_pertokenFp8_gqa8_2tg_4w_uhpE Success
[aiter INFO] 2025-10-23 03:31:07.948 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 60.26912864186976 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:07.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-10-23 03:31:07.973 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.71900000000002
[aiter INFO] 2025-10-23 03:31:07.988 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp 100.0            0.0          3,977.5        CUDA            5
1                               aiter::wrapper_pa_fwd_asm 100.0        3,977.5              0.0         CPU       239091
[avg us/iter]                                         NaN   NaN           39.8             39.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:07.989 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    39.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:08.016 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.9486835475015 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 27, 31}
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.999000000000024
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.99899999999997
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.399
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.07900000000001
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999999
[aiter INFO] 2025-10-23 03:31:08.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.601
[aiter INFO] 2025-10-23 03:31:08.094 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            472.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          4,470.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,102.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           51.0             51.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:08.095 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    50.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:08.098 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:08.195 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 206.7199008594645 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:08.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:31:08.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 88.03900000000002
[aiter INFO] 2025-10-23 03:31:08.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000024
[aiter INFO] 2025-10-23 03:31:08.264 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            920.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          8,367.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,288.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           92.9             92.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:08.264 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    92.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:09.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 497.62344507887815 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:09.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {347, 12, 1279}
[aiter INFO] 2025-10-23 03:31:09.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.1210000000001
[aiter INFO] 2025-10-23 03:31:09.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 296.76099999999997
[aiter INFO] 2025-10-23 03:31:09.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.0789999999979
[aiter INFO] 2025-10-23 03:31:09.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         28,931.4        CUDA            5
[avg us/iter]               NaN  NaN            0.0            295.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:09.435 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.72352459112017 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:09.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:09.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.919000000000011
[aiter INFO] 2025-10-23 03:31:09.477 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            682.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:09.478 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   302.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:09.807 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 263.58228774354006 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:09.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:31:09.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.47900000000004
[aiter INFO] 2025-10-23 03:31:09.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.239000000000004
[aiter INFO] 2025-10-23 03:31:09.872 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          4,940.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             49.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:10.065 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 108.40788114779066 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:10.105 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:10.105 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.038999999999987
[aiter INFO] 2025-10-23 03:31:10.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            678.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:10.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1.co GetFunction: _ZN5aiter40pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1E Success
[aiter INFO] 2025-10-23 03:31:10.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 57.35310871559795 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 36, 12, 18, 27}
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.59900000000002
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.999000000000024
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.278999999999996
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.35900000000004
[aiter INFO] 2025-10-23 03:31:10.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.07900000000001
[aiter INFO] 2025-10-23 03:31:10.195 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  96.0            0.0          3,493.8        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        3,643.5              0.0         CPU       239091
[avg us/iter]                                              NaN   NaN           36.4             36.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:10.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:10.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 218.816940884779 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:10.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:31:10.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.11899999999997
[aiter INFO] 2025-10-23 03:31:10.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.319000000000017
[aiter INFO] 2025-10-23 03:31:10.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            921.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0          8,883.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,805.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           98.1             98.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:10.426 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    98.05 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:10.430 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:10.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 253.21233759422114 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:10.590 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9, 51, 21}
[aiter INFO] 2025-10-23 03:31:10.591 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999969
[aiter INFO] 2025-10-23 03:31:10.591 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.79900000000004
[aiter INFO] 2025-10-23 03:31:10.591 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.19899999999996
[aiter INFO] 2025-10-23 03:31:10.591 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.59899999999999
[aiter INFO] 2025-10-23 03:31:10.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,205.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         12,417.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,759.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          137.6            137.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:10.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   137.61 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:11.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 191.39231638153 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:11.098 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:11.098 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.03900000000002
[aiter INFO] 2025-10-23 03:31:11.110 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          6,964.3        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             69.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:11.378 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.63032678920443 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:11.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:11.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999993
[aiter INFO] 2025-10-23 03:31:11.424 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            854.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:11.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    78.19 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:11.482 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 217.39755438105897 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:11.537 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:31:11.537 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.399
[aiter INFO] 2025-10-23 03:31:11.537 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.801000000000045
[aiter INFO] 2025-10-23 03:31:11.556 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,207.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         11,887.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,095.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          131.0            131.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:11.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   130.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:11.564 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:11.649 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 251.5168815556139 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:11.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {128, 1062, 1063, 9, 141, 1108, 1109, 23}
[aiter INFO] 2025-10-23 03:31:11.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.19899999999984
[aiter INFO] 2025-10-23 03:31:11.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.4410000000007
[aiter INFO] 2025-10-23 03:31:11.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000378
[aiter INFO] 2025-10-23 03:31:11.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 161.039
[aiter INFO] 2025-10-23 03:31:11.721 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000005
[aiter INFO] 2025-10-23 03:31:11.721 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.5590000000011
[aiter INFO] 2025-10-23 03:31:11.721 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999796
[aiter INFO] 2025-10-23 03:31:11.721 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000033
[aiter INFO] 2025-10-23 03:31:11.740 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,462.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         15,146.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,127.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          171.3            171.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:11.740 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   171.23 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:12.185 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.77138689602955 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:12.237 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:12.237 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.03900000000002
[aiter INFO] 2025-10-23 03:31:12.248 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          7,305.2        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             73.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:12.539 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.01846556203199 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:12.576 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:12.576 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.59899999999999
[aiter INFO] 2025-10-23 03:31:12.588 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            981.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:12.589 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    82.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:12.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 80.88858440370842 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:12.661 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 4}
[aiter INFO] 2025-10-23 03:31:12.661 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.959
[aiter INFO] 2025-10-23 03:31:12.661 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.03900000000002
[aiter INFO] 2025-10-23 03:31:12.677 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  99.0            0.0          6,230.3        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        6,291.3              0.0         CPU       239091
[avg us/iter]                                              NaN   NaN           62.9             62.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:12.678 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:12.770 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 736.2808626477081 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 63, 982, 983, 1084, 1085, 1086, 1087}
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 634.6389999999999
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.7589999999999
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.0430000000015
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999796
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.6790000000037
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.400999999998021
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.8009999999995
[aiter INFO] 2025-10-23 03:31:13.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.639000000002852
[aiter INFO] 2025-10-23 03:31:13.065 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,483.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         61,622.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,075.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          650.8            650.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.065 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   650.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:13.194 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.87461368872388 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17, 1108, 1109, 1110, 1111}
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.519
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.119000000000028
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.55899999999929
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.918999999999869
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.75900000000001
[aiter INFO] 2025-10-23 03:31:13.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.439000000000306
[aiter INFO] 2025-10-23 03:31:13.268 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            844.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0          9,027.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,116.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          101.2            100.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.269 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   100.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.446 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 448.46722749200194 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.522 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {37, 901, 12, 1268, 543}
[aiter INFO] 2025-10-23 03:31:13.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 343.4789999999999
[aiter INFO] 2025-10-23 03:31:13.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 347.2390000000014
[aiter INFO] 2025-10-23 03:31:13.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 347.59899999999993
[aiter INFO] 2025-10-23 03:31:13.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 347.20100000000093
[aiter INFO] 2025-10-23 03:31:13.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 347.3590000000004
[aiter INFO] 2025-10-23 03:31:13.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         33,148.0        CUDA            5
[avg us/iter]               NaN  NaN            0.0            345.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.562 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.65529681786452 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.592 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:13.592 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5589999999999975
[aiter INFO] 2025-10-23 03:31:13.604 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            712.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.605 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   352.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.654 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.77177182636638 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 532, 12}
[aiter INFO] 2025-10-23 03:31:13.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.23899999999998
[aiter INFO] 2025-10-23 03:31:13.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.75900000000001
[aiter INFO] 2025-10-23 03:31:13.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.75900000000001
[aiter INFO] 2025-10-23 03:31:13.719 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          7,137.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             72.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.745 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.54318789680406 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.780 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:13.781 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.199000000000012
[aiter INFO] 2025-10-23 03:31:13.793 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            714.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.794 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    79.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.831 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.57655485667804 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {456, 436, 4, 31}
[aiter INFO] 2025-10-23 03:31:13.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.47900000000027
[aiter INFO] 2025-10-23 03:31:13.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.4390000000003
[aiter INFO] 2025-10-23 03:31:13.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.07900000000001
[aiter INFO] 2025-10-23 03:31:13.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.99899999999997
[aiter INFO] 2025-10-23 03:31:13.874 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  97.0            0.0          6,505.4        CUDA            5
1                               aiter::wrapper_pa_fwd_asm 100.0        6,711.4              0.0         CPU       239091
[avg us/iter]                                         NaN   NaN           67.1             67.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.874 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    67.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.900 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 161.4583656929507 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {930, 9, 17, 20, 922, 28}
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000306
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.44099999999997
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.998999999999967
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.11899999999997
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.96099999999933
[aiter INFO] 2025-10-23 03:31:13.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999983
[aiter INFO] 2025-10-23 03:31:13.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            746.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          6,847.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,748.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           77.5             77.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:13.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    77.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:13.980 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:14.105 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 219.3563666084025 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {899, 838, 776, 9, 21, 888, 826, 764}
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.559000000001106
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.47899999999936
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.59899999999925
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.079
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.559000000000026
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.24099999999999
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.31900000000041
[aiter INFO] 2025-10-23 03:31:14.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.36099999999988
[aiter INFO] 2025-10-23 03:31:14.179 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,286.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         12,513.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,231.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          142.3            142.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.179 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   142.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:14.369 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 585.6756154853518 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1258, 12, 989}
[aiter INFO] 2025-10-23 03:31:14.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 479.1209999999992
[aiter INFO] 2025-10-23 03:31:14.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 481.51899999999995
[aiter INFO] 2025-10-23 03:31:14.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 476.96099999999933
[aiter INFO] 2025-10-23 03:31:14.471 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         46,854.5        CUDA            5
[avg us/iter]               NaN  NaN            0.0            478.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.498 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.46442555732067 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.527 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:14.527 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999997
[aiter INFO] 2025-10-23 03:31:14.539 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            823.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.540 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   486.34 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:14.591 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.24697977245444 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77, 493, 272, 532, 25}
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.63900000000001
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.43899999999996
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.79899999999998
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.63900000000012
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.51900000000023
[aiter INFO] 2025-10-23 03:31:14.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.839
[aiter INFO] 2025-10-23 03:31:14.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 95.0            0.0          7,217.1        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             76.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.05410887935373 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.718 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:14.718 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-10-23 03:31:14.730 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            824.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.731 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    84.21 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:14.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 86.91433625351084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:14.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {17, 4, 462, 31}
[aiter INFO] 2025-10-23 03:31:14.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.87899999999999
[aiter INFO] 2025-10-23 03:31:14.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.55900000000003
[aiter INFO] 2025-10-23 03:31:14.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.80100000000039
[aiter INFO] 2025-10-23 03:31:14.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.76099999999997
[aiter INFO] 2025-10-23 03:31:14.981 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  97.0            0.0          6,789.1        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        7,000.6              0.0         CPU       239091
[avg us/iter]                                              NaN   NaN           70.0             70.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:14.982 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    69.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:15.020 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 237.7683067380792 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:15.087 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21}
[aiter INFO] 2025-10-23 03:31:15.087 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.199
[aiter INFO] 2025-10-23 03:31:15.087 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.238999999999976
[aiter INFO] 2025-10-23 03:31:15.106 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,325.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         14,059.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,384.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          153.8            153.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:15.107 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   153.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:15.113 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:15.247 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 295.813652843532 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:15.314 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:31:15.314 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.08099999999996
[aiter INFO] 2025-10-23 03:31:15.314 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-10-23 03:31:15.334 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,771.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         19,667.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,439.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          214.4            214.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:15.334 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   214.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:15.497 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 230.42374273928084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:15.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1182}
[aiter INFO] 2025-10-23 03:31:15.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 109.55899999999997
[aiter INFO] 2025-10-23 03:31:15.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 109.07899999999972
[aiter INFO] 2025-10-23 03:31:15.569 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         10,637.4        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            107.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:15.596 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.35428687428484 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:15.627 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:15.627 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999988
[aiter INFO] 2025-10-23 03:31:15.639 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,135.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:15.640 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   118.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:15.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 291.48571414522604 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:15.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:31:15.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 189.599
[aiter INFO] 2025-10-23 03:31:15.769 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.799000000000035
[aiter INFO] 2025-10-23 03:31:15.788 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,767.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         18,803.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,570.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          205.7            205.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:15.788 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   205.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:15.798 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:15.922 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 352.51561308851336 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1088, 1089, 643, 9, 620, 1100, 1101, 28}
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 247.11899999999878
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.879000000000815
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.998999999999796
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 249.11900000000003
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 247.03899999999976
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 247.3610000000008
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.638999999999214
[aiter INFO] 2025-10-23 03:31:16.000 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.158999999999992
[aiter INFO] 2025-10-23 03:31:16.019 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,200.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         23,904.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       26,914.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          269.1            269.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:16.020 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   269.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:16.194 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 235.15840656686538 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:16.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 805}
[aiter INFO] 2025-10-23 03:31:16.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.839
[aiter INFO] 2025-10-23 03:31:16.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.47899999999998
[aiter INFO] 2025-10-23 03:31:16.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.83899999999994
[aiter INFO] 2025-10-23 03:31:16.257 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         10,968.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            111.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:16.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.36417840317924 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:16.316 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:16.316 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.479000000000013
[aiter INFO] 2025-10-23 03:31:16.329 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,252.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             12.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:16.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   124.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:16.380 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.29313815702307 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:16.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {481, 28, 4}
[aiter INFO] 2025-10-23 03:31:16.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.67900000000009
[aiter INFO] 2025-10-23 03:31:16.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.161
[aiter INFO] 2025-10-23 03:31:16.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.59899999999999
[aiter INFO] 2025-10-23 03:31:16.435 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  98.0            0.0         12,090.9        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0       12,335.7              0.0         CPU       239091
[avg us/iter]                                              NaN   NaN          123.4            123.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:16.435 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   123.38 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:16.573 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1119.4496662309855 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:16.723 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 99}
[aiter INFO] 2025-10-23 03:31:16.723 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1019.483
[aiter INFO] 2025-10-23 03:31:16.723 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.239000000000033
[aiter INFO] 2025-10-23 03:31:16.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,259.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0        101,370.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      103,630.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,036.3          1,036.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:16.743 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1036.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:16.757 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:16.844 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.51529739516798 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:17.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {259, 999, 9, 394, 75, 1007, 17, 402, 83, 20, 405, 251, 28, 413}
[aiter INFO] 2025-10-23 03:31:17.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999905
[aiter INFO] 2025-10-23 03:31:17.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.55899999999929
[aiter INFO] 2025-10-23 03:31:17.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.759000000000015
[aiter INFO] 2025-10-23 03:31:17.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.23900000000003
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.55899999999997
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.998999999999796
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000092
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.15899999999999
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.19900000000007
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.639000000000124
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000024
[aiter INFO] 2025-10-23 03:31:17.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-10-23 03:31:17.076 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            654.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  94.0            0.0          5,579.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,644.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           66.4             66.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:17.077 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    66.32 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:17.732 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 321.30323778284657 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:17.802 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 1275, 116, 12}
[aiter INFO] 2025-10-23 03:31:17.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.87900000000002
[aiter INFO] 2025-10-23 03:31:17.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 213.1989999999987
[aiter INFO] 2025-10-23 03:31:17.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 213.19900000000007
[aiter INFO] 2025-10-23 03:31:17.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.75899999999996
[aiter INFO] 2025-10-23 03:31:17.815 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         20,778.5        CUDA            5
[avg us/iter]               NaN  NaN            0.0            214.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.010 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.37333664209535 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:18.043 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:18.043 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000024
[aiter INFO] 2025-10-23 03:31:18.055 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            633.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   220.54 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:18.376 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.5597426631663 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:18.430 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:18.430 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.11900000000003
[aiter INFO] 2025-10-23 03:31:18.442 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          4,833.3        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             48.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.640 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 95.16468297431965 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:18.682 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {692, 6}
[aiter INFO] 2025-10-23 03:31:18.682 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.798999999999978
[aiter INFO] 2025-10-23 03:31:18.682 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:31:18.695 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            626.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.696 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    54.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_2tg_4w.co GetFunction: _ZN5aiter32pa_bf16_pertokenFp8_gqa16_2tg_4wE Success
[aiter INFO] 2025-10-23 03:31:18.730 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 53.78236617929864 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:18.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 27, 12, 4}
[aiter INFO] 2025-10-23 03:31:18.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.12100000000004
[aiter INFO] 2025-10-23 03:31:18.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.718999999999994
[aiter INFO] 2025-10-23 03:31:18.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.198999999999984
[aiter INFO] 2025-10-23 03:31:18.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.43899999999999
[aiter INFO] 2025-10-23 03:31:18.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  97.0            0.0          3,495.5        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        3,605.6              0.0         CPU       239091
[avg us/iter]                                      NaN   NaN           36.1             36.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:18.795 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.52044522998355 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:18.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 460, 16, 1010, 20, 468, 1017, 27, 31}
[aiter INFO] 2025-10-23 03:31:18.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.879000000000019
[aiter INFO] 2025-10-23 03:31:18.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.278999999999996
[aiter INFO] 2025-10-23 03:31:18.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.71900000000005
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.878999999998996
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.15899999999999
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.198999999999614
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.879000000000815
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:31:18.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.11900000000003
[aiter INFO] 2025-10-23 03:31:18.878 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            664.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          4,477.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,364.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           53.6             53.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:18.878 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    53.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:18.881 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:18.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.42791075399606 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:19.024 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:31:19.024 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.11899999999997
[aiter INFO] 2025-10-23 03:31:19.024 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-10-23 03:31:19.043 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,158.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          8,468.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,627.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           96.3             96.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:19.043 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    96.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:19.926 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 408.20293113736824 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1313, 1091, 1258, 1292, 12, 719, 756, 1302, 409}
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.6010000000024
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.6810000000005
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.71899999999914
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.64100000000326
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 298.919
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.7610000000004
[aiter INFO] 2025-10-23 03:31:20.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.6790000000001
[aiter INFO] 2025-10-23 03:31:20.004 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.59899999999834
[aiter INFO] 2025-10-23 03:31:20.004 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 294.4409999999998
[aiter INFO] 2025-10-23 03:31:20.016 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 92.0            0.0         27,222.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            295.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:20.292 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.54914843504972 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:20.324 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:20.324 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000001
[aiter INFO] 2025-10-23 03:31:20.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            818.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:20.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   304.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:20.710 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 191.69293107962847 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:20.936 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 77}
[aiter INFO] 2025-10-23 03:31:20.937 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.31900000000002
[aiter INFO] 2025-10-23 03:31:20.937 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.279
[aiter INFO] 2025-10-23 03:31:20.949 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          6,524.4        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             65.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:21.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.07785188797678 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:21.271 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:21.271 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-10-23 03:31:21.283 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            820.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:21.285 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    74.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1.co GetFunction: _ZN5aiter41pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1E Success
[aiter INFO] 2025-10-23 03:31:21.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 80.00068292759433 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:21.353 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 473, 4}
[aiter INFO] 2025-10-23 03:31:21.354 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.07899999999998
[aiter INFO] 2025-10-23 03:31:21.354 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.95899999999983
[aiter INFO] 2025-10-23 03:31:21.354 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.63899999999998
[aiter INFO] 2025-10-23 03:31:21.369 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0          6,126.3        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        6,249.3              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN           62.5             62.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:21.370 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.51 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:21.401 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 186.9000293830834 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:21.466 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 42, 17, 51, 20, 28}
[aiter INFO] 2025-10-23 03:31:21.466 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.71900000000002
[aiter INFO] 2025-10-23 03:31:21.467 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.83900000000006
[aiter INFO] 2025-10-23 03:31:21.467 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.838999999999999
[aiter INFO] 2025-10-23 03:31:21.467 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-10-23 03:31:21.467 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.59900000000005
[aiter INFO] 2025-10-23 03:31:21.467 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.439000000000021
[aiter INFO] 2025-10-23 03:31:21.486 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,062.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          8,944.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,217.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          102.2            102.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:21.486 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   102.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:21.491 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:21.590 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.52311925958878 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:21.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {19, 9, 691, 703}
[aiter INFO] 2025-10-23 03:31:21.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.798999999999978
[aiter INFO] 2025-10-23 03:31:21.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.999
[aiter INFO] 2025-10-23 03:31:21.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.1210000000001
[aiter INFO] 2025-10-23 03:31:21.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59900000000016
[aiter INFO] 2025-10-23 03:31:21.667 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,431.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         12,849.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,423.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          144.2            144.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:21.668 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   144.25 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:22.103 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.18595968142594 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:22.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {857, 506, 12, 935}
[aiter INFO] 2025-10-23 03:31:22.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.1210000000001
[aiter INFO] 2025-10-23 03:31:22.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.59900000000016
[aiter INFO] 2025-10-23 03:31:22.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.07900000000001
[aiter INFO] 2025-10-23 03:31:22.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.71900000000096
[aiter INFO] 2025-10-23 03:31:22.172 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          6,530.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             67.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:22.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.08580216971956 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:22.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:22.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.919000000000011
[aiter INFO] 2025-10-23 03:31:22.484 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            928.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:22.485 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    76.62 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:22.530 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 107.45146509149286 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:22.560 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {59, 4, 21, 437}
[aiter INFO] 2025-10-23 03:31:22.560 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.71900000000005
[aiter INFO] 2025-10-23 03:31:22.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.43900000000002
[aiter INFO] 2025-10-23 03:31:22.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 88.31899999999999
[aiter INFO] 2025-10-23 03:31:22.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.56100000000015
[aiter INFO] 2025-10-23 03:31:22.576 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0          8,738.8        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        9,008.4              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN           90.1             90.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:22.577 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    90.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:22.613 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 222.1088415325278 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:22.679 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:31:22.679 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.399
[aiter INFO] 2025-10-23 03:31:22.679 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.399000000000001
[aiter INFO] 2025-10-23 03:31:22.699 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,451.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,255.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,707.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          137.1            137.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:22.699 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   137.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:22.707 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:22.808 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.2539210815241 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:22.868 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {208, 9, 221, 23}
[aiter INFO] 2025-10-23 03:31:22.868 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 161.11900000000014
[aiter INFO] 2025-10-23 03:31:22.868 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.75900000000001
[aiter INFO] 2025-10-23 03:31:22.868 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.399000000000342
[aiter INFO] 2025-10-23 03:31:22.868 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.599000000000046
[aiter INFO] 2025-10-23 03:31:22.887 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,787.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,834.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,800.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          178.0            178.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:22.887 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   177.99 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:23.589 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 220.82051516759512 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:23.649 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {714, 12, 1013}
[aiter INFO] 2025-10-23 03:31:23.649 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.48099999999977
[aiter INFO] 2025-10-23 03:31:23.649 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.959
[aiter INFO] 2025-10-23 03:31:23.649 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.35900000000038
[aiter INFO] 2025-10-23 03:31:23.662 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          9,842.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.00066350415202 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 6, 104, 13, 20, 90}
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000008
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15900000000002
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999805
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000033
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:31:24.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-10-23 03:31:24.122 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          1,015.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             10.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.123 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   111.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:24.175 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.38264395104775 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.210 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 4}
[aiter INFO] 2025-10-23 03:31:24.210 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.96100000000001
[aiter INFO] 2025-10-23 03:31:24.210 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.799
[aiter INFO] 2025-10-23 03:31:24.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  99.0            0.0         11,640.1        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       11,756.0              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          117.6            117.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.226 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   117.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:24.320 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 737.4408699498318 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.440 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9, 1020, 1021}
[aiter INFO] 2025-10-23 03:31:24.440 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.438999999999965
[aiter INFO] 2025-10-23 03:31:24.440 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 635.8389999999999
[aiter INFO] 2025-10-23 03:31:24.440 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.1189999999988
[aiter INFO] 2025-10-23 03:31:24.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.159000000006927
[aiter INFO] 2025-10-23 03:31:24.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,809.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         62,895.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,364.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          653.6            653.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   653.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:24.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:24.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.77915788286984 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 16, 1070, 1080, 1083, 1094, 1095, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111}
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.87900000000002
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.8390000000000555
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.95899999999892
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000001179
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.95899999999892
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.519000000000233
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.24099999999999
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.398999999999432
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.4390000000003
[aiter INFO] 2025-10-23 03:31:24.642 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.638999999999214
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.67900000000009
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.398999999999432
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.6810000000005
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.438999999998487
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.79900000000089
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.47899999999936
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.27900000000045
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.35899999999856
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.31900000000132
[aiter INFO] 2025-10-23 03:31:24.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000524
[aiter INFO] 2025-10-23 03:31:24.662 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            901.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  91.0            0.0          8,346.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,260.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          102.6            101.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.662 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   101.63 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:24.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 446.7817028560261 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1283, 12, 1253, 1302}
[aiter INFO] 2025-10-23 03:31:24.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 345.9190000000017
[aiter INFO] 2025-10-23 03:31:24.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 349.919
[aiter INFO] 2025-10-23 03:31:24.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 346.0410000000011
[aiter INFO] 2025-10-23 03:31:24.911 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 348.882999999998
[aiter INFO] 2025-10-23 03:31:24.923 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         33,688.0        CUDA            5
[avg us/iter]               NaN  NaN            0.0            347.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.949 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.59070313035852 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:24.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:24.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.679000000000002
[aiter INFO] 2025-10-23 03:31:24.991 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            735.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:24.992 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   354.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:25.040 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.55508891662748 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.092 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 766}
[aiter INFO] 2025-10-23 03:31:25.093 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.559
[aiter INFO] 2025-10-23 03:31:25.093 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.47900000000027
[aiter INFO] 2025-10-23 03:31:25.105 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          7,265.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             73.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:25.131 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.9590295942703 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:25.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.198999999999984
[aiter INFO] 2025-10-23 03:31:25.177 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            741.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:25.178 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    80.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:25.214 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 77.09569292198313 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 486, 462, 303, 441, 30}
[aiter INFO] 2025-10-23 03:31:25.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.03899999999999
[aiter INFO] 2025-10-23 03:31:25.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.878999999999905
[aiter INFO] 2025-10-23 03:31:25.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.91899999999987
[aiter INFO] 2025-10-23 03:31:25.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.919000000000096
[aiter INFO] 2025-10-23 03:31:25.242 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.92099999999982
[aiter INFO] 2025-10-23 03:31:25.242 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.55900000000003
[aiter INFO] 2025-10-23 03:31:25.257 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  95.0            0.0          5,877.1        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        6,189.3              0.0         CPU       239091
[avg us/iter]                                      NaN   NaN           61.9             61.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:25.257 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    61.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:25.283 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 160.96052497920425 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 897, 9, 273, 17, 20, 152, 281, 28, 889}
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.398999999999887
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.23899999999998
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.279
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.75900000000001
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.59900000000016
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.159000000000106
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-10-23 03:31:25.342 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.23900000000049
[aiter INFO] 2025-10-23 03:31:25.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            901.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          6,788.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,007.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           80.1             80.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:25.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    80.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:25.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:25.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 222.90254450670562 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.543 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:31:25.543 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.599
[aiter INFO] 2025-10-23 03:31:25.543 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.881000000000029
[aiter INFO] 2025-10-23 03:31:25.562 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,560.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         13,042.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,603.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          146.0            146.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:25.562 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   146.03 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:25.749 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 583.1714939362932 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:25.973 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {306, 1291, 12}
[aiter INFO] 2025-10-23 03:31:25.973 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 482.201
[aiter INFO] 2025-10-23 03:31:25.973 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 482.00300000000425
[aiter INFO] 2025-10-23 03:31:25.973 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 484.96099999999996
[aiter INFO] 2025-10-23 03:31:25.985 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         47,064.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            480.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.012 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.55628742734984 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.041 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:26.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.119
[aiter INFO] 2025-10-23 03:31:26.054 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            986.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.055 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   490.12 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001662510447204113

NaN info:
{}
out_ref_md5=1a8b2eac773cea76267e29f8cfa9dfe8
triton_fp8_output_md5=4fd44610074537b77f0eb00d2a14427e
diff.abs.max=0.001220703125
max_diff_thr=0.001210214220918715

NaN info:
{}
out_ref_md5=1a8b2eac773cea76267e29f8cfa9dfe8
gluon_fp8_output_md5=9dc35ed1b5d5f9086fa469c2afb6cdd4
diff.abs.max=0.0003662109375
max_diff_thr=0.0003637686313595623

NaN info:
{}
diff.abs.max=0.00360107421875
max_diff_thr=0.003562371712177992

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017923287814483047

NaN info:
{}
out_ref_md5=1823acf55313993aad6d1f91e73dbffc
triton_fp8_output_md5=630dbfce7830b6e6123a023ea6205a9d
diff.abs.max=0.001220703125
max_diff_thr=0.0012035142863169312

NaN info:
{}
out_ref_md5=1823acf55313993aad6d1f91e73dbffc
gluon_fp8_output_md5=1077bdc0e2199e1c03aa9f8d15ac5d67
diff.abs.max=0.001220703125
max_diff_thr=0.0012192705180495977

NaN info:
{}
diff.abs.max=0.003082275390625
max_diff_thr=0.003073739353567362

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012161751510575414

NaN info:
{}
out_ref_md5=c02a9323583b8855cec71d57043ca729
gluon_fp8_output_md5=109a04abece728acbc7c97db805d824e
diff.abs.max=0.00311279296875
max_diff_thr=0.003060489660128951

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012022843584418297

NaN info:
{}
out_ref_md5=64e528d0980985f6006165b6fdaa2d01
gluon_fp8_output_md5=1cb05ddc18ba2f1558afb70e3f16be84
diff.abs.max=0.0011749267578125
max_diff_thr=0.0011701061157509685

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0030882887076586485

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00189208984375
max_diff_thr=0.0018644373631104827

NaN info:
{}
out_ref_md5=d37b1fca4e41576d51d2ec182433d8c2
triton_fp8_output_md5=fc78c1eeb80540ea09a90c3ea4504fd7
diff.abs.max=0.0010986328125
max_diff_thr=0.001092232996597886

NaN info:
{}
out_ref_md5=d37b1fca4e41576d51d2ec182433d8c2
gluon_fp8_output_md5=1d081b8c7507bcf761d088839efa5dba
diff.abs.max=0.00048828125
max_diff_thr=0.00047303689643740654

NaN info:
{}
diff.abs.max=0.00295257568359375
max_diff_thr=0.002948503941297531

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016912297578528523

NaN info:
{}
out_ref_md5=450ea234a1c9057b042a4ee6d8b66517
triton_fp8_output_md5=f30c74873d643b75d806e19515d37153
diff.abs.max=0.001247406005859375
max_diff_thr=0.0012471823720261455

NaN info:
{}
out_ref_md5=450ea234a1c9057b042a4ee6d8b66517
gluon_fp8_output_md5=85c5763f642333cc6ad35704580aa0d6
diff.abs.max=0.001232147216796875
max_diff_thr=0.0012314378982409835

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0031293253414332867

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001190185546875
max_diff_thr=0.00118533824570477

NaN info:
{}
out_ref_md5=e22dd14a46d06d4bab9ab4dd40236f59
gluon_fp8_output_md5=a076ac3a55cea57d30f781e49eb6d33d
diff.abs.max=0.0035400390625
max_diff_thr=0.0034597949124872684

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012072920799255371

NaN info:
{}
out_ref_md5=4783c07286319c03d1a49c25238ceab3
gluon_fp8_output_md5=d7ec956d3e1b43ea994711117041ced6
diff.abs.max=0.001190185546875
max_diff_thr=0.0011881730752065778

NaN info:
{}
diff.abs.max=0.0034360885620117188
max_diff_thr=0.003423551097512245

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016901068156585097

NaN info:
{}
out_ref_md5=d0996160e4ca81eb20673f9d4265e9d3
triton_fp8_output_md5=4206df5fab9b2a8d78db3f56ea546377
diff.abs.max=0.001129150390625
max_diff_thr=0.0011224024929106236

NaN info:
{}
out_ref_md5=d0996160e4ca81eb20673f9d4265e9d3
gluon_fp8_output_md5=5e85d2414de201a1ed76c0ed28d1031e
diff.abs.max=0.0010986328125
max_diff_thr=0.0010920673375949264

NaN info:
{}
diff.abs.max=0.00299072265625
max_diff_thr=0.0029653836973011494

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018028846243396401

NaN info:
{}
out_ref_md5=0e3c197c69735d483900380c4307db08
triton_fp8_output_md5=b05164b0ea01e24fe944227f53a12bb8
diff.abs.max=0.00115966796875
max_diff_thr=0.0011569669004529715

NaN info:
{}
out_ref_md5=0e3c197c69735d483900380c4307db08
gluon_fp8_output_md5=68c060f635dddb67af03400c84fde5e4
diff.abs.max=0.0011749267578125
max_diff_thr=0.00117099576164037

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.003218362806364894

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012627021642401814

NaN info:
{}
out_ref_md5=3d3c73b44b3bc788203d1251ba49c3fa
gluon_fp8_output_md5=caeb832ce389445a8d466da9f16237b1
diff.abs.max=0.001190185546875
max_diff_thr=0.0011823555687442422

NaN info:
{}
diff.abs.max=0.00307464599609375
max_diff_thr=0.003069377038627863

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012614127481356263

NaN info:
{}
out_ref_md5=df0ecacdd2047519af1c750654fbacb2
gluon_fp8_output_md5=738b9b5ff9aa2f77717c394643b2dc67
diff.abs.max=0.001373291015625
max_diff_thr=0.0013623153790831566

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.0030030030757188797

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017893355106934905

NaN info:
{}
out_ref_md5=07f0e6d05d3be702284ebe2ec428fbc4
triton_fp8_output_md5=2bf5daf01bed42784bcc12e55287d87f
diff.abs.max=0.001251220703125
max_diff_thr=0.0012452165829017758

NaN info:
{}
out_ref_md5=07f0e6d05d3be702284ebe2ec428fbc4
gluon_fp8_output_md5=f63715eee3acd00c749319e9ac2849d5
diff.abs.max=0.0011692047119140625
max_diff_thr=0.0011682109907269478

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003161478554829955

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875[aiter INFO] 2025-10-23 03:31:26.119 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 278.87140598037456 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.184 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {896, 12, 701, 38}
[aiter INFO] 2025-10-23 03:31:26.184 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.51900000000023
[aiter INFO] 2025-10-23 03:31:26.184 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.719
[aiter INFO] 2025-10-23 03:31:26.185 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.55899999999929
[aiter INFO] 2025-10-23 03:31:26.185 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.55900000000008
[aiter INFO] 2025-10-23 03:31:26.197 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          9,770.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.224 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.36616841106132 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.259 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:26.259 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.119
[aiter INFO] 2025-10-23 03:31:26.272 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            987.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.273 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   110.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:26.318 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.22066370803532 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.355 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 4, 505, 431}
[aiter INFO] 2025-10-23 03:31:26.355 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.63900000000001
[aiter INFO] 2025-10-23 03:31:26.355 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.35900000000001
[aiter INFO] 2025-10-23 03:31:26.355 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.03900000000067
[aiter INFO] 2025-10-23 03:31:26.355 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.12099999999964
[aiter INFO] 2025-10-23 03:31:26.370 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0         11,888.7        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       12,254.5              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          122.5            122.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   122.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:26.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 240.47917762015126 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {58, 37, 70, 807, 1080, 9, 559, 22, 824, 1081, 26, 571}
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.159
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.598999999999933
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.3189999999995
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.27900000000045
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.239
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.5590000000002
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.998999999999967
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999542
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.798999999999069
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.71899999999994
[aiter INFO] 2025-10-23 03:31:26.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.47899999999936
[aiter INFO] 2025-10-23 03:31:26.495 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,480.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0         13,711.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,992.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          159.9            159.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.496 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   159.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:26.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:26.634 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 304.0572478629575 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.699 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {26, 9, 1010, 1011, 1082, 1083}
[aiter INFO] 2025-10-23 03:31:26.699 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.959000000000003
[aiter INFO] 2025-10-23 03:31:26.700 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 205.47899999999998
[aiter INFO] 2025-10-23 03:31:26.700 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.88100000000122
[aiter INFO] 2025-10-23 03:31:26.700 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.27900000000045
[aiter INFO] 2025-10-23 03:31:26.700 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.2390000000014
[aiter INFO] 2025-10-23 03:31:26.700 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.758999999998196
[aiter INFO] 2025-10-23 03:31:26.719 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,110.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         19,948.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,509.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          225.1            225.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.719 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   225.09 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:26.876 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 223.14769236168058 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.930 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1234, 818, 12, 77}
[aiter INFO] 2025-10-23 03:31:26.930 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.19900000000052
[aiter INFO] 2025-10-23 03:31:26.930 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.27900000000045
[aiter INFO] 2025-10-23 03:31:26.930 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.03899999999999
[aiter INFO] 2025-10-23 03:31:26.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.71900000000005
[aiter INFO] 2025-10-23 03:31:26.943 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         10,004.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            103.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:26.969 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.71388103643267 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.081000000000017
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999942
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.91900000000004
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.958999999999946
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.959000000000003
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.839000000000055
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.07899999999995
[aiter INFO] 2025-10-23 03:31:26.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999983
[aiter INFO] 2025-10-23 03:31:27.011 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 89.0            0.0          1,039.2        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.012 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   114.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:27.071 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.0014160600039 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:27.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 37, 463}
[aiter INFO] 2025-10-23 03:31:27.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 179.719
[aiter INFO] 2025-10-23 03:31:27.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 176.159
[aiter INFO] 2025-10-23 03:31:27.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 178.24099999999999
[aiter INFO] 2025-10-23 03:31:27.130 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0         17,393.2        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       17,747.6              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          177.5            177.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.131 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   177.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:27.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 298.37444572165464 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:27.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:31:27.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 194.59900000000002
[aiter INFO] 2025-10-23 03:31:27.246 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.63900000000001
[aiter INFO] 2025-10-23 03:31:27.265 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,158.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         19,302.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,460.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          214.6            214.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.265 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   214.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:27.279 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:27.414 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 362.31841633815577 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:27.613 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 34}
[aiter INFO] 2025-10-23 03:31:27.613 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 255.161
[aiter INFO] 2025-10-23 03:31:27.613 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-10-23 03:31:27.632 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,746.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         25,333.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       28,079.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          280.8            280.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   280.79 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:27.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 274.74581310064485 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:27.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 548, 12}
[aiter INFO] 2025-10-23 03:31:27.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.401
[aiter INFO] 2025-10-23 03:31:27.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.64099999999962
[aiter INFO] 2025-10-23 03:31:27.858 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.63899999999998
[aiter INFO] 2025-10-23 03:31:27.871 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         15,358.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            156.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.897 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.85768339539518 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.238999999999976
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.519000000000005
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.59899999999999
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.158999999999992
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.19900000000007
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.959000000000003
[aiter INFO] 2025-10-23 03:31:27.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.19900000000007
[aiter INFO] 2025-10-23 03:31:27.928 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119000000000028
[aiter INFO] 2025-10-23 03:31:27.928 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.999000000000024
[aiter INFO] 2025-10-23 03:31:27.940 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,348.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:27.941 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   171.54 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:28.010 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.09509869849327 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:28.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {49, 4}
[aiter INFO] 2025-10-23 03:31:28.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 230.91900000000004
[aiter INFO] 2025-10-23 03:31:28.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.921
[aiter INFO] 2025-10-23 03:31:28.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  99.0            0.0         23,028.8        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       23,259.7              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          232.6            232.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:28.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   232.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:28.213 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1127.109119207552 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:28.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 98, 1068, 1069}
[aiter INFO] 2025-10-23 03:31:28.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1021.3210000000001
[aiter INFO] 2025-10-23 03:31:28.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.838999999999942
[aiter INFO] 2025-10-23 03:31:28.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1022.9610000000102
[aiter INFO] 2025-10-23 03:31:28.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.519000000000233
[aiter INFO] 2025-10-23 03:31:28.383 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,715.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0        100,730.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      104,496.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,045.0          1,044.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:28.384 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1044.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:28.399 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:28.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 140.29948516647414 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:28.536 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 14}
[aiter INFO] 2025-10-23 03:31:28.536 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.959
[aiter INFO] 2025-10-23 03:31:28.536 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-10-23 03:31:28.558 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            924.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          6,071.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,995.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           70.0             70.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:28.559 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    69.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:29.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 312.4802561089544 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1284, 327, 75, 12, 943}
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.07899999999972
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.08100000000013
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.92100000000005
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 206.51899999999998
[aiter INFO] 2025-10-23 03:31:29.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.15899999999965
[aiter INFO] 2025-10-23 03:31:29.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         19,590.4        CUDA            5
[avg us/iter]               NaN  NaN            0.0            204.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:29.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.26077231558241 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:29.356 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:29.356 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000025
[aiter INFO] 2025-10-23 03:31:29.368 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            680.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:29.369 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   210.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:29.686 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.52253494522358 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:29.738 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38}
[aiter INFO] 2025-10-23 03:31:29.738 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.71900000000005
[aiter INFO] 2025-10-23 03:31:29.738 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.55899999999997
[aiter INFO] 2025-10-23 03:31:29.738 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.99899999999997
[aiter INFO] 2025-10-23 03:31:29.750 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          4,868.4        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             49.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:29.776 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.51744552000915 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:29.815 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:29.815 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999999975
[aiter INFO] 2025-10-23 03:31:29.827 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            682.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:29.828 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:29.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 51.33796048046339 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:29.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {27, 4}
[aiter INFO] 2025-10-23 03:31:29.886 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.321000000000026
[aiter INFO] 2025-10-23 03:31:29.886 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.519000000000005
[aiter INFO] 2025-10-23 03:31:29.901 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          3,613.5        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        3,651.8              0.0         CPU       239091
[avg us/iter]                                      NaN   NaN           36.5             36.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:29.902 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:29.926 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.1695643805041 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {482, 9, 490, 845, 526, 16, 273, 20, 853, 534, 281, 27}
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.59900000000016
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.198999999999984
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.079000000000633
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.59900000000016
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.60100000000057
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.118999999999971
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.39899999999989
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.19900000000001
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.118999999999687
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999869
[aiter INFO] 2025-10-23 03:31:30.118 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.999000000000251
[aiter INFO] 2025-10-23 03:31:30.119 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.119000000000028
[aiter INFO] 2025-10-23 03:31:30.137 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            850.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0          4,565.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,696.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           57.0             57.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:30.138 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    57.01 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:30.143 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:30.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 177.3419692964837 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:30.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:31:30.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.95899999999995
[aiter INFO] 2025-10-23 03:31:30.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.041
[aiter INFO] 2025-10-23 03:31:30.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.59899999999999
[aiter INFO] 2025-10-23 03:31:30.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999976
[aiter INFO] 2025-10-23 03:31:30.306 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,497.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          8,682.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,286.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          102.9            102.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:30.306 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   102.83 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:31.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 394.8508037789033 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:31.782 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1313, 211, 12, 62}
[aiter INFO] 2025-10-23 03:31:31.782 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 285.51900000000023
[aiter INFO] 2025-10-23 03:31:31.782 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 285.48099999999977
[aiter INFO] 2025-10-23 03:31:31.783 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.24100000000004
[aiter INFO] 2025-10-23 03:31:31.783 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 287.8789999999999
[aiter INFO] 2025-10-23 03:31:31.795 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         27,779.4        CUDA            5
[avg us/iter]               NaN  NaN            0.0            286.4         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.085 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.698832117685 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:32.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:32.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.359000000000009
[aiter INFO] 2025-10-23 03:31:32.129 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            954.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.130 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   295.93 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:32.501 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 188.18952453018414 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:32.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {467, 1260, 12, 1247}
[aiter INFO] 2025-10-23 03:31:32.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.83899999999994
[aiter INFO] 2025-10-23 03:31:32.555 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.79900000000089
[aiter INFO] 2025-10-23 03:31:32.556 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.31900000000002
[aiter INFO] 2025-10-23 03:31:32.556 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.91899999999987
[aiter INFO] 2025-10-23 03:31:32.568 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          6,567.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             67.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.594 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.57963385853436 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:32.632 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:32.632 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-10-23 03:31:32.645 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            956.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    77.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:32.687 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.36936606038915 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:32.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {505, 484, 4, 14}
[aiter INFO] 2025-10-23 03:31:32.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.39900000000034
[aiter INFO] 2025-10-23 03:31:32.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.35900000000038
[aiter INFO] 2025-10-23 03:31:32.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.07900000000001
[aiter INFO] 2025-10-23 03:31:32.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.001000000000005
[aiter INFO] 2025-10-23 03:31:32.732 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0          6,098.4        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        6,284.2              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN           62.8             62.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.733 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:32.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 191.6315341644948 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:32.832 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1102, 1103, 18, 20, 29}
[aiter INFO] 2025-10-23 03:31:32.832 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.27899999999997
[aiter INFO] 2025-10-23 03:31:32.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.47899999999936
[aiter INFO] 2025-10-23 03:31:32.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59900000000016
[aiter INFO] 2025-10-23 03:31:32.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.959000000000003
[aiter INFO] 2025-10-23 03:31:32.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.399
[aiter INFO] 2025-10-23 03:31:32.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999985
[aiter INFO] 2025-10-23 03:31:32.852 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,487.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          9,174.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,882.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          108.8            108.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:32.852 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   108.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:32.860 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:32.954 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 230.01936550187594 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:33.011 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:31:33.011 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.71900000000002
[aiter INFO] 2025-10-23 03:31:33.011 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.399
[aiter INFO] 2025-10-23 03:31:33.030 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,109.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         13,346.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,455.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          154.6            154.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:33.031 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   154.55 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:33.530 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 223.73652472944545 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:33.716 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {129, 12}
[aiter INFO] 2025-10-23 03:31:33.716 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.91899999999987
[aiter INFO] 2025-10-23 03:31:33.716 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.041
[aiter INFO] 2025-10-23 03:31:33.728 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          9,949.1        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:34.158 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.07073260415899 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.558999999999997
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000033
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000033
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.15900000000002
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000096
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999905
[aiter INFO] 2025-10-23 03:31:34.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.91900000000004
[aiter INFO] 2025-10-23 03:31:34.191 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999955
[aiter INFO] 2025-10-23 03:31:34.203 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 87.0            0.0          1,049.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:34.204 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   112.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:34.255 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 106.31164369901808 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:34.291 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {462, 4, 21, 446}
[aiter INFO] 2025-10-23 03:31:34.291 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.19900000000052
[aiter INFO] 2025-10-23 03:31:34.291 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.35900000000001
[aiter INFO] 2025-10-23 03:31:34.291 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 88.59899999999999
[aiter INFO] 2025-10-23 03:31:34.292 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.07899999999972
[aiter INFO] 2025-10-23 03:31:34.307 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0          8,781.0        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        9,051.9              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN           90.5             90.5         NaN          NaN
[aiter INFO] 2025-10-23 03:31:34.308 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    90.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:34.352 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 226.7643276712682 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:34.417 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 18}
[aiter INFO] 2025-10-23 03:31:34.417 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.91899999999998
[aiter INFO] 2025-10-23 03:31:34.417 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:31:34.436 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,122.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,261.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,384.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          143.8            143.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:34.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   143.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:34.448 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:34.547 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 268.9704062915084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:34.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {536, 9, 518, 24}
[aiter INFO] 2025-10-23 03:31:34.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.958999999999833
[aiter INFO] 2025-10-23 03:31:34.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 167.039
[aiter INFO] 2025-10-23 03:31:34.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.83899999999994
[aiter INFO] 2025-10-23 03:31:34.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.678999999999974
[aiter INFO] 2025-10-23 03:31:34.629 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,686.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         16,222.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,101.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          191.0            191.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:34.630 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   191.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:35.161 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 238.11245539990983 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:35.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:35.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.999
[aiter INFO] 2025-10-23 03:31:35.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         11,773.4        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            117.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:35.789 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.78441604352233 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.158999999999992
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.71900000000005
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.718999999999994
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.038999999999987
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.599000000000046
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.558999999999997
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.679000000000087
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.678999999999974
[aiter INFO] 2025-10-23 03:31:35.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:31:35.821 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.319000000000017
[aiter INFO] 2025-10-23 03:31:35.821 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.598999999999933
[aiter INFO] 2025-10-23 03:31:35.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 90.0            0.0          1,358.3        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:35.834 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   132.83 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:35.891 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.78224735802942 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:35.926 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 490, 75, 505, 50, 25}
[aiter INFO] 2025-10-23 03:31:35.926 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.71900000000002
[aiter INFO] 2025-10-23 03:31:35.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.40099999999984
[aiter INFO] 2025-10-23 03:31:35.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.99900000000002
[aiter INFO] 2025-10-23 03:31:35.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 117.51900000000023
[aiter INFO] 2025-10-23 03:31:35.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.47899999999998
[aiter INFO] 2025-10-23 03:31:35.927 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.31900000000002
[aiter INFO] 2025-10-23 03:31:35.942 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  95.0            0.0         11,204.9        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       11,794.6              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          117.9            117.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:35.943 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   117.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:36.044 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 753.7929805198519 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:36.159 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9}
[aiter INFO] 2025-10-23 03:31:36.159 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.158999999999992
[aiter INFO] 2025-10-23 03:31:36.159 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 637.483
[aiter INFO] 2025-10-23 03:31:36.178 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,716.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         64,258.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       66,974.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          669.7            669.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:36.179 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   669.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:36.191 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:36.306 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.1443165446272 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1029, 1032, 9, 17, 1042, 1047, 924, 1058, 1059, 941, 942, 1069, 1070, 952, 953, 1081, 1083, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 964, 1092, 966, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 976, 980, 993, 995, 1005, 1006, 1016, 1018}
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.119000000000597
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.55899999999929
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.47900000000001
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.959000000000003
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999942
[aiter INFO] 2025-10-23 03:31:36.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.75900000000001
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.67900000000009
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.679000000000087
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.3189999999995
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.198999999998705
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.03900000000067
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.958999999998923
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.35900000000038
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359000000000378
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.03900000000067
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999869
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.67900000000009
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999141
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.71899999999914
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.03900000000067
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.08100000000013
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999942
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.15899999999965
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.199000000000524
[aiter INFO] 2025-10-23 03:31:36.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.51899999999841
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.55899999999929
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.918999999999869
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.60100000000057
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.398999999999432
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.95900000000074
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999578
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.5589999999993
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000597
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.08100000000013
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.03899999999885
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.59900000000016
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.15899999999965
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.03900000000067
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.28099999999904
[aiter INFO] 2025-10-23 03:31:36.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.91899999999987
[aiter INFO] 2025-10-23 03:31:36.381 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  80.0            0.0          1,082.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  80.0            0.0          7,569.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,021.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          110.2            108.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:36.382 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   108.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:36.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 430.72734522347406 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:36.625 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:36.625 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 334.07900000000006
[aiter INFO] 2025-10-23 03:31:36.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         32,980.9        CUDA            5
[avg us/iter]               NaN   NaN            0.0            329.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:36.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.8719207254967 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:36.825 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:36.825 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.879000000000019
[aiter INFO] 2025-10-23 03:31:36.837 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            796.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:36.838 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   337.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:36.889 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.056880907257 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:36.943 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {480, 961, 675, 519, 12, 142, 792, 25}
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15900000000056
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.27900000000045
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.27899999999954
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15900000000056
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.15899999999999
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.23900000000003
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.47900000000027
[aiter INFO] 2025-10-23 03:31:36.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15899999999999
[aiter INFO] 2025-10-23 03:31:36.956 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 93.0            0.0          7,027.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             75.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:36.982 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.89085135778578 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.017 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:31:37.017 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000023
[aiter INFO] 2025-10-23 03:31:37.029 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            799.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.030 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    83.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:37.068 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.98360410067114 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 30}
[aiter INFO] 2025-10-23 03:31:37.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.15899999999999
[aiter INFO] 2025-10-23 03:31:37.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.55900000000003
[aiter INFO] 2025-10-23 03:31:37.113 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          6,171.0        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        6,235.5              0.0         CPU       239091
[avg us/iter]                                      NaN   NaN           62.4             62.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.113 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:37.141 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 166.86193069609084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.200 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:31:37.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.31900000000002
[aiter INFO] 2025-10-23 03:31:37.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.15899999999999
[aiter INFO] 2025-10-23 03:31:37.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.678999999999974
[aiter INFO] 2025-10-23 03:31:37.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.159000000000049
[aiter INFO] 2025-10-23 03:31:37.220 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,259.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          7,220.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,568.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           85.7             85.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.220 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    85.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:37.226 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:37.348 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.58931661478363 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {354, 1060, 1061, 520, 457, 9, 337, 469, 22, 508}
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000233
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.07899999999972
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.759000000000015
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71899999999914
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.4409999999998
[aiter INFO] 2025-10-23 03:31:37.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.159
[aiter INFO] 2025-10-23 03:31:37.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.23900000000003
[aiter INFO] 2025-10-23 03:31:37.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71900000000005
[aiter INFO] 2025-10-23 03:31:37.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.119000000000028
[aiter INFO] 2025-10-23 03:31:37.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.15900000000056
[aiter INFO] 2025-10-23 03:31:37.426 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          2,171.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         12,880.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,681.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          156.8            156.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.426 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   156.79 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:37.617 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 567.0478220033174 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:37.706 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 467.35900000000004
[aiter INFO] 2025-10-23 03:31:37.718 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         46,285.3        CUDA            5
[avg us/iter]               NaN   NaN            0.0            462.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.745 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.81052487793535 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6, 76, 48, 83, 20, 55, 27}
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.719000000000023
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-10-23 03:31:37.775 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:31:37.787 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 93.0            0.0          1,119.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.788 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   474.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:37.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.56314835217918 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.905 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:31:37.905 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.63900000000001
[aiter INFO] 2025-10-23 03:31:37.917 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         10,299.2        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            103.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.05649498724702 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999985
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999933
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599000000000046
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559000000000026
[aiter INFO] 2025-10-23 03:31:37.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:31:37.990 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 89.0            0.0          1,060.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:31:37.991 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   114.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:38.044 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.15094073220055 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 488, 492, 472, 25}
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.51900000000003
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.72099999999955
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.83899999999994
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.75900000000001
[aiter INFO] 2025-10-23 03:31:38.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.23899999999998
[aiter INFO] 2025-10-23 03:31:38.100 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  96.0            0.0         11,808.1        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       12,300.6              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          123.0            123.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:38.100 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   123.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:38.146 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 251.04281055455164 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:38.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 27, 25, 39}
[aiter INFO] 2025-10-23 03:31:38.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.359
[aiter INFO] 2025-10-23 03:31:38.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.35899999999992
[aiter INFO] 2025-10-23 03:31:38.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.079000000000008
[aiter INFO] 2025-10-23 03:31:38.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.798999999999978
[aiter INFO] 2025-10-23 03:31:38.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,238.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,505.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,914.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          169.1            169.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:38.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   169.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:38.242 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:38.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 320.07829712169007 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 618, 1038, 1039, 597, 28}
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 210.959
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.35899999999947
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 211.60100000000057
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.23899999999958
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 210.92100000000028
[aiter INFO] 2025-10-23 03:31:38.437 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.67900000000003
[aiter INFO] 2025-10-23 03:31:38.456 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          3,152.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         20,542.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,181.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          241.8            241.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:38.457 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   241.78 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:38.627 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 277.0004656055186 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:38.814 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {881, 12}
[aiter INFO] 2025-10-23 03:31:38.815 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.7990000000009
[aiter INFO] 2025-10-23 03:31:38.815 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.72099999999998
[aiter INFO] 2025-10-23 03:31:38.827 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         15,465.2        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            156.2         NaN          NaN
[aiter INFO] 2025-10-23 03:31:38.855 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 77.47232685289761 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.158999999999992
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.958999999999975
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.199000000000012
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.758999999999986
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.958999999999946
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.878999999999962
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.158999999999992
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-10-23 03:31:38.885 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.598999999999933
[aiter INFO] 2025-10-23 03:31:38.897 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,935.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:38.898 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   177.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:38.963 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.31352471715152 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.005 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {450, 4, 38}
[aiter INFO] 2025-10-23 03:31:39.005 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.4389999999994
[aiter INFO] 2025-10-23 03:31:39.005 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 180.601
[aiter INFO] 2025-10-23 03:31:39.006 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 176.23900000000003
[aiter INFO] 2025-10-23 03:31:39.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0         17,451.0        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       17,804.7              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          178.0            178.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   178.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:39.079 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 307.99944595535203 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {609, 26, 590, 9}
[aiter INFO] 2025-10-23 03:31:39.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.35900000000038
[aiter INFO] 2025-10-23 03:31:39.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.35899999999998
[aiter INFO] 2025-10-23 03:31:39.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 194.27899999999954
[aiter INFO] 2025-10-23 03:31:39.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 196.081
[aiter INFO] 2025-10-23 03:31:39.167 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          3,177.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         19,161.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,565.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          225.7            225.6         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.168 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   225.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:39.183 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:39.321 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 380.2293854774815 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.394 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 31}
[aiter INFO] 2025-10-23 03:31:39.394 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 259.761
[aiter INFO] 2025-10-23 03:31:39.394 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.399
[aiter INFO] 2025-10-23 03:31:39.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          4,158.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         25,738.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       29,896.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          299.0            299.0         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   298.96 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:39.605 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 304.8033971007508 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.670 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1305}
[aiter INFO] 2025-10-23 03:31:39.670 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 181.39900000000006
[aiter INFO] 2025-10-23 03:31:39.670 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.76100000000002
[aiter INFO] 2025-10-23 03:31:39.670 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.96099999999933
[aiter INFO] 2025-10-23 03:31:39.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         17,944.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            183.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 85.10123790785818 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.15899999999999
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.238999999999976
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.678999999999974
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.238999999999976
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.119000000000028
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.56099999999998
[aiter INFO] 2025-10-23 03:31:39.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-10-23 03:31:39.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,512.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.7         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.756 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   209.83 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:39.832 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 249.76121818665231 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:39.881 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 45}
[aiter INFO] 2025-10-23 03:31:39.881 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 235.201
[aiter INFO] 2025-10-23 03:31:39.881 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 231.47899999999993
[aiter INFO] 2025-10-23 03:31:39.897 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  99.0            0.0         23,050.1        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       23,281.6              0.0         CPU       239091
[avg us/iter]                                               NaN   NaN          232.8            232.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:39.897 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   232.83 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:40.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1145.4521110742398 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {98, 9, 1074, 1075, 1014, 1015}
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.31900000000019
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1025.041
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1026.8830000000016
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.75899999999092
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1026.8410000000003
[aiter INFO] 2025-10-23 03:31:40.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.999000000003434
[aiter INFO] 2025-10-23 03:31:40.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          4,087.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0        100,261.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      106,486.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,064.9          1,064.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:40.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1064.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:40.247 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:31:40.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 160.42706916237822 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:40.382 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 732, 724, 17}
[aiter INFO] 2025-10-23 03:31:40.383 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.679
[aiter INFO] 2025-10-23 03:31:40.383 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000815
[aiter INFO] 2025-10-23 03:31:40.383 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.19900000000052
[aiter INFO] 2025-10-23 03:31:40.383 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-10-23 03:31:40.402 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            484.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          7,568.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,136.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           81.4             81.3         NaN          NaN
[aiter INFO] 2025-10-23 03:31:40.402 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    81.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:41.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 323.36785179553647 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:41.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 50, 314, 12}
[aiter INFO] 2025-10-23 03:31:41.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.71900000000005
[aiter INFO] 2025-10-23 03:31:41.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.71899999999994
[aiter INFO] 2025-10-23 03:31:41.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.07899999999972
[aiter INFO] 2025-10-23 03:31:41.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 218.59900000000005
[aiter INFO] 2025-10-23 03:31:41.128 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         20,862.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            215.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:41.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.24341570445807 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:41.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {650, 636, 6}
[aiter INFO] 2025-10-23 03:31:41.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.719000000000051
[aiter INFO] 2025-10-23 03:31:41.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.719000000000051
[aiter INFO] 2025-10-23 03:31:41.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:31:41.372 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            602.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:41.373 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   221.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:41.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 173.05602000491456 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1156, 38, 298, 12, 909, 25, 506}
[aiter INFO] 2025-10-23 03:31:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.998999999999796
[aiter INFO] 2025-10-23 03:31:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.59899999999993
[aiter INFO] 2025-10-23 03:31:41.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.878999999999905
[aiter INFO] 2025-10-23 03:31:41.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.478999999999985
[aiter INFO] 2025-10-23 03:31:41.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.8809999999994
[aiter INFO] 2025-10-23 03:31:41.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.11899999999997
[aiter INFO] 2025-10-23 03:31:41.768 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.27900000000045
[aiter INFO] 2025-10-23 03:31:41.780 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 94.0            0.0          4,865.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             51.8         NaN          NaN
[aiter INFO] 2025-10-23 03:31:41.807 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.95627715386966 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:31:41.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {384, 454, 6}
[aiter INFO] 2025-10-23 03:31:41.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5590000000001965
[aiter INFO] 2025-10-23 03:31:41.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.519000000000233
[aiter INFO] 2025-10-23 03:31:41.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.638999999999982
[aiter INFO] 2025-10-23 03:31:41.862 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            595.3        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:31:41.863 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    57.83 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:31:41.867 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_589296f99ad07162606d0fe815cead87' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_589296f99ad07162606d0fe815cead87', 'folder': 'pa_589296f99ad07162606d0fe815cead87', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_589296f99ad07162606d0fe815cead87(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:31:41.867 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include -c pa_589296f99ad07162606d0fe815cead87.cpp -o pa_589296f99ad07162606d0fe815cead87.o
In file included from pa_589296f99ad07162606d0fe815cead87.cpp:1:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/quant_utils.cuh:19:
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_589296f99ad07162606d0fe815cead87.cpp:1:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/quant_utils.cuh:19:
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_589296f99ad07162606d0fe815cead87/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_589296f99ad07162606d0fe815cead87.o -o lib.so
[aiter INFO] 2025-10-23 03:32:04.935 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_589296f99ad07162606d0fe815cead87, cost 23.06814245s
[aiter INFO] 2025-10-23 03:32:04.976 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.5854066988029 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {743, 9, 42, 16, 49, 379, 20, 53, 372, 27, 60, 735}
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.918999999999869
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.31899999999996
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.15899999999999
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.95900000000006
[aiter INFO] 2025-10-23 03:32:05.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.03899999999999
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.839000000000055
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.83899999999994
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.03899999999993
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.958999999999946
[aiter INFO] 2025-10-23 03:32:05.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.198999999999614
[aiter INFO] 2025-10-23 03:32:05.056 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            463.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0          4,547.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,279.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           52.8             52.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:05.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    52.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:05.060 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:05.107 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_24657a25f1ca5f4f77fe533398dc0de9' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_24657a25f1ca5f4f77fe533398dc0de9', 'folder': 'pa_24657a25f1ca5f4f77fe533398dc0de9', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_24657a25f1ca5f4f77fe533398dc0de9(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:05.108 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include -c pa_24657a25f1ca5f4f77fe533398dc0de9.cpp -o pa_24657a25f1ca5f4f77fe533398dc0de9.o
In file included from pa_24657a25f1ca5f4f77fe533398dc0de9.cpp:1:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/quant_utils.cuh:19:
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_24657a25f1ca5f4f77fe533398dc0de9.cpp:1:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/quant_utils.cuh:19:
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_24657a25f1ca5f4f77fe533398dc0de9.o -o lib.so
[aiter INFO] 2025-10-23 03:32:08.271 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_24657a25f1ca5f4f77fe533398dc0de9, cost 3.16342352s
[aiter INFO] 2025-10-23 03:32:08.297 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 186.90401005862964 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:08.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {191, 98, 225, 771, 872, 713, 9, 781, 703, 881, 18, 181, 88, 216}
[aiter INFO] 2025-10-23 03:32:08.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.358999999999924
[aiter INFO] 2025-10-23 03:32:08.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.638999999999896
[aiter INFO] 2025-10-23 03:32:08.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.518999999999778
[aiter INFO] 2025-10-23 03:32:08.366 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.08100000000013
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.75900000000001
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.719000000000051
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.63900000000001
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.639000000000124
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.71899999999914
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.318999999999505
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999994
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.03899999999999
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.95900000000006
[aiter INFO] 2025-10-23 03:32:08.367 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.8789999999999
[aiter INFO] 2025-10-23 03:32:08.386 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0            809.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  94.0            0.0          9,124.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,580.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          105.8            105.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:08.387 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   105.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:09.296 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 397.23415717039956 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:09.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 37, 62}
[aiter INFO] 2025-10-23 03:32:09.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 290.839
[aiter INFO] 2025-10-23 03:32:09.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 288.881
[aiter INFO] 2025-10-23 03:32:09.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.04100000000005
[aiter INFO] 2025-10-23 03:32:09.382 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         28,200.1        CUDA            5
[avg us/iter]               NaN  NaN            0.0            287.8         NaN          NaN
[aiter INFO] 2025-10-23 03:32:09.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.79113857167782 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:09.447 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:09.447 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.638999999999982
[aiter INFO] 2025-10-23 03:32:09.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            697.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-10-23 03:32:09.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   294.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:09.796 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 178.91900979056217 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:09.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 675, 12, 766}
[aiter INFO] 2025-10-23 03:32:09.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.11900000000003
[aiter INFO] 2025-10-23 03:32:09.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.998999999999796
[aiter INFO] 2025-10-23 03:32:09.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.03899999999999
[aiter INFO] 2025-10-23 03:32:09.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.23900000000049
[aiter INFO] 2025-10-23 03:32:09.863 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          5,276.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             54.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:09.890 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.48420817663174 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:10.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:10.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999995
[aiter INFO] 2025-10-23 03:32:10.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            697.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-10-23 03:32:10.111 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    61.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:10.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_519f17729045d2108ae8ffb8750796fa' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_519f17729045d2108ae8ffb8750796fa', 'folder': 'pa_519f17729045d2108ae8ffb8750796fa', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_519f17729045d2108ae8ffb8750796fa(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:10.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include -c pa_519f17729045d2108ae8ffb8750796fa.cpp -o pa_519f17729045d2108ae8ffb8750796fa.o
In file included from pa_519f17729045d2108ae8ffb8750796fa.cpp:1:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/quant_utils.cuh:19:
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_519f17729045d2108ae8ffb8750796fa.cpp:1:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/quant_utils.cuh:19:
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_519f17729045d2108ae8ffb8750796fa.o -o lib.so
[aiter INFO] 2025-10-23 03:32:13.282 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_519f17729045d2108ae8ffb8750796fa, cost 3.16438480s
[aiter INFO] 2025-10-23 03:32:13.328 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 184.88258447977577 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:13.395 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:32:13.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.399
[aiter INFO] 2025-10-23 03:32:13.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.879000000000019
[aiter INFO] 2025-10-23 03:32:13.415 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            915.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0          9,075.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,991.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           99.9             99.9         NaN          NaN
[aiter INFO] 2025-10-23 03:32:13.416 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    99.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:13.422 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:13.470 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_d737417f928eb72e0c4f75b4aa006b2f' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_d737417f928eb72e0c4f75b4aa006b2f', 'folder': 'pa_d737417f928eb72e0c4f75b4aa006b2f', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_d737417f928eb72e0c4f75b4aa006b2f(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:13.470 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include -c pa_d737417f928eb72e0c4f75b4aa006b2f.cpp -o pa_d737417f928eb72e0c4f75b4aa006b2f.o
In file included from pa_d737417f928eb72e0c4f75b4aa006b2f.cpp:1:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_d737417f928eb72e0c4f75b4aa006b2f.cpp:1:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_d737417f928eb72e0c4f75b4aa006b2f.o -o lib.so
[aiter INFO] 2025-10-23 03:32:16.688 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_d737417f928eb72e0c4f75b4aa006b2f, cost 3.21776534s
[aiter INFO] 2025-10-23 03:32:16.718 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 228.7888709861453 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:16.792 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21, 948, 965}
[aiter INFO] 2025-10-23 03:32:16.792 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 140.32099999999997
[aiter INFO] 2025-10-23 03:32:16.792 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.758999999999958
[aiter INFO] 2025-10-23 03:32:16.792 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 139.03900000000067
[aiter INFO] 2025-10-23 03:32:16.793 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.59900000000016
[aiter INFO] 2025-10-23 03:32:16.812 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,167.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         13,651.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,970.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          149.7            149.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:16.812 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   149.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:17.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 217.30963428421776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:17.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:32:17.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.23899999999998
[aiter INFO] 2025-10-23 03:32:17.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.719
[aiter INFO] 2025-10-23 03:32:17.343 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          9,806.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             99.1         NaN          NaN
[aiter INFO] 2025-10-23 03:32:17.370 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.75943558286912 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:17.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:17.407 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000012
[aiter INFO] 2025-10-23 03:32:17.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            824.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:17.420 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   107.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

max_diff_thr=0.0017927573062479496

NaN info:
{}
out_ref_md5=46c54f3d991ba6928c6a79d43c8767e3
triton_fp8_output_md5=a1cb8dbdd394010ce7cf5d95e9d859e6
diff.abs.max=0.00122833251953125
max_diff_thr=0.0012245767284184694

NaN info:
{}
out_ref_md5=46c54f3d991ba6928c6a79d43c8767e3
gluon_fp8_output_md5=b843119258df933de3143a4914ea60bf
diff.abs.max=0.001220703125
max_diff_thr=0.0012089705560356379

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0031989377457648516

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.001208824454806745

NaN info:
{}
out_ref_md5=a6acb2c11b966d97b36d8000ebce1fa6
gluon_fp8_output_md5=3af4e8a4b0c105b24e13f3903f2fbde6
diff.abs.max=0.00128173828125
max_diff_thr=0.0012698796344920993

NaN info:
{}
diff.abs.max=0.00341796875
max_diff_thr=0.003409696277230978

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012053275713697076

NaN info:
{}
out_ref_md5=e87bafe04e20bf4aa76468241c6c787e
gluon_fp8_output_md5=2184032b602f63393c5013b878bd0396
diff.abs.max=0.001220703125
max_diff_thr=0.0012152882991358638

NaN info:
{}
diff.abs.max=0.0032806396484375
max_diff_thr=0.003270708257332444

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.001811484806239605

NaN info:
{}
out_ref_md5=2dd3136b0b0e835ac58c3d620e06f550
triton_fp8_output_md5=639fee20dc5ce973e2ba6e20977d6af0
diff.abs.max=0.00115966796875
max_diff_thr=0.001150051481090486

NaN info:
{}
out_ref_md5=2dd3136b0b0e835ac58c3d620e06f550
gluon_fp8_output_md5=3749206dd475a48258b8a2692654f8bd
diff.abs.max=0.001220703125
max_diff_thr=0.0012017786502838135

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003146176226437092

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00189208984375
max_diff_thr=0.0018651103600859642

NaN info:
{}
out_ref_md5=3d8fcfa458b7222e8ee55df270a2da5d
triton_fp8_output_md5=9beb2756c4b4853def846cbeb8be1fc9
diff.abs.max=0.00128173828125
max_diff_thr=0.0012612612918019295

NaN info:
{}
out_ref_md5=3d8fcfa458b7222e8ee55df270a2da5d
gluon_fp8_output_md5=4491b71b1d67c06e41bbb4dd8dfc6329
diff.abs.max=0.00118255615234375
max_diff_thr=0.001181888859719038

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.0030033637303858995

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00122833251953125
max_diff_thr=0.0012263957178220153

NaN info:
{}
out_ref_md5=4a02aef43d1df5161833ee1e3d2e3547
gluon_fp8_output_md5=394d584119e1b75059265026f48ec249
diff.abs.max=0.0013427734375
max_diff_thr=0.001327300094999373

NaN info:
{}
diff.abs.max=0.003570556640625
max_diff_thr=0.003541590878739953

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012755101779475808

NaN info:
{}
out_ref_md5=eb337bdc9b4f190c19f4d6228a2d8000
gluon_fp8_output_md5=84467fba69750daae65166e9c0f24e8d
diff.abs.max=0.00128173828125
max_diff_thr=0.0012701868545264006

NaN info:
{}
diff.abs.max=0.00319671630859375
max_diff_thr=0.003190630581229925

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017461464740335941

NaN info:
{}
out_ref_md5=72089833722c4f5604e2994d7d0a7e2e
triton_fp8_output_md5=7911976be69d9f79d5470261252bcefa
diff.abs.max=0.0013275146484375
max_diff_thr=0.0013242614222690463

NaN info:
{}
out_ref_md5=72089833722c4f5604e2994d7d0a7e2e
gluon_fp8_output_md5=4af9d9389a108479c649e2c1503273e2
diff.abs.max=0.001220703125
max_diff_thr=0.0011974613880738616

NaN info:
{}
diff.abs.max=0.0029296875
max_diff_thr=0.002916248980909586

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018002880970016122

NaN info:
{}
out_ref_md5=2801e440bd4d856aaf272b3ffac4213a
triton_fp8_output_md5=2fc880ce2f75daa3ce8ae54614b42edd
diff.abs.max=0.0013885498046875
max_diff_thr=0.001386054209433496

NaN info:
{}
out_ref_md5=2801e440bd4d856aaf272b3ffac4213a
gluon_fp8_output_md5=495e770677e3845387e266484acc15c6
diff.abs.max=0.00128173828125
max_diff_thr=0.0012620192719623446

NaN info:
{}
diff.abs.max=0.00304412841796875
max_diff_thr=0.00303930533118546

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001239776611328125
max_diff_thr=0.0012372280471026897

NaN info:
{}
out_ref_md5=d12e129d0029be294d8d7d239bf4db94
gluon_fp8_output_md5=9c14524f46df63355b3da6600f18e0ed
diff.abs.max=0.001434326171875
max_diff_thr=0.0014275733847171068

NaN info:
{}
diff.abs.max=0.00347900390625
max_diff_thr=0.003450363175943494

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001338958740234375
max_diff_thr=0.001336816931143403

NaN info:
{}
out_ref_md5=ddd81e6922686362124169962e381212
gluon_fp8_output_md5=cce1ef621b3db895b9a80b1711e1fafb
diff.abs.max=0.00136566162109375
max_diff_thr=0.0013649119064211845

NaN info:
{}
diff.abs.max=0.004150390625
max_diff_thr=0.004129471257328987

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001676044543273747

NaN info:
{}
out_ref_md5=158f440f3e3be58142ddd9503b9b2187
triton_fp8_output_md5=f8fa3a25349848bf7123c60c7cd6d048
diff.abs.max=0.001129150390625
max_diff_thr=0.0011267090449109674

NaN info:
{}
out_ref_md5=158f440f3e3be58142ddd9503b9b2187
gluon_fp8_output_md5=266e84834d05fe6ab26f3b537d854fc4
diff.abs.max=0.0029754638671875
max_diff_thr=0.002958400407806039

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.001805271371267736

NaN info:
{}
out_ref_md5=674cccd6e09d0d16e28d386816fdab10
triton_fp8_output_md5=bf9d94972c58c042b14a0c71122b27d7
diff.abs.max=0.0012664794921875
max_diff_thr=0.0012609765399247408

NaN info:
{}
out_ref_md5=674cccd6e09d0d16e28d386816fdab10
gluon_fp8_output_md5=d78a679190e5f35e4ac067f1b94d2d52
diff.abs.max=0.003082275390625
max_diff_thr=0.0030506222974509

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00116729736328125
max_diff_thr=0.0011653680121526122

NaN info:
{}
out_ref_md5=beadb2c8e370d6efee37a6fc4bc23ec2[aiter INFO] 2025-10-23 03:32:17.429 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_98a7f807468a36537c6f6304a39a08d3' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_98a7f807468a36537c6f6304a39a08d3', 'folder': 'pa_98a7f807468a36537c6f6304a39a08d3', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_98a7f807468a36537c6f6304a39a08d3(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:17.429 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include -c pa_98a7f807468a36537c6f6304a39a08d3.cpp -o pa_98a7f807468a36537c6f6304a39a08d3.o
In file included from pa_98a7f807468a36537c6f6304a39a08d3.cpp:1:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/quant_utils.cuh:19:
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_98a7f807468a36537c6f6304a39a08d3.cpp:1:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/quant_utils.cuh:19:
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_98a7f807468a36537c6f6304a39a08d3.o -o lib.so
[aiter INFO] 2025-10-23 03:32:20.648 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_98a7f807468a36537c6f6304a39a08d3, cost 3.21817047s
[aiter INFO] 2025-10-23 03:32:20.696 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 217.59396053776882 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:20.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:32:20.754 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.23899999999998
[aiter INFO] 2025-10-23 03:32:20.754 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-10-23 03:32:20.773 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,214.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,002.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,216.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          132.2            132.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:20.774 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   132.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:20.781 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:20.826 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_e594ccd350465060f7f9893d96565bcc' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_e594ccd350465060f7f9893d96565bcc', 'folder': 'pa_e594ccd350465060f7f9893d96565bcc', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_e594ccd350465060f7f9893d96565bcc(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:20.826 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include -c pa_e594ccd350465060f7f9893d96565bcc.cpp -o pa_e594ccd350465060f7f9893d96565bcc.o
In file included from pa_e594ccd350465060f7f9893d96565bcc.cpp:1:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_e594ccd350465060f7f9893d96565bcc.cpp:1:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_e594ccd350465060f7f9893d96565bcc.o -o lib.so
[aiter INFO] 2025-10-23 03:32:24.088 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_e594ccd350465060f7f9893d96565bcc, cost 3.26184209s
[aiter INFO] 2025-10-23 03:32:24.123 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 260.4230099385328 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:24.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 25, 870, 887}
[aiter INFO] 2025-10-23 03:32:24.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 167.75900000000001
[aiter INFO] 2025-10-23 03:32:24.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:32:24.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.6389999999992
[aiter INFO] 2025-10-23 03:32:24.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.639000000001033
[aiter INFO] 2025-10-23 03:32:24.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,476.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         16,134.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,791.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          177.9            177.9         NaN          NaN
[aiter INFO] 2025-10-23 03:32:24.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   177.89 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:24.694 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 217.9884355847198 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:24.747 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 636, 12}
[aiter INFO] 2025-10-23 03:32:24.748 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.12099999999998
[aiter INFO] 2025-10-23 03:32:24.748 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.32100000000082
[aiter INFO] 2025-10-23 03:32:24.748 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.35900000000004
[aiter INFO] 2025-10-23 03:32:24.759 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          9,860.1        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.6         NaN          NaN
[aiter INFO] 2025-10-23 03:32:24.786 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.69843557093402 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:24.823 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:24.823 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.439000000000021
[aiter INFO] 2025-10-23 03:32:24.835 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            982.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-10-23 03:32:24.837 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   110.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:24.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_fa618a17c68e6cc46f3b0e8cff8224ef' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_fa618a17c68e6cc46f3b0e8cff8224ef', 'folder': 'pa_fa618a17c68e6cc46f3b0e8cff8224ef', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_fa618a17c68e6cc46f3b0e8cff8224ef(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:24.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include -c pa_fa618a17c68e6cc46f3b0e8cff8224ef.cpp -o pa_fa618a17c68e6cc46f3b0e8cff8224ef.o
In file included from pa_fa618a17c68e6cc46f3b0e8cff8224ef.cpp:1:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/quant_utils.cuh:19:
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_fa618a17c68e6cc46f3b0e8cff8224ef.cpp:1:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/quant_utils.cuh:19:
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_fa618a17c68e6cc46f3b0e8cff8224ef.o -o lib.so
[aiter INFO] 2025-10-23 03:32:28.166 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_fa618a17c68e6cc46f3b0e8cff8224ef, cost 3.31667715s
[aiter INFO] 2025-10-23 03:32:28.268 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 732.6859100030201 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:28.376 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1094, 1095, 359, 9, 298, 62}
[aiter INFO] 2025-10-23 03:32:28.376 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 638.6390000000029
[aiter INFO] 2025-10-23 03:32:28.376 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.319000000003143
[aiter INFO] 2025-10-23 03:32:28.377 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.559000000000196
[aiter INFO] 2025-10-23 03:32:28.377 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 631.0809999999999
[aiter INFO] 2025-10-23 03:32:28.377 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.3610000000003
[aiter INFO] 2025-10-23 03:32:28.377 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.719000000000051
[aiter INFO] 2025-10-23 03:32:28.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,488.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         61,912.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       64,712.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          647.1            646.9         NaN          NaN
[aiter INFO] 2025-10-23 03:32:28.397 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   646.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:28.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:28.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 204.7547429504961 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {999, 9, 427, 780, 1011, 19, 794, 413}
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.79900000000089
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.48100000000002
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.47900000000027
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 117.59900000000016
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.078999999999724
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000017
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-10-23 03:32:28.753 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.51899999999978
[aiter INFO] 2025-10-23 03:32:28.772 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            781.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         11,423.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,585.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          125.9            125.8         NaN          NaN
[aiter INFO] 2025-10-23 03:32:28.773 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   125.82 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:28.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 443.5242275790413 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.041 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:32:29.041 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 351.599
[aiter INFO] 2025-10-23 03:32:29.052 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         34,721.4        CUDA            5
[avg us/iter]               NaN   NaN            0.0            347.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.078 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.94636629359556 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.112 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 447}
[aiter INFO] 2025-10-23 03:32:29.112 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999983
[aiter INFO] 2025-10-23 03:32:29.112 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5590000000001965
[aiter INFO] 2025-10-23 03:32:29.124 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            701.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.125 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   354.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:29.174 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 201.21456431870413 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38}
[aiter INFO] 2025-10-23 03:32:29.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.43899999999996
[aiter INFO] 2025-10-23 03:32:29.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.31900000000002
[aiter INFO] 2025-10-23 03:32:29.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.75900000000007
[aiter INFO] 2025-10-23 03:32:29.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          7,680.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             78.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.267 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.64418797150697 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.303 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {692, 468, 6}
[aiter INFO] 2025-10-23 03:32:29.303 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.59900000000016
[aiter INFO] 2025-10-23 03:32:29.303 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.359000000000378
[aiter INFO] 2025-10-23 03:32:29.303 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-10-23 03:32:29.315 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            696.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.316 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    85.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:29.360 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.1938611906354 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {39, 9, 17, 20, 28, 31}
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.999
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.63900000000001
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-10-23 03:32:29.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.44099999999997
[aiter INFO] 2025-10-23 03:32:29.432 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            745.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          7,098.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,006.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           80.1             80.0         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.433 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    80.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:29.436 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:29.542 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 245.77268367946738 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1058, 1059, 1064, 1065, 9, 619, 22, 633}
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 153.79899999999907
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.318999999999505
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.03900000000067
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.19899999999998
[aiter INFO] 2025-10-23 03:32:29.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.39900000000034
[aiter INFO] 2025-10-23 03:32:29.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999994
[aiter INFO] 2025-10-23 03:32:29.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999578
[aiter INFO] 2025-10-23 03:32:29.627 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,284.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         14,785.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,572.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          165.7            165.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.628 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   165.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:29.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 568.7361424512202 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.922 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:32:29.922 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 469.601
[aiter INFO] 2025-10-23 03:32:29.932 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         46,539.8        CUDA            5
[avg us/iter]               NaN   NaN            0.0            465.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:29.959 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.47905938283051 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:29.993 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 167}
[aiter INFO] 2025-10-23 03:32:29.993 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999993
[aiter INFO] 2025-10-23 03:32:29.993 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.038999999999987
[aiter INFO] 2025-10-23 03:32:30.005 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            815.3        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.006 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   473.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:30.057 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 206.5092180625047 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:30.111 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1169, 12}
[aiter INFO] 2025-10-23 03:32:30.111 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.91899999999987
[aiter INFO] 2025-10-23 03:32:30.111 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.96100000000001
[aiter INFO] 2025-10-23 03:32:30.123 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          8,183.1        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             82.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.150 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.77410890501325 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:30.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:30.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.87899999999999
[aiter INFO] 2025-10-23 03:32:30.361 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            822.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.363 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    90.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:30.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 241.40078153940712 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:30.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 37, 23}
[aiter INFO] 2025-10-23 03:32:30.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.79899999999998
[aiter INFO] 2025-10-23 03:32:30.480 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.84099999999995
[aiter INFO] 2025-10-23 03:32:30.480 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999969
[aiter INFO] 2025-10-23 03:32:30.480 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.63900000000001
[aiter INFO] 2025-10-23 03:32:30.498 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,314.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,137.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,609.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          156.1            156.1         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.499 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   156.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:30.505 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:30.620 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 316.5214460084934 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:30.696 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 28}
[aiter INFO] 2025-10-23 03:32:30.696 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 221.639
[aiter INFO] 2025-10-23 03:32:30.696 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000028
[aiter INFO] 2025-10-23 03:32:30.715 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,771.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         21,902.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       23,673.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          236.7            236.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.716 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   236.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:30.892 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 263.6460301899674 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:30.951 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1302}
[aiter INFO] 2025-10-23 03:32:30.951 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.11900000000003
[aiter INFO] 2025-10-23 03:32:30.951 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 156.47899999999998
[aiter INFO] 2025-10-23 03:32:30.951 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.15899999999965
[aiter INFO] 2025-10-23 03:32:30.962 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         14,891.4        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            152.0         NaN          NaN
[aiter INFO] 2025-10-23 03:32:30.989 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.1903468335029 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:31.024 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:31.024 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.479000000000013
[aiter INFO] 2025-10-23 03:32:31.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,145.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.5         NaN          NaN
[aiter INFO] 2025-10-23 03:32:31.037 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   163.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:31.101 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 293.1023455492341 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:31.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 1060, 1061}
[aiter INFO] 2025-10-23 03:32:31.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.599
[aiter INFO] 2025-10-23 03:32:31.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000019
[aiter INFO] 2025-10-23 03:32:31.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 189.88100000000122
[aiter INFO] 2025-10-23 03:32:31.166 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.638999999999214
[aiter INFO] 2025-10-23 03:32:31.184 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,755.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         18,875.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,838.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          208.4            208.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:31.185 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   208.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:31.193 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:31.311 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 362.6914853506749 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:31.392 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {33, 9, 1106, 983, 1107, 1078, 1079, 982}
[aiter INFO] 2025-10-23 03:32:31.392 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.158999999999992
[aiter INFO] 2025-10-23 03:32:31.392 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.31899999999996
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 253.9190000000017
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.799000000000888
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.47899999999936
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.39900000000125
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.15900000000329
[aiter INFO] 2025-10-23 03:32:31.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 258.39900000000125
[aiter INFO] 2025-10-23 03:32:31.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,198.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         24,791.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       27,827.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          278.3            278.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:31.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   278.24 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:31.590 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 269.1668404801057 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:31.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {128, 12, 588, 693}
[aiter INFO] 2025-10-23 03:32:31.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.99900000000002
[aiter INFO] 2025-10-23 03:32:31.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.67900000000003
[aiter INFO] 2025-10-23 03:32:31.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.15900000000056
[aiter INFO] 2025-10-23 03:32:31.646 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.03900000000067
[aiter INFO] 2025-10-23 03:32:31.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         14,910.2        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            153.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:31.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.86956415554084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6, 41, 48, 55, 251, 62}
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999984
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.000999999999976
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000028
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000028
[aiter INFO] 2025-10-23 03:32:31.717 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000251
[aiter INFO] 2025-10-23 03:32:31.718 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-10-23 03:32:31.730 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          1,153.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:31.731 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   165.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:31.886 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1113.7260647103337 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:32.035 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {98, 1028, 1029, 998, 999, 9, 970, 971}
[aiter INFO] 2025-10-23 03:32:32.035 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.999000000000024
[aiter INFO] 2025-10-23 03:32:32.035 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1013.4029999999984
[aiter INFO] 2025-10-23 03:32:32.035 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.47899999999936
[aiter INFO] 2025-10-23 03:32:32.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1013.5629999999946
[aiter INFO] 2025-10-23 03:32:32.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.398999999997613
[aiter INFO] 2025-10-23 03:32:32.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1011.9630000000001
[aiter INFO] 2025-10-23 03:32:32.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1013.8029999999999
[aiter INFO] 2025-10-23 03:32:32.036 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.559000000001106
[aiter INFO] 2025-10-23 03:32:32.055 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,187.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         97,787.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      103,082.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,030.8          1,030.7         NaN          NaN
[aiter INFO] 2025-10-23 03:32:32.055 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1030.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:32.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:32.114 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_c9cc172312187ae298dc10daea348da9' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_c9cc172312187ae298dc10daea348da9', 'folder': 'pa_c9cc172312187ae298dc10daea348da9', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_c9cc172312187ae298dc10daea348da9(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:32.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include -c pa_c9cc172312187ae298dc10daea348da9.cpp -o pa_c9cc172312187ae298dc10daea348da9.o
In file included from pa_c9cc172312187ae298dc10daea348da9.cpp:1:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/quant_utils.cuh:19:
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_c9cc172312187ae298dc10daea348da9.cpp:1:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/quant_utils.cuh:19:
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_c9cc172312187ae298dc10daea348da9.o -o lib.so
[aiter INFO] 2025-10-23 03:32:35.237 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_c9cc172312187ae298dc10daea348da9, cost 3.12188950s
[aiter INFO] 2025-10-23 03:32:35.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.21321750395367 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17, 20, 28, 669, 163, 677, 680, 171, 688, 449, 457, 735, 743, 878, 240, 757, 886, 248, 765}
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.719
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000012
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.51899999999995
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999946
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.68099999999959
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.04099999999994
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.719000000000051
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.4390000000003
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.1590000000001055
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999905
[aiter INFO] 2025-10-23 03:32:35.503 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.47900000000027
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.79899999999998
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.238999999999578
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.3189999999995
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.35899999999992
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.11899999999969
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:32:35.504 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-10-23 03:32:35.523 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            624.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  91.0            0.0          6,972.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,364.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           83.6             83.5         NaN          NaN
[aiter INFO] 2025-10-23 03:32:35.524 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    83.49 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:36.194 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 321.7602271844845 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:36.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 50, 1282, 12}
[aiter INFO] 2025-10-23 03:32:36.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.04100000000005
[aiter INFO] 2025-10-23 03:32:36.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.841
[aiter INFO] 2025-10-23 03:32:36.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.16100000000006
[aiter INFO] 2025-10-23 03:32:36.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 218.839
[aiter INFO] 2025-10-23 03:32:36.272 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         20,961.1        CUDA            5
[avg us/iter]               NaN  NaN            0.0            216.1         NaN          NaN
[aiter INFO] 2025-10-23 03:32:36.298 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.92062413397402 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:36.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {265, 643, 692, 6}
[aiter INFO] 2025-10-23 03:32:36.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-10-23 03:32:36.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.918999999999869
[aiter INFO] 2025-10-23 03:32:36.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.879000000000815
[aiter INFO] 2025-10-23 03:32:36.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.279000000000025
[aiter INFO] 2025-10-23 03:32:36.348 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0            613.7        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:36.350 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   222.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:36.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.94234642297914 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {844, 12, 25, 922, 571}
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.39899999999943
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.278999999999996
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.799000000000035
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.60100000000057
[aiter INFO] 2025-10-23 03:32:36.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.48100000000068
[aiter INFO] 2025-10-23 03:32:36.752 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0          5,020.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             52.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:36.778 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.4627823764735 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:36.821 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {629, 6}
[aiter INFO] 2025-10-23 03:32:36.821 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:32:36.821 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-10-23 03:32:36.833 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            626.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:36.835 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    58.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:36.839 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_ba9092b682dcf6186730ded49a474318' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_ba9092b682dcf6186730ded49a474318', 'folder': 'pa_ba9092b682dcf6186730ded49a474318', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_ba9092b682dcf6186730ded49a474318(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:36.839 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include -c pa_ba9092b682dcf6186730ded49a474318.cpp -o pa_ba9092b682dcf6186730ded49a474318.o
In file included from pa_ba9092b682dcf6186730ded49a474318.cpp:1:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/quant_utils.cuh:19:
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_ba9092b682dcf6186730ded49a474318.cpp:1:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/quant_utils.cuh:19:
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_ba9092b682dcf6186730ded49a474318.o -o lib.so
[aiter INFO] 2025-10-23 03:32:39.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_ba9092b682dcf6186730ded49a474318, cost 3.12164621s
[aiter INFO] 2025-10-23 03:32:40.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 143.90937644656344 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:40.061 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 75, 14, 82, 20, 24}
[aiter INFO] 2025-10-23 03:32:40.061 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.678999999999974
[aiter INFO] 2025-10-23 03:32:40.061 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.19900000000007
[aiter INFO] 2025-10-23 03:32:40.062 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000035
[aiter INFO] 2025-10-23 03:32:40.062 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:32:40.062 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.079000000000065
[aiter INFO] 2025-10-23 03:32:40.062 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:32:40.081 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            676.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          4,742.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,529.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           55.3             55.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:40.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    55.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:40.086 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:40.133 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_5594e384b75e99eeecad872ecfb5704d' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_5594e384b75e99eeecad872ecfb5704d', 'folder': 'pa_5594e384b75e99eeecad872ecfb5704d', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_5594e384b75e99eeecad872ecfb5704d(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:40.133 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include -c pa_5594e384b75e99eeecad872ecfb5704d.cpp -o pa_5594e384b75e99eeecad872ecfb5704d.o
In file included from pa_5594e384b75e99eeecad872ecfb5704d.cpp:1:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_5594e384b75e99eeecad872ecfb5704d.cpp:1:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_5594e384b75e99eeecad872ecfb5704d.o -o lib.so
[aiter INFO] 2025-10-23 03:32:43.306 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_5594e384b75e99eeecad872ecfb5704d, cost 3.17319932s
[aiter INFO] 2025-10-23 03:32:43.334 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 189.68855478976033 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {992, 194, 9, 1002, 204, 17, 20, 28}
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.88100000000122
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.279
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.43900000000002
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999069
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999978
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.19900000000001
[aiter INFO] 2025-10-23 03:32:43.405 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.599000000000046
[aiter INFO] 2025-10-23 03:32:43.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,041.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0          9,620.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,997.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          110.0            109.9         NaN          NaN
[aiter INFO] 2025-10-23 03:32:43.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   109.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:44.338 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 400.4242762480632 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:44.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {99, 12, 37, 62}
[aiter INFO] 2025-10-23 03:32:44.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.519
[aiter INFO] 2025-10-23 03:32:44.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 291.28099999999995
[aiter INFO] 2025-10-23 03:32:44.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.361
[aiter INFO] 2025-10-23 03:32:44.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.83900000000006
[aiter INFO] 2025-10-23 03:32:44.423 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         27,969.2        CUDA            5
[avg us/iter]               NaN  NaN            0.0            288.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:44.449 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.6758813356409 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:44.486 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:44.487 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000009
[aiter INFO] 2025-10-23 03:32:44.499 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            824.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:44.500 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   296.59 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:44.886 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 213.00821758732937 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {961, 38, 12, 1169, 25}
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.07899999999972
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.56100000000004
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.35900000000004
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.19900000000052
[aiter INFO] 2025-10-23 03:32:45.117 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.15899999999999
[aiter INFO] 2025-10-23 03:32:45.129 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0          9,450.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             98.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:45.157 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.99785161490487 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:45.199 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:45.199 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999984
[aiter INFO] 2025-10-23 03:32:45.211 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            818.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:45.213 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   106.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:45.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_c6d41b2a00463238e23ac6907984e040' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_c6d41b2a00463238e23ac6907984e040', 'folder': 'pa_c6d41b2a00463238e23ac6907984e040', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_c6d41b2a00463238e23ac6907984e040(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:45.222 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include -c pa_c6d41b2a00463238e23ac6907984e040.cpp -o pa_c6d41b2a00463238e23ac6907984e040.o
In file included from pa_c6d41b2a00463238e23ac6907984e040.cpp:1:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/quant_utils.cuh:19:
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_c6d41b2a00463238e23ac6907984e040.cpp:1:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/quant_utils.cuh:19:
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_c6d41b2a00463238e23ac6907984e040.o -o lib.so
[aiter INFO] 2025-10-23 03:32:48.380 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_c6d41b2a00463238e23ac6907984e040, cost 3.15880394s
[aiter INFO] 2025-10-23 03:32:48.427 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.92497067286237 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:48.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {185, 193, 9, 17}
[aiter INFO] 2025-10-23 03:32:48.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.35899999999992
[aiter INFO] 2025-10-23 03:32:48.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.43899999999985
[aiter INFO] 2025-10-23 03:32:48.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.279
[aiter INFO] 2025-10-23 03:32:48.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999999
[aiter INFO] 2025-10-23 03:32:48.508 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,112.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          9,223.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,438.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          104.4            104.4         NaN          NaN
[aiter INFO] 2025-10-23 03:32:48.510 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   104.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:48.515 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:48.564 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_129d87bef06865c095403dccfeea7b0c' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_129d87bef06865c095403dccfeea7b0c', 'folder': 'pa_129d87bef06865c095403dccfeea7b0c', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_129d87bef06865c095403dccfeea7b0c(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:48.564 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include -c pa_129d87bef06865c095403dccfeea7b0c.cpp -o pa_129d87bef06865c095403dccfeea7b0c.o
In file included from pa_129d87bef06865c095403dccfeea7b0c.cpp:1:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/quant_utils.cuh:19:
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_129d87bef06865c095403dccfeea7b0c.cpp:1:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/quant_utils.cuh:19:
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_129d87bef06865c095403dccfeea7b0c.o -o lib.so
[aiter INFO] 2025-10-23 03:32:51.796 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_129d87bef06865c095403dccfeea7b0c, cost 3.23199079s
[aiter INFO] 2025-10-23 03:32:51.827 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.325178336389 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 554, 1070, 175, 1071, 19, 566, 191}
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.87899999999996
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 141.1189999999997
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.95900000000074
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 140.88099999999986
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.95900000000006
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.118999999999687
[aiter INFO] 2025-10-23 03:32:51.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.43899999999985
[aiter INFO] 2025-10-23 03:32:51.929 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,391.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         13,796.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,656.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          156.6            156.6         NaN          NaN
[aiter INFO] 2025-10-23 03:32:51.929 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   156.57 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:52.422 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 219.667653636177 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:52.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 337, 532, 597, 25, 415}
[aiter INFO] 2025-10-23 03:32:52.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.67900000000003
[aiter INFO] 2025-10-23 03:32:52.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.31899999999996
[aiter INFO] 2025-10-23 03:32:52.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.03900000000067
[aiter INFO] 2025-10-23 03:32:52.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.23900000000049
[aiter INFO] 2025-10-23 03:32:52.480 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.79899999999998
[aiter INFO] 2025-10-23 03:32:52.480 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.5610000000006
[aiter INFO] 2025-10-23 03:32:52.490 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 95.0            0.0          9,578.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.8         NaN          NaN
[aiter INFO] 2025-10-23 03:32:52.518 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.61410878495414 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:52.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:32:52.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.119
[aiter INFO] 2025-10-23 03:32:52.570 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            919.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.2         NaN          NaN
[aiter INFO] 2025-10-23 03:32:52.571 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   110.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:52.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_fed5109bec2e86fec6fb080b10ac9982' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_fed5109bec2e86fec6fb080b10ac9982', 'folder': 'pa_fed5109bec2e86fec6fb080b10ac9982', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_fed5109bec2e86fec6fb080b10ac9982(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:52.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include -c pa_fed5109bec2e86fec6fb080b10ac9982.cpp -o pa_fed5109bec2e86fec6fb080b10ac9982.o
In file included from pa_fed5109bec2e86fec6fb080b10ac9982.cpp:1:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/quant_utils.cuh:19:
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_fed5109bec2e86fec6fb080b10ac9982.cpp:1:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/quant_utils.cuh:19:
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_fed5109bec2e86fec6fb080b10ac9982.o -o lib.so
[aiter INFO] 2025-10-23 03:32:55.820 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_fed5109bec2e86fec6fb080b10ac9982, cost 3.23853507s
[aiter INFO] 2025-10-23 03:32:55.870 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 228.34687111991468 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:55.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {240, 9, 19, 229}
[aiter INFO] 2025-10-23 03:32:55.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:32:55.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.55899999999997
[aiter INFO] 2025-10-23 03:32:55.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.680999999999983
[aiter INFO] 2025-10-23 03:32:55.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.1210000000001
[aiter INFO] 2025-10-23 03:32:55.952 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,435.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         12,308.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,883.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          138.8            138.8         NaN          NaN
[aiter INFO] 2025-10-23 03:32:55.954 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   138.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:55.962 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:32:56.010 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_1110336ec9511417d051fe29e1a370ba' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_1110336ec9511417d051fe29e1a370ba', 'folder': 'pa_1110336ec9511417d051fe29e1a370ba', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_1110336ec9511417d051fe29e1a370ba(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:32:56.010 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include -c pa_1110336ec9511417d051fe29e1a370ba.cpp -o pa_1110336ec9511417d051fe29e1a370ba.o
In file included from pa_1110336ec9511417d051fe29e1a370ba.cpp:1:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/quant_utils.cuh:19:
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_1110336ec9511417d051fe29e1a370ba.cpp:1:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/quant_utils.cuh:19:
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_1110336ec9511417d051fe29e1a370ba.o -o lib.so
[aiter INFO] 2025-10-23 03:32:59.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_1110336ec9511417d051fe29e1a370ba, cost 3.26625553s
[aiter INFO] 2025-10-23 03:32:59.313 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 273.24326823253443 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:32:59.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {433, 450, 21, 9}
[aiter INFO] 2025-10-23 03:32:59.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.07899999999972
[aiter INFO] 2025-10-23 03:32:59.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91899999999987
[aiter INFO] 2025-10-23 03:32:59.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.958999999999946
[aiter INFO] 2025-10-23 03:32:59.393 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 169.27900000000005
[aiter INFO] 2025-10-23 03:32:59.412 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,793.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         16,745.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,721.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          187.2            187.3         NaN          NaN
[aiter INFO] 2025-10-23 03:32:59.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   187.26 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:32:59.968 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.30926714203144 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:00.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {883, 12}
[aiter INFO] 2025-10-23 03:33:00.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.87900000000081
[aiter INFO] 2025-10-23 03:33:00.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.67900000000003
[aiter INFO] 2025-10-23 03:33:00.032 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         10,608.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            107.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:00.060 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.86121799509124 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:00.096 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:00.096 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119
[aiter INFO] 2025-10-23 03:33:00.108 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,126.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:00.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   118.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:00.122 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_e5795f96d037bd9e2d8243d44a917cbc' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_e5795f96d037bd9e2d8243d44a917cbc', 'folder': 'pa_e5795f96d037bd9e2d8243d44a917cbc', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_e5795f96d037bd9e2d8243d44a917cbc(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:00.123 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include -c pa_e5795f96d037bd9e2d8243d44a917cbc.cpp -o pa_e5795f96d037bd9e2d8243d44a917cbc.o
In file included from pa_e5795f96d037bd9e2d8243d44a917cbc.cpp:1:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_e5795f96d037bd9e2d8243d44a917cbc.cpp:1:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_e5795f96d037bd9e2d8243d44a917cbc.o -o lib.so
[aiter INFO] 2025-10-23 03:33:03.442 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_e5795f96d037bd9e2d8243d44a917cbc, cost 3.31900880s
[aiter INFO] 2025-10-23 03:33:03.732 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 739.3018520704591 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:03.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1034, 1035, 62}
[aiter INFO] 2025-10-23 03:33:03.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 639.079
[aiter INFO] 2025-10-23 03:33:03.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 639.6829999999973
[aiter INFO] 2025-10-23 03:33:03.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.239000000001397
[aiter INFO] 2025-10-23 03:33:03.844 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.399
[aiter INFO] 2025-10-23 03:33:03.863 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,811.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         62,861.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,330.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          653.3            653.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:03.864 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   653.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:03.875 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:03.974 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 207.39156450375472 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:33:04.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.11899999999997
[aiter INFO] 2025-10-23 03:33:04.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.718999999999994
[aiter INFO] 2025-10-23 03:33:04.068 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            983.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         11,812.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,796.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          128.0            128.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   127.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:04.259 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 448.5654355865894 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {185, 1308, 12}
[aiter INFO] 2025-10-23 03:33:04.338 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 350.0790000000002
[aiter INFO] 2025-10-23 03:33:04.338 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 350.1209999999992
[aiter INFO] 2025-10-23 03:33:04.338 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 353.72100000000006
[aiter INFO] 2025-10-23 03:33:04.348 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         34,217.7        CUDA            5
[avg us/iter]               NaN  NaN            0.0            349.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.375 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.59546504516413 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:04.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799000000000007
[aiter INFO] 2025-10-23 03:33:04.422 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            758.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.423 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   356.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:04.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 201.1994751963285 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1065, 103}
[aiter INFO] 2025-10-23 03:33:04.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.11900000000003
[aiter INFO] 2025-10-23 03:33:04.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.36100000000002
[aiter INFO] 2025-10-23 03:33:04.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.28100000000086
[aiter INFO] 2025-10-23 03:33:04.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.39899999999989
[aiter INFO] 2025-10-23 03:33:04.540 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          7,692.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             79.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.567 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.67825762824256 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.602 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:04.603 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.919000000000011
[aiter INFO] 2025-10-23 03:33:04.615 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            759.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.616 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    86.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:04.661 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.87619763789792 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {867, 9, 875, 17, 20, 28}
[aiter INFO] 2025-10-23 03:33:04.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.67900000000009
[aiter INFO] 2025-10-23 03:33:04.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.47900000000001
[aiter INFO] 2025-10-23 03:33:04.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15899999999965
[aiter INFO] 2025-10-23 03:33:04.713 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.559000000000026
[aiter INFO] 2025-10-23 03:33:04.714 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.719
[aiter INFO] 2025-10-23 03:33:04.714 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.35899999999998
[aiter INFO] 2025-10-23 03:33:04.733 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            916.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          7,189.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,272.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           82.7             82.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.733 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    82.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:04.737 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:04.842 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 251.3247921620265 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:04.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 109, 25, 95}
[aiter INFO] 2025-10-23 03:33:04.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.68099999999998
[aiter INFO] 2025-10-23 03:33:04.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.878999999999905
[aiter INFO] 2025-10-23 03:33:04.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:33:04.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.44100000000003
[aiter INFO] 2025-10-23 03:33:04.928 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,541.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,426.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,141.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          171.4            171.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:04.929 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   171.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:05.137 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 571.4791328600137 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:05.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1201, 12, 1289}
[aiter INFO] 2025-10-23 03:33:05.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 466.03899999999885
[aiter INFO] 2025-10-23 03:33:05.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 472.081
[aiter INFO] 2025-10-23 03:33:05.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 466.03899999999703
[aiter INFO] 2025-10-23 03:33:05.235 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         45,766.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            467.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:05.262 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.65647489894735 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:05.295 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:05.295 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-10-23 03:33:05.307 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,024.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             10.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:05.308 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   477.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:05.368 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 262.5323448440816 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:05.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1013}
[aiter INFO] 2025-10-23 03:33:05.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.319
[aiter INFO] 2025-10-23 03:33:05.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.96099999999933
[aiter INFO] 2025-10-23 03:33:05.600 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         14,939.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            150.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:05.628 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.6148810717139 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:05.664 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:05.664 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-10-23 03:33:05.676 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,025.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             10.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:05.677 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   161.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:05.738 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 247.3524755770617 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:05.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 202, 214, 22}
[aiter INFO] 2025-10-23 03:33:05.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 149.281
[aiter INFO] 2025-10-23 03:33:05.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.03900000000021
[aiter INFO] 2025-10-23 03:33:05.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-10-23 03:33:05.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.118999999999971
[aiter INFO] 2025-10-23 03:33:05.818 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,544.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,557.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,263.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          162.6            162.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:05.819 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   162.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:05.827 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:05.941 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 326.61812966412833 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {452, 549, 9, 527, 1044, 1045, 476, 30}
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 227.71900000000005
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.559000000000196
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 229.241
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 225.27900000000045
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 225.40099999999802
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.35900000000038
[aiter INFO] 2025-10-23 03:33:06.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.71900000000005
[aiter INFO] 2025-10-23 03:33:06.023 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.238999999999976
[aiter INFO] 2025-10-23 03:33:06.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,085.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         21,983.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,812.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          248.1            248.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:06.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   248.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:06.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 264.4990898004853 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:06.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {243, 12}
[aiter INFO] 2025-10-23 03:33:06.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.96099999999979
[aiter INFO] 2025-10-23 03:33:06.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.11899999999997
[aiter INFO] 2025-10-23 03:33:06.294 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         15,203.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            153.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:06.323 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.87626694452644 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:06.357 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:06.357 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:33:06.369 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,213.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             12.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:06.370 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   165.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:06.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 302.29248652363765 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:06.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {88, 9, 26, 71}
[aiter INFO] 2025-10-23 03:33:06.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.278999999999996
[aiter INFO] 2025-10-23 03:33:06.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.67900000000003
[aiter INFO] 2025-10-23 03:33:06.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.799000000000035
[aiter INFO] 2025-10-23 03:33:06.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 196.55900000000008
[aiter INFO] 2025-10-23 03:33:06.530 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,133.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         19,523.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,874.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          218.7            218.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:06.531 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   218.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:06.544 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:06.662 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 374.7279703026951 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:06.741 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1024, 1025, 35, 260, 1062, 1063, 9, 204, 1036, 238, 175, 1037, 181, 152}
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 263.59899999999834
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.47899999999936
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.35899999999998
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.40099999999984
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 261.9989999999998
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.318999999999505
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 261.721
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.559000000000196
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 261.60099999999875
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 261.83899999999994
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.479000000000042
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.319000000003143
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 262.2790000000002
[aiter INFO] 2025-10-23 03:33:06.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 261.799
[aiter INFO] 2025-10-23 03:33:06.761 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0          2,571.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  94.0            0.0         24,398.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       28,707.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          287.1            286.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:06.762 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   286.91 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:06.947 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 296.6401777645149 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:07.004 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {204, 12}
[aiter INFO] 2025-10-23 03:33:07.004 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 168.8409999999999
[aiter INFO] 2025-10-23 03:33:07.004 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.19899999999998
[aiter INFO] 2025-10-23 03:33:07.015 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         16,516.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            166.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:07.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.09211886047136 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:07.074 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:33:07.074 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.31899999999996
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.0390000000001
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.079000000000008
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.758999999999986
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.319000000000074
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.240999999999985
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119000000000028
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.998999999999967
[aiter INFO] 2025-10-23 03:33:07.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.159000000000106
[aiter INFO] 2025-10-23 03:33:07.087 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,355.2        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:07.088 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   181.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:07.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1125.498363287142 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {98, 581, 485, 677, 9, 586}
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.638999999999896
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.27899999999954
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1023.3229999999994
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.398999999999432
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1019.443
[aiter INFO] 2025-10-23 03:33:07.561 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1023.2030000000004
[aiter INFO] 2025-10-23 03:33:07.580 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,678.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         99,712.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      104,491.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,044.9          1,044.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:07.582 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1044.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:07.603 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:07.652 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_6353257cc29923c65aadc9b0b7aa8d7d' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_6353257cc29923c65aadc9b0b7aa8d7d', 'folder': 'pa_6353257cc29923c65aadc9b0b7aa8d7d', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_6353257cc29923c65aadc9b0b7aa8d7d(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:07.652 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include -c pa_6353257cc29923c65aadc9b0b7aa8d7d.cpp -o pa_6353257cc29923c65aadc9b0b7aa8d7d.o
In file included from pa_6353257cc29923c65aadc9b0b7aa8d7d.cpp:1:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_6353257cc29923c65aadc9b0b7aa8d7d.cpp:1:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_6353257cc29923c65aadc9b0b7aa8d7d.o -o lib.so
[aiter INFO] 2025-10-23 03:33:10.792 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_6353257cc29923c65aadc9b0b7aa8d7d, cost 3.14000892s
[aiter INFO] 2025-10-23 03:33:10.818 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.79302909350633 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:10.889 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {977, 985, 9, 17}
[aiter INFO] 2025-10-23 03:33:10.890 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.71900000000096
[aiter INFO] 2025-10-23 03:33:10.890 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000001397
[aiter INFO] 2025-10-23 03:33:10.890 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.35899999999998
[aiter INFO] 2025-10-23 03:33:10.890 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-10-23 03:33:10.909 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            842.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          7,753.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,686.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           86.9             86.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:10.910 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    86.83 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:11.586 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 318.13450408453986 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:11.651 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {50, 12}
[aiter INFO] 2025-10-23 03:33:11.651 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 213.59899999999993
[aiter INFO] 2025-10-23 03:33:11.651 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.279
[aiter INFO] 2025-10-23 03:33:11.662 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         21,031.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            212.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:11.689 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.86675241382994 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:11.727 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:11.727 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.799000000000007
[aiter INFO] 2025-10-23 03:33:11.739 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            701.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:11.740 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   219.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:12.079 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 176.0877037402427 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:12.135 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 272, 12, 870}
[aiter INFO] 2025-10-23 03:33:12.135 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.999000000000024
[aiter INFO] 2025-10-23 03:33:12.135 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.07900000000018
[aiter INFO] 2025-10-23 03:33:12.135 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.59899999999999
[aiter INFO] 2025-10-23 03:33:12.135 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.55899999999929
[aiter INFO] 2025-10-23 03:33:12.148 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          5,260.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             54.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:12.175 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.38322779801813 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:12.218 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:12.218 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.07899999999998
[aiter INFO] 2025-10-23 03:33:12.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            693.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:12.231 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    61.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:12.237 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_d0fc7465e87f1a1eef4d394efff112cd' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_d0fc7465e87f1a1eef4d394efff112cd', 'folder': 'pa_d0fc7465e87f1a1eef4d394efff112cd', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_d0fc7465e87f1a1eef4d394efff112cd(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:12.237 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include -c pa_d0fc7465e87f1a1eef4d394efff112cd.cpp -o pa_d0fc7465e87f1a1eef4d394efff112cd.o
In file included from pa_d0fc7465e87f1a1eef4d394efff112cd.cpp:1:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_d0fc7465e87f1a1eef4d394efff112cd.cpp:1:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_d0fc7465e87f1a1eef4d394efff112cd.o -o lib.so
[aiter INFO] 2025-10-23 03:33:15.372 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_d0fc7465e87f1a1eef4d394efff112cd, cost 3.13516462s
[aiter INFO] 2025-10-23 03:33:15.413 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 143.89471267119492 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:15.468 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 9, 27, 20}
[aiter INFO] 2025-10-23 03:33:15.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.439000000000021
[aiter INFO] 2025-10-23 03:33:15.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.03899999999999
[aiter INFO] 2025-10-23 03:33:15.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-10-23 03:33:15.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.63899999999995
[aiter INFO] 2025-10-23 03:33:15.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            887.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          4,938.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,885.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           58.9             58.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:15.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    58.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:15.492 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:15.540 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_9ff94316100cfaa8bc867aed9a79de74' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_9ff94316100cfaa8bc867aed9a79de74', 'folder': 'pa_9ff94316100cfaa8bc867aed9a79de74', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_9ff94316100cfaa8bc867aed9a79de74(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:15.540 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include -c pa_9ff94316100cfaa8bc867aed9a79de74.cpp -o pa_9ff94316100cfaa8bc867aed9a79de74.o
In file included from pa_9ff94316100cfaa8bc867aed9a79de74.cpp:1:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_9ff94316100cfaa8bc867aed9a79de74.cpp:1:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_9ff94316100cfaa8bc867aed9a79de74.o -o lib.so
[aiter INFO] 2025-10-23 03:33:18.710 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_9ff94316100cfaa8bc867aed9a79de74, cost 3.16969671s
[aiter INFO] 2025-10-23 03:33:18.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.24618791471613 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:18.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 514, 17, 503}
[aiter INFO] 2025-10-23 03:33:18.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.55899999999997
[aiter INFO] 2025-10-23 03:33:18.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999796
[aiter INFO] 2025-10-23 03:33:18.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.838999999999999
[aiter INFO] 2025-10-23 03:33:18.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.39900000000034
[aiter INFO] 2025-10-23 03:33:18.824 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,496.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         10,175.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,792.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          117.9            117.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:18.825 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   117.90 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:20.228 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 401.9177620953853 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:20.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:20.301 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 297.19899999999996
[aiter INFO] 2025-10-23 03:33:20.311 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         29,440.0        CUDA            5
[avg us/iter]               NaN   NaN            0.0            294.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:20.338 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.22835634958625 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:20.374 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:20.374 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.518999999999977
[aiter INFO] 2025-10-23 03:33:20.386 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            949.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:20.387 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   303.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

gluon_fp8_output_md5=43b1a29574f505fd6dcfb78c10937347
diff.abs.max=0.0030517578125
max_diff_thr=0.003016585484147072

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013427734375
max_diff_thr=0.0013181546237319708

NaN info:
{}
out_ref_md5=1bcc4214288e8f3aaf12ea00c633a870
gluon_fp8_output_md5=245a2a53937e6f54a1145c9f8ad84cc7
diff.abs.max=0.00348663330078125
max_diff_thr=0.003469059243798256

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.001745410729199648

NaN info:
{}
out_ref_md5=5bb4a418187ef1ca4a9367ea2ea7f359
triton_fp8_output_md5=1fdb4581d67fe69a8a4dcbeee060c147
diff.abs.max=0.0010986328125
max_diff_thr=0.0010862350463867188

NaN info:
{}
out_ref_md5=5bb4a418187ef1ca4a9367ea2ea7f359
gluon_fp8_output_md5=8b015790e3e78d0b0d2e92c7e2dafbe6
diff.abs.max=0.0029296875
max_diff_thr=0.0029064486734569073

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017598154954612255

NaN info:
{}
out_ref_md5=a7ebf8caa50808cac7979025412408c1
triton_fp8_output_md5=1decd35236722773ca22cff43d52b6e9
diff.abs.max=0.00115966796875
max_diff_thr=0.0011554014636203647

NaN info:
{}
out_ref_md5=a7ebf8caa50808cac7979025412408c1
gluon_fp8_output_md5=4acf74124eff618075d5031e0f2f2b2b
diff.abs.max=0.00323486328125
max_diff_thr=0.003191425232216716

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.001268575550056994

NaN info:
{}
out_ref_md5=477acd8dac41f0d8269757eb03c63961
gluon_fp8_output_md5=9707492a7d19f9f284428d1119fce586
diff.abs.max=0.00311279296875
max_diff_thr=0.003078649751842022

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.00146484375
max_diff_thr=0.0014407491544261575

NaN info:
{}
out_ref_md5=33a777faa1443854ba1dc21f6f823783
gluon_fp8_output_md5=e28dfdfa8178f89e5f89feeab6ac5067
diff.abs.max=0.0032958984375
max_diff_thr=0.003233532886952162

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017514192732051015

NaN info:
{}
out_ref_md5=f7f07a381d5a01ff17cba0769c20fc46
triton_fp8_output_md5=e383997a1dd6debd0a42eafb15c2fcce
diff.abs.max=0.001220703125
max_diff_thr=0.001200336148031056

NaN info:
{}
out_ref_md5=f7f07a381d5a01ff17cba0769c20fc46
gluon_fp8_output_md5=19f540f87a1f3e199f6f4374cf19eed1
diff.abs.max=0.0029296875
max_diff_thr=0.0029045140836387873

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016894949367269874

NaN info:
{}
out_ref_md5=00e591cfa3bf40baefcbdf6cab730b24
triton_fp8_output_md5=cfa5c5d7fb533fc727d30c955bba6fef
diff.abs.max=0.001190185546875
max_diff_thr=0.0011823914246633649

NaN info:
{}
out_ref_md5=00e591cfa3bf40baefcbdf6cab730b24
gluon_fp8_output_md5=206e19180ce507590727549c80361a7d
diff.abs.max=0.003173828125
max_diff_thr=0.0031555313616991043

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012758589582517743

NaN info:
{}
out_ref_md5=d7f2242e05aff3afb85892ad0ddd2dc1
gluon_fp8_output_md5=2451472d14e096cdef23dfd2f84699e0
diff.abs.max=0.0031585693359375
max_diff_thr=0.0031369340140372515

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001201629638671875
max_diff_thr=0.0011998263653367758

NaN info:
{}
out_ref_md5=c46045eede32ec1aca6040e381c4dd00
gluon_fp8_output_md5=dc838012d0eec657200ee480ee9be2f3
diff.abs.max=0.00311279296875
max_diff_thr=0.003070069942623377

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017840152140706778

NaN info:
{}
out_ref_md5=06eb9ffe5a4974a7c93494fe6a2769f7
triton_fp8_output_md5=eca1257c4c3a710fa342bdef996e3080
diff.abs.max=0.00130462646484375
max_diff_thr=0.0013013500720262527

NaN info:
{}
out_ref_md5=06eb9ffe5a4974a7c93494fe6a2769f7
gluon_fp8_output_md5=2bafddaccc575661cf4624cd5e8a3c36
diff.abs.max=0.0032958984375
max_diff_thr=0.0032465581316500902

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001953125
max_diff_thr=0.001917545567266643

NaN info:
{}
out_ref_md5=c43a53ce78c2b460766b1ad92e04c2b1
triton_fp8_output_md5=9480f691b5914dfad87b8ea3efed5949
diff.abs.max=0.00128173828125
max_diff_thr=0.0012714173644781113

NaN info:
{}
out_ref_md5=c43a53ce78c2b460766b1ad92e04c2b1
gluon_fp8_output_md5=3d6aed0e477c5f1c3e646c75e614e767
diff.abs.max=0.00315093994140625
max_diff_thr=0.0031376301776617765

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013427734375
max_diff_thr=0.0013265798334032297

NaN info:
{}
out_ref_md5=a88df53730584bb579d0dee248cf83fe
gluon_fp8_output_md5=c07163b722b88e7a0ef8a3e876adf732
diff.abs.max=0.0030517578125
max_diff_thr=0.00301841227337718

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0012598037719726562
max_diff_thr=0.0012597545282915235

NaN info:
{}
out_ref_md5=4342585a97cd22f6ca15368629b67597
gluon_fp8_output_md5=9885e1f81e525f6af0f5912aa2eee6a9
diff.abs.max=0.00334930419921875
max_diff_thr=0.003346419194713235

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001690514967776835

NaN info:
{}
out_ref_md5=3b72ac5afae225b0f37bceaa727fe031
triton_fp8_output_md5=2ad95f3d7a8d38e9fb4dfd5e5b3818b1
diff.abs.max=0.00140380859375
max_diff_thr=0.001392842037603259

NaN info:
{}
out_ref_md5=3b72ac5afae225b0f37bceaa727fe031
gluon_fp8_output_md5=c6d9fc737f3604b38233b4c85039efbd
diff.abs.max=0.0029144287109375
max_diff_thr=0.002903573913499713

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00189208984375
max_diff_thr=0.001874811016023159

NaN info:
{}
out_ref_md5=78a3b43bfe8b00c82a1ed8e78e6baa8a
triton_fp8_output_md5=a47cad4d2a1f5433e914573dbca5c1cc[aiter INFO] 2025-10-23 03:33:20.917 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 215.25534633362648 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:20.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1117}
[aiter INFO] 2025-10-23 03:33:20.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.03900000000004
[aiter INFO] 2025-10-23 03:33:20.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.59899999999999
[aiter INFO] 2025-10-23 03:33:20.972 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.7609999999986
[aiter INFO] 2025-10-23 03:33:20.985 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          9,786.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             99.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:21.012 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.42597034662077 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:21.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:21.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.638999999999982
[aiter INFO] 2025-10-23 03:33:21.063 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            957.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:21.064 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   109.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:21.074 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_5eba3241d5950b84f90e45d8f25d292d' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_5eba3241d5950b84f90e45d8f25d292d', 'folder': 'pa_5eba3241d5950b84f90e45d8f25d292d', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_5eba3241d5950b84f90e45d8f25d292d(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:21.075 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include -c pa_5eba3241d5950b84f90e45d8f25d292d.cpp -o pa_5eba3241d5950b84f90e45d8f25d292d.o
In file included from pa_5eba3241d5950b84f90e45d8f25d292d.cpp:1:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_5eba3241d5950b84f90e45d8f25d292d.cpp:1:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_5eba3241d5950b84f90e45d8f25d292d.o -o lib.so
[aiter INFO] 2025-10-23 03:33:24.260 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_5eba3241d5950b84f90e45d8f25d292d, cost 3.18511742s
[aiter INFO] 2025-10-23 03:33:24.306 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.43785092854262 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:24.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 874, 17, 882, 20, 53, 28, 62}
[aiter INFO] 2025-10-23 03:33:24.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.55899999999997
[aiter INFO] 2025-10-23 03:33:24.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.3189999999995
[aiter INFO] 2025-10-23 03:33:24.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.878999999999962
[aiter INFO] 2025-10-23 03:33:24.364 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.679000000000087
[aiter INFO] 2025-10-23 03:33:24.365 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.23899999999998
[aiter INFO] 2025-10-23 03:33:24.365 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.59899999999993
[aiter INFO] 2025-10-23 03:33:24.365 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:33:24.365 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:33:24.384 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,466.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          9,200.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,997.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          110.0            110.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:24.385 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   109.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:24.394 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:24.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_59765456d268a39c598a0ef6959722e6' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_59765456d268a39c598a0ef6959722e6', 'folder': 'pa_59765456d268a39c598a0ef6959722e6', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_59765456d268a39c598a0ef6959722e6(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:24.442 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include -c pa_59765456d268a39c598a0ef6959722e6.cpp -o pa_59765456d268a39c598a0ef6959722e6.o
In file included from pa_59765456d268a39c598a0ef6959722e6.cpp:1:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_59765456d268a39c598a0ef6959722e6.cpp:1:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_59765456d268a39c598a0ef6959722e6.o -o lib.so
[aiter INFO] 2025-10-23 03:33:27.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_59765456d268a39c598a0ef6959722e6, cost 3.21566668s
[aiter INFO] 2025-10-23 03:33:27.690 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 246.7544943389326 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:27.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19, 1094, 1095}
[aiter INFO] 2025-10-23 03:33:27.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.839
[aiter INFO] 2025-10-23 03:33:27.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.63900000000001
[aiter INFO] 2025-10-23 03:33:27.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.3209999999999
[aiter INFO] 2025-10-23 03:33:27.771 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.79899999999907
[aiter INFO] 2025-10-23 03:33:27.790 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,083.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         14,487.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,736.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          167.4            167.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:27.791 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   167.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:28.344 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 238.70810895863144 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 12, 51, 116, 441}
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 110.64099999999985
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 111.15899999999999
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 110.67900000000009
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 111.519
[aiter INFO] 2025-10-23 03:33:28.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.35899999999947
[aiter INFO] 2025-10-23 03:33:28.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0         10,510.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            109.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:28.438 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.0691482082452 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.319000000000017
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000019
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.439000000000021
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000037
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.95900000000006
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.95900000000006
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.95900000000006
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-10-23 03:33:28.475 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999955
[aiter INFO] 2025-10-23 03:33:28.476 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999919
[aiter INFO] 2025-10-23 03:33:28.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,078.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:28.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   121.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:28.507 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_6b51f1457cd427fe5d8a9b7f46bddf28' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_6b51f1457cd427fe5d8a9b7f46bddf28', 'folder': 'pa_6b51f1457cd427fe5d8a9b7f46bddf28', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_6b51f1457cd427fe5d8a9b7f46bddf28(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:28.507 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include -c pa_6b51f1457cd427fe5d8a9b7f46bddf28.cpp -o pa_6b51f1457cd427fe5d8a9b7f46bddf28.o
In file included from pa_6b51f1457cd427fe5d8a9b7f46bddf28.cpp:1:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/quant_utils.cuh:19:
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_6b51f1457cd427fe5d8a9b7f46bddf28.cpp:1:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/quant_utils.cuh:19:
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_6b51f1457cd427fe5d8a9b7f46bddf28.o -o lib.so
[aiter INFO] 2025-10-23 03:33:31.741 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_6b51f1457cd427fe5d8a9b7f46bddf28, cost 3.23348349s
[aiter INFO] 2025-10-23 03:33:31.790 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 231.9512674123934 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:31.853 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:33:31.853 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.08100000000002
[aiter INFO] 2025-10-23 03:33:31.853 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.11899999999997
[aiter INFO] 2025-10-23 03:33:31.873 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,114.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,407.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,522.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          145.2            145.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:31.874 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   145.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:31.887 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:31.934 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_f377078ba853ae2e5655e67315739bd6' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_f377078ba853ae2e5655e67315739bd6', 'folder': 'pa_f377078ba853ae2e5655e67315739bd6', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_f377078ba853ae2e5655e67315739bd6(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:31.934 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include -c pa_f377078ba853ae2e5655e67315739bd6.cpp -o pa_f377078ba853ae2e5655e67315739bd6.o
In file included from pa_f377078ba853ae2e5655e67315739bd6.cpp:1:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_f377078ba853ae2e5655e67315739bd6.cpp:1:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_f377078ba853ae2e5655e67315739bd6.o -o lib.so
[aiter INFO] 2025-10-23 03:33:35.223 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_f377078ba853ae2e5655e67315739bd6, cost 3.28938813s
[aiter INFO] 2025-10-23 03:33:35.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 282.9141587314039 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {704, 928, 26, 1082, 809, 1083, 9, 108, 687, 913, 1108, 1109, 1110, 1111, 825, 1018, 1019, 126}
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.438999999999396
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.119000000000597
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.5590000000011
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.79899999999998
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.998999999999796
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 174.12099999999998
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.31899999999996
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.59900000000016
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 171.51900000000023
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.03900000000067
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.47899999999936
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.03900000000067
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.438999999998487
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.238999999999578
[aiter INFO] 2025-10-23 03:33:35.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 171.28099999999904
[aiter INFO] 2025-10-23 03:33:35.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.119000000000597
[aiter INFO] 2025-10-23 03:33:35.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.479000000000042
[aiter INFO] 2025-10-23 03:33:35.356 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0          2,501.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  92.0            0.0         16,042.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,149.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          201.5            201.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:35.357 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   201.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:36.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 259.12482166054224 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:36.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {919, 324, 12, 596}
[aiter INFO] 2025-10-23 03:33:36.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.27899999999863
[aiter INFO] 2025-10-23 03:33:36.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.28099999999995
[aiter INFO] 2025-10-23 03:33:36.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.719
[aiter INFO] 2025-10-23 03:33:36.115 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.6790000000001
[aiter INFO] 2025-10-23 03:33:36.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         13,732.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            141.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:36.153 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.3871882610982 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.319000000000017
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.119
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.15900000000002
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.478999999999985
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.359000000000037
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.039000000000044
[aiter INFO] 2025-10-23 03:33:36.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.038999999999987
[aiter INFO] 2025-10-23 03:33:36.201 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 90.0            0.0          1,375.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:36.203 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   156.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:36.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_51bfa47109250c10b369211417c50269' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_51bfa47109250c10b369211417c50269', 'folder': 'pa_51bfa47109250c10b369211417c50269', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_51bfa47109250c10b369211417c50269(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:33:36.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_51bfa47109250c10b369211417c50269
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include -c pa_51bfa47109250c10b369211417c50269.cpp -o pa_51bfa47109250c10b369211417c50269.o
In file included from pa_51bfa47109250c10b369211417c50269.cpp:1:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/quant_utils.cuh:19:
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_51bfa47109250c10b369211417c50269.cpp:1:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/quant_utils.cuh:19:
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_51bfa47109250c10b369211417c50269/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_51bfa47109250c10b369211417c50269.o -o lib.so
[aiter INFO] 2025-10-23 03:33:39.585 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_51bfa47109250c10b369211417c50269, cost 3.35447018s
[aiter INFO] 2025-10-23 03:33:39.687 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 750.4785143502868 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:39.804 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {968, 969, 1001, 1000, 9, 62}
[aiter INFO] 2025-10-23 03:33:39.804 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 644.6790000000001
[aiter INFO] 2025-10-23 03:33:39.804 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.199000000000524
[aiter INFO] 2025-10-23 03:33:39.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.23899999999776
[aiter INFO] 2025-10-23 03:33:39.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 644.6409999999996
[aiter INFO] 2025-10-23 03:33:39.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.479
[aiter INFO] 2025-10-23 03:33:39.805 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.438999999999965
[aiter INFO] 2025-10-23 03:33:39.824 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,662.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         62,476.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       66,482.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          664.8            664.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:39.825 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   664.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:39.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:39.942 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 212.25536636786885 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19, 581, 566}
[aiter INFO] 2025-10-23 03:33:40.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.35899999999998
[aiter INFO] 2025-10-23 03:33:40.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.678999999999974
[aiter INFO] 2025-10-23 03:33:40.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.519000000000233
[aiter INFO] 2025-10-23 03:33:40.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.67900000000009
[aiter INFO] 2025-10-23 03:33:40.034 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,309.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         11,950.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,395.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          134.0            133.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.034 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   133.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:40.226 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 446.63471396606747 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.305 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:40.305 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 349.121
[aiter INFO] 2025-10-23 03:33:40.316 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         34,332.5        CUDA            5
[avg us/iter]               NaN   NaN            0.0            343.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.343 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.86320806847941 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.378 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:40.378 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.63900000000001
[aiter INFO] 2025-10-23 03:33:40.390 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            797.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.391 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   351.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:40.443 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 201.47510876159856 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.498 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:40.498 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.40100000000001
[aiter INFO] 2025-10-23 03:33:40.510 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          8,172.1        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             81.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.537 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.97687140077647 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.572 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:40.572 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000009
[aiter INFO] 2025-10-23 03:33:40.584 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            794.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.585 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    89.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:40.632 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.79024632614437 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {713, 9, 493, 721, 17, 20, 501, 28}
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.59900000000016
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.719
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.15899999999965
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.719000000000051
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.91900000000004
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.31899999999996
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.798999999999978
[aiter INFO] 2025-10-23 03:33:40.684 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.678999999999974
[aiter INFO] 2025-10-23 03:33:40.703 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,235.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          7,290.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,793.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           87.9             87.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:40.704 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    87.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:40.710 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:40.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 261.6820500628783 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.013 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 1102, 1103}
[aiter INFO] 2025-10-23 03:33:41.013 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.04099999999997
[aiter INFO] 2025-10-23 03:33:41.013 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.199000000000012
[aiter INFO] 2025-10-23 03:33:41.013 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 161.51900000000023
[aiter INFO] 2025-10-23 03:33:41.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.47899999999936
[aiter INFO] 2025-10-23 03:33:41.032 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,239.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,818.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,241.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          182.4            182.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.033 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   182.40 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:41.247 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 571.8715845948399 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:41.337 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 481.161
[aiter INFO] 2025-10-23 03:33:41.348 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         47,646.7        CUDA            5
[avg us/iter]               NaN   NaN            0.0            476.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.375 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.81644546454496 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.35899999999998
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999985
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-10-23 03:33:41.409 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.159000000000106
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.919000000000011
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.799000000000092
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-10-23 03:33:41.410 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:41.422 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 89.0            0.0          1,061.9        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.423 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   488.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:41.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 265.1422675883416 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.547 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:41.547 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.75900000000001
[aiter INFO] 2025-10-23 03:33:41.560 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         15,243.4        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            152.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.587 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.6327324763383 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000012
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.721000000000004
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:41.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:33:41.623 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-10-23 03:33:41.635 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,047.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.636 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   164.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:41.699 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 255.3311491956805 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21}
[aiter INFO] 2025-10-23 03:33:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.64100000000002
[aiter INFO] 2025-10-23 03:33:41.767 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.71900000000005
[aiter INFO] 2025-10-23 03:33:41.786 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,263.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         14,847.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,111.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          171.1            171.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:41.787 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   171.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:41.799 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:41.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 344.73302075178316 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:41.990 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 28}
[aiter INFO] 2025-10-23 03:33:41.990 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.041
[aiter INFO] 2025-10-23 03:33:41.990 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.039000000000044
[aiter INFO] 2025-10-23 03:33:42.009 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          3,218.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         23,299.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       26,518.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          265.2            265.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:42.010 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   265.19 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:42.198 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 298.3173978800821 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:42.258 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {802, 12}
[aiter INFO] 2025-10-23 03:33:42.258 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.31900000000041
[aiter INFO] 2025-10-23 03:33:42.258 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 173.799
[aiter INFO] 2025-10-23 03:33:42.269 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         16,898.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            170.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:42.296 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 81.24618837148836 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 706, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.199000000000012
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.439000000000306
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71900000000005
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.438999999999993
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.15900000000005
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.199000000000012
[aiter INFO] 2025-10-23 03:33:42.330 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839000000000055
[aiter INFO] 2025-10-23 03:33:42.331 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.158999999999992
[aiter INFO] 2025-10-23 03:33:42.331 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.158999999999992
[aiter INFO] 2025-10-23 03:33:42.331 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.238999999999976
[aiter INFO] 2025-10-23 03:33:42.331 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.19900000000007
[aiter INFO] 2025-10-23 03:33:42.343 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 90.0            0.0          1,895.9        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:42.344 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   191.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:42.426 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 315.0279796359562 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:42.492 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:33:42.492 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.76099999999997
[aiter INFO] 2025-10-23 03:33:42.492 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.35899999999998
[aiter INFO] 2025-10-23 03:33:42.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          3,214.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         19,687.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,901.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          229.0            229.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:42.511 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   229.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:42.531 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:42.652 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 396.83934751123485 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:42.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 34}
[aiter INFO] 2025-10-23 03:33:42.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 272.799
[aiter INFO] 2025-10-23 03:33:42.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.480999999999995
[aiter INFO] 2025-10-23 03:33:42.748 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          4,181.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         26,945.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       31,127.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          311.3            311.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:42.748 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   311.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:42.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 337.01138626230824 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:43.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:33:43.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 218.84100000000007
[aiter INFO] 2025-10-23 03:33:43.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 223.47900000000004
[aiter INFO] 2025-10-23 03:33:43.156 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         21,858.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            220.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:43.184 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 84.63555412127239 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.399
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.998999999999995
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.15899999999999
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.91900000000004
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.55899999999997
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.43900000000002
[aiter INFO] 2025-10-23 03:33:43.217 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.759000000000015
[aiter INFO] 2025-10-23 03:33:43.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,502.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:43.231 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   247.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:43.403 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1140.105141271459 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:43.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1008, 1009, 98, 9}
[aiter INFO] 2025-10-23 03:33:43.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1029.1229999999996
[aiter INFO] 2025-10-23 03:33:43.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.559000000001106
[aiter INFO] 2025-10-23 03:33:43.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.278999999999996
[aiter INFO] 2025-10-23 03:33:43.557 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1024.0430000000001
[aiter INFO] 2025-10-23 03:33:43.576 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          4,114.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0        101,220.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      106,405.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,064.1          1,064.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:43.576 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1063.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:43.607 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:43.677 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 158.59139600012563 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {611, 9, 17, 20, 603, 28}
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.76100000000002
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.118999999999971
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.959
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.19899999999961
[aiter INFO] 2025-10-23 03:33:43.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.078999999999951
[aiter INFO] 2025-10-23 03:33:43.755 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            479.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0          8,016.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,675.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           86.8             86.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:43.756 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    86.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:44.615 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 346.5195147707911 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:44.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1292, 12}
[aiter INFO] 2025-10-23 03:33:44.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 237.43900000000212
[aiter INFO] 2025-10-23 03:33:44.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 238.91900000000004
[aiter INFO] 2025-10-23 03:33:44.694 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         23,366.8        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            236.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:44.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.27229736583067 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:44.757 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:44.757 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000002
[aiter INFO] 2025-10-23 03:33:44.769 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            583.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:44.770 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   241.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:45.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.15579165798601 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:45.139 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12}
[aiter INFO] 2025-10-23 03:33:45.139 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.718999999999994
[aiter INFO] 2025-10-23 03:33:45.139 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.919000000000096
[aiter INFO] 2025-10-23 03:33:45.139 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.679
[aiter INFO] 2025-10-23 03:33:45.151 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          4,897.3        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             50.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:45.178 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.68064335903318 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:45.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {468, 6, 671}
[aiter INFO] 2025-10-23 03:33:45.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.198999999999614
[aiter INFO] 2025-10-23 03:33:45.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.679000000000002
[aiter INFO] 2025-10-23 03:33:45.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.2390000000004875
[aiter INFO] 2025-10-23 03:33:45.231 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            572.9        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:45.232 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    55.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:45.276 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 145.32799015540888 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {900, 39, 9, 908, 17, 20, 28, 31}
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.39900000000125
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.158999999999992
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.799000000000035
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.838999999999942
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.91900000000004
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.879000000000019
[aiter INFO] 2025-10-23 03:33:45.327 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.27900000000005
[aiter INFO] 2025-10-23 03:33:45.346 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            474.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          5,715.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,386.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           63.9             63.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:45.347 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    63.81 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:45.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:45.419 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 187.70834715059488 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:45.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:33:45.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.71900000000002
[aiter INFO] 2025-10-23 03:33:45.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000003
[aiter INFO] 2025-10-23 03:33:45.502 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            875.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         10,218.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,093.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          110.9            110.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:45.502 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   110.94 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:46.568 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 434.5499595793167 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:46.784 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {297, 1282, 12, 334}
[aiter INFO] 2025-10-23 03:33:46.784 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 317.16100000000006
[aiter INFO] 2025-10-23 03:33:46.784 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.0010000000002
[aiter INFO] 2025-10-23 03:33:46.784 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.799
[aiter INFO] 2025-10-23 03:33:46.784 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 317.31899999999996
[aiter INFO] 2025-10-23 03:33:46.794 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 97.0            0.0         30,905.0        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            318.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:46.822 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.1127127509306 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:46.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:46.859 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.15900000000002
[aiter INFO] 2025-10-23 03:33:46.871 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            679.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:46.872 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   325.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:47.181 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.73597058211223 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:47.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {272, 25, 12, 38}
[aiter INFO] 2025-10-23 03:33:47.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.5590000000002
[aiter INFO] 2025-10-23 03:33:47.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.99899999999997
[aiter INFO] 2025-10-23 03:33:47.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.438999999999965
[aiter INFO] 2025-10-23 03:33:47.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.95900000000006
[aiter INFO] 2025-10-23 03:33:47.248 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0          5,131.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             52.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:47.275 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.45015850692693 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:47.315 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:47.316 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999995
[aiter INFO] 2025-10-23 03:33:47.328 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            678.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:47.329 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    59.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:47.379 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 192.32657404229192 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 9, 687, 18, 697, 31}
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.839
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.07899999999972
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-10-23 03:33:47.434 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.43900000000002
[aiter INFO] 2025-10-23 03:33:47.453 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            838.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          9,944.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,006.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          110.1            110.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:47.454 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   110.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:47.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:47.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 235.27999015727846 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:47.606 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {921, 938, 20, 9}
[aiter INFO] 2025-10-23 03:33:47.606 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.6790000000001
[aiter INFO] 2025-10-23 03:33:47.606 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.479000000001179
[aiter INFO] 2025-10-23 03:33:47.606 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999999
[aiter INFO] 2025-10-23 03:33:47.606 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.87900000000002
[aiter INFO] 2025-10-23 03:33:47.625 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,178.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         14,372.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,709.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          157.1            157.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:47.626 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   157.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:48.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 197.89808870542166 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:48.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 51, 12, 285}
[aiter INFO] 2025-10-23 03:33:48.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.11899999999997
[aiter INFO] 2025-10-23 03:33:48.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.68100000000004
[aiter INFO] 2025-10-23 03:33:48.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.279
[aiter INFO] 2025-10-23 03:33:48.126 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.55899999999974
[aiter INFO] 2025-10-23 03:33:48.137 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0          7,064.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             72.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:48.164 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.16856440341118 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:48.200 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:48.200 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.798999999999978
[aiter INFO] 2025-10-23 03:33:48.213 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            826.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:48.214 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    81.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:48.270 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.52743528503004 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 873, 9, 20, 22, 861}
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.398999999999432
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.75900000000001
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.35899999999998
[aiter INFO] 2025-10-23 03:33:48.325 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.11899999999997
[aiter INFO] 2025-10-23 03:33:48.326 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.27900000000045
[aiter INFO] 2025-10-23 03:33:48.344 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,177.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         12,646.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,109.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          141.1            141.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:48.345 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   141.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:48.350 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:48.430 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 272.8218896554248 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1026, 1027, 9, 45, 720, 26, 27, 735}
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 174.8809999999994
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000742
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.121
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 174.72099999999955
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.199000000000012
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 174.59900000000005
[aiter INFO] 2025-10-23 03:33:48.637 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.15899999999965
[aiter INFO] 2025-10-23 03:33:48.656 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,439.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         16,810.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,819.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          188.2            188.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:48.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   188.14 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:49.100 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 192.9511390995271 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:49.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 948, 12}
[aiter INFO] 2025-10-23 03:33:49.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.839
[aiter INFO] 2025-10-23 03:33:49.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.63899999999921
[aiter INFO] 2025-10-23 03:33:49.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.439
[aiter INFO] 2025-10-23 03:33:49.165 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          7,221.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             73.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:49.192 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.47429695164803 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:49.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:49.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.558999999999997
[aiter INFO] 2025-10-23 03:33:49.241 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            956.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:49.242 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    83.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:49.353 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 738.6625957961129 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:49.463 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9}
[aiter INFO] 2025-10-23 03:33:49.463 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.319000000000074
[aiter INFO] 2025-10-23 03:33:49.463 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 645.441
[aiter INFO] 2025-10-23 03:33:49.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,516.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         64,408.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,924.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          659.2            659.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:49.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   659.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:49.492 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:49.588 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 210.26088164584473 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:49.660 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:33:49.660 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.56099999999998
[aiter INFO] 2025-10-23 03:33:49.660 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.35899999999998
[aiter INFO] 2025-10-23 03:33:49.679 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            801.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         12,586.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,388.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          133.9            133.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:49.680 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   133.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:49.878 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 495.4107144091389 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:49.960 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1282, 12, 813, 1307, 1278}
[aiter INFO] 2025-10-23 03:33:49.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.1990000000005
[aiter INFO] 2025-10-23 03:33:49.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 385.44100000000003
[aiter INFO] 2025-10-23 03:33:49.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.28100000000086
[aiter INFO] 2025-10-23 03:33:49.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 381.51900000000023
[aiter INFO] 2025-10-23 03:33:49.961 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.3189999999995
[aiter INFO] 2025-10-23 03:33:49.971 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 96.0            0.0         36,705.8        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            382.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:49.998 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.8834254771176 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.032 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:50.032 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-10-23 03:33:50.044 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            693.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:50.045 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   389.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:50.093 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.00023749323177 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:33:50.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.719
[aiter INFO] 2025-10-23 03:33:50.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.15900000000002
[aiter INFO] 2025-10-23 03:33:50.158 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          7,417.2        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             74.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:50.185 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.90636644800111 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:50.219 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000003
[aiter INFO] 2025-10-23 03:33:50.231 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            691.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:50.232 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    81.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:50.278 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 175.7661385996507 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {163, 9, 172, 17, 20, 28}
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.55899999999997
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.439
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.719000000000051
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.8390000000000555
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.20099999999996
[aiter INFO] 2025-10-23 03:33:50.459 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.558999999999969
[aiter INFO] 2025-10-23 03:33:50.478 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            822.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          8,714.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,732.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           97.3             97.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:50.479 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    97.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:50.483 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:50.589 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.8844268333794 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {737, 103, 9, 429, 365, 725, 24, 89, 348, 446}
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999687
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.55900000000003
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.8789999999999
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.9989999999998
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.83900000000017
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.91899999999987
[aiter INFO] 2025-10-23 03:33:50.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.239000000000487
[aiter INFO] 2025-10-23 03:33:50.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,264.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         15,262.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,215.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          172.2            172.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:50.683 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   172.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:50.900 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 628.0784949217692 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:50.996 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:33:50.996 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 520.5630000000001
[aiter INFO] 2025-10-23 03:33:51.006 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         51,745.4        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            517.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.033 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.5047820328486 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.067 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:51.067 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.759000000000015
[aiter INFO] 2025-10-23 03:33:51.080 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            796.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.081 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   525.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:51.131 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.63473185690322 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38, 350}
[aiter INFO] 2025-10-23 03:33:51.189 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.99899999999997
[aiter INFO] 2025-10-23 03:33:51.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.43900000000002
[aiter INFO] 2025-10-23 03:33:51.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.04100000000005
[aiter INFO] 2025-10-23 03:33:51.190 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.91899999999987
[aiter INFO] 2025-10-23 03:33:51.202 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0          7,717.2        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             79.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.229 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.24735639768072 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.264 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:51.264 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.718999999999994
[aiter INFO] 2025-10-23 03:33:51.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            797.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.278 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    87.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:51.333 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 257.1157122602557 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.395 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {549, 39, 9, 1066, 1067, 620, 813, 535, 26, 27, 606, 799}
[aiter INFO] 2025-10-23 03:33:51.395 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.398999999999432
[aiter INFO] 2025-10-23 03:33:51.395 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.959
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.96099999999933
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.718999999999141
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.078999999999724
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.200999999999112
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.40099999999984
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000033
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.71900000000005
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.75900000000001
[aiter INFO] 2025-10-23 03:33:51.396 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.5590000000002
[aiter INFO] 2025-10-23 03:33:51.415 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,253.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0         15,354.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,482.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          174.8            174.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.416 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   174.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:51.422 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:51.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 327.5131671735556 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1050, 1051, 28}
[aiter INFO] 2025-10-23 03:33:51.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 231.161
[aiter INFO] 2025-10-23 03:33:51.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 230.3209999999999
[aiter INFO] 2025-10-23 03:33:51.609 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.95900000000256
[aiter INFO] 2025-10-23 03:33:51.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.91900000000004
[aiter INFO] 2025-10-23 03:33:51.629 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,747.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         22,639.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,635.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          246.4            246.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.629 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   246.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:51.808 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.7421690379039 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {220, 12}
[aiter INFO] 2025-10-23 03:33:51.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 113.8390000000004
[aiter INFO] 2025-10-23 03:33:51.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.719
[aiter INFO] 2025-10-23 03:33:51.871 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         11,154.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            112.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.898 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.71074274979016 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:51.931 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:51.932 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.479000000000013
[aiter INFO] 2025-10-23 03:33:51.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,109.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:51.945 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   123.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:52.009 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 303.5051568900005 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:52.205 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 27, 1060, 1061}
[aiter INFO] 2025-10-23 03:33:52.205 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 208.15900000000002
[aiter INFO] 2025-10-23 03:33:52.205 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-10-23 03:33:52.205 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.35900000000038
[aiter INFO] 2025-10-23 03:33:52.205 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.638999999999214
[aiter INFO] 2025-10-23 03:33:52.224 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,744.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         20,339.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,306.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          223.1            223.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:52.225 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   223.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:52.235 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:52.352 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 381.2824564405007 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:52.436 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 35}
[aiter INFO] 2025-10-23 03:33:52.436 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 275.919
[aiter INFO] 2025-10-23 03:33:52.436 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.278999999999996
[aiter INFO] 2025-10-23 03:33:52.455 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,263.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         27,256.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       29,519.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          295.2            295.2         NaN          NaN
[aiter INFO] 2025-10-23 03:33:52.455 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   295.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:52.636 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 235.34099064250984 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:52.690 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1091, 12}
[aiter INFO] 2025-10-23 03:33:52.691 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.19900000000052
[aiter INFO] 2025-10-23 03:33:52.691 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.43900000000002
[aiter INFO] 2025-10-23 03:33:52.701 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         11,266.3        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            113.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:52.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.76219819500895 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:52.763 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:33:52.763 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999993
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999933
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.67900000000003
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.919000000000096
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:33:52.764 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:33:52.776 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,041.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:52.777 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   125.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:52.934 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1131.1110541372016 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {99, 9, 1048, 1049, 990, 991}
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.878999999999905
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1035.921
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1039.202999999994
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.39900000000489
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1038.1630000000005
[aiter INFO] 2025-10-23 03:33:53.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.479000000006636
[aiter INFO] 2025-10-23 03:33:53.108 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,205.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0        101,268.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      105,596.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,056.0          1,055.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:53.109 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1055.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:53.124 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:53.193 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.6302387454722 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:53.253 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {163, 9, 171, 17, 20, 405, 28, 413}
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.11899999999991
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 87.11899999999997
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.1590000000001055
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.399
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.279
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-10-23 03:33:53.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.999000000000251
[aiter INFO] 2025-10-23 03:33:53.273 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            671.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0          7,915.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,858.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           88.6             88.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:53.273 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    88.53 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:54.134 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 351.1124058525161 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:54.211 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1273, 58, 12}
[aiter INFO] 2025-10-23 03:33:54.211 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 237.63900000000103
[aiter INFO] 2025-10-23 03:33:54.211 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 238.039
[aiter INFO] 2025-10-23 03:33:54.211 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 240.361
[aiter INFO] 2025-10-23 03:33:54.222 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0         23,201.4        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            236.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:54.248 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.05370289441382 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:54.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {580, 6}
[aiter INFO] 2025-10-23 03:33:54.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.519000000000233
[aiter INFO] 2025-10-23 03:33:54.285 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.919000000000011
[aiter INFO] 2025-10-23 03:33:54.297 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            598.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:54.298 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   242.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:54.603 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.46786069751965 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:54.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38}
[aiter INFO] 2025-10-23 03:33:54.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.03899999999999
[aiter INFO] 2025-10-23 03:33:54.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.59900000000002
[aiter INFO] 2025-10-23 03:33:54.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.28099999999995
[aiter INFO] 2025-10-23 03:33:54.667 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          4,946.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             50.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:54.694 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.81370291320405 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:54.734 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:54.734 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999975
[aiter INFO] 2025-10-23 03:33:54.746 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            607.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:33:54.747 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.001220703125
max_diff_thr=0.0011973179643973708

NaN info:
{}
out_ref_md5=78a3b43bfe8b00c82a1ed8e78e6baa8a
gluon_fp8_output_md5=2ea8cd2f0670b6f31c812935db5f104b
diff.abs.max=0.0032958984375
max_diff_thr=0.003235082607716322

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0012969970703125
max_diff_thr=0.0012936413986608386

NaN info:
{}
out_ref_md5=943e3240640ffea06e574b7e59dbe7dc
gluon_fp8_output_md5=8b0942b154742fe7d4c0a2fa3e9685c9
diff.abs.max=0.003448486328125
max_diff_thr=0.0034155482426285744

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013003349304199219
max_diff_thr=0.001300279749557376

NaN info:
{}
out_ref_md5=847e0d7e9d0855356490f3e9df17d000
gluon_fp8_output_md5=bbc16f7f52bd2c5d491dde1934f3f7fd
diff.abs.max=0.003173828125
max_diff_thr=0.0031402253080159426

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017861395608633757

NaN info:
{}
out_ref_md5=94489c3c698eee7be77d1d18260df2b8
triton_fp8_output_md5=eac13582a131d443005d8c773be315fd
diff.abs.max=0.00115966796875
max_diff_thr=0.0011423074174672365

NaN info:
{}
out_ref_md5=94489c3c698eee7be77d1d18260df2b8
gluon_fp8_output_md5=52485e5c25080d54625b6f3b481c36be
diff.abs.max=0.002956390380859375
max_diff_thr=0.002954035298898816

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001953125
max_diff_thr=0.0019038553582504392

NaN info:
{}
out_ref_md5=55b5e592342d7834809ca1f385d86a45
triton_fp8_output_md5=c0930415bb959849ea9c8834f92090b4
diff.abs.max=0.001251220703125
max_diff_thr=0.001241784542798996

NaN info:
{}
out_ref_md5=55b5e592342d7834809ca1f385d86a45
gluon_fp8_output_md5=21e109fa0636d06aa26a166fdd1cfcef
diff.abs.max=0.0031585693359375
max_diff_thr=0.0031419810838997364

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001251220703125
max_diff_thr=0.0012487774947658181

NaN info:
{}
out_ref_md5=9d0aa4459c3f036e1cc3234e8e6cb508
gluon_fp8_output_md5=ae53ffb16b05ab39b1385fb6e7481ac9
diff.abs.max=0.00341796875
max_diff_thr=0.0033818467054516077

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013427734375
max_diff_thr=0.0013399111339822412

NaN info:
{}
out_ref_md5=73c9c0c6d80b1d09a8fbdec5a4678be3
gluon_fp8_output_md5=ca3627b60de566990777ec6d481ede98
diff.abs.max=0.00334930419921875
max_diff_thr=0.0033485633321106434

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016911276616156101

NaN info:
{}
out_ref_md5=b592c14b720b0226bdf1259b7afc6566
triton_fp8_output_md5=8f3707e655c33970128686cbfb588ef2
diff.abs.max=0.0010986328125
max_diff_thr=0.0010812109103426337

NaN info:
{}
out_ref_md5=b592c14b720b0226bdf1259b7afc6566
gluon_fp8_output_md5=8f8356d8937b330d8c43bffedfb0bf67
diff.abs.max=0.0029296875
max_diff_thr=0.002901880070567131

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00177001953125
max_diff_thr=0.0017537494422867894

NaN info:
{}
out_ref_md5=34ec31ca92d701b96058801dee997015
triton_fp8_output_md5=1a33040ac315fd5072dd4f487c8a8bd8
diff.abs.max=0.001312255859375
max_diff_thr=0.0013022804632782936

NaN info:
{}
out_ref_md5=34ec31ca92d701b96058801dee997015
gluon_fp8_output_md5=fe511fd63dc2a017347c777cae2c573d
diff.abs.max=0.002899169921875
max_diff_thr=0.002881145104765892

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012656701728701591

NaN info:
{}
out_ref_md5=326e09bafa860632a7e52f50d7f6febc
gluon_fp8_output_md5=3f81d9ce7fe112f4392cbaefda0448da
diff.abs.max=0.003143310546875
max_diff_thr=0.0031237679067999125

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012759752571582794

NaN info:
{}
out_ref_md5=e17b8f0bc0ba75d70c3c27b39e5e6596
gluon_fp8_output_md5=a68f8ac524475a01f1433475501bd275
diff.abs.max=0.003082275390625
max_diff_thr=0.0030627406667917967

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0020751953125
max_diff_thr=0.0020173252560198307

NaN info:
{}
out_ref_md5=f9212a18350124a8552b9d2812d92896
triton_fp8_output_md5=5674cf3c3a2db01b05eab792ea0d5ed1
diff.abs.max=0.001190185546875
max_diff_thr=0.0011850501177832484

NaN info:
{}
out_ref_md5=f9212a18350124a8552b9d2812d92896
gluon_fp8_output_md5=8bd001dcc4e98bb2e51e5ee960378a84
diff.abs.max=0.003021240234375
max_diff_thr=0.0030078385025262833

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

NaN info:
{}
diff.abs.max=0.001953125
max_diff_thr=0.001905896351672709

NaN info:
{}
out_ref_md5=e602cd8d01da47d113257898a4dea029
triton_fp8_output_md5=8f88d56bd4153fd27a683ef16bd81b78
diff.abs.max=0.001251220703125
max_diff_thr=0.0012439697748050094

NaN info:
{}
out_ref_md5=e602cd8d01da47d113257898a4dea029
gluon_fp8_output_md5=7d554b41bfe4ba1e1891e35a43908ab5
diff.abs.max=0.003326416015625
max_diff_thr=0.0033101520966738462

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00130462646484375
max_diff_thr=0.0013013104908168316

NaN info:
{}
out_ref_md5=ebe619c4b557b1f746c0f538f2a534e2
gluon_fp8_output_md5=79564cb7d7e9a4081f645cd84785b3af
diff.abs.max=0.003173828125
max_diff_thr=0.0031141454819589853

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0012243986129760742
max_diff_thr=0.0012228685664013028

NaN info:
{}
out_ref_md5=c34299308a20e29f65bec2502b377a7b
gluon_fp8_output_md5=1ba29353dfbc85918b838b2d7ce73eb6
diff.abs.max=0.00323486328125
max_diff_thr=0.003207261674106121

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001953125
max_diff_thr=0.0019070322159677744

NaN info:
{}
out_ref_md5=dc40c303bdec0e88087ebc3a8715fad1
triton_fp8_output_md5=120613b29e71cc3241fe40f5dba4dcc7
diff.abs.max=0.0010986328125[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1E Success
[aiter INFO] 2025-10-23 03:33:54.780 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 46.12370296427519 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:54.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 17, 4}
[aiter INFO] 2025-10-23 03:33:54.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.478999999999985
[aiter INFO] 2025-10-23 03:33:54.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.839
[aiter INFO] 2025-10-23 03:33:54.803 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.63899999999998
[aiter INFO] 2025-10-23 03:33:54.819 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1  98.0            0.0          2,873.8        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        2,936.1              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           29.4             29.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:54.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    29.32 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:33:54.843 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.05712890625, delta details: 0.0% (11 of 102400) elements
[aiter INFO] 2025-10-23 03:33:54.867 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 147.1565250713046 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {39, 9, 42, 174, 17, 50, 20, 182, 28, 31}
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.281
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.11900000000003
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.43899999999985
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.758999999999958
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.078999999999951
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.07900000000001
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.839000000000169
[aiter INFO] 2025-10-23 03:33:55.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.998999999999967
[aiter INFO] 2025-10-23 03:33:55.070 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.23900000000003
[aiter INFO] 2025-10-23 03:33:55.088 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            658.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          5,658.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,586.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           65.9             65.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:55.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    65.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:55.092 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:55.179 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 191.676663880301 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:55.234 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {19, 33, 43, 9}
[aiter INFO] 2025-10-23 03:33:55.234 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-10-23 03:33:55.234 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.11900000000003
[aiter INFO] 2025-10-23 03:33:55.234 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-10-23 03:33:55.234 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 111.00099999999998
[aiter INFO] 2025-10-23 03:33:55.253 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,065.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         10,271.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,454.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          114.5            114.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:55.254 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   114.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:56.331 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 432.58157401981924 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:56.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {74, 12, 606}
[aiter INFO] 2025-10-23 03:33:56.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.879
[aiter INFO] 2025-10-23 03:33:56.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.00100000000003
[aiter INFO] 2025-10-23 03:33:56.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 318.15899999999965
[aiter INFO] 2025-10-23 03:33:56.424 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0         31,318.5        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            319.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:56.451 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.86596058677918 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:56.482 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:56.482 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.318999999999988
[aiter INFO] 2025-10-23 03:33:56.494 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            794.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:56.495 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   327.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:56.863 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.358237317293 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 1286, 12, 25, 90}
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.59900000000005
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.0010000000002
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.79899999999998
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.47899999999998
[aiter INFO] 2025-10-23 03:33:56.921 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.00099999999998
[aiter INFO] 2025-10-23 03:33:56.933 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0          6,887.1        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             71.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:56.960 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.07626687123043 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:57.001 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:57.001 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.479000000000013
[aiter INFO] 2025-10-23 03:33:57.014 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            797.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:57.015 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    79.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1E Success
[aiter INFO] 2025-10-23 03:33:57.054 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.63507912654688 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:57.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 4, 22}
[aiter INFO] 2025-10-23 03:33:57.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.91900000000004
[aiter INFO] 2025-10-23 03:33:57.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.07900000000001
[aiter INFO] 2025-10-23 03:33:57.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.239000000000004
[aiter INFO] 2025-10-23 03:33:57.098 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1  98.0            0.0          4,933.1        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,035.2              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           50.4             50.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:57.099 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    50.34 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:33:57.099 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.05908203125, delta details: 0.0% (23 of 204800) elements
[aiter INFO] 2025-10-23 03:33:57.131 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.58919777492486 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:57.195 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 9, 18, 20, 30, 31}
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.31899999999999
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999969
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 107.11899999999997
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.718999999999994
[aiter INFO] 2025-10-23 03:33:57.196 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.32099999999997
[aiter INFO] 2025-10-23 03:33:57.215 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,057.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         10,308.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,600.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          116.0            116.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:57.215 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   115.97 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:57.221 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:57.313 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 242.21663398317773 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:57.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 916, 933, 22}
[aiter INFO] 2025-10-23 03:33:57.371 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 152.55899999999997
[aiter INFO] 2025-10-23 03:33:57.372 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.6790000000001
[aiter INFO] 2025-10-23 03:33:57.372 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.47899999999936
[aiter INFO] 2025-10-23 03:33:57.372 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.959000000000003
[aiter INFO] 2025-10-23 03:33:57.391 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,414.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         14,789.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,370.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          163.7            163.7         NaN          NaN
[aiter INFO] 2025-10-23 03:33:57.391 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   163.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:57.810 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.51825762503216 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:58.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 1195, 12}
[aiter INFO] 2025-10-23 03:33:58.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.91899999999998
[aiter INFO] 2025-10-23 03:33:58.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.4390000000003
[aiter INFO] 2025-10-23 03:33:58.003 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.99900000000002
[aiter INFO] 2025-10-23 03:33:58.016 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          7,195.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             73.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:58.042 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.10953430787171 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:58.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:58.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-10-23 03:33:58.085 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            897.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:58.086 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    82.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1E Success
[aiter INFO] 2025-10-23 03:33:58.128 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 66.88853463914135 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 4, 453, 13, 25}
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.438999999999965
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.478999999999985
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.159000000000106
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.15900000000002
[aiter INFO] 2025-10-23 03:33:58.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.15899999999999
[aiter INFO] 2025-10-23 03:33:58.170 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1  96.0            0.0          4,872.5        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,076.4              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           50.8             50.8         NaN          NaN
[aiter INFO] 2025-10-23 03:33:58.172 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    50.75 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:33:58.172 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.056640625, delta details: 0.0% (13 of 307200) elements
[aiter INFO] 2025-10-23 03:33:58.208 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 231.51481136827184 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:58.276 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1088, 1089, 36, 9, 493, 19, 22, 478}
[aiter INFO] 2025-10-23 03:33:58.276 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.28100000000086
[aiter INFO] 2025-10-23 03:33:58.276 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.198999999998705
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.481
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.319000000000415
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.479000000000042
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.159
[aiter INFO] 2025-10-23 03:33:58.277 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.59900000000016
[aiter INFO] 2025-10-23 03:33:58.296 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,388.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         13,015.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,854.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          148.5            148.5         NaN          NaN
[aiter INFO] 2025-10-23 03:33:58.296 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   148.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:58.303 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:58.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 279.6400989046191 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:58.464 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1058, 1059, 1062, 678, 1063, 9, 686, 26}
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 181.35900000000038
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.878999999998996
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 181.79899999999907
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 181.59900000000016
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.921000000000276
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 182.23899999999998
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.959000000000742
[aiter INFO] 2025-10-23 03:33:58.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.478999999999985
[aiter INFO] 2025-10-23 03:33:58.484 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,745.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         17,365.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,709.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          197.1            197.0         NaN          NaN
[aiter INFO] 2025-10-23 03:33:58.484 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   197.02 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:59.008 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 240.43048490392098 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {896, 1091, 12, 909, 974, 792, 25}
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.03899999999885
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.35900000000038
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.67900000000003
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.87900000000081
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.80099999999948
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.47900000000027
[aiter INFO] 2025-10-23 03:33:59.069 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.99900000000002
[aiter INFO] 2025-10-23 03:33:59.082 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 94.0            0.0         11,032.6        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            117.4         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.110 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.11274236263615 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.142 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:33:59.142 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:33:59.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,095.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             10.9         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.156 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   128.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1E Success
[aiter INFO] 2025-10-23 03:33:59.204 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.82605923579472 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {17, 43, 4, 30}
[aiter INFO] 2025-10-23 03:33:59.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.31900000000002
[aiter INFO] 2025-10-23 03:33:59.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.91899999999998
[aiter INFO] 2025-10-23 03:33:59.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.481
[aiter INFO] 2025-10-23 03:33:59.233 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.11899999999997
[aiter INFO] 2025-10-23 03:33:59.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1  97.0            0.0          6,429.9        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        6,629.2              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           66.3             66.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.250 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    66.29 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:33:59.250 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.061767578125, delta details: 0.0% (74 of 409600) elements
[aiter INFO] 2025-10-23 03:33:59.344 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 748.9925664250213 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9, 948, 949, 62, 126}
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 656.1610000000001
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 649.443
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 647.759
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.318999999999505
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.51899999999989
[aiter INFO] 2025-10-23 03:33:59.465 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.19899999999984
[aiter INFO] 2025-10-23 03:33:59.484 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,776.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         63,908.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       67,025.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          670.3            670.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.485 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   670.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:59.496 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:33:59.608 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 212.83039642442571 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {833, 9, 49, 19, 823, 60}
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.079000000001543
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.921
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.11900000000003
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.799000000000035
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.95900000000074
[aiter INFO] 2025-10-23 03:33:59.666 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.63900000000001
[aiter INFO] 2025-10-23 03:33:59.685 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            961.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         12,527.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,764.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          137.6            137.6         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.685 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   137.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:33:59.872 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 493.9747122254702 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:33:59.953 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {406, 12, 86}
[aiter INFO] 2025-10-23 03:33:59.953 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 383.3590000000004
[aiter INFO] 2025-10-23 03:33:59.953 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 388.19899999999996
[aiter INFO] 2025-10-23 03:33:59.953 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 385.3610000000001
[aiter INFO] 2025-10-23 03:33:59.966 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0         37,660.1        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            384.3         NaN          NaN
[aiter INFO] 2025-10-23 03:33:59.992 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.11985140507764 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.021 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:00.022 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999999
[aiter INFO] 2025-10-23 03:34:00.034 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            738.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.034 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   391.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:00.083 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.4710889665207 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.274 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:34:00.274 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.67899999999997
[aiter INFO] 2025-10-23 03:34:00.274 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.31900000000002
[aiter INFO] 2025-10-23 03:34:00.287 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          7,594.7        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             76.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.314 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.11032642586397 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.350 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:00.350 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.079000000000008
[aiter INFO] 2025-10-23 03:34:00.362 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            738.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.363 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    84.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:00.399 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.07943543349162 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.427 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {26, 4}
[aiter INFO] 2025-10-23 03:34:00.427 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.59899999999999
[aiter INFO] 2025-10-23 03:34:00.427 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.881
[aiter INFO] 2025-10-23 03:34:00.443 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1  99.0            0.0          5,532.4        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,590.0              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           55.9             55.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.444 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    55.88 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:34:00.444 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.0625, delta details: 0.0% (24 of 163840) elements
[aiter INFO] 2025-10-23 03:34:00.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 178.60376170956263 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {163, 9, 171, 17, 1010, 1019}
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.83899999999994
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.87900000000002
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.599000000000046
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.12099999999919
[aiter INFO] 2025-10-23 03:34:00.532 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.799000000000888
[aiter INFO] 2025-10-23 03:34:00.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            968.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          8,806.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,979.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           99.8             99.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.552 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    99.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:00.556 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:00.675 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 257.0440114134609 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:00.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {164, 615, 9, 179, 22, 600}
[aiter INFO] 2025-10-23 03:34:00.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.8789999999999
[aiter INFO] 2025-10-23 03:34:00.736 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.358999999999469
[aiter INFO] 2025-10-23 03:34:00.737 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.55899999999997
[aiter INFO] 2025-10-23 03:34:00.737 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999942
[aiter INFO] 2025-10-23 03:34:00.737 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:34:00.737 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.59900000000016
[aiter INFO] 2025-10-23 03:34:00.756 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,525.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         15,841.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,721.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          177.2            177.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:00.756 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   177.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:00.962 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 629.2971095236221 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.060 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:01.060 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 522.841
[aiter INFO] 2025-10-23 03:34:01.073 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         51,918.6        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            519.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.100 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.54714872459374 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.132 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:01.132 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-10-23 03:34:01.144 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            989.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.145 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   529.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:01.203 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.15520757731827 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:01.261 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 114.52100000000002
[aiter INFO] 2025-10-23 03:34:01.273 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 100.0            0.0         11,163.7        CUDA            5
[avg us/iter]                             NaN   NaN            0.0            111.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.9527226285179 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.335 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:01.336 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000002
[aiter INFO] 2025-10-23 03:34:01.348 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            989.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   121.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:01.391 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 112.25263339163054 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.424 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 21}
[aiter INFO] 2025-10-23 03:34:01.424 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.07899999999998
[aiter INFO] 2025-10-23 03:34:01.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.87900000000002
[aiter INFO] 2025-10-23 03:34:01.440 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1  99.0            0.0          9,635.5        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        9,731.3              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           97.3             97.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    97.33 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:34:01.441 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.05810546875, delta details: 0.0% (25 of 327680) elements
[aiter INFO] 2025-10-23 03:34:01.482 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 264.0293751022603 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1094, 1095, 41, 9, 26, 27}
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 168.4409999999989
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.919000000001688
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.599000000000046
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.921
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.67900000000003
[aiter INFO] 2025-10-23 03:34:01.551 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 169.23900000000003
[aiter INFO] 2025-10-23 03:34:01.570 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,529.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         16,465.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,364.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          183.6            183.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.571 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   183.62 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:01.580 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:01.707 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 335.9768904081666 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:01.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 914, 28, 935}
[aiter INFO] 2025-10-23 03:34:01.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 237.799
[aiter INFO] 2025-10-23 03:34:01.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 236.60099999999875
[aiter INFO] 2025-10-23 03:34:01.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.798999999999978
[aiter INFO] 2025-10-23 03:34:01.914 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.03900000000067
[aiter INFO] 2025-10-23 03:34:01.933 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,128.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         23,288.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       25,675.1              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          256.8            256.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:01.934 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   256.73 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:02.102 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 231.32353401420139 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.158 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 727}
[aiter INFO] 2025-10-23 03:34:02.159 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 117.239
[aiter INFO] 2025-10-23 03:34:02.159 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 114.8789999999999
[aiter INFO] 2025-10-23 03:34:02.171 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         11,221.1        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            113.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:02.199 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.47589089433745 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.558999999999969
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999999962
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000092
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.95900000000006
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.999000000000024
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.63900000000001
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.63900000000001
[aiter INFO] 2025-10-23 03:34:02.230 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:34:02.242 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 87.0            0.0          1,006.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:02.244 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   124.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:02.295 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 113.18255422434004 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 4}
[aiter INFO] 2025-10-23 03:34:02.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.91899999999998
[aiter INFO] 2025-10-23 03:34:02.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.87900000000002
[aiter INFO] 2025-10-23 03:34:02.347 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1  99.0            0.0          9,716.3        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        9,813.2              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN           98.1             98.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:02.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:    98.14 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:34:02.349 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.062255859375, delta details: 0.0% (77 of 491520) elements
[aiter INFO] 2025-10-23 03:34:02.399 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 316.1812392201754 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.470 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:34:02.471 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.959
[aiter INFO] 2025-10-23 03:34:02.471 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.87900000000002
[aiter INFO] 2025-10-23 03:34:02.490 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,152.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         21,370.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       23,523.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          235.2            235.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:02.490 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   235.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:02.502 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:02.634 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 390.33992131157675 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1088, 1089, 34, 9, 1072, 1073}
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 284.40100000000166
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.47899999999936
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.759000000000015
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 281.67900000000003
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 284.6010000000024
[aiter INFO] 2025-10-23 03:34:02.711 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.198999999996886
[aiter INFO] 2025-10-23 03:34:02.730 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,682.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         27,611.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       30,917.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          309.2            309.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:02.731 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   309.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:02.913 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 308.18400052514403 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:02.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:34:02.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.87899999999996
[aiter INFO] 2025-10-23 03:34:02.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 187.839
[aiter INFO] 2025-10-23 03:34:02.990 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         18,453.1        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            186.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:03.017 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.06638606113962 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000004
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.878999999999905
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.278999999999996
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.99899999999991
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.158999999999992
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.999000000000024
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.758999999999958
[aiter INFO] 2025-10-23 03:34:03.049 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:34:03.061 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,340.9        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:03.062 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   201.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:03.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 147.44048543495708 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:03.153 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {505, 28, 4}
[aiter INFO] 2025-10-23 03:34:03.153 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.7990000000009
[aiter INFO] 2025-10-23 03:34:03.153 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.55900000000003
[aiter INFO] 2025-10-23 03:34:03.153 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.479
[aiter INFO] 2025-10-23 03:34:03.169 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1  98.0            0.0         12,769.9        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0       13,028.2              0.0         CPU       239091
[avg us/iter]                                                 NaN   NaN          130.3            130.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:03.170 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:408 - checkAllclose
[torch vs aiter_asm][   Quant]:   130.30 us......[checkAllclose atol=0.05 rtol=0.05 [33mwarning![0m] a and b results are not all close
[aiter INFO] 2025-10-23 03:34:03.170 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:411 - checkAllclose
-->max abs delta:0.0625, delta details: 0.0% (89 of 655360) elements
[aiter INFO] 2025-10-23 03:34:03.313 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1144.0536397518497 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:03.468 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 102}
[aiter INFO] 2025-10-23 03:34:03.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1048.563
[aiter INFO] 2025-10-23 03:34:03.469 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.598999999999933
[aiter INFO] 2025-10-23 03:34:03.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,732.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0        104,437.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      107,169.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,071.7          1,071.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:03.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1071.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:03.499 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:03.580 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 166.53797089463413 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:03.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {787, 9, 779, 17}
[aiter INFO] 2025-10-23 03:34:03.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.59900000000016
[aiter INFO] 2025-10-23 03:34:03.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.35900000000001
[aiter INFO] 2025-10-23 03:34:03.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.07899999999972
[aiter INFO] 2025-10-23 03:34:03.633 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999985
[aiter INFO] 2025-10-23 03:34:03.652 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            920.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          8,214.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,230.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           92.3             92.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:03.652 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    92.27 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:04.486 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 347.931833255409 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:04.553 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:34:04.553 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.71900000000005
[aiter INFO] 2025-10-23 03:34:04.553 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 236.88100000000003
[aiter INFO] 2025-10-23 03:34:04.566 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         23,137.1        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            233.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:04.592 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.99033674332175 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:04.622 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:04.623 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999991
[aiter INFO] 2025-10-23 03:34:04.635 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            679.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:04.636 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   240.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:05.097 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.62076295720468 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:05.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 1000, 12, 207, 402, 51, 25}
[aiter INFO] 2025-10-23 03:34:05.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.23899999999992
[aiter INFO] 2025-10-23 03:34:05.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.71900000000096
[aiter INFO] 2025-10-23 03:34:05.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.63900000000001
[aiter INFO] 2025-10-23 03:34:05.154 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.598999999999705
[aiter INFO] 2025-10-23 03:34:05.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.79899999999998
[aiter INFO] 2025-10-23 03:34:05.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.759000000000015
[aiter INFO] 2025-10-23 03:34:05.155 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.959
[aiter INFO] 2025-10-23 03:34:05.167 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 94.0            0.0          4,937.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             52.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:05.194 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.37566332769866 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:05.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:05.236 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999988
[aiter INFO] 2025-10-23 03:34:05.248 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            675.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:05.249 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    59.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:05.255 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_078cc7a61e59ad097493f1a29dc6eecf' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_078cc7a61e59ad097493f1a29dc6eecf', 'folder': 'pa_078cc7a61e59ad097493f1a29dc6eecf', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_078cc7a61e59ad097493f1a29dc6eecf(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:05.255 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include -c pa_078cc7a61e59ad097493f1a29dc6eecf.cpp -o pa_078cc7a61e59ad097493f1a29dc6eecf.o
In file included from pa_078cc7a61e59ad097493f1a29dc6eecf.cpp:1:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/quant_utils.cuh:19:
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_078cc7a61e59ad097493f1a29dc6eecf.cpp:1:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/quant_utils.cuh:19:
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_078cc7a61e59ad097493f1a29dc6eecf.o -o lib.so
[aiter INFO] 2025-10-23 03:34:08.416 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_078cc7a61e59ad097493f1a29dc6eecf, cost 3.16114762s
[aiter INFO] 2025-10-23 03:34:08.458 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 149.94266334146556 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {677, 39, 9, 17, 20, 28, 669, 31}
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.198999999999614
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.67899999999997
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000012
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.43900000000002
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.03899999999976
[aiter INFO] 2025-10-23 03:34:08.516 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.561000000000035
[aiter INFO] 2025-10-23 03:34:08.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            893.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          5,897.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,004.3              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN           70.0             70.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:08.536 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    70.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:08.541 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:08.588 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_4e4e34375509d0c340b40678727a6fa4' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_4e4e34375509d0c340b40678727a6fa4', 'folder': 'pa_4e4e34375509d0c340b40678727a6fa4', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_4e4e34375509d0c340b40678727a6fa4(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:08.588 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include -c pa_4e4e34375509d0c340b40678727a6fa4.cpp -o pa_4e4e34375509d0c340b40678727a6fa4.o
In file included from pa_4e4e34375509d0c340b40678727a6fa4.cpp:1:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/quant_utils.cuh:19:
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_4e4e34375509d0c340b40678727a6fa4.cpp:1:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/quant_utils.cuh:19:
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_4e4e34375509d0c340b40678727a6fa4.o -o lib.so
[aiter INFO] 2025-10-23 03:34:11.763 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_4e4e34375509d0c340b40678727a6fa4, cost 3.17479356s
[aiter INFO] 2025-10-23 03:34:11.790 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.54046581405225 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:11.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:34:11.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.11899999999997
[aiter INFO] 2025-10-23 03:34:11.861 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.800999999999988
[aiter INFO] 2025-10-23 03:34:11.880 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,499.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         10,654.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,154.2              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          121.5            121.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:11.881 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   121.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:13.411 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 434.9697533220348 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:13.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:13.489 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.03900000000004
[aiter INFO] 2025-10-23 03:34:13.500 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         32,046.8        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            320.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:13.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.01489093693175 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:13.566 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:13.566 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.959000000000003
[aiter INFO] 2025-10-23 03:34:13.578 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            960.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:13.579 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   330.07 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:13.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.7396534799349 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:13.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 571, 12, 974}
[aiter INFO] 2025-10-23 03:34:13.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.31900000000002
[aiter INFO] 2025-10-23 03:34:13.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.39900000000034
[aiter INFO] 2025-10-23 03:34:13.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.519
[aiter INFO] 2025-10-23 03:34:13.999 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.67900000000009
[aiter INFO] 2025-10-23 03:34:14.012 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0          7,036.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             72.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:14.039 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.25009909655789 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:14.077 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:14.077 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.519000000000005
[aiter INFO] 2025-10-23 03:34:14.089 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            962.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:14.090 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    82.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:14.103 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_9ccc2bf952c47f80c0de49360a878341' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_9ccc2bf952c47f80c0de49360a878341', 'folder': 'pa_9ccc2bf952c47f80c0de49360a878341', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_9ccc2bf952c47f80c0de49360a878341(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:14.103 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include -c pa_9ccc2bf952c47f80c0de49360a878341.cpp -o pa_9ccc2bf952c47f80c0de49360a878341.o
In file included from pa_9ccc2bf952c47f80c0de49360a878341.cpp:1:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_9ccc2bf952c47f80c0de49360a878341.cpp:1:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_9ccc2bf952c47f80c0de49360a878341.o -o lib.so
[aiter INFO] 2025-10-23 03:34:17.284 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_9ccc2bf952c47f80c0de49360a878341, cost 3.18113488s
[aiter INFO] 2025-10-23 03:34:17.332 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 210.22524751058899 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 9, 17, 20, 29, 31}
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.638999999999896
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 110.87899999999996
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.35899999999998
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 110.161
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000065
[aiter INFO] 2025-10-23 03:34:17.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.55899999999997
[aiter INFO] 2025-10-23 03:34:17.552 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,479.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         10,558.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,287.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          122.9            122.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:17.553 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   122.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:17.563 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:17.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_95113ea143548db49570b5d4f0ecf347' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_95113ea143548db49570b5d4f0ecf347', 'folder': 'pa_95113ea143548db49570b5d4f0ecf347', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_95113ea143548db49570b5d4f0ecf347(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:17.610 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include -c pa_95113ea143548db49570b5d4f0ecf347.cpp -o pa_95113ea143548db49570b5d4f0ecf347.o
In file included from pa_95113ea143548db49570b5d4f0ecf347.cpp:1:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/quant_utils.cuh:19:
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_95113ea143548db49570b5d4f0ecf347.cpp:1:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/quant_utils.cuh:19:
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_95113ea143548db49570b5d4f0ecf347.o -o lib.so
[aiter INFO] 2025-10-23 03:34:20.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_95113ea143548db49570b5d4f0ecf347, cost 3.23954446s
[aiter INFO] 2025-10-23 03:34:20.883 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 250.15489019379754 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:20.964 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {112, 9, 128, 25}
[aiter INFO] 2025-10-23 03:34:20.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.519
[aiter INFO] 2025-10-23 03:34:20.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.87899999999996
[aiter INFO] 2025-10-23 03:34:20.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.919000000000096
[aiter INFO] 2025-10-23 03:34:20.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.438999999999965
[aiter INFO] 2025-10-23 03:34:20.984 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,090.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,153.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,419.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          174.2            174.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:20.984 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   174.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:21.525 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 238.5358313227644 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {961, 1026, 1221, 1273, 1286, 649, 12, 974, 1078, 727, 857, 922, 636}
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.59899999999834
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.95900000000074
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.95899999999892
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.48099999999977
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.91899999999987
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.91899999999987
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.15899999999999
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.5590000000011
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.95900000000074
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.79899999999998
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.95899999999892
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.121000000001
[aiter INFO] 2025-10-23 03:34:21.581 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.76099999999951
[aiter INFO] 2025-10-23 03:34:21.592 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 88.0            0.0         10,313.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            117.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:21.620 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.71031703394239 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {69, 6, 41, 13, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000037
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59899999999999
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000004
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999965
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.319000000000017
[aiter INFO] 2025-10-23 03:34:21.657 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.19900000000007
[aiter INFO] 2025-10-23 03:34:21.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 93.0            0.0          1,143.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:21.671 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   129.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:21.686 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_1f79a9bb3c81e2b1fd46238b3a5984bb' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_1f79a9bb3c81e2b1fd46238b3a5984bb', 'folder': 'pa_1f79a9bb3c81e2b1fd46238b3a5984bb', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_1f79a9bb3c81e2b1fd46238b3a5984bb(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:21.687 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include -c pa_1f79a9bb3c81e2b1fd46238b3a5984bb.cpp -o pa_1f79a9bb3c81e2b1fd46238b3a5984bb.o
In file included from pa_1f79a9bb3c81e2b1fd46238b3a5984bb.cpp:1:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/quant_utils.cuh:19:
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_1f79a9bb3c81e2b1fd46238b3a5984bb.cpp:1:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/quant_utils.cuh:19:
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_1f79a9bb3c81e2b1fd46238b3a5984bb.o -o lib.so
[aiter INFO] 2025-10-23 03:34:24.924 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_1f79a9bb3c81e2b1fd46238b3a5984bb, cost 3.23760092s
[aiter INFO] 2025-10-23 03:34:24.975 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 242.69940608208722 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 38, 9, 49, 19, 22}
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.239000000000033
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 137.32100000000003
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 137.75900000000001
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.958999999999946
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.199000000000012
[aiter INFO] 2025-10-23 03:34:25.050 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 137.47900000000004
[aiter INFO] 2025-10-23 03:34:25.070 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,068.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         13,335.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,721.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          157.2            157.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:25.071 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   157.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:25.084 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:25.130 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_929abcd2f93ad938089e83048994d773' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_929abcd2f93ad938089e83048994d773', 'folder': 'pa_929abcd2f93ad938089e83048994d773', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': '__hip_bfloat16', 'fp8_kv_dtype': 'auto', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerTensor', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_929abcd2f93ad938089e83048994d773(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            __hip_bfloat16,\n                                            \n                                            vllm::Fp8KVCacheDataType::kAuto,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerTensor,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<__hip_bfloat16*>(key_cache_ptr),                  \n                                    reinterpret_cast<__hip_bfloat16*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:25.130 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include -c pa_929abcd2f93ad938089e83048994d773.cpp -o pa_929abcd2f93ad938089e83048994d773.o
In file included from pa_929abcd2f93ad938089e83048994d773.cpp:1:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/quant_utils.cuh:19:
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_929abcd2f93ad938089e83048994d773.cpp:1:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/quant_utils.cuh:19:
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_929abcd2f93ad938089e83048994d773/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_929abcd2f93ad938089e83048994d773.o -o lib.so
[aiter INFO] 2025-10-23 03:34:28.406 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_929abcd2f93ad938089e83048994d773, cost 3.27545425s
[aiter INFO] 2025-10-23 03:34:28.445 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 291.51816769401626 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:28.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:34:28.528 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 187.47900000000004
[aiter INFO] 2025-10-23 03:34:28.529 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.678999999999974
[aiter INFO] 2025-10-23 03:34:28.548 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,712.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         18,364.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,076.9              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          210.8            210.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:28.549 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   210.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:29.116 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.78338687490708 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:29.171 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:34:29.171 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.87900000000002
[aiter INFO] 2025-10-23 03:34:29.171 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.32099999999997
[aiter INFO] 2025-10-23 03:34:29.182 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         12,567.6        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            126.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:29.209 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.70201973867889 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.878999999999962
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.038999999999987
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.279000000000025
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.438999999999965
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.438999999999965
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.561000000000007
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.399
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.718999999999994
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.839000000000055
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.718999999999994
[aiter INFO] 2025-10-23 03:34:29.245 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.399
[aiter INFO] 2025-10-23 03:34:29.257 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 90.0            0.0          1,390.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:29.259 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   142.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:29.278 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_e48f11adddeaa6473312a30f5ddb7c16' with {'src_template': <Template memory:7fe639a17e30>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_e48f11adddeaa6473312a30f5ddb7c16', 'folder': 'pa_e48f11adddeaa6473312a30f5ddb7c16', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': False}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_e48f11adddeaa6473312a30f5ddb7c16(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            false>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:34:29.278 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16
hipcc -fPIC -DUSE_ROCM -fgpu-flush-denormals-to-zero -D__HIP_PLATFORM_AMD__=1 -Wno-undefined-func-template -std=c++20 -mllvm -enable-post-misched=0 -Wno-vla-cxx-extension -DENABLE_FP8 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -fno-offload-uniform-block -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -D__HIP_PLATFORM_HCC__=1 -DUSE_PROF_API=1 -mllvm --lsr-drop-solution=1 -U__HIP_NO_HALF_CONVERSIONS__ --offload-arch=gfx942 -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -mllvm --amdgpu-kernarg-preload-count=16 -mllvm -amdgpu-coerce-illegal-types=1 -I/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include -c pa_e48f11adddeaa6473312a30f5ddb7c16.cpp -o pa_e48f11adddeaa6473312a30f5ddb7c16.o
In file included from pa_e48f11adddeaa6473312a30f5ddb7c16.cpp:1:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_e48f11adddeaa6473312a30f5ddb7c16.cpp:1:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_e48f11adddeaa6473312a30f5ddb7c16.o -o lib.so
[aiter INFO] 2025-10-23 03:34:32.598 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_e48f11adddeaa6473312a30f5ddb7c16, cost 3.31978554s
[aiter INFO] 2025-10-23 03:34:32.701 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 764.9348012291559 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:32.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {62, 9, 974, 975}
[aiter INFO] 2025-10-23 03:34:32.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.158999999999992
[aiter INFO] 2025-10-23 03:34:32.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 653.4789999999999
[aiter INFO] 2025-10-23 03:34:32.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 661.8389999999999
[aiter INFO] 2025-10-23 03:34:32.816 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.079000000001543
[aiter INFO] 2025-10-23 03:34:32.835 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,680.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         64,960.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       68,330.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          683.3            683.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:32.836 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   683.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:32.854 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:32.951 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 216.06723787170824 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {485, 744, 9, 364, 80, 19, 277, 757, 474, 92, 350, 287}
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.078999999999724
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.72100000000046
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.43899999999996
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.998999999999796
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.03899999999987
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.319000000000017
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.63899999999967
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.078999999999724
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.63900000000012
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.958999999999833
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.8409999999999
[aiter INFO] 2025-10-23 03:34:33.160 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.278999999999996
[aiter INFO] 2025-10-23 03:34:33.179 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,248.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0         12,163.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,126.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          141.3            141.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.180 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   141.18 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:33.380 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 489.1925238736785 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {665, 1292, 12}
[aiter INFO] 2025-10-23 03:34:33.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 377.91899999999987
[aiter INFO] 2025-10-23 03:34:33.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 377.8810000000012
[aiter INFO] 2025-10-23 03:34:33.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 382.603
[aiter INFO] 2025-10-23 03:34:33.471 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0         37,121.7        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            378.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.498 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.30597059679504 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:33.533 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.679000000000002
[aiter INFO] 2025-10-23 03:34:33.546 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            798.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.547 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   386.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:33.598 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.57803943015563 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.654 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 532, 181, 25, 1052}
[aiter INFO] 2025-10-23 03:34:33.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.32100000000003
[aiter INFO] 2025-10-23 03:34:33.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.07899999999972
[aiter INFO] 2025-10-23 03:34:33.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.03899999999999
[aiter INFO] 2025-10-23 03:34:33.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.75900000000001
[aiter INFO] 2025-10-23 03:34:33.655 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.36099999999897
[aiter INFO] 2025-10-23 03:34:33.667 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0          7,655.2        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             79.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.694 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.56182150380445 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:33.729 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.799000000000007
[aiter INFO] 2025-10-23 03:34:33.741 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            790.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.742 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    87.65 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:33.791 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 182.84930657632282 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:33.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {902, 9, 912, 17, 20, 28}
[aiter INFO] 2025-10-23 03:34:33.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.4390000000003
[aiter INFO] 2025-10-23 03:34:33.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.79900000000004
[aiter INFO] 2025-10-23 03:34:33.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.718999999999141
[aiter INFO] 2025-10-23 03:34:33.849 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.118999999999971
[aiter INFO] 2025-10-23 03:34:33.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.91899999999998
[aiter INFO] 2025-10-23 03:34:33.850 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.878999999999962
[aiter INFO] 2025-10-23 03:34:33.869 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,284.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          9,075.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,572.5              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          105.7            105.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:33.869 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   105.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:33.875 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:33.980 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 266.5002779795392 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {672, 615, 9, 657, 600, 26}
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71900000000005
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.838999999999942
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 167.999
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.04100000000017
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.71900000000005
[aiter INFO] 2025-10-23 03:34:34.051 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.278999999999996
[aiter INFO] 2025-10-23 03:34:34.070 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,213.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         16,140.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,730.8              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          187.3            187.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.071 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   187.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:34.292 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 629.5093681552622 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.387 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:34.387 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 523.641
[aiter INFO] 2025-10-23 03:34:34.397 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         51,826.5        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            518.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.425 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.15114836999686 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999985
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839000000000055
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.758999999999986
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999985
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999955
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599000000000046
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.439000000000021
[aiter INFO] 2025-10-23 03:34:34.460 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:34:34.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,046.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.473 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   530.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:34.539 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 233.11915934675991 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.595 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 662}
[aiter INFO] 2025-10-23 03:34:34.595 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 115.75899999999996
[aiter INFO] 2025-10-23 03:34:34.595 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 113.23900000000049
[aiter INFO] 2025-10-23 03:34:34.607 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         11,092.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            112.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.634 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.52142648236585 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.668 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 132, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:34:34.668 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.958999999999946
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999985
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.07899999999995
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999993
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.59899999999999
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.920999999999992
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359000000000037
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:34:34.669 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.719000000000051
[aiter INFO] 2025-10-23 03:34:34.681 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 86.0            0.0          1,014.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.682 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   123.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:34.750 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 275.13119814419514 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:34.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1036, 1037, 25}
[aiter INFO] 2025-10-23 03:34:34.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 173.199
[aiter INFO] 2025-10-23 03:34:34.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 171.75900000000001
[aiter INFO] 2025-10-23 03:34:34.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.439000000000306
[aiter INFO] 2025-10-23 03:34:34.958 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.678999999999974
[aiter INFO] 2025-10-23 03:34:34.977 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,227.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         16,879.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,301.4              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          193.0            193.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:34.978 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   193.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:34.991 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:35.107 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 353.8479005346204 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:35.186 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {738, 1058, 900, 901, 1030, 1031, 1059, 9, 874, 1008, 1009, 1040, 1041, 764, 925, 30}
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 240.47900000000027
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 248.5610000000015
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.998999999999796
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.83899999999994
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.80099999999948
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.879000000000815
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.11899999999878
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.55900000000003
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.75900000000001
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.87900000000081
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.11899999999878
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 244.95899999999892
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.2390000000014
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.958999999999833
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.11899999999878
[aiter INFO] 2025-10-23 03:34:35.187 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.838999999999942
[aiter INFO] 2025-10-23 03:34:35.206 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          2,989.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  93.0            0.0         22,570.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       27,497.7              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          275.0            274.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:35.207 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   274.84 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

max_diff_thr=0.0010946574620902538

NaN info:
{}
out_ref_md5=dc40c303bdec0e88087ebc3a8715fad1
gluon_fp8_output_md5=bcb8a6289c60b822fe2c9051bab9440a
diff.abs.max=0.05706787109375
max_diff_thr=0.05632869526743889

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.002991862129420042

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016806722851470113

NaN info:
{}
out_ref_md5=34d45af77c8a4df04d40a69195051292
triton_fp8_output_md5=53dfea43fbdcd7039fbd6ef894cda0d1
diff.abs.max=0.00136566162109375
max_diff_thr=0.0013612788170576096

NaN info:
{}
out_ref_md5=34d45af77c8a4df04d40a69195051292
gluon_fp8_output_md5=55505baa066e1d67fc532fa74c8249f9
diff.abs.max=0.05908203125
max_diff_thr=0.0572916679084301

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0031287604942917824

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012090436648577452

NaN info:
{}
out_ref_md5=854f28b17d55712347e83cb7daf6587b
gluon_fp8_output_md5=4492238b04e582c5b452f24dbaad9c02
diff.abs.max=0.0567626953125
max_diff_thr=0.055416516959667206

NaN info:
{}
diff.abs.max=0.00299072265625
max_diff_thr=0.002956978976726532

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012126356596127152

NaN info:
{}
out_ref_md5=4cfc52aacc265ce270fc70d84dc63614
gluon_fp8_output_md5=b0fe0e86884fa18117805cdeb857fe1f
diff.abs.max=0.061767578125
max_diff_thr=0.06016646698117256

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0032130947802215815

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.0016784558538347483

NaN info:
{}
out_ref_md5=e50c0d03010a3329d3419b031e747dd7
triton_fp8_output_md5=23c5c12190dd6dec2a6ed1c65f1f4577
diff.abs.max=0.001312255859375
max_diff_thr=0.0013042555656284094

NaN info:
{}
out_ref_md5=e50c0d03010a3329d3419b031e747dd7
gluon_fp8_output_md5=8277673d02e57d6a1315ae0e5e660e8f
diff.abs.max=0.0625
max_diff_thr=0.060235295444726944

NaN info:
{}
diff.abs.max=0.00322723388671875
max_diff_thr=0.003220354439690709

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017959770048037171

NaN info:
{}
out_ref_md5=fece419f418c5c32c11a0a0811ad0905
triton_fp8_output_md5=153ed982a0ac5fbeed4087a8a283414e
diff.abs.max=0.001190185546875
max_diff_thr=0.0011873049661517143

NaN info:
{}
out_ref_md5=fece419f418c5c32c11a0a0811ad0905
gluon_fp8_output_md5=78e410e36e0d83b7c273e092d1392639
diff.abs.max=0.0579833984375
max_diff_thr=0.05650053545832634

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0032318057492375374

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.00128173828125
max_diff_thr=0.0012691122246906161

NaN info:
{}
out_ref_md5=dcd5100ffe541840be8784098839a223
gluon_fp8_output_md5=0f64f091a7205a5ae837aed55cde5fdc
diff.abs.max=0.062255859375
max_diff_thr=0.05985915660858154

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003116011619567871

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013427734375
max_diff_thr=0.0013393604895099998

NaN info:
{}
out_ref_md5=977d40c81412d91c5eaf08a59558ba9d
gluon_fp8_output_md5=111644ede923e831b2a44f3e9ea04db9
diff.abs.max=0.062744140625
max_diff_thr=0.061336517333984375

NaN info:
{}
diff.abs.max=0.00341796875
max_diff_thr=0.003411098150536418

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0017976989038288593

NaN info:
{}
out_ref_md5=6f0c17a16d6e0ebdd2cab9c049fb7f21
triton_fp8_output_md5=fc27c229ed81d42b8dc41b5b02165456
diff.abs.max=0.0013427734375
max_diff_thr=0.0013322836020961404

NaN info:
{}
out_ref_md5=6f0c17a16d6e0ebdd2cab9c049fb7f21
gluon_fp8_output_md5=13805e076b8d1d358b25d3da83cfb39d
diff.abs.max=0.0031890869140625
max_diff_thr=0.003168298862874508

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001708984375
max_diff_thr=0.001671442179940641

NaN info:
{}
out_ref_md5=ca25ce9acca15284c013d9c5dc22549f
triton_fp8_output_md5=744b5e3834a44210508dd51db2b61495
diff.abs.max=0.001194000244140625
max_diff_thr=0.001193840871565044

NaN info:
{}
out_ref_md5=ca25ce9acca15284c013d9c5dc22549f
gluon_fp8_output_md5=242f7835c7067e6e7baad0ab123617e9
diff.abs.max=0.0030570030212402344
max_diff_thr=0.003047563135623932

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0011977482354268432

NaN info:
{}
out_ref_md5=fcffd04fe353dca5eb1548acdea87f62
gluon_fp8_output_md5=9822c067362671d452324278bff232ff
diff.abs.max=0.00323486328125
max_diff_thr=0.0032308700028806925

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001220703125
max_diff_thr=0.0012115337885916233

NaN info:
{}
out_ref_md5=2831d7408192c64b41fae66fc2555d73
gluon_fp8_output_md5=c6a081b647f3cc3f0452d97f1e483e33
diff.abs.max=0.00312042236328125
max_diff_thr=0.0031155969481915236

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0018310546875
max_diff_thr=0.0018123602494597435

NaN info:
{}
out_ref_md5=c14dcd8417a8c47cb74b681a198373fa
triton_fp8_output_md5=94b198aa073486c0dc3c6c19f1989ca5
diff.abs.max=0.001190185546875
max_diff_thr=0.001181138097308576

NaN info:
{}
out_ref_md5=c14dcd8417a8c47cb74b681a198373fa
gluon_fp8_output_md5=41b3aaf844ee8df1e3f41bb81ff4891a
diff.abs.max=0.003326416015625
max_diff_thr=0.003306437050923705

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001953125
max_diff_thr=0.001898659043945372

NaN info:
{}
out_ref_md5=e214a3a9116962313e53ee8baecbab47
triton_fp8_output_md5=2d69c5fa3096b9f1a372696abbe1d5c6
diff.abs.max=0.001190185546875
max_diff_thr=0.0011861494276672602

NaN info:
{}
out_ref_md5=e214a3a9116962313e53ee8baecbab47
gluon_fp8_output_md5=40733c70259c50ac2f687c754cf9092d
diff.abs.max=0.003173828125
max_diff_thr=0.0031476998701691628

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625[aiter INFO] 2025-10-23 03:34:35.400 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 308.7257530429576 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:35.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1313}
[aiter INFO] 2025-10-23 03:34:35.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.079
[aiter INFO] 2025-10-23 03:34:35.461 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 189.12099999999998
[aiter INFO] 2025-10-23 03:34:35.462 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.4389999999985
[aiter INFO] 2025-10-23 03:34:35.472 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         18,287.9        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            186.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:35.499 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 79.39470293793347 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.399
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.038999999999987
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.199000000000012
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.038999999999987
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.038999999999987
[aiter INFO] 2025-10-23 03:34:35.534 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.161
[aiter INFO] 2025-10-23 03:34:35.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.358999999999924
[aiter INFO] 2025-10-23 03:34:35.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.278999999999996
[aiter INFO] 2025-10-23 03:34:35.535 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.798999999999978
[aiter INFO] 2025-10-23 03:34:35.547 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,941.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:35.548 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   207.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:35.629 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 327.5816738605499 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:35.701 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 28}
[aiter INFO] 2025-10-23 03:34:35.701 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 220.241
[aiter INFO] 2025-10-23 03:34:35.701 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.199000000000012
[aiter INFO] 2025-10-23 03:34:35.720 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          3,200.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         21,737.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,938.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          249.4            249.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:35.721 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   249.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:35.741 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = False)
[aiter INFO] 2025-10-23 03:34:35.862 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 410.4159893375812 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:35.944 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {745, 34, 774, 9}
[aiter INFO] 2025-10-23 03:34:35.945 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 290.1210000000001
[aiter INFO] 2025-10-23 03:34:35.945 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.55900000000008
[aiter INFO] 2025-10-23 03:34:35.945 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.999000000000706
[aiter INFO] 2025-10-23 03:34:35.945 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 288.32099999999997
[aiter INFO] 2025-10-23 03:34:35.964 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          4,139.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         28,325.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       32,796.6              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN          328.0            327.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:35.965 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   327.92 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:36.164 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 326.76939769546584 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:36.227 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1313}
[aiter INFO] 2025-10-23 03:34:36.227 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 199.99899999999997
[aiter INFO] 2025-10-23 03:34:36.227 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.321
[aiter INFO] 2025-10-23 03:34:36.227 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.9190000000017
[aiter INFO] 2025-10-23 03:34:36.238 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         19,772.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            201.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:36.266 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 88.45811860986275 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.43900000000002
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.519000000000005
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.63900000000001
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.27899999999997
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.278999999999996
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.11900000000003
[aiter INFO] 2025-10-23 03:34:36.300 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.15899999999999
[aiter INFO] 2025-10-23 03:34:36.312 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,504.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:36.314 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   228.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:36.488 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1162.6925102554926 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:36.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {964, 965, 100, 1032, 1033, 9, 1048, 1049}
[aiter INFO] 2025-10-23 03:34:36.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1052.523000000001
[aiter INFO] 2025-10-23 03:34:36.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.47899999999936
[aiter INFO] 2025-10-23 03:34:36.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.118999999999915
[aiter INFO] 2025-10-23 03:34:36.643 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1045.002999999997
[aiter INFO] 2025-10-23 03:34:36.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.99899999999616
[aiter INFO] 2025-10-23 03:34:36.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1051.2430000000002
[aiter INFO] 2025-10-23 03:34:36.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1052.7209999999905
[aiter INFO] 2025-10-23 03:34:36.644 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.2390000000014
[aiter INFO] 2025-10-23 03:34:36.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          4,027.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0        101,726.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      109,029.0              0.0         CPU       239091
[avg us/iter]                                                                                        NaN   NaN        1,090.3          1,090.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:36.663 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1090.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:36.697 - MainProcess:239091 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:934 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  us_triton_fp8  us_gluon_fp8  err_gluon_fp8  gluon_fp8_bandwith(TB/s)  us_asm_fp8  asm_fp8_bandwith(TB/s)  us_hip_fp8 perf_fp8_gluon_vs_hip perf_fp8_gluon_vs_asm
0       4096          80    (8, 1)        128          16  torch.bfloat16     1    False         63.8          218.8          53.4              0                       1.4        39.8                     1.9        51.0                   95%                   74%
1       4096          80    (8, 1)        128          16  torch.bfloat16     2    False         92.9          302.0          56.7              0                       1.4        36.4                     2.1        98.1                  173%                   64%
2       4096          80    (8, 1)        128          16  torch.bfloat16     3    False        137.6            NaN          78.2              0                       1.0         NaN                     NaN       131.0                  167%                   NaN
3       4096          80    (8, 1)        128          16  torch.bfloat16     4    False        171.2            NaN          82.9              0                       0.9        62.9                     1.2       650.6                  785%                   76%
4       4096         128    (8, 1)        128          16  torch.bfloat16     1    False        100.7          352.4          80.0              0                       1.5        67.1                     1.8        77.5                   97%                   84%
5       4096         128    (8, 1)        128          16  torch.bfloat16     2    False        142.3          486.3          84.2              0                       1.5        70.0                     1.8       153.8                  183%                   83%
6       4096         128    (8, 1)        128          16  torch.bfloat16     3    False        214.4            NaN         118.8              0                       1.0         NaN                     NaN       205.7                  173%                   NaN
7       4096         128    (8, 1)        128          16  torch.bfloat16     4    False        269.1            NaN         124.4              0                       1.0       123.4                     1.0     1,036.3                  833%                   99%
8       4096          80   (10, 1)        128          16  torch.bfloat16     1    False         66.3          220.5          54.7              0                       1.4        36.0                     2.1        53.6                   98%                   66%
9       4096          80   (10, 1)        128          16  torch.bfloat16     2    False         96.3          304.1          74.1              0                       1.0        62.5                     1.2       102.1                  138%                   84%
10      4096          80   (10, 1)        128          16  torch.bfloat16     3    False        144.3            NaN          76.6              0                       1.0        90.1                     0.9       137.1                  179%                  118%
11      4096          80   (10, 1)        128          16  torch.bfloat16     4    False        178.0            NaN         111.2              0                       0.7       117.6                     0.7       653.6                  588%                  106%
12      4096         128   (10, 1)        128          16  torch.bfloat16     1    False        101.6          354.7          80.8              0                       1.5        61.9                     2.0        80.1                   99%                   77%
13      4096         128   (10, 1)        128          16  torch.bfloat16     2    False        146.0          490.1         110.6              0                       1.1       122.6                     1.0       159.9                  145%                  111%
14      4096         128   (10, 1)        128          16  torch.bfloat16     3    False        225.1            NaN         114.8              0                       1.1       177.5                     0.7       214.6                  187%                  155%
15      4096         128   (10, 1)        128          16  torch.bfloat16     4    False        280.8            NaN         171.5              0                       0.7       232.6                     0.5     1,044.9                  609%                  136%
16      4096          80   (16, 1)        128          16  torch.bfloat16     1    False         70.0          210.9          56.5              0                       1.4        36.5                     2.1        57.0                  101%                   65%
17      4096          80   (16, 1)        128          16  torch.bfloat16     2    False        102.8          295.9          77.3              0                       1.0        62.9                     1.2       108.8                  141%                   81%
18      4096          80   (16, 1)        128          16  torch.bfloat16     3    False        154.6            NaN         112.6              0                       0.7        90.5                     0.9       143.8                  128%                   80%
19      4096          80   (16, 1)        128          16  torch.bfloat16     4    False        191.0            NaN         132.8              0                       0.6       117.9                     0.7       669.7                  504%                   89%
20      4096         128   (16, 1)        128          16  torch.bfloat16     1    False        108.1          337.8          83.6              0                       1.5        62.3                     2.0        85.7                  103%                   75%
21      4096         128   (16, 1)        128          16  torch.bfloat16     2    False        156.8          474.9         114.9              0                       1.1       123.0                     1.0       169.1                  147%                  107%
22      4096         128   (16, 1)        128          16  torch.bfloat16     3    False        241.8            NaN         177.3              0                       0.7       178.1                     0.7       225.6                  127%                  100%
23      4096         128   (16, 1)        128          16  torch.bfloat16     4    False        299.0            NaN         209.8              0                       0.6       232.8                     0.5     1,064.8                  507%                  111%
24      4096          80    (8, 1)        128          64  torch.bfloat16     1    False         81.3          221.2          57.8              0                       1.3         NaN                     NaN        52.7                   91%                   NaN
25      4096          80    (8, 1)        128          64  torch.bfloat16     2    False        105.7          294.7          61.4              0                       1.2         NaN                     NaN        99.9                  163%                   NaN
26      4096          80    (8, 1)        128          64  torch.bfloat16     3    False        149.7            NaN         107.3              0                       0.7         NaN                     NaN       132.2                  123%                   NaN
27      4096          80    (8, 1)        128          64  torch.bfloat16     4    False        177.9            NaN         110.4              0                       0.7         NaN                     NaN       646.9                  586%                   NaN
28      4096         128    (8, 1)        128          64  torch.bfloat16     1    False        125.8          354.3          85.5              0                       1.4         NaN                     NaN        80.0                   94%                   NaN
29      4096         128    (8, 1)        128          64  torch.bfloat16     2    False        165.7          473.6          90.9              0                       1.3         NaN                     NaN       156.1                  172%                   NaN
30      4096         128    (8, 1)        128          64  torch.bfloat16     3    False        236.7            NaN         163.4              0                       0.8         NaN                     NaN       208.4                  128%                   NaN
31      4096         128    (8, 1)        128          64  torch.bfloat16     4    False        278.2            NaN         166.0              0                       0.7         NaN                     NaN     1,030.7                  621%                   NaN
32      4096          80   (10, 1)        128          64  torch.bfloat16     1    False         83.5          222.4          58.6              0                       1.3         NaN                     NaN        55.3                   94%                   NaN
33      4096          80   (10, 1)        128          64  torch.bfloat16     2    False        109.9          296.6         106.6              0                       0.7         NaN                     NaN       104.4                   98%                   NaN
34      4096          80   (10, 1)        128          64  torch.bfloat16     3    False        156.6            NaN         110.0              0                       0.7         NaN                     NaN       138.8                  126%                   NaN
35      4096          80   (10, 1)        128          64  torch.bfloat16     4    False        187.3            NaN         118.4              0                       0.7         NaN                     NaN       653.3                  552%                   NaN
36      4096         128   (10, 1)        128          64  torch.bfloat16     1    False        128.0          356.7          86.9              0                       1.4         NaN                     NaN        82.7                   95%                   NaN
37      4096         128   (10, 1)        128          64  torch.bfloat16     2    False        171.4          477.3         161.2              0                       0.8         NaN                     NaN       162.6                  101%                   NaN
38      4096         128   (10, 1)        128          64  torch.bfloat16     3    False        248.1            NaN         165.7              0                       0.7         NaN                     NaN       218.8                  132%                   NaN
39      4096         128   (10, 1)        128          64  torch.bfloat16     4    False        286.9            NaN         181.7              0                       0.7         NaN                     NaN     1,044.8                  575%                   NaN
40      4096          80   (16, 1)        128          64  torch.bfloat16     1    False         86.8          219.4          61.2              0                       1.3         NaN                     NaN        58.8                   96%                   NaN
41      4096          80   (16, 1)        128          64  torch.bfloat16     2    False        117.9          303.9         109.4              0                       0.7         NaN                     NaN       110.0                  100%                   NaN
42      4096          80   (16, 1)        128          64  torch.bfloat16     3    False        167.4            NaN         121.7              0                       0.6         NaN                     NaN       145.2                  119%                   NaN
43      4096          80   (16, 1)        128          64  torch.bfloat16     4    False        201.6            NaN         156.9              0                       0.5         NaN                     NaN       664.7                  424%                   NaN
44      4096         128   (16, 1)        128          64  torch.bfloat16     1    False        133.9          351.3          89.7              0                       1.4         NaN                     NaN        87.9                   98%                   NaN
45      4096         128   (16, 1)        128          64  torch.bfloat16     2    False        182.4          488.4         164.3              0                       0.7         NaN                     NaN       171.1                  104%                   NaN
46      4096         128   (16, 1)        128          64  torch.bfloat16     3    False        265.2            NaN         191.8              0                       0.6         NaN                     NaN       229.0                  119%                   NaN
47      4096         128   (16, 1)        128          64  torch.bfloat16     4    False        311.3            NaN         247.4              0                       0.5         NaN                     NaN     1,064.0                  430%                   NaN
48      4096          80    (8, 1)        128        1024  torch.bfloat16     1    False         86.7          241.9          55.8              0                       1.4         NaN                     NaN        63.8                  114%                   NaN
49      4096          80    (8, 1)        128        1024  torch.bfloat16     2    False        110.9          325.4          59.7              0                       1.3         NaN                     NaN       110.0                  184%                   NaN
50      4096          80    (8, 1)        128        1024  torch.bfloat16     3    False        157.1            NaN          81.1              0                       0.9         NaN                     NaN       141.1                  174%                   NaN
51      4096          80    (8, 1)        128        1024  torch.bfloat16     4    False        188.1            NaN          83.3              0                       0.9         NaN                     NaN       659.2                  792%                   NaN
52      4096         128    (8, 1)        128        1024  torch.bfloat16     1    False        133.9          389.3          81.8              0                       1.5         NaN                     NaN        97.3                  119%                   NaN
53      4096         128    (8, 1)        128        1024  torch.bfloat16     2    False        172.2          525.4          87.5              0                       1.4         NaN                     NaN       174.8                  200%                   NaN
54      4096         128    (8, 1)        128        1024  torch.bfloat16     3    False        246.3            NaN         123.8              0                       1.0         NaN                     NaN       223.1                  180%                   NaN
55      4096         128    (8, 1)        128        1024  torch.bfloat16     4    False        295.2            NaN         125.6              0                       1.0         NaN                     NaN     1,055.9                  840%                   NaN
56      4096          80   (10, 1)        128        1024  torch.bfloat16     1    False         88.5          242.8          56.5              0                       1.4        29.3                     2.6        65.8                  116%                   52%
57      4096          80   (10, 1)        128        1024  torch.bfloat16     2    False        114.5          327.5          79.7              0                       1.0        50.3                     1.5       116.0                  145%                   63%
58      4096          80   (10, 1)        128        1024  torch.bfloat16     3    False        163.7            NaN          82.4              0                       0.9        50.8                     1.5       148.5                  180%                   62%
59      4096          80   (10, 1)        128        1024  torch.bfloat16     4    False        197.0            NaN         128.3              0                       0.6        66.3                     1.2       670.3                  522%                   52%
60      4096         128   (10, 1)        128        1024  torch.bfloat16     1    False        137.6          391.7          84.1              0                       1.5        55.9                     2.2        99.7                  119%                   66%
61      4096         128   (10, 1)        128        1024  torch.bfloat16     2    False        177.2          529.1         121.5              0                       1.0        97.3                     1.3       183.6                  151%                   80%
62      4096         128   (10, 1)        128        1024  torch.bfloat16     3    False        256.7            NaN         124.9              0                       1.0        98.1                     1.3       235.2                  188%                   79%
63      4096         128   (10, 1)        128        1024  torch.bfloat16     4    False        309.1            NaN         201.1              0                       0.6       130.3                     1.0     1,071.7                  533%                   65%
64      4096          80   (16, 1)        128        1024  torch.bfloat16     1    False         92.3          240.5          59.3              0                       1.3         NaN                     NaN        70.0                  118%                   NaN
65      4096          80   (16, 1)        128        1024  torch.bfloat16     2    False        121.5          330.1          82.2              0                       0.9         NaN                     NaN       122.8                  150%                   NaN
66      4096          80   (16, 1)        128        1024  torch.bfloat16     3    False        174.2            NaN         129.5              0                       0.6         NaN                     NaN       157.2                  121%                   NaN
67      4096          80   (16, 1)        128        1024  torch.bfloat16     4    False        210.8            NaN         142.4              0                       0.5         NaN                     NaN       683.2                  480%                   NaN
68      4096         128   (16, 1)        128        1024  torch.bfloat16     1    False        141.2          386.8          87.6              0                       1.4         NaN                     NaN       105.7                  121%                   NaN
69      4096         128   (16, 1)        128        1024  torch.bfloat16     2    False        187.3          530.2         123.8              0                       1.0         NaN                     NaN       193.0                  156%                   NaN
70      4096         128   (16, 1)        128        1024  torch.bfloat16     3    False        274.8            NaN         207.7              0                       0.6         NaN                     NaN       249.4                  120%                   NaN
71      4096         128   (16, 1)        128        1024  torch.bfloat16     4    False        327.9            NaN         228.4              0                       0.5         NaN                     NaN     1,090.2                  477%                   NaN

max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.001312255859375
max_diff_thr=0.0013040577759966254

NaN info:
{}
out_ref_md5=17beed7f1bc8dd30bf8bc934ea290267
gluon_fp8_output_md5=1a67912a6f5f17adb722649218f84169
diff.abs.max=0.00323486328125
max_diff_thr=0.0032151415944099426

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
diff.abs.max=0.0013427734375
max_diff_thr=0.0013381994795054197

NaN info:
{}
out_ref_md5=882f85357a1f9dbba7300a183cb8d334
gluon_fp8_output_md5=f1d9e2e71c76e7c5a93b7cc639e988f5
diff.abs.max=0.0032958984375
max_diff_thr=0.00325203244574368

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
++ python ./test_pa_mtp.py --trans_v
[aiter INFO] 2025-10-23 03:34:41.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/core.py:351 - get_module_custom_op
import [module_aiter_enum] under /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/module_aiter_enum.so
[aiter INFO] 2025-10-23 03:34:44.241 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:45.407 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.7556829664967 us/iter from cuda.Event
[W1023 03:34:45.145125041 collection.cpp:1100] Warning: ROCTracer produced duplicate flow start: 1 (function operator())
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {515, 9, 523, 592, 16, 86, 600, 94}
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.79899999999998
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.63900000000001
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.59900000000016
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000044
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.52099999999996
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-10-23 03:34:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.719000000000051
[aiter INFO] 2025-10-23 03:34:45.575 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            473.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0          5,740.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,409.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           64.1             64.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:45.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    64.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:46.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 328.9821094805651 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1145, 1284, 201, 1290, 492, 12, 1296, 50, 755, 1302, 25}
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.00099999999838
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.76100000000042
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 212.36100000000033
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.20100000000093
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.71900000000005
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.55899999999997
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.64100000000326
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.88099999999997
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.9989999999998
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.79899999999907
[aiter INFO] 2025-10-23 03:34:46.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.719
[aiter INFO] 2025-10-23 03:34:46.967 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 90.0            0.0         19,207.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            213.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:46.999 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.73095068128981 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.028 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:47.028 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000007
[aiter INFO] 2025-10-23 03:34:47.040 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            584.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.048 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   219.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:47.484 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 275.91980182298335 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 38, 935}
[aiter INFO] 2025-10-23 03:34:47.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.35899999999998
[aiter INFO] 2025-10-23 03:34:47.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.43900000000002
[aiter INFO] 2025-10-23 03:34:47.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.03899999999999
[aiter INFO] 2025-10-23 03:34:47.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.240999999999985
[aiter INFO] 2025-10-23 03:34:47.550 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          4,629.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             47.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.586 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 114.71089145334639 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.625 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:47.625 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000007
[aiter INFO] 2025-10-23 03:34:47.637 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            582.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.638 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    53.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:47.642 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/core.py:351 - get_module_custom_op
import [module_attention_asm] under /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/jit/module_attention_asm.so
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp.co GetFunction: _ZN5aiter35pa_bf16_pertokenFp8_gqa8_2tg_4w_uhpE Success
[aiter INFO] 2025-10-23 03:34:47.674 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 59.901574202398265 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.698 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {40, 4}
[aiter INFO] 2025-10-23 03:34:47.698 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.23900000000003
[aiter INFO] 2025-10-23 03:34:47.698 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.35899999999998
[aiter INFO] 2025-10-23 03:34:47.714 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  99.0            0.0          3,909.8        CUDA            5
1                               aiter::wrapper_pa_fwd_asm 100.0        3,951.0              0.0         CPU       242313
[avg us/iter]                                         NaN   NaN           39.5             39.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    39.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:47.741 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.88690075543846 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 42, 16, 49, 20, 27, 31}
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.798999999999978
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.559
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.83899999999994
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.718999999999937
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.278999999999996
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.799000000000035
[aiter INFO] 2025-10-23 03:34:47.801 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.438999999999965
[aiter INFO] 2025-10-23 03:34:47.820 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            472.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          4,457.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,087.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           50.9             50.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    50.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:47.824 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:47.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 205.58490065654905 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:47.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1065, 1074, 9, 17}
[aiter INFO] 2025-10-23 03:34:47.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.71900000000096
[aiter INFO] 2025-10-23 03:34:47.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000597
[aiter INFO] 2025-10-23 03:34:47.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.48100000000002
[aiter INFO] 2025-10-23 03:34:47.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.038999999999987
[aiter INFO] 2025-10-23 03:34:47.991 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            917.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          8,264.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,279.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           92.8             92.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:47.991 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    92.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:48.883 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 402.8777618809502 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:48.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1312, 347, 12, 1279}
[aiter INFO] 2025-10-23 03:34:48.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 292.6810000000005
[aiter INFO] 2025-10-23 03:34:48.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 292.80099999999993
[aiter INFO] 2025-10-23 03:34:48.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 295.20099999999996
[aiter INFO] 2025-10-23 03:34:48.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 292.8009999999995
[aiter INFO] 2025-10-23 03:34:48.968 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         28,508.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            293.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:48.996 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.35150482630965 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:49.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.679000000000002
[aiter INFO] 2025-10-23 03:34:49.037 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            679.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   300.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:49.362 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 173.75422763352347 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {168, 116, 12, 974}
[aiter INFO] 2025-10-23 03:34:49.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.278999999999996
[aiter INFO] 2025-10-23 03:34:49.414 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.19900000000007
[aiter INFO] 2025-10-23 03:34:49.414 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.759000000000015
[aiter INFO] 2025-10-23 03:34:49.414 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.199000000000524
[aiter INFO] 2025-10-23 03:34:49.426 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          4,855.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             50.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.90635631108049 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.492 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:49.492 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-10-23 03:34:49.504 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            680.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.505 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1.co GetFunction: _ZN5aiter40pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1E Success
[aiter INFO] 2025-10-23 03:34:49.542 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 52.217207885909794 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.566 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4}
[aiter INFO] 2025-10-23 03:34:49.566 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.87899999999999
[aiter INFO] 2025-10-23 03:34:49.581 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1 100.0            0.0          3,672.8        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        3,672.8              0.0         CPU       242313
[avg us/iter]                                              NaN   NaN           36.7             36.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.582 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:49.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.01405979383108 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.788 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:34:49.788 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.23899999999998
[aiter INFO] 2025-10-23 03:34:49.788 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999962
[aiter INFO] 2025-10-23 03:34:49.807 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            933.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0          8,871.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,804.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           98.0             98.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.808 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    98.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:49.812 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:49.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 215.55398994743234 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:49.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19, 748, 735}
[aiter INFO] 2025-10-23 03:34:49.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.12100000000004
[aiter INFO] 2025-10-23 03:34:49.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999978
[aiter INFO] 2025-10-23 03:34:49.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999141
[aiter INFO] 2025-10-23 03:34:49.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.27900000000045
[aiter INFO] 2025-10-23 03:34:49.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,206.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         12,420.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,762.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          137.6            137.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:49.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   137.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:50.410 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 191.065981098921 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:50.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 701}
[aiter INFO] 2025-10-23 03:34:50.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.19900000000001
[aiter INFO] 2025-10-23 03:34:50.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.27899999999997
[aiter INFO] 2025-10-23 03:34:50.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.11899999999969
[aiter INFO] 2025-10-23 03:34:50.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          6,823.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             69.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:50.505 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.59071283293243 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:50.534 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:50.534 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.998999999999995
[aiter INFO] 2025-10-23 03:34:50.546 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            829.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:50.547 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    77.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:50.602 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 214.50447460802474 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:50.655 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:34:50.655 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.23900000000003
[aiter INFO] 2025-10-23 03:34:50.655 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.59899999999999
[aiter INFO] 2025-10-23 03:34:50.674 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,217.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         11,891.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,108.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          131.1            131.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:50.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   131.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:50.682 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:50.762 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.77389114682035 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {325, 165, 9, 1106, 1107, 23, 149, 1078, 311, 1079}
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999905
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 160.55900000000003
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.27899999999863
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000002561
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.519
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.59900000000016
[aiter INFO] 2025-10-23 03:34:50.830 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.96099999999979
[aiter INFO] 2025-10-23 03:34:50.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000378
[aiter INFO] 2025-10-23 03:34:50.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,452.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         14,996.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,141.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          171.4            171.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:50.850 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   171.35 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:51.287 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 196.65649429996415 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:51.338 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1299, 12}
[aiter INFO] 2025-10-23 03:34:51.338 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.59900000000016
[aiter INFO] 2025-10-23 03:34:51.338 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.23899999999998
[aiter INFO] 2025-10-23 03:34:51.349 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          7,161.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             72.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:51.377 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.0236036287676 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:51.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:51.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.759000000000015
[aiter INFO] 2025-10-23 03:34:51.424 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            962.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:51.425 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    81.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:51.468 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 77.64104001297808 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:51.495 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {17, 43, 4}
[aiter INFO] 2025-10-23 03:34:51.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.23900000000003
[aiter INFO] 2025-10-23 03:34:51.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.75899999999996
[aiter INFO] 2025-10-23 03:34:51.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.91900000000001
[aiter INFO] 2025-10-23 03:34:51.511 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  98.0            0.0          6,160.0        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        6,285.0              0.0         CPU       242313
[avg us/iter]                                              NaN   NaN           62.8             62.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:51.512 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:51.603 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 734.5363468226819 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {256, 193, 67, 9, 685, 942, 943, 1006, 625, 1007, 1010, 1011, 1110, 1111, 1052, 1053}
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.559000000000196
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 644.5990000000002
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.359000000000037
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 634.563
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000233
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.7209999999995
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.0430000000015
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.8409999999994
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999997759
[aiter INFO] 2025-10-23 03:34:51.835 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 645.6429999999964
[aiter INFO] 2025-10-23 03:34:51.836 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:34:51.836 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.6430000000037
[aiter INFO] 2025-10-23 03:34:51.836 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.559000000008382
[aiter INFO] 2025-10-23 03:34:51.836 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 642.8389999999999
[aiter INFO] 2025-10-23 03:34:51.836 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.55899999999383
[aiter INFO] 2025-10-23 03:34:51.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          1,424.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  93.0            0.0         59,064.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,096.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          651.0            650.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:51.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   650.42 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:51.865 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:51.979 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 161.74785158421733 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17, 1044, 1059, 1061, 1073, 1074, 1085, 1086, 1096, 1097, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111}
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.32100000000003
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.03900000000067
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999287
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.08100000000013
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.59900000000016
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000233
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.87900000000081
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.439000000000306
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.84100000000035
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.39899999999943
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.879000000000815
[aiter INFO] 2025-10-23 03:34:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.1989999999987
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000233
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.03900000000067
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999069
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.51900000000023
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.55899999999929
[aiter INFO] 2025-10-23 03:34:52.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.279000000000451
[aiter INFO] 2025-10-23 03:34:52.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  90.0            0.0            745.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  90.0            0.0          8,212.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,059.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          100.6             99.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    99.53 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:52.226 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 446.2343469114587 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.302 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {185, 12}
[aiter INFO] 2025-10-23 03:34:52.302 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 348.203
[aiter INFO] 2025-10-23 03:34:52.302 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 350.35900000000004
[aiter INFO] 2025-10-23 03:34:52.314 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         34,260.7        CUDA            5
[avg us/iter]               NaN  NaN            0.0            346.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.50681187964902 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.369 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:52.369 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.199000000000012
[aiter INFO] 2025-10-23 03:34:52.382 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            691.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.382 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   352.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:52.430 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.62120783801126 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {584, 25, 12, 350}
[aiter INFO] 2025-10-23 03:34:52.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.55899999999929
[aiter INFO] 2025-10-23 03:34:52.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.80099999999999
[aiter INFO] 2025-10-23 03:34:52.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.15899999999999
[aiter INFO] 2025-10-23 03:34:52.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.67900000000009
[aiter INFO] 2025-10-23 03:34:52.494 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          7,053.2        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             72.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.520 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.45056453081641 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:52.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.638999999999982
[aiter INFO] 2025-10-23 03:34:52.567 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            692.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.568 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    79.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:52.603 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 81.46363371374584 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {33, 4, 17, 471, 477}
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.11900000000003
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.35899999999998
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.519
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.4390000000003
[aiter INFO] 2025-10-23 03:34:52.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.39899999999943
[aiter INFO] 2025-10-23 03:34:52.647 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                     name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_2tg_4w_uhp  96.0            0.0          6,431.6        CUDA            5
1                               aiter::wrapper_pa_fwd_asm 100.0        6,706.0              0.0         CPU       242313
[avg us/iter]                                         NaN   NaN           67.1             67.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.647 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    67.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:52.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 158.09515841526562 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.727 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:34:52.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.39900000000003
[aiter INFO] 2025-10-23 03:34:52.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.839
[aiter INFO] 2025-10-23 03:34:52.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.678999999999974
[aiter INFO] 2025-10-23 03:34:52.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.3589999999999804
[aiter INFO] 2025-10-23 03:34:52.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            758.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          6,896.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,733.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           77.3             77.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    77.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:52.750 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:52.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 218.05182158356845 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:52.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1058, 1059, 1060, 1061, 1062, 1063, 9, 1068, 1069, 19}
[aiter INFO] 2025-10-23 03:34:52.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.9989999999998
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999998996
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.19900000000052
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.47899999999936
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.95900000000074
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.15899999999996
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.07899999999972
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.03899999999885
[aiter INFO] 2025-10-23 03:34:52.925 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-10-23 03:34:52.944 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,281.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         12,432.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,297.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          143.0            142.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:52.945 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   142.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:53.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 582.0842709871802 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.217 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:53.217 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 479.55899999999997
[aiter INFO] 2025-10-23 03:34:53.229 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         47,676.8        CUDA            5
[avg us/iter]               NaN   NaN            0.0            476.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.255 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.65726702520163 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.284 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:53.284 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.001000000000005
[aiter INFO] 2025-10-23 03:34:53.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            798.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.297 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   484.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:53.347 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 195.0620293322176 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.516 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:34:53.516 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.59899999999999
[aiter INFO] 2025-10-23 03:34:53.528 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          7,607.5        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             76.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.555 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.01768296012784 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.590 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:53.590 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.278999999999996
[aiter INFO] 2025-10-23 03:34:53.602 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            792.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.603 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    84.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:53.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 85.38554439155183 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 458, 4, 453}
[aiter INFO] 2025-10-23 03:34:53.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.519
[aiter INFO] 2025-10-23 03:34:53.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.43899999999985
[aiter INFO] 2025-10-23 03:34:53.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.35900000000001
[aiter INFO] 2025-10-23 03:34:53.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.31899999999996
[aiter INFO] 2025-10-23 03:34:53.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  97.0            0.0          6,805.2        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0        7,020.5              0.0         CPU       242313
[avg us/iter]                                              NaN   NaN           70.2             70.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    70.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:53.723 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 236.3156341385133 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:53.787 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21}
[aiter INFO] 2025-10-23 03:34:53.787 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 142.399
[aiter INFO] 2025-10-23 03:34:53.787 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.278999999999996
[aiter INFO] 2025-10-23 03:34:53.806 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,323.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         14,052.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,375.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          153.8            153.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:53.807 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   153.76 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:53.813 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:53.943 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 294.29168482818227 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.007 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:34:54.007 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.599
[aiter INFO] 2025-10-23 03:34:54.007 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000028
[aiter INFO] 2025-10-23 03:34:54.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,764.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         19,674.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,439.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          214.4            214.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   214.39 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:54.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 226.44589074177318 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 701}
[aiter INFO] 2025-10-23 03:34:54.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 109.35900000000001
[aiter INFO] 2025-10-23 03:34:54.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.60099999999966
[aiter INFO] 2025-10-23 03:34:54.245 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         10,606.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            107.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.272 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.77329716883084 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:54.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.519000000000005
[aiter INFO] 2025-10-23 03:34:54.312 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,115.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.313 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   118.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:54.377 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 289.78115821828936 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.438 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:34:54.438 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 190.04100000000003
[aiter INFO] 2025-10-23 03:34:54.438 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.079000000000008
[aiter INFO] 2025-10-23 03:34:54.457 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,767.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         18,793.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,560.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          205.6            205.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.458 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   205.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:54.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:54.585 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 350.5484851280061 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 9}
[aiter INFO] 2025-10-23 03:34:54.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.199000000000012
[aiter INFO] 2025-10-23 03:34:54.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 248.401
[aiter INFO] 2025-10-23 03:34:54.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,264.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         24,656.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       26,920.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          269.2            269.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   269.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:54.848 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 234.6039411455098 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 935, 12, 1039, 688}
[aiter INFO] 2025-10-23 03:34:54.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.31900000000041
[aiter INFO] 2025-10-23 03:34:54.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 110.15899999999965
[aiter INFO] 2025-10-23 03:34:54.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 114.35899999999998
[aiter INFO] 2025-10-23 03:34:54.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.27900000000045
[aiter INFO] 2025-10-23 03:34:54.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 112.63900000000012
[aiter INFO] 2025-10-23 03:34:54.910 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0         10,679.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            111.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.937 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.82278185551709 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.439000000000078
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.158999999999992
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:34:54.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999928
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999994
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.31899999999996
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:34:54.970 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-10-23 03:34:54.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,042.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:54.983 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   123.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:55.032 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.773535481774 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {448, 484, 4, 430, 432, 468, 471, 29}
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.91899999999987
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.03900000000067
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.519
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.96099999999979
[aiter INFO] 2025-10-23 03:34:55.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.68100000000004
[aiter INFO] 2025-10-23 03:34:55.071 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.03899999999976
[aiter INFO] 2025-10-23 03:34:55.071 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.92100000000028
[aiter INFO] 2025-10-23 03:34:55.071 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.43900000000002
[aiter INFO] 2025-10-23 03:34:55.086 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                          name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa8_1tg_4w_mtp_msk1  93.0            0.0         11,465.9        CUDA            5
1                                    aiter::wrapper_pa_fwd_asm 100.0       12,329.9              0.0         CPU       242313
[avg us/iter]                                              NaN   NaN          123.3            123.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:55.087 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   123.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:55.224 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1117.533590533946 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {100, 9, 1040, 1041, 1046, 1047, 1050, 1051}
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.95900000000006
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1015.163
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1022.2010000000009
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000233
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1024.3629999999976
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.55899999999383
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1020.6030000000028
[aiter INFO] 2025-10-23 03:34:55.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.75900000000547
[aiter INFO] 2025-10-23 03:34:55.518 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,191.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         98,375.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      103,702.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,037.0          1,036.8         NaN          NaN
[aiter INFO] 2025-10-23 03:34:55.519 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1036.78 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:55.535 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:55.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.26896962316908 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:55.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {897, 515, 996, 9, 523, 988, 174, 17, 20, 182, 889, 28}
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.958999999999833
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.95899999999983
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.879000000000815
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.759000000000015
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.03899999999976
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 58.15899999999965
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.15899999999988
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.19900000000001
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.95900000000006
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 60.91899999999987
[aiter INFO] 2025-10-23 03:34:55.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.158999999999992
[aiter INFO] 2025-10-23 03:34:55.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            665.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0          5,662.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        6,665.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           66.7             66.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:55.692 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    66.61 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:56.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 322.43201077574554 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1313, 12, 25, 953, 414}
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 213.72099999999773
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 217.481
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.88099999999997
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 213.75900000000001
[aiter INFO] 2025-10-23 03:34:56.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 215.64099999999962
[aiter INFO] 2025-10-23 03:34:56.425 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         20,605.4        CUDA            5
[avg us/iter]               NaN  NaN            0.0            214.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:56.452 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.39390124660908 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:56.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {657, 685, 6}
[aiter INFO] 2025-10-23 03:34:56.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.6010000000005675
[aiter INFO] 2025-10-23 03:34:56.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.639000000000124
[aiter INFO] 2025-10-23 03:34:56.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.758999999999986
[aiter INFO] 2025-10-23 03:34:56.495 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 98.0            0.0            592.5        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:56.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   220.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:56.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 172.2603756012303 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:56.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:34:56.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.559000000000026
[aiter INFO] 2025-10-23 03:34:56.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.238999999999976
[aiter INFO] 2025-10-23 03:34:56.883 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          4,768.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             48.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:56.910 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.50046568164731 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:56.950 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {608, 6}
[aiter INFO] 2025-10-23 03:34:56.950 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.59900000000016
[aiter INFO] 2025-10-23 03:34:56.950 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.399000000000001
[aiter INFO] 2025-10-23 03:34:56.962 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            599.3        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    54.22 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_2tg_4w.co GetFunction: _ZN5aiter32pa_bf16_pertokenFp8_gqa16_2tg_4wE Success
[aiter INFO] 2025-10-23 03:34:56.997 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 51.5740000006586 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:57.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {27, 12, 4, 36}
[aiter INFO] 2025-10-23 03:34:57.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.59899999999999
[aiter INFO] 2025-10-23 03:34:57.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.278999999999996
[aiter INFO] 2025-10-23 03:34:57.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.399
[aiter INFO] 2025-10-23 03:34:57.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.92100000000005
[aiter INFO] 2025-10-23 03:34:57.036 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  97.0            0.0          3,509.6        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        3,618.4              0.0         CPU       242313
[avg us/iter]                                      NaN   NaN           36.2             36.2         NaN          NaN
[aiter INFO] 2025-10-23 03:34:57.037 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:57.060 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.48322785254751 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:57.119 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 16, 20, 27, 31}
[aiter INFO] 2025-10-23 03:34:57.119 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:34:57.119 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.15900000000002
[aiter INFO] 2025-10-23 03:34:57.119 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.7590000000000146
[aiter INFO] 2025-10-23 03:34:57.120 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.84100000000001
[aiter INFO] 2025-10-23 03:34:57.120 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.039000000000044
[aiter INFO] 2025-10-23 03:34:57.120 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.198999999999955
[aiter INFO] 2025-10-23 03:34:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            682.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          4,578.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,371.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           53.7             53.7         NaN          NaN
[aiter INFO] 2025-10-23 03:34:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    53.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:57.142 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:57.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.52016812976046 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17, 53, 86, 61, 94}
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.07899999999998
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.798999999999978
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.87900000000002
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.91899999999998
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.961000000000013
[aiter INFO] 2025-10-23 03:34:57.280 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.841000000000008
[aiter INFO] 2025-10-23 03:34:57.299 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,054.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0          8,312.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,562.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           95.6             95.6         NaN          NaN
[aiter INFO] 2025-10-23 03:34:57.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    95.58 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:58.179 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 406.1819497901614 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {384, 1281, 1313, 1258, 1259, 1291, 12, 1078, 1303, 410, 731}
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.24100000000044
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.3209999999999
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.31900000000314
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.39900000000125
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.35899999999856
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.15899999999965
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 296.84099999999995
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.27900000000045
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.1210000000028
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.19900000000007
[aiter INFO] 2025-10-23 03:34:58.254 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.16100000000006
[aiter INFO] 2025-10-23 03:34:58.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 90.0            0.0         26,506.8        CUDA            5
[avg us/iter]               NaN  NaN            0.0            294.5         NaN          NaN
[aiter INFO] 2025-10-23 03:34:58.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.76973273199384 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:58.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:58.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.238999999999976
[aiter INFO] 2025-10-23 03:34:58.459 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            800.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:58.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   302.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:58.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 186.37048519483886 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:58.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {90, 12, 610, 935}
[aiter INFO] 2025-10-23 03:34:58.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.31900000000007
[aiter INFO] 2025-10-23 03:34:58.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.959
[aiter INFO] 2025-10-23 03:34:58.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.23900000000049
[aiter INFO] 2025-10-23 03:34:58.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.47900000000118
[aiter INFO] 2025-10-23 03:34:58.905 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          6,415.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             66.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:58.933 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.5392278497762 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:58.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:58.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.318999999999988
[aiter INFO] 2025-10-23 03:34:58.984 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            799.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:58.985 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    74.14 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1.co GetFunction: _ZN5aiter41pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1E Success
[aiter INFO] 2025-10-23 03:34:59.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.39988164677477 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 43, 16, 505, 29}
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.719
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.35899999999998
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.15899999999999
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.998999999999796
[aiter INFO] 2025-10-23 03:34:59.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.161
[aiter INFO] 2025-10-23 03:34:59.067 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  96.0            0.0          5,991.8        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        6,241.4              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN           62.4             62.4         NaN          NaN
[aiter INFO] 2025-10-23 03:34:59.068 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:59.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 185.6449705244291 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {291, 1094, 9, 301, 18, 20, 28, 1085}
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.07900000000018
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000001397
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.119
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.119000000000142
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999999
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.19900000000001
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000021
[aiter INFO] 2025-10-23 03:34:59.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.07900000000154
[aiter INFO] 2025-10-23 03:34:59.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,058.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          8,862.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,230.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          102.3            102.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:59.181 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   102.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:59.186 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:34:59.279 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.63241467263438 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {777, 714, 9, 142, 19, 792, 154, 701}
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.4409999999998
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000487
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.44100000000003
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.11900000000014
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.959000000000003
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999287
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:34:59.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.63900000000012
[aiter INFO] 2025-10-23 03:34:59.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,404.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         12,596.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,435.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          144.4            144.3         NaN          NaN
[aiter INFO] 2025-10-23 03:34:59.355 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   144.33 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:59.783 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.07626692257304 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.838 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 493, 77, 909, 753}
[aiter INFO] 2025-10-23 03:34:59.838 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.87900000000002
[aiter INFO] 2025-10-23 03:34:59.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.95899999999983
[aiter INFO] 2025-10-23 03:34:59.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.95900000000006
[aiter INFO] 2025-10-23 03:34:59.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.47900000000118
[aiter INFO] 2025-10-23 03:34:59.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.95899999999983
[aiter INFO] 2025-10-23 03:34:59.851 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0          6,439.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             67.1         NaN          NaN
[aiter INFO] 2025-10-23 03:34:59.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.96616835493853 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:34:59.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.959000000000003
[aiter INFO] 2025-10-23 03:34:59.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            903.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.0         NaN          NaN
[aiter INFO] 2025-10-23 03:34:59.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    76.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:34:59.964 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.77055457795021 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:34:59.994 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 21}
[aiter INFO] 2025-10-23 03:34:59.994 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.91899999999998
[aiter INFO] 2025-10-23 03:34:59.994 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.001
[aiter INFO] 2025-10-23 03:35:00.010 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  99.0            0.0          8,925.0        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        9,014.0              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN           90.1             90.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:00.010 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    90.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:00.046 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 220.69577194086395 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:00.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 36, 21, 22}
[aiter INFO] 2025-10-23 03:35:00.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.519
[aiter INFO] 2025-10-23 03:35:00.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.478999999999985
[aiter INFO] 2025-10-23 03:35:00.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.439000000000021
[aiter INFO] 2025-10-23 03:35:00.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.59900000000005
[aiter INFO] 2025-10-23 03:35:00.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,428.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         12,128.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,695.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          137.0            136.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:00.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   136.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:00.136 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:00.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 254.7085546325929 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:00.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 170, 26, 157}
[aiter INFO] 2025-10-23 03:35:00.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.439
[aiter INFO] 2025-10-23 03:35:00.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.399000000000115
[aiter INFO] 2025-10-23 03:35:00.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-10-23 03:35:00.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 161.28099999999995
[aiter INFO] 2025-10-23 03:35:00.435 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,785.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,846.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,811.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          178.1            178.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:00.436 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   178.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:00.964 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.98568343526065 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1013, 12, 77, 727}
[aiter INFO] 2025-10-23 03:35:01.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.79900000000089
[aiter INFO] 2025-10-23 03:35:01.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.75899999999999
[aiter INFO] 2025-10-23 03:35:01.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.63900000000001
[aiter INFO] 2025-10-23 03:35:01.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.5590000000002
[aiter INFO] 2025-10-23 03:35:01.034 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          9,665.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             99.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.063 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.67508943895302 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {104, 97, 90, 6}
[aiter INFO] 2025-10-23 03:35:01.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999915
[aiter INFO] 2025-10-23 03:35:01.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999955
[aiter INFO] 2025-10-23 03:35:01.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999915
[aiter INFO] 2025-10-23 03:35:01.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.279000000000025
[aiter INFO] 2025-10-23 03:35:01.105 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 97.0            0.0          1,060.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             10.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.106 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   110.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:01.157 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.3755057046909 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.190 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 4, 477}
[aiter INFO] 2025-10-23 03:35:01.190 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.279
[aiter INFO] 2025-10-23 03:35:01.190 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 119.87899999999999
[aiter INFO] 2025-10-23 03:35:01.190 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.35900000000038
[aiter INFO] 2025-10-23 03:35:01.206 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0         11,544.7        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       11,779.4              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          117.8            117.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.206 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   117.80 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:01.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 738.6741266392245 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.418 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {960, 961, 66, 964, 965, 1030, 1031, 9, 976, 977, 1020, 1021, 1086, 1087}
[aiter INFO] 2025-10-23 03:35:01.418 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.2389999999978
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.319000000003143
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.438999999999965
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 643.7590000000018
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.318999999999505
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 643.8389999999999
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.479000000006636
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.563
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.8809999999976
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.27900000000227
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 643.6809999999969
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.199000000000524
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.359000000004
[aiter INFO] 2025-10-23 03:35:01.419 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.59900000000198
[aiter INFO] 2025-10-23 03:35:01.438 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0          1,719.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  94.0            0.0         59,776.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,459.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          654.6            654.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.439 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   654.21 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:01.451 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:01.564 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 164.25168322454584 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1030, 1033, 9, 17, 1044, 1048, 1058, 1060, 1070, 1071, 1081, 1082, 1093, 1095, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 86, 1110, 1111, 96, 1020}
[aiter INFO] 2025-10-23 03:35:01.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999069
[aiter INFO] 2025-10-23 03:35:01.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.80099999999948
[aiter INFO] 2025-10-23 03:35:01.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.59899999999993
[aiter INFO] 2025-10-23 03:35:01.619 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.03900000000067
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.55899999999929
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.15899999999965
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.67900000000009
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.798999999999069
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.67900000000009
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.918999999999869
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.79900000000089
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.5590000000011
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.078999999999724
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.95899999999892
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.998999999999796
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.9989999999998
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.918999999999869
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.48099999999977
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.759000000000015
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.19900000000052
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.679000000000087
[aiter INFO] 2025-10-23 03:35:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.15900000000147
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.03899999999885
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.20100000000093
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.799000000000888
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 90.16100000000006
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.91899999999987
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.359000000000378
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.719000000000051
[aiter INFO] 2025-10-23 03:35:01.621 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.87900000000081
[aiter INFO] 2025-10-23 03:35:01.640 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  85.0            0.0            873.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  85.0            0.0          7,878.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,431.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          104.3            103.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.640 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   102.97 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.001662510447204113

NaN info:
{}
out_ref_md5=1a8b2eac773cea76267e29f8cfa9dfe8
triton_fp8_output_md5=4fd44610074537b77f0eb00d2a14427e
diff.abs.max=0.001220703125
max_diff_thr=0.001210214220918715

NaN info:
{}
out_ref_md5=1a8b2eac773cea76267e29f8cfa9dfe8
gluon_fp8_output_md5=9dc35ed1b5d5f9086fa469c2afb6cdd4
diff.abs.max=0.0003662109375
max_diff_thr=0.0003637686313595623

NaN info:
{}
diff.abs.max=0.00360107421875
max_diff_thr=0.003562371712177992

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017923287814483047

NaN info:
{}
out_ref_md5=1823acf55313993aad6d1f91e73dbffc
triton_fp8_output_md5=630dbfce7830b6e6123a023ea6205a9d
diff.abs.max=0.001220703125
max_diff_thr=0.0012035142863169312

NaN info:
{}
out_ref_md5=1823acf55313993aad6d1f91e73dbffc
gluon_fp8_output_md5=1077bdc0e2199e1c03aa9f8d15ac5d67
diff.abs.max=0.001220703125
max_diff_thr=0.0012192705180495977

NaN info:
{}
diff.abs.max=0.003082275390625
max_diff_thr=0.003073739353567362

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.0012161751510575414

NaN info:
{}
out_ref_md5=c02a9323583b8855cec71d57043ca729
gluon_fp8_output_md5=109a04abece728acbc7c97db805d824e
diff.abs.max=0.00311279296875
max_diff_thr=0.003060489660128951

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.0012022843584418297

NaN info:
{}
out_ref_md5=64e528d0980985f6006165b6fdaa2d01
gluon_fp8_output_md5=1cb05ddc18ba2f1558afb70e3f16be84
diff.abs.max=0.0011749267578125
max_diff_thr=0.0011701061157509685

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0030882887076586485

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.00189208984375
max_diff_thr=0.0018644373631104827

NaN info:
{}
out_ref_md5=d37b1fca4e41576d51d2ec182433d8c2
triton_fp8_output_md5=fc78c1eeb80540ea09a90c3ea4504fd7
diff.abs.max=0.0010986328125
max_diff_thr=0.001092232996597886

NaN info:
{}
out_ref_md5=d37b1fca4e41576d51d2ec182433d8c2
gluon_fp8_output_md5=1d081b8c7507bcf761d088839efa5dba
diff.abs.max=0.00048828125
max_diff_thr=0.00047303689643740654

NaN info:
{}
diff.abs.max=0.00295257568359375
max_diff_thr=0.002948503941297531

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016912297578528523

NaN info:
{}
out_ref_md5=450ea234a1c9057b042a4ee6d8b66517
triton_fp8_output_md5=f30c74873d643b75d806e19515d37153
diff.abs.max=0.001247406005859375
max_diff_thr=0.0012471823720261455

NaN info:
{}
out_ref_md5=450ea234a1c9057b042a4ee6d8b66517
gluon_fp8_output_md5=85c5763f642333cc6ad35704580aa0d6
diff.abs.max=0.001232147216796875
max_diff_thr=0.0012314378982409835

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0031293253414332867

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001190185546875
max_diff_thr=0.00118533824570477

NaN info:
{}
out_ref_md5=e22dd14a46d06d4bab9ab4dd40236f59
gluon_fp8_output_md5=a076ac3a55cea57d30f781e49eb6d33d
diff.abs.max=0.0035400390625
max_diff_thr=0.0034597949124872684

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.0012072920799255371

NaN info:
{}
out_ref_md5=4783c07286319c03d1a49c25238ceab3
gluon_fp8_output_md5=d7ec956d3e1b43ea994711117041ced6
diff.abs.max=0.001190185546875
max_diff_thr=0.0011881730752065778

NaN info:
{}
diff.abs.max=0.0034360885620117188
max_diff_thr=0.003423551097512245

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016901068156585097

NaN info:
{}
out_ref_md5=d0996160e4ca81eb20673f9d4265e9d3
triton_fp8_output_md5=4206df5fab9b2a8d78db3f56ea546377
diff.abs.max=0.001129150390625
max_diff_thr=0.0011224024929106236

NaN info:
{}
out_ref_md5=d0996160e4ca81eb20673f9d4265e9d3
gluon_fp8_output_md5=5e85d2414de201a1ed76c0ed28d1031e
diff.abs.max=0.0010986328125
max_diff_thr=0.0010920673375949264

NaN info:
{}
diff.abs.max=0.00299072265625
max_diff_thr=0.0029653836973011494

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0018028846243396401

NaN info:
{}
out_ref_md5=0e3c197c69735d483900380c4307db08
triton_fp8_output_md5=b05164b0ea01e24fe944227f53a12bb8
diff.abs.max=0.00115966796875
max_diff_thr=0.0011569669004529715

NaN info:
{}
out_ref_md5=0e3c197c69735d483900380c4307db08
gluon_fp8_output_md5=68c060f635dddb67af03400c84fde5e4
diff.abs.max=0.0011749267578125
max_diff_thr=0.00117099576164037

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.003218362806364894

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.0012627021642401814

NaN info:
{}
out_ref_md5=3d3c73b44b3bc788203d1251ba49c3fa
gluon_fp8_output_md5=caeb832ce389445a8d466da9f16237b1
diff.abs.max=0.001190185546875
max_diff_thr=0.0011823555687442422

NaN info:
{}
diff.abs.max=0.00307464599609375
max_diff_thr=0.003069377038627863

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.0012614127481356263

NaN info:
{}
out_ref_md5=df0ecacdd2047519af1c750654fbacb2
gluon_fp8_output_md5=738b9b5ff9aa2f77717c394643b2dc67
diff.abs.max=0.001373291015625
max_diff_thr=0.0013623153790831566

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.0030030030757188797

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])[aiter INFO] 2025-10-23 03:35:01.812 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 447.41454307395634 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.889 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1108, 12, 1303}
[aiter INFO] 2025-10-23 03:35:01.889 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 346.6810000000005
[aiter INFO] 2025-10-23 03:35:01.889 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 352.279
[aiter INFO] 2025-10-23 03:35:01.889 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 346.51900000000023
[aiter INFO] 2025-10-23 03:35:01.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         34,105.0        CUDA            5
[avg us/iter]               NaN  NaN            0.0            348.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.927 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.72302975926068 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:01.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:01.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000017
[aiter INFO] 2025-10-23 03:35:01.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            735.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:01.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   355.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:02.018 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.58086242770204 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {51, 12}
[aiter INFO] 2025-10-23 03:35:02.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.519
[aiter INFO] 2025-10-23 03:35:02.070 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.679
[aiter INFO] 2025-10-23 03:35:02.083 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          7,273.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             73.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.108 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.88380204096879 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.142 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:02.142 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.35899999999998
[aiter INFO] 2025-10-23 03:35:02.154 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            734.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.155 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    80.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:02.191 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.72896096021822 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 30}
[aiter INFO] 2025-10-23 03:35:02.219 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.001
[aiter INFO] 2025-10-23 03:35:02.219 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.799000000000035
[aiter INFO] 2025-10-23 03:35:02.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  99.0            0.0          6,126.1        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        6,189.9              0.0         CPU       242313
[avg us/iter]                                      NaN   NaN           61.9             61.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.235 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    61.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:02.261 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 160.5419404435866 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {259, 9, 779, 17, 787, 20, 284, 28, 163, 292, 42, 171, 50, 306, 314, 977, 985, 493, 501, 251}
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.239000000000033
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.03900000000002
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.79899999999998
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.5989999999999895
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.15899999999965
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 72.20100000000002
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.92100000000028
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.399000000000001
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.519
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.119000000000142
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.55899999999997
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.479000000000042
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.038999999999987
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.47900000000027
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.83899999999994
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.119000000000597
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.5590000000002
[aiter INFO] 2025-10-23 03:35:02.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-10-23 03:35:02.320 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.721
[aiter INFO] 2025-10-23 03:35:02.338 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  91.0            0.0            850.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  91.0            0.0          6,433.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,996.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           80.0             80.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.339 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    80.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:02.344 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:02.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.03675314695528 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {387, 9, 372, 21, 1078, 1079}
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.47900000000027
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.07899999999998
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 131.71900000000005
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.998999999999967
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.91899999999987
[aiter INFO] 2025-10-23 03:35:02.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59900000000016
[aiter INFO] 2025-10-23 03:35:02.660 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,527.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         12,779.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,598.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          146.0            146.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   145.99 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:02.850 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 581.4042592992878 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:02.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1273, 12}
[aiter INFO] 2025-10-23 03:35:02.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 480.16300000000047
[aiter INFO] 2025-10-23 03:35:02.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 483.241
[aiter INFO] 2025-10-23 03:35:02.953 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         47,332.3        CUDA            5
[avg us/iter]               NaN  NaN            0.0            478.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:02.980 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.42359380202718 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.009 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:03.009 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.758999999999986
[aiter INFO] 2025-10-23 03:35:03.021 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            995.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             10.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.022 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   488.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:03.078 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 223.2771686988302 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {896, 1221, 12, 688, 467, 181, 857}
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.76100000000042
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.1989999999987
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.679
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.91899999999987
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.75900000000001
[aiter INFO] 2025-10-23 03:35:03.132 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.07899999999995
[aiter INFO] 2025-10-23 03:35:03.133 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.79899999999907
[aiter INFO] 2025-10-23 03:35:03.145 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 94.0            0.0          9,598.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            102.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.171 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.79349535880702 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.205 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:03.205 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.998999999999995
[aiter INFO] 2025-10-23 03:35:03.217 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            990.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   112.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:03.262 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.89709856604586 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {26, 451, 4, 445}
[aiter INFO] 2025-10-23 03:35:03.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.35899999999998
[aiter INFO] 2025-10-23 03:35:03.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.07900000000063
[aiter INFO] 2025-10-23 03:35:03.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.11900000000003
[aiter INFO] 2025-10-23 03:35:03.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.11899999999969
[aiter INFO] 2025-10-23 03:35:03.313 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0         11,895.3        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       12,261.9              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          122.6            122.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.314 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   122.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:03.352 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 242.47963416694415 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 9, 21, 37}
[aiter INFO] 2025-10-23 03:35:03.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.35899999999992
[aiter INFO] 2025-10-23 03:35:03.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.31900000000002
[aiter INFO] 2025-10-23 03:35:03.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.998999999999967
[aiter INFO] 2025-10-23 03:35:03.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000005
[aiter INFO] 2025-10-23 03:35:03.437 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,545.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,282.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,988.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          159.9            159.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.437 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   159.87 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:03.445 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:03.574 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 304.7277334302959 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.638 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {163, 932, 998, 999, 9, 1100, 1101, 142, 912, 1010, 1011, 26}
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.07899999999995
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000233
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.5590000000011
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.398999999999432
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 206.03900000000002
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.48099999999977
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.47899999999936
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.91899999999987
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.4390000000003
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.6389999999992
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.398999999999432
[aiter INFO] 2025-10-23 03:35:03.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.999000000000024
[aiter INFO] 2025-10-23 03:35:03.658 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          2,045.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0         19,339.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,506.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          225.1            225.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   225.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:03.817 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 226.39361407497142 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {688, 818, 636, 12}
[aiter INFO] 2025-10-23 03:35:03.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.95899999999983
[aiter INFO] 2025-10-23 03:35:03.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.31900000000041
[aiter INFO] 2025-10-23 03:35:03.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.47900000000027
[aiter INFO] 2025-10-23 03:35:03.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.519
[aiter INFO] 2025-10-23 03:35:03.882 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         10,018.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            103.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.909 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.58236622574306 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 62}
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999953
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999942
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000013
[aiter INFO] 2025-10-23 03:35:03.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.998999999999967
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.278999999999996
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.838999999999999
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.7589999999999
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.719000000000051
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-10-23 03:35:03.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.638999999999896
[aiter INFO] 2025-10-23 03:35:03.951 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 89.0            0.0          1,029.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:03.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   114.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:04.010 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.20617793220106 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 40, 426, 234, 152}
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 179.55900000000003
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 176.399
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 178.279
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 178.40100000000007
[aiter INFO] 2025-10-23 03:35:04.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 178.24099999999999
[aiter INFO] 2025-10-23 03:35:04.068 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  96.0            0.0         17,043.7        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       17,755.0              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          177.5            177.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:04.069 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   177.54 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:04.119 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 299.03423756656076 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.304 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {720, 9, 26, 701}
[aiter INFO] 2025-10-23 03:35:04.304 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.15899999999965
[aiter INFO] 2025-10-23 03:35:04.304 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.321
[aiter INFO] 2025-10-23 03:35:04.305 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.038999999999987
[aiter INFO] 2025-10-23 03:35:04.305 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.63900000000012
[aiter INFO] 2025-10-23 03:35:04.324 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,132.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         19,128.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,474.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          214.7            214.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:04.325 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   214.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:04.339 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:04.476 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 362.64398192415143 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.547 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {257, 34, 9, 231}
[aiter INFO] 2025-10-23 03:35:04.548 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.31899999999996
[aiter INFO] 2025-10-23 03:35:04.548 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.07899999999995
[aiter INFO] 2025-10-23 03:35:04.548 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 254.639
[aiter INFO] 2025-10-23 03:35:04.548 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 252.1189999999997
[aiter INFO] 2025-10-23 03:35:04.567 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,714.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         25,073.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       28,066.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          280.7            280.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:04.568 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   280.68 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:04.734 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 276.90187185117514 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 396, 12, 588}
[aiter INFO] 2025-10-23 03:35:04.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.47900000000004
[aiter INFO] 2025-10-23 03:35:04.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.91899999999987
[aiter INFO] 2025-10-23 03:35:04.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.839
[aiter INFO] 2025-10-23 03:35:04.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.63900000000012
[aiter INFO] 2025-10-23 03:35:04.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         15,208.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            156.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:04.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.15470333382635 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.87900000000002
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.118999999999915
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.239000000000004
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.959000000000003
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.87899999999999
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.160999999999945
[aiter INFO] 2025-10-23 03:35:04.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.039000000000044
[aiter INFO] 2025-10-23 03:35:04.862 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.87900000000002
[aiter INFO] 2025-10-23 03:35:04.862 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.63900000000001
[aiter INFO] 2025-10-23 03:35:04.862 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.278999999999996
[aiter INFO] 2025-10-23 03:35:04.874 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,349.2        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:04.875 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   171.62 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:04.943 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.2035943482182 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:04.989 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {472, 426, 4, 53}
[aiter INFO] 2025-10-23 03:35:04.989 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 233.3610000000008
[aiter INFO] 2025-10-23 03:35:04.989 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 233.3209999999999
[aiter INFO] 2025-10-23 03:35:04.989 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.72099999999998
[aiter INFO] 2025-10-23 03:35:04.989 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 230.88100000000003
[aiter INFO] 2025-10-23 03:35:05.004 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  97.0            0.0         22,573.4        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       23,271.0              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          232.7            232.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:05.005 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   232.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:05.144 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1126.6663334157208 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:05.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 98}
[aiter INFO] 2025-10-23 03:35:05.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1020.7629999999999
[aiter INFO] 2025-10-23 03:35:05.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.71900000000005
[aiter INFO] 2025-10-23 03:35:05.315 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,735.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0        101,854.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      104,590.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,045.9          1,045.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:05.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1045.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:05.331 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:05.414 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.94421743520417 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:05.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {473, 481, 9, 14}
[aiter INFO] 2025-10-23 03:35:05.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 62.5590000000002
[aiter INFO] 2025-10-23 03:35:05.465 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.47899999999936
[aiter INFO] 2025-10-23 03:35:05.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.75899999999999
[aiter INFO] 2025-10-23 03:35:05.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000012
[aiter INFO] 2025-10-23 03:35:05.488 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            916.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          6,014.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,002.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           70.0             70.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:05.488 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    70.01 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:06.146 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 314.81767320396875 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {931, 72, 12, 1233, 50, 1300, 629, 1272}
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 201.96100000000115
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 203.92100000000005
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 206.199
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 201.83899999999994
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.44099999999992
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.2390000000014
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 201.75900000000001
[aiter INFO] 2025-10-23 03:35:06.210 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.07899999999972
[aiter INFO] 2025-10-23 03:35:06.223 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 93.0            0.0         18,863.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            202.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:06.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.06631669667688 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:06.278 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:06.278 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-10-23 03:35:06.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            687.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:06.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   209.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:06.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.8750293986632 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:06.662 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:35:06.662 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.559000000000026
[aiter INFO] 2025-10-23 03:35:06.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          4,982.2        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             49.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:06.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.9324949047353 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:06.739 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:06.739 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.918999999999983
[aiter INFO] 2025-10-23 03:35:06.751 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            678.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:06.752 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:06.786 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 50.96174282307672 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:06.809 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 4, 426, 12, 54, 27}
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.23900000000003
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.559
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 36.75899999999979
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.278999999999996
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 35.478999999999985
[aiter INFO] 2025-10-23 03:35:06.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 37.07900000000001
[aiter INFO] 2025-10-23 03:35:06.825 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  95.0            0.0          3,437.2        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        3,619.1              0.0         CPU       242313
[avg us/iter]                                      NaN   NaN           36.2             36.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:06.826 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    36.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:06.851 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.78740621085214 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:07.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:35:07.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.758999999999986
[aiter INFO] 2025-10-23 03:35:07.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.478999999999985
[aiter INFO] 2025-10-23 03:35:07.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.31899999999996
[aiter INFO] 2025-10-23 03:35:07.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.239000000000033
[aiter INFO] 2025-10-23 03:35:07.057 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            883.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          4,764.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,707.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           57.1             57.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:07.058 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    57.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:07.062 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:07.152 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 176.97642537036745 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:07.205 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:35:07.205 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.31900000000002
[aiter INFO] 2025-10-23 03:35:07.205 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.718999999999994
[aiter INFO] 2025-10-23 03:35:07.224 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,504.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          8,781.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,286.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          102.9            102.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:07.225 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   102.87 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:08.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 395.21871256356195 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:08.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 62, 983}
[aiter INFO] 2025-10-23 03:35:08.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 287.28099999999995
[aiter INFO] 2025-10-23 03:35:08.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 285.3990000000001
[aiter INFO] 2025-10-23 03:35:08.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 283.27900000000045
[aiter INFO] 2025-10-23 03:35:08.712 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         27,860.9        CUDA            5
[avg us/iter]               NaN  NaN            0.0            284.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:08.740 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.98757468237734 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:08.771 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:08.771 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000002
[aiter INFO] 2025-10-23 03:35:08.783 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            960.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:08.784 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   293.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:09.155 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 188.2956827631091 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 168, 12, 467, 792}
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.07900000000063
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.35900000000015
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.47899999999998
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.96100000000024
[aiter INFO] 2025-10-23 03:35:09.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.27900000000045
[aiter INFO] 2025-10-23 03:35:09.222 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0          6,482.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             67.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:09.248 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.65132706826276 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:09.286 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:09.286 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.721000000000004
[aiter INFO] 2025-10-23 03:35:09.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            963.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:09.299 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    77.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:09.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.21925722136355 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:09.370 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 4}
[aiter INFO] 2025-10-23 03:35:09.370 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.35900000000004
[aiter INFO] 2025-10-23 03:35:09.370 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.799
[aiter INFO] 2025-10-23 03:35:09.386 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  99.0            0.0          6,210.3        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        6,271.7              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN           62.7             62.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:09.387 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:09.422 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.95706969204514 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:09.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:35:09.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.119
[aiter INFO] 2025-10-23 03:35:09.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:35:09.504 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,515.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0          9,336.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,852.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          108.5            108.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:09.505 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   108.52 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:09.512 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:09.607 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 230.7195644272436 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:09.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20}
[aiter INFO] 2025-10-23 03:35:09.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.561
[aiter INFO] 2025-10-23 03:35:09.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.67900000000003
[aiter INFO] 2025-10-23 03:35:09.683 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,111.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         13,334.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,445.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          154.5            154.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:09.684 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   154.46 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:10.200 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.52269343928535 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:10.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1156, 12, 948, 597}
[aiter INFO] 2025-10-23 03:35:10.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.96100000000115
[aiter INFO] 2025-10-23 03:35:10.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.99900000000002
[aiter INFO] 2025-10-23 03:35:10.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.59900000000016
[aiter INFO] 2025-10-23 03:35:10.381 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.59900000000016
[aiter INFO] 2025-10-23 03:35:10.393 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          9,739.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            100.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:10.423 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.65132673837171 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:10.453 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:35:10.453 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:35:10.453 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000037
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.358999999999924
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.318999999999988
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.998999999999967
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.95900000000006
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.118999999999971
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000028
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-10-23 03:35:10.454 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.439000000000078
[aiter INFO] 2025-10-23 03:35:10.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 87.0            0.0          1,051.9        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:10.467 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   112.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:10.519 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 105.97345572296936 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:10.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {505, 4, 21}
[aiter INFO] 2025-10-23 03:35:10.555 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.96099999999933
[aiter INFO] 2025-10-23 03:35:10.555 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.439
[aiter INFO] 2025-10-23 03:35:10.555 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 88.999
[aiter INFO] 2025-10-23 03:35:10.570 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0          8,874.2        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0        9,053.2              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN           90.5             90.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:10.571 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    90.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:10.616 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 227.1860902852351 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {165, 489, 9, 19, 503, 154}
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.159000000000106
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.48099999999977
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.07900000000001
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.478999999999985
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.878999999999905
[aiter INFO] 2025-10-23 03:35:10.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.6389999999999
[aiter INFO] 2025-10-23 03:35:10.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,081.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         11,993.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,359.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          143.6            143.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:10.700 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   143.62 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:10.711 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:10.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 270.9200695009515 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:10.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1100, 1101, 25}
[aiter INFO] 2025-10-23 03:35:10.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.399
[aiter INFO] 2025-10-23 03:35:10.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.52100000000064
[aiter INFO] 2025-10-23 03:35:10.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.47899999999936
[aiter INFO] 2025-10-23 03:35:10.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.480999999999995
[aiter INFO] 2025-10-23 03:35:10.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,694.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         16,221.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,109.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          191.1            191.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:10.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   191.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:11.426 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 239.6994156412559 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:11.483 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:35:11.483 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 117.91900000000001
[aiter INFO] 2025-10-23 03:35:11.495 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         11,742.3        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            117.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:11.524 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.84933675338726 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:11.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.119000000000028
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.319000000000074
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.839
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.11899999999997
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.679000000000002
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.599000000000046
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.959000000000003
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.119000000000028
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.839
[aiter INFO] 2025-10-23 03:35:11.554 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.278999999999996
[aiter INFO] 2025-10-23 03:35:11.566 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,392.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:11.567 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   132.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:11.625 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 133.94857338159392 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:11.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {28, 4, 79}
[aiter INFO] 2025-10-23 03:35:11.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 116.67899999999997
[aiter INFO] 2025-10-23 03:35:11.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 120.07900000000004
[aiter INFO] 2025-10-23 03:35:11.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 118.839
[aiter INFO] 2025-10-23 03:35:11.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0         11,581.9        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       11,817.5              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          118.2            118.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:11.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   118.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:11.776 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 746.814753749583 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9, 1034, 1035, 819, 760}
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.678999999999974
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 636.043
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.8410000000003
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.078999999997905
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.398999999999432
[aiter INFO] 2025-10-23 03:35:11.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.5210000000006
[aiter INFO] 2025-10-23 03:35:11.910 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,672.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         62,423.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       66,432.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          664.3            664.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:11.911 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   664.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:11.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:12.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.63303940957135 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {293, 136, 9, 42, 78, 303, 17, 115, 52, 87, 125, 126}
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.39899999999989
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000142
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.83900000000003
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.67899999999997
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.519
[aiter INFO] 2025-10-23 03:35:12.091 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.119000000000142
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.119000000000028
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.67899999999986
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000065
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.31899999999996
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999842
[aiter INFO] 2025-10-23 03:35:12.092 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.99900000000002
[aiter INFO] 2025-10-23 03:35:12.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,300.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0          9,026.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,860.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          108.6            108.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   108.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:12.281 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 426.8548618448843 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1296, 1059, 12}
[aiter INFO] 2025-10-23 03:35:12.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 329.44100000000253
[aiter INFO] 2025-10-23 03:35:12.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.59900000000016
[aiter INFO] 2025-10-23 03:35:12.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 331.321
[aiter INFO] 2025-10-23 03:35:12.367 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         32,148.1        CUDA            5
[avg us/iter]               NaN  NaN            0.0            328.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.392 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.75306946747374 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.421 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:12.421 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.59899999999999
[aiter INFO] 2025-10-23 03:35:12.433 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            794.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.434 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   335.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:12.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 194.8683970045335 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.665 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 142}
[aiter INFO] 2025-10-23 03:35:12.665 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.279
[aiter INFO] 2025-10-23 03:35:12.665 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 76.71899999999982
[aiter INFO] 2025-10-23 03:35:12.677 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          7,495.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             75.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.703 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.96337612489663 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.738 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:12.738 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.959000000000003
[aiter INFO] 2025-10-23 03:35:12.750 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            797.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.751 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    83.69 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:12.789 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 76.61371272389252 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {476, 44, 4, 30}
[aiter INFO] 2025-10-23 03:35:12.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.51900000000023
[aiter INFO] 2025-10-23 03:35:12.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 63.718999999999994
[aiter INFO] 2025-10-23 03:35:12.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 67.96099999999998
[aiter INFO] 2025-10-23 03:35:12.818 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 64.15899999999999
[aiter INFO] 2025-10-23 03:35:12.834 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                  name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_2tg_4w  97.0            0.0          6,022.8        CUDA            5
1                            aiter::wrapper_pa_fwd_asm 100.0        6,214.2              0.0         CPU       242313
[avg us/iter]                                      NaN   NaN           62.1             62.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.834 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    62.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:12.862 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 166.15302949258597 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {295, 9, 303, 240, 17, 691, 20, 248, 699, 28}
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.8789999999999
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.239
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.75899999999956
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.999000000000024
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.8789999999999
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.55900000000003
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.998999999999796
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-10-23 03:35:12.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.838999999999999
[aiter INFO] 2025-10-23 03:35:12.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,221.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          6,997.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,567.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           85.7             85.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:12.942 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    85.62 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:12.947 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:13.071 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 235.27169316121848 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.128 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {807, 9, 819, 21, 1078, 1079, 1080, 1081, 1110, 1111}
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.71900000000005
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 136.839
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.47900000000027
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.319000000000017
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.83899999999994
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.639000000001033
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.59900000000016
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.559000000001106
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 133.15900000000147
[aiter INFO] 2025-10-23 03:35:13.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.15899999999965
[aiter INFO] 2025-10-23 03:35:13.148 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          2,176.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         12,873.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,673.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          156.7            156.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.149 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   156.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:13.339 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 564.3226716778066 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.427 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1264, 1288, 12}
[aiter INFO] 2025-10-23 03:35:13.428 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 458.4409999999989
[aiter INFO] 2025-10-23 03:35:13.428 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 458.4409999999989
[aiter INFO] 2025-10-23 03:35:13.428 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 464.83899999999994
[aiter INFO] 2025-10-23 03:35:13.440 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         45,060.5        CUDA            5
[avg us/iter]               NaN  NaN            0.0            459.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.467 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.20381174170144 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 48, 83, 20, 55}
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000019
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.07899999999995
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.999000000000024
[aiter INFO] 2025-10-23 03:35:13.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839000000000055
[aiter INFO] 2025-10-23 03:35:13.508 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,107.7        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.509 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   471.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:13.571 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.09142553806305 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.627 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 38}
[aiter INFO] 2025-10-23 03:35:13.627 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.55899999999997
[aiter INFO] 2025-10-23 03:35:13.627 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.31899999999996
[aiter INFO] 2025-10-23 03:35:13.640 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         10,165.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            102.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.667 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.05919807264121 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.558999999999997
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839000000000055
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.679000000000002
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599000000000046
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.878999999999962
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-10-23 03:35:13.701 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:35:13.714 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,036.7        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   114.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:13.769 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 137.49233625902988 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 356, 497, 501, 26}
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.999
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.68100000000004
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.71900000000096
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.79900000000089
[aiter INFO] 2025-10-23 03:35:13.810 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.07900000000001
[aiter INFO] 2025-10-23 03:35:13.825 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  96.0            0.0         11,798.6        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       12,290.9              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          122.9            122.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.826 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   122.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:13.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 250.4150899920133 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 1030, 1031, 73, 1094, 1095, 9, 25, 58, 27}
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.918999999999983
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.9989999999998
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.91899999999987
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.399
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.19900000000052
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.79899999999907
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.83900000000003
[aiter INFO] 2025-10-23 03:35:13.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.839
[aiter INFO] 2025-10-23 03:35:13.935 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.79899999999998
[aiter INFO] 2025-10-23 03:35:13.935 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.079
[aiter INFO] 2025-10-23 03:35:13.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          2,170.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0         14,058.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,907.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          169.1            169.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:13.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   169.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:13.968 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:14.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 320.0275945191336 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:14.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1034, 1035, 1004, 1005, 1066, 1067, 1098, 1099, 1018, 1019, 28}
[aiter INFO] 2025-10-23 03:35:14.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 212.201
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 207.6790000000001
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.959000000000742
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 207.71900000000096
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.11899999999878
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 208.0010000000002
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.879000000000815
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 207.87900000000081
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.03900000000067
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 211.3189999999995
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.15899999999965
[aiter INFO] 2025-10-23 03:35:14.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.718999999999994
[aiter INFO] 2025-10-23 03:35:14.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          3,046.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0         19,914.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,164.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          241.6            241.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:14.312 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   241.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:14.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 275.0713568512756 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:14.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 1098, 12}
[aiter INFO] 2025-10-23 03:35:14.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.27900000000005
[aiter INFO] 2025-10-23 03:35:14.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.3209999999999
[aiter INFO] 2025-10-23 03:35:14.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 158.999
[aiter INFO] 2025-10-23 03:35:14.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         15,262.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            155.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:14.580 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.46955460782098 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.999000000000024
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.119
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.119000000000028
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.87899999999999
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839000000000055
[aiter INFO] 2025-10-23 03:35:14.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.11899999999997
[aiter INFO] 2025-10-23 03:35:14.610 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.839000000000055
[aiter INFO] 2025-10-23 03:35:14.610 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.87900000000002
[aiter INFO] 2025-10-23 03:35:14.610 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.119000000000028
[aiter INFO] 2025-10-23 03:35:14.622 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,943.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:14.623 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   176.85 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:14.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 192.9974653343163 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:14.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {41, 4, 505}
[aiter INFO] 2025-10-23 03:35:14.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 176.76100000000002
[aiter INFO] 2025-10-23 03:35:14.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 180.159
[aiter INFO] 2025-10-23 03:35:14.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 177.2390000000014
[aiter INFO] 2025-10-23 03:35:14.744 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  98.0            0.0         17,446.5        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       17,800.5              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          178.0            178.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:14.744 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   178.03 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:14.802 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 309.62359433126926 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:14.870 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {293, 73, 906, 9, 274, 887, 26, 91}
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.838999999999942
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.68099999999993
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.838999999999942
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.519
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.67899999999963
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.6810000000005
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.31899999999996
[aiter INFO] 2025-10-23 03:35:14.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.95900000000006
[aiter INFO] 2025-10-23 03:35:14.890 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          3,111.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         18,781.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,567.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          225.7            225.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:14.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   225.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:14.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 16,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:15.042 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 380.6202568040036 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {36, 9, 1110, 1111, 57, 30}
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 259.001
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 259.35900000000004
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 255.6790000000001
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.2390000000014
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.79899999999998
[aiter INFO] 2025-10-23 03:35:15.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.07899999999995
[aiter INFO] 2025-10-23 03:35:15.134 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          4,072.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         25,216.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       29,886.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          298.9            298.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:15.135 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   298.87 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:15.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 302.3273469788013 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:15.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1029}
[aiter INFO] 2025-10-23 03:35:15.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 180.96100000000007
[aiter INFO] 2025-10-23 03:35:15.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.31900000000002
[aiter INFO] 2025-10-23 03:35:15.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.0010000000002
[aiter INFO] 2025-10-23 03:35:15.390 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         17,884.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            182.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:15.418 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.23433663290326 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:15.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:35:15.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.999000000000024
[aiter INFO] 2025-10-23 03:35:15.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999998
[aiter INFO] 2025-10-23 03:35:15.447 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.75899999999996
[aiter INFO] 2025-10-23 03:35:15.448 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.839
[aiter INFO] 2025-10-23 03:35:15.448 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 29.278999999999996
[aiter INFO] 2025-10-23 03:35:15.448 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.07900000000001
[aiter INFO] 2025-10-23 03:35:15.448 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.43900000000002
[aiter INFO] 2025-10-23 03:35:15.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,500.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:15.461 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   209.10 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:15.535 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.56402983169744 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {448, 417, 4, 428, 50, 502, 446}
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 233.878999999999
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.1590000000001
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 235.159
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.08100000000013
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 232.281
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.15899999999965
[aiter INFO] 2025-10-23 03:35:15.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 234.11899999999878
[aiter INFO] 2025-10-23 03:35:15.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa16_1tg_4w_mtp_msk1  94.0            0.0         21,924.6        CUDA            5
1                                     aiter::wrapper_pa_fwd_asm 100.0       23,327.3              0.0         CPU       242313
[avg us/iter]                                               NaN   NaN          233.3            233.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:15.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   233.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:15.748 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1143.6291083250896 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:15.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {968, 969, 100, 9}
[aiter INFO] 2025-10-23 03:35:15.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1029.201000000001
[aiter INFO] 2025-10-23 03:35:15.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.638999999999214
[aiter INFO] 2025-10-23 03:35:15.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.31899999999996
[aiter INFO] 2025-10-23 03:35:15.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1025.763
[aiter INFO] 2025-10-23 03:35:15.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          4,132.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0        101,302.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      106,505.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,065.1          1,065.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:15.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1065.00 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:15.943 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:16.022 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 157.30110828829282 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:16.073 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:35:16.074 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.15900000000002
[aiter INFO] 2025-10-23 03:35:16.074 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.199000000000012
[aiter INFO] 2025-10-23 03:35:16.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            486.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          7,644.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,130.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           81.3             81.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:16.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    81.31 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]

diff.abs.max=0.0018310546875
max_diff_thr=0.0017893355106934905

NaN info:
{}
out_ref_md5=07f0e6d05d3be702284ebe2ec428fbc4
triton_fp8_output_md5=2bf5daf01bed42784bcc12e55287d87f
diff.abs.max=0.001251220703125
max_diff_thr=0.0012452165829017758

NaN info:
{}
out_ref_md5=07f0e6d05d3be702284ebe2ec428fbc4
gluon_fp8_output_md5=f63715eee3acd00c749319e9ac2849d5
diff.abs.max=0.0011692047119140625
max_diff_thr=0.0011682109907269478

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003161478554829955

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017927573062479496

NaN info:
{}
out_ref_md5=46c54f3d991ba6928c6a79d43c8767e3
triton_fp8_output_md5=a1cb8dbdd394010ce7cf5d95e9d859e6
diff.abs.max=0.00122833251953125
max_diff_thr=0.0012245767284184694

NaN info:
{}
out_ref_md5=46c54f3d991ba6928c6a79d43c8767e3
gluon_fp8_output_md5=b843119258df933de3143a4914ea60bf
diff.abs.max=0.001220703125
max_diff_thr=0.0012089705560356379

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0031989377457648516

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.001208824454806745

NaN info:
{}
out_ref_md5=a6acb2c11b966d97b36d8000ebce1fa6
gluon_fp8_output_md5=3af4e8a4b0c105b24e13f3903f2fbde6
diff.abs.max=0.00128173828125
max_diff_thr=0.0012698796344920993

NaN info:
{}
diff.abs.max=0.00341796875
max_diff_thr=0.003409696277230978

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.0012053275713697076

NaN info:
{}
out_ref_md5=e87bafe04e20bf4aa76468241c6c787e
gluon_fp8_output_md5=2184032b602f63393c5013b878bd0396
diff.abs.max=0.001220703125
max_diff_thr=0.0012152882991358638

NaN info:
{}
diff.abs.max=0.0032806396484375
max_diff_thr=0.003270708257332444

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.001811484806239605

NaN info:
{}
out_ref_md5=2dd3136b0b0e835ac58c3d620e06f550
triton_fp8_output_md5=639fee20dc5ce973e2ba6e20977d6af0
diff.abs.max=0.00115966796875
max_diff_thr=0.001150051481090486

NaN info:
{}
out_ref_md5=2dd3136b0b0e835ac58c3d620e06f550
gluon_fp8_output_md5=3749206dd475a48258b8a2692654f8bd
diff.abs.max=0.001220703125
max_diff_thr=0.0012017786502838135

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003146176226437092

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.00189208984375
max_diff_thr=0.0018651103600859642

NaN info:
{}
out_ref_md5=3d8fcfa458b7222e8ee55df270a2da5d
triton_fp8_output_md5=9beb2756c4b4853def846cbeb8be1fc9
diff.abs.max=0.00128173828125
max_diff_thr=0.0012612612918019295

NaN info:
{}
out_ref_md5=3d8fcfa458b7222e8ee55df270a2da5d
gluon_fp8_output_md5=4491b71b1d67c06e41bbb4dd8dfc6329
diff.abs.max=0.00118255615234375
max_diff_thr=0.001181888859719038

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.0030033637303858995

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.00122833251953125
max_diff_thr=0.0012263957178220153

NaN info:
{}
out_ref_md5=4a02aef43d1df5161833ee1e3d2e3547
gluon_fp8_output_md5=394d584119e1b75059265026f48ec249
diff.abs.max=0.0013427734375
max_diff_thr=0.001327300094999373

NaN info:
{}
diff.abs.max=0.003570556640625
max_diff_thr=0.003541590878739953

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([81920, 1, 1, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.0012755101779475808

NaN info:
{}
out_ref_md5=eb337bdc9b4f190c19f4d6228a2d8000
gluon_fp8_output_md5=84467fba69750daae65166e9c0f24e8d
diff.abs.max=0.00128173828125
max_diff_thr=0.0012701868545264006

NaN info:
{}
diff.abs.max=0.00319671630859375
max_diff_thr=0.003190630581229925

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017461464740335941

NaN info:
{}
out_ref_md5=72089833722c4f5604e2994d7d0a7e2e
triton_fp8_output_md5=7911976be69d9f79d5470261252bcefa
diff.abs.max=0.0013275146484375
max_diff_thr=0.0013242614222690463

NaN info:
{}
out_ref_md5=72089833722c4f5604e2994d7d0a7e2e
gluon_fp8_output_md5=4af9d9389a108479c649e2c1503273e2
diff.abs.max=0.001220703125
max_diff_thr=0.0011974613880738616

NaN info:
{}
diff.abs.max=0.0029296875
max_diff_thr=0.002916248980909586

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0018002880970016122

NaN info:
{}
out_ref_md5=2801e440bd4d856aaf272b3ffac4213a
triton_fp8_output_md5=2fc880ce2f75daa3ce8ae54614b42edd
diff.abs.max=0.0013885498046875
max_diff_thr=0.001386054209433496

NaN info:
{}
out_ref_md5=2801e440bd4d856aaf272b3ffac4213a
gluon_fp8_output_md5=495e770677e3845387e266484acc15c6
diff.abs.max=0.00128173828125
max_diff_thr=0.0012620192719623446

NaN info:
{}
diff.abs.max=0.00304412841796875
max_diff_thr=0.00303930533118546

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001239776611328125
max_diff_thr=0.0012372280471026897

NaN info:
{}
out_ref_md5=d12e129d0029be294d8d7d239bf4db94
gluon_fp8_output_md5=9c14524f46df63355b3da6600f18e0ed
diff.abs.max=0.001434326171875
max_diff_thr=0.0014275733847171068

NaN info:
{}
diff.abs.max=0.00347900390625
max_diff_thr=0.003450363175943494

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([131072, 1, 1, 128, 16])
diff.abs.max=0.001338958740234375
max_diff_thr=0.001336816931143403

NaN info:
{}
out_ref_md5=ddd81e6922686362124169962e381212
gluon_fp8_output_md5=cce1ef621b3db895b9a80b1711e1fafb
diff.abs.max=0.00136566162109375
max_diff_thr=0.0013649119064211845

NaN info:
{}
diff.abs.max=0.004150390625
max_diff_thr=0.004129471257328987

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])[aiter INFO] 2025-10-23 03:35:16.741 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 310.813307762146 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:16.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {50, 12, 1045}
[aiter INFO] 2025-10-23 03:35:16.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 199.519
[aiter INFO] 2025-10-23 03:35:16.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 235.959
[aiter INFO] 2025-10-23 03:35:16.805 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.76100000000042
[aiter INFO] 2025-10-23 03:35:16.817 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 98.0            0.0         19,400.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            198.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:16.842 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.95226763498664 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:16.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {643, 293, 6, 125, 573}
[aiter INFO] 2025-10-23 03:35:16.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.399000000000342
[aiter INFO] 2025-10-23 03:35:16.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.398999999999887
[aiter INFO] 2025-10-23 03:35:16.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:35:16.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.1189999999999145
[aiter INFO] 2025-10-23 03:35:16.873 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.359000000000378
[aiter INFO] 2025-10-23 03:35:16.885 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            552.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:16.885 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   203.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:17.361 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.59738594706698 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 12, 688, 51, 25}
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.59899999999993
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.87900000000002
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.07899999999972
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.198999999999955
[aiter INFO] 2025-10-23 03:35:17.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.27900000000005
[aiter INFO] 2025-10-23 03:35:17.427 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 96.0            0.0          4,877.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             50.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:17.453 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.403791894417 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:17.494 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:17.494 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.799000000000007
[aiter INFO] 2025-10-23 03:35:17.506 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            576.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:17.507 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.57 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:17.511 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_e0d29996b946383d2bf8f091027c36a0' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_e0d29996b946383d2bf8f091027c36a0', 'folder': 'pa_e0d29996b946383d2bf8f091027c36a0', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_e0d29996b946383d2bf8f091027c36a0(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:35:17.511 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include -c pa_e0d29996b946383d2bf8f091027c36a0.cpp -o pa_e0d29996b946383d2bf8f091027c36a0.o
In file included from pa_e0d29996b946383d2bf8f091027c36a0.cpp:1:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_e0d29996b946383d2bf8f091027c36a0.cpp:1:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/quant_utils.cuh:19:
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_e0d29996b946383d2bf8f091027c36a0.o -o lib.so
[aiter INFO] 2025-10-23 03:35:40.575 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_e0d29996b946383d2bf8f091027c36a0, cost 23.06433955s
[aiter INFO] 2025-10-23 03:35:40.616 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 136.47730678024857 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 9, 16, 20, 27, 31}
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.8390000000000555
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.47900000000004
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.07899999999995
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 4.7590000000000146
[aiter INFO] 2025-10-23 03:35:40.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.519000000000005
[aiter INFO] 2025-10-23 03:35:40.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            479.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          4,678.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,266.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           52.7             52.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:40.692 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    52.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:40.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:40.763 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 183.17808904270134 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:40.828 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {705, 1090, 421, 648, 41, 906, 9, 364, 431, 658, 754, 916, 19, 374, 695, 1080, 764, 31}
[aiter INFO] 2025-10-23 03:35:40.828 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000378
[aiter INFO] 2025-10-23 03:35:40.828 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.558999999999287
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.63899999999967
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.8789999999999
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.478999999999928
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.03900000000067
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 102.07900000000004
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.95899999999983
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.639000000000124
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.559000000000196
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.27900000000045
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.318999999999505
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000017
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.239000000000033
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.07899999999972
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.1190000000006
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999925
[aiter INFO] 2025-10-23 03:35:40.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.40100000000007
[aiter INFO] 2025-10-23 03:35:40.848 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            791.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  92.0            0.0          8,937.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,592.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          105.9            105.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:40.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   105.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:41.760 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 396.81875233603 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:41.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 62}
[aiter INFO] 2025-10-23 03:35:41.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 286.39899999999994
[aiter INFO] 2025-10-23 03:35:41.829 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 284.44100000000003
[aiter INFO] 2025-10-23 03:35:41.840 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         28,043.9        CUDA            5
[avg us/iter]               NaN  NaN            0.0            283.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:41.867 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.64650510207261 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:41.903 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:41.903 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.998999999999995
[aiter INFO] 2025-10-23 03:35:41.916 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            685.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:41.917 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   290.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:42.258 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.94509878961168 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:42.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 129, 12}
[aiter INFO] 2025-10-23 03:35:42.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 55.19900000000001
[aiter INFO] 2025-10-23 03:35:42.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.638999999999896
[aiter INFO] 2025-10-23 03:35:42.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.239000000000004
[aiter INFO] 2025-10-23 03:35:42.323 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          5,209.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             53.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:42.349 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.56937610158826 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:42.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:42.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.7590000000000146
[aiter INFO] 2025-10-23 03:35:42.401 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            680.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:42.402 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    59.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:42.407 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_76bd34544d103f6c86f2143e0163a4f6' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_76bd34544d103f6c86f2143e0163a4f6', 'folder': 'pa_76bd34544d103f6c86f2143e0163a4f6', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_76bd34544d103f6c86f2143e0163a4f6(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:35:42.407 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include -c pa_76bd34544d103f6c86f2143e0163a4f6.cpp -o pa_76bd34544d103f6c86f2143e0163a4f6.o
In file included from pa_76bd34544d103f6c86f2143e0163a4f6.cpp:1:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_76bd34544d103f6c86f2143e0163a4f6.cpp:1:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/quant_utils.cuh:19:
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_76bd34544d103f6c86f2143e0163a4f6.o -o lib.so
[aiter INFO] 2025-10-23 03:35:45.584 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_76bd34544d103f6c86f2143e0163a4f6, cost 3.17657050s
[aiter INFO] 2025-10-23 03:35:45.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 185.1123069772626 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {40, 9, 17, 20, 53, 28, 62, 31}
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.27900000000011
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.91899999999998
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999962
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.959
[aiter INFO] 2025-10-23 03:35:45.685 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.23900000000003
[aiter INFO] 2025-10-23 03:35:45.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.878999999999962
[aiter INFO] 2025-10-23 03:35:45.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.399000000000001
[aiter INFO] 2025-10-23 03:35:45.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.08100000000002
[aiter INFO] 2025-10-23 03:35:45.705 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            872.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          8,907.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,089.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          100.9            100.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:45.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   100.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:45.711 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:45.785 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 228.64392075208153 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:45.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 25}
[aiter INFO] 2025-10-23 03:35:45.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 142.599
[aiter INFO] 2025-10-23 03:35:45.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.119000000000028
[aiter INFO] 2025-10-23 03:35:46.001 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,170.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         13,804.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,975.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          149.8            149.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:46.002 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   149.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:46.472 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 208.8021879444028 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {935, 1260, 12, 974, 25, 987}
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.31900000000132
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.35900000000038
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.47899999999998
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.3189999999995
[aiter INFO] 2025-10-23 03:35:46.526 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.63900000000001
[aiter INFO] 2025-10-23 03:35:46.527 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.32099999999991
[aiter INFO] 2025-10-23 03:35:46.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 95.0            0.0          8,887.8        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             93.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:46.564 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.67547587533988 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:46.600 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:46.600 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.919000000000011
[aiter INFO] 2025-10-23 03:35:46.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            841.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:46.614 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   101.97 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:46.622 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_d7a35fc9b9ef4b6577283ce053766582' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_d7a35fc9b9ef4b6577283ce053766582', 'folder': 'pa_d7a35fc9b9ef4b6577283ce053766582', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_d7a35fc9b9ef4b6577283ce053766582(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:35:46.623 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include -c pa_d7a35fc9b9ef4b6577283ce053766582.cpp -o pa_d7a35fc9b9ef4b6577283ce053766582.o
In file included from pa_d7a35fc9b9ef4b6577283ce053766582.cpp:1:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_d7a35fc9b9ef4b6577283ce053766582.cpp:1:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_d7a35fc9b9ef4b6577283ce053766582.o -o lib.so
[aiter INFO] 2025-10-23 03:35:49.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_d7a35fc9b9ef4b6577283ce053766582, cost 3.21591788s
[aiter INFO] 2025-10-23 03:35:49.888 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 219.6656834371019 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:49.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 18}
[aiter INFO] 2025-10-23 03:35:49.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.55899999999997
[aiter INFO] 2025-10-23 03:35:49.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.438999999999965
[aiter INFO] 2025-10-23 03:35:49.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,208.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,093.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,301.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          133.0            133.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:49.973 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   133.01 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:49.981 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:50.062 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.86024992064677 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:50.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 429, 25, 443, 1022, 1023}
[aiter INFO] 2025-10-23 03:35:50.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.71899999999997
[aiter INFO] 2025-10-23 03:35:50.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.1189999999997
[aiter INFO] 2025-10-23 03:35:50.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:35:50.138 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.358999999999469
[aiter INFO] 2025-10-23 03:35:50.138 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.52100000000064
[aiter INFO] 2025-10-23 03:35:50.138 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.718999999999141
[aiter INFO] 2025-10-23 03:35:50.157 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,461.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         15,968.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,790.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          177.9            177.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:50.157 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   177.85 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:50.634 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 216.16744523001188 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:50.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:35:50.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 99.31900000000002
[aiter INFO] 2025-10-23 03:35:50.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.719
[aiter INFO] 2025-10-23 03:35:50.699 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0          9,459.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             95.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:50.726 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.72299047153776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:50.763 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:50.763 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.239000000000004
[aiter INFO] 2025-10-23 03:35:50.776 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            982.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:50.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   105.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:50.789 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_ea3e81ff08bbdabf04c7342b89f3038d' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_ea3e81ff08bbdabf04c7342b89f3038d', 'folder': 'pa_ea3e81ff08bbdabf04c7342b89f3038d', 'kwargs': OrderedDict({'gqa_ratio': 8, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_ea3e81ff08bbdabf04c7342b89f3038d(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            8,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:35:50.789 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include -c pa_ea3e81ff08bbdabf04c7342b89f3038d.cpp -o pa_ea3e81ff08bbdabf04c7342b89f3038d.o
In file included from pa_ea3e81ff08bbdabf04c7342b89f3038d.cpp:1:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_ea3e81ff08bbdabf04c7342b89f3038d.cpp:1:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/quant_utils.cuh:19:
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_ea3e81ff08bbdabf04c7342b89f3038d.o -o lib.so
[aiter INFO] 2025-10-23 03:35:54.081 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_ea3e81ff08bbdabf04c7342b89f3038d, cost 3.29186887s
[aiter INFO] 2025-10-23 03:35:54.183 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 736.1200800036439 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 948, 949, 952, 953, 62}
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 637.403
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 643.6810000000005
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000524
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 641.4809999999998
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.398999999999432
[aiter INFO] 2025-10-23 03:35:54.294 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.519000000000005
[aiter INFO] 2025-10-23 03:35:54.313 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,491.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         62,099.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       64,906.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          649.1            648.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:54.314 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   648.88 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:54.323 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:54.423 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 205.17099892148877 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:54.493 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:35:54.493 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.55900000000003
[aiter INFO] 2025-10-23 03:35:54.493 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.479000000000042
[aiter INFO] 2025-10-23 03:35:54.512 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            809.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         11,785.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,595.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          126.0            126.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:54.513 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   125.95 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:54.703 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 429.60418864051894 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:54.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1266, 12}
[aiter INFO] 2025-10-23 03:35:54.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.3989999999976
[aiter INFO] 2025-10-23 03:35:54.952 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.201
[aiter INFO] 2025-10-23 03:35:54.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 99.0            0.0         31,641.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            319.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:54.990 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.31746544106173 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:55.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999993
[aiter INFO] 2025-10-23 03:35:55.037 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            709.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.038 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   326.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:55.087 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 197.52818803385932 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1208, 675, 12}
[aiter INFO] 2025-10-23 03:35:55.141 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.47899999999936
[aiter INFO] 2025-10-23 03:35:55.141 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.3189999999995
[aiter INFO] 2025-10-23 03:35:55.141 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.15900000000002
[aiter INFO] 2025-10-23 03:35:55.153 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0          7,588.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             77.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.77291120574026 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:55.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-10-23 03:35:55.228 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            712.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.229 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    84.56 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:55.273 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 163.52846436571366 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {867, 9, 875, 17, 20, 28}
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.8789999999999
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.839
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519000000000233
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.79899999999998
[aiter INFO] 2025-10-23 03:35:55.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.599000000000046
[aiter INFO] 2025-10-23 03:35:55.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            744.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          7,126.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,031.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           80.3             80.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    80.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:55.350 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:55.456 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 244.36952454028744 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 9, 174, 1007, 22, 1022}
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.71900000000005
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.239
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.320999999999913
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 153.7990000000009
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.599000000000046
[aiter INFO] 2025-10-23 03:35:55.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.279000000000451
[aiter INFO] 2025-10-23 03:35:55.542 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,297.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         14,940.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,572.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          165.7            165.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.543 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   165.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:55.752 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 570.5321891473072 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1280, 1250, 1255, 12, 1301, 1310}
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 459.40300000000207
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 459.47899999999936
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 459.07900000000154
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 462.321
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 456.88300000000163
[aiter INFO] 2025-10-23 03:35:55.839 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 459.2390000000014
[aiter INFO] 2025-10-23 03:35:55.850 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 95.0            0.0         43,510.8        CUDA            5
[avg us/iter]               NaN  NaN            0.0            458.0         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.877 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.22598049546232 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:55.911 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:55.911 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.758999999999986
[aiter INFO] 2025-10-23 03:35:55.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            817.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:55.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   466.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:55.975 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 200.42004960008185 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.029 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 285, 246}
[aiter INFO] 2025-10-23 03:35:56.030 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.59899999999999
[aiter INFO] 2025-10-23 03:35:56.030 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 85.119
[aiter INFO] 2025-10-23 03:35:56.030 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.11899999999969
[aiter INFO] 2025-10-23 03:35:56.030 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.55899999999974
[aiter INFO] 2025-10-23 03:35:56.042 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          7,813.2        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             80.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.069 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.14798014588875 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.103 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:56.103 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000009
[aiter INFO] 2025-10-23 03:35:56.115 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            823.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.116 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    88.79 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:56.172 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 244.03012861119637 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21, 1068, 1069}
[aiter INFO] 2025-10-23 03:35:56.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.639
[aiter INFO] 2025-10-23 03:35:56.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.559000000000026
[aiter INFO] 2025-10-23 03:35:56.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.0010000000002
[aiter INFO] 2025-10-23 03:35:56.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.15899999999965
[aiter INFO] 2025-10-23 03:35:56.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,307.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,349.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,813.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          158.1            158.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.250 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   158.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:56.256 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:56.369 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 316.9959007513405 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1104, 1105, 1050, 1051, 28}
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 220.639
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 220.43900000000212
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.758999999998196
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 220.71900000000096
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.47899999999936
[aiter INFO] 2025-10-23 03:35:56.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.119000000000028
[aiter INFO] 2025-10-23 03:35:56.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,735.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         21,465.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       23,677.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          236.8            236.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   236.74 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:56.812 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 259.4963256085273 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.868 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 229}
[aiter INFO] 2025-10-23 03:35:56.868 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.55899999999997
[aiter INFO] 2025-10-23 03:35:56.868 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.07899999999972
[aiter INFO] 2025-10-23 03:35:56.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         14,210.0        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            143.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.170138762729 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:56.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:56.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119
[aiter INFO] 2025-10-23 03:35:56.953 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,145.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:56.954 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   154.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:57.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 296.2073373912585 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1060, 1061, 9, 1008, 1009, 26}
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 191.35900000000038
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.679000000000087
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 194.31900000000002
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 192.51900000000023
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.958999999998923
[aiter INFO] 2025-10-23 03:35:57.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.879000000000019
[aiter INFO] 2025-10-23 03:35:57.103 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,737.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         18,816.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,972.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          209.7            209.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:57.104 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   209.73 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:57.113 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:57.232 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 362.205959192597 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:57.315 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {773, 9, 523, 747, 1010, 1011, 502, 30}
[aiter INFO] 2025-10-23 03:35:57.315 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.878999999999905
[aiter INFO] 2025-10-23 03:35:57.315 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.999
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.71900000000005
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.5189999999993
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.5209999999988
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.759000000000015
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 257.59900000000016
[aiter INFO] 2025-10-23 03:35:57.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.319000000000017
[aiter INFO] 2025-10-23 03:35:57.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,203.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  97.0            0.0         24,814.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       27,859.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          278.6            278.5         NaN          NaN
[aiter INFO] 2025-10-23 03:35:57.335 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   278.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:57.516 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 264.5240606057762 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 347, 25, 1307, 1118, 1310}
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.91900000000004
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.11900000000014
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.27900000000005
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.03900000000067
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.23899999999958
[aiter INFO] 2025-10-23 03:35:57.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.23899999999958
[aiter INFO] 2025-10-23 03:35:57.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 95.0            0.0         13,837.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            145.7         NaN          NaN
[aiter INFO] 2025-10-23 03:35:57.611 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.00974284599323 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:57.644 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {83, 6}
[aiter INFO] 2025-10-23 03:35:57.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.99899999999991
[aiter INFO] 2025-10-23 03:35:57.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.199000000000012
[aiter INFO] 2025-10-23 03:35:57.657 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0          1,230.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.4         NaN          NaN
[aiter INFO] 2025-10-23 03:35:57.658 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   158.09 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:57.814 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1118.3379900337447 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:57.964 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1072, 1073, 9, 97}
[aiter INFO] 2025-10-23 03:35:57.965 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1016.7229999999981
[aiter INFO] 2025-10-23 03:35:57.965 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.519000000000233
[aiter INFO] 2025-10-23 03:35:57.965 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1014.643
[aiter INFO] 2025-10-23 03:35:57.965 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.838999999999942
[aiter INFO] 2025-10-23 03:35:57.984 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,236.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0        100,041.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      103,317.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,033.2          1,033.1         NaN          NaN
[aiter INFO] 2025-10-23 03:35:57.985 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1033.11 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:57.998 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:35:58.068 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 161.1681081870995 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {611, 229, 9, 237, 17, 603}
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.839000000000851
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.51900000000023
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.03899999999999
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.03899999999976
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.278999999999996
[aiter INFO] 2025-10-23 03:35:58.127 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 78.83899999999994
[aiter INFO] 2025-10-23 03:35:58.147 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            674.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0          7,534.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,380.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           83.8             83.8         NaN          NaN
[aiter INFO] 2025-10-23 03:35:58.147 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    83.76 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:58.817 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 313.01408888089776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 50, 1303, 1304, 25}
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 201.04100000000003
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 199.71899999999994
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.3209999999999
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 198.27899999999863
[aiter INFO] 2025-10-23 03:35:58.879 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 199.71900000000005
[aiter INFO] 2025-10-23 03:35:58.890 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 96.0            0.0         19,098.8        CUDA            5
[avg us/iter]               NaN  NaN            0.0            198.9         NaN          NaN
[aiter INFO] 2025-10-23 03:35:58.916 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.15864318078107 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:58.951 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:35:58.951 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.081000000000017
[aiter INFO] 2025-10-23 03:35:58.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            628.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:58.964 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   205.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:59.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.68611882110633 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:59.552 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:35:59.552 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.19900000000001
[aiter INFO] 2025-10-23 03:35:59.565 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          5,159.1        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             51.6         NaN          NaN
[aiter INFO] 2025-10-23 03:35:59.591 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.7535045866919 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:35:59.632 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {202, 6}
[aiter INFO] 2025-10-23 03:35:59.632 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.719000000000051
[aiter INFO] 2025-10-23 03:35:59.632 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.798999999999978
[aiter INFO] 2025-10-23 03:35:59.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            624.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.3         NaN          NaN
[aiter INFO] 2025-10-23 03:35:59.646 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    57.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:35:59.651 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_0c1673a8cbfa192e2cd73135db11a4e8' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_0c1673a8cbfa192e2cd73135db11a4e8', 'folder': 'pa_0c1673a8cbfa192e2cd73135db11a4e8', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_0c1673a8cbfa192e2cd73135db11a4e8(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:35:59.651 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include -c pa_0c1673a8cbfa192e2cd73135db11a4e8.cpp -o pa_0c1673a8cbfa192e2cd73135db11a4e8.o
In file included from pa_0c1673a8cbfa192e2cd73135db11a4e8.cpp:1:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_0c1673a8cbfa192e2cd73135db11a4e8.cpp:1:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_0c1673a8cbfa192e2cd73135db11a4e8.o -o lib.so
[aiter INFO] 2025-10-23 03:36:02.755 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_0c1673a8cbfa192e2cd73135db11a4e8, cost 3.10402495s
[aiter INFO] 2025-10-23 03:36:02.796 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.2024459626415 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:02.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1062, 9, 812, 16, 20, 820, 27, 1054}
[aiter INFO] 2025-10-23 03:36:02.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.398999999999432
[aiter INFO] 2025-10-23 03:36:02.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.799000000000035
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.759000000000015
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.87900000000002
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15899999999965
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.718999999999994
[aiter INFO] 2025-10-23 03:36:02.856 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.198999999998705
[aiter INFO] 2025-10-23 03:36:02.876 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            665.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          4,703.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,541.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           55.4             55.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:02.877 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    55.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:02.880 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:02.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 187.8069500521858 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {416, 1088, 1091, 870, 809, 714, 427, 906, 9, 19, 980, 821, 918, 991, 860, 703}
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.35900000000038
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.92100000000028
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.878999999998996
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.8789999999999
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-10-23 03:36:03.026 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.679000000000087
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.35900000000038
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.64100000000002
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.038999999999987
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.27900000000045
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.918999999999869
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.998999999999796
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.998999999999796
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.63900000000012
[aiter INFO] 2025-10-23 03:36:03.027 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.67900000000009
[aiter INFO] 2025-10-23 03:36:03.046 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  93.0            0.0          1,001.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  93.0            0.0          9,241.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,029.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          110.3            110.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:03.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   110.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:03.976 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 399.4270595583585 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:04.051 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:04.051 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 286.39899999999994
[aiter INFO] 2025-10-23 03:36:04.062 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         28,382.6        CUDA            5
[avg us/iter]               NaN   NaN            0.0            283.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:04.088 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.10319806443583 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:04.126 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:04.126 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.359000000000009
[aiter INFO] 2025-10-23 03:36:04.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            813.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:04.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   291.96 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:04.536 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 212.98881214443998 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:04.590 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:04.591 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.719
[aiter INFO] 2025-10-23 03:36:04.603 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          9,342.7        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             93.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:04.630 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.68655491937506 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:04.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:04.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.198999999999984
[aiter INFO] 2025-10-23 03:36:04.684 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            823.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:04.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   101.66 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:04.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_0eceed70bbfb75ac36c08b9fde8d79db' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_0eceed70bbfb75ac36c08b9fde8d79db', 'folder': 'pa_0eceed70bbfb75ac36c08b9fde8d79db', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_0eceed70bbfb75ac36c08b9fde8d79db(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:04.695 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include -c pa_0eceed70bbfb75ac36c08b9fde8d79db.cpp -o pa_0eceed70bbfb75ac36c08b9fde8d79db.o
In file included from pa_0eceed70bbfb75ac36c08b9fde8d79db.cpp:1:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_0eceed70bbfb75ac36c08b9fde8d79db.cpp:1:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/quant_utils.cuh:19:
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_0eceed70bbfb75ac36c08b9fde8d79db.o -o lib.so
[aiter INFO] 2025-10-23 03:36:07.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_0eceed70bbfb75ac36c08b9fde8d79db, cost 3.17759044s
[aiter INFO] 2025-10-23 03:36:07.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 189.8889405892627 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {903, 1065, 9, 913, 17, 915, 20, 28, 925, 1055}
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.51900000000023
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.918999999999869
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.59899999999999
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.279000000000451
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.91899999999987
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.99899999999997
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.678999999999974
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.838999999999942
[aiter INFO] 2025-10-23 03:36:07.971 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.9989999999998
[aiter INFO] 2025-10-23 03:36:07.991 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,039.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          9,033.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,496.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          105.0            104.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:07.992 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   104.92 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:07.997 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:08.072 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 231.2609804148721 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:08.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 37, 23}
[aiter INFO] 2025-10-23 03:36:08.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.15900000000002
[aiter INFO] 2025-10-23 03:36:08.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.67900000000003
[aiter INFO] 2025-10-23 03:36:08.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.438999999999965
[aiter INFO] 2025-10-23 03:36:08.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-10-23 03:36:08.301 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,422.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         14,085.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,665.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          156.7            156.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:08.302 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   156.64 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:08.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 211.68389119724236 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:08.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {545, 779, 12, 623}
[aiter INFO] 2025-10-23 03:36:08.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.4389999999994
[aiter INFO] 2025-10-23 03:36:08.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.19900000000052
[aiter INFO] 2025-10-23 03:36:08.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.88100000000003
[aiter INFO] 2025-10-23 03:36:08.831 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.8789999999999
[aiter INFO] 2025-10-23 03:36:08.842 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          9,206.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             94.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:08.869 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.61407885161958 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:08.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:08.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.638999999999982
[aiter INFO] 2025-10-23 03:36:08.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            906.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:08.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   103.98 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:08.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_b610f89f93c377f785aa84c93dcefd43' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_b610f89f93c377f785aa84c93dcefd43', 'folder': 'pa_b610f89f93c377f785aa84c93dcefd43', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_b610f89f93c377f785aa84c93dcefd43(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:08.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include -c pa_b610f89f93c377f785aa84c93dcefd43.cpp -o pa_b610f89f93c377f785aa84c93dcefd43.o
In file included from pa_b610f89f93c377f785aa84c93dcefd43.cpp:1:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/quant_utils.cuh:19:
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_b610f89f93c377f785aa84c93dcefd43.cpp:1:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/quant_utils.cuh:19:
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_b610f89f93c377f785aa84c93dcefd43.o -o lib.so
[aiter INFO] 2025-10-23 03:36:12.182 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_b610f89f93c377f785aa84c93dcefd43, cost 3.25184254s
[aiter INFO] 2025-10-23 03:36:12.230 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 223.94732599801355 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:12.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:36:12.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.47899999999998
[aiter INFO] 2025-10-23 03:36:12.291 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.31899999999996
[aiter INFO] 2025-10-23 03:36:12.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,437.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         12,495.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,933.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          139.3            139.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:12.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   139.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:12.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:12.399 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 266.02623014166807 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:12.475 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:36:12.475 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.31900000000002
[aiter INFO] 2025-10-23 03:36:12.475 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.559000000000026
[aiter INFO] 2025-10-23 03:36:12.495 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,807.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         16,862.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,669.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          186.7            186.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:12.495 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   186.69 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:13.055 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 230.61146550249345 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:13.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:13.109 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 108.87899999999996
[aiter INFO] 2025-10-23 03:36:13.120 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         10,723.9        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            107.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:13.147 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.53571290308886 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:13.183 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 132, 69, 6, 104, 41, 76, 13, 111, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:36:13.183 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.19900000000007
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999971
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.918999999999983
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.518999999999977
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.959000000000003
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999955
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999976
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.159000000000106
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.798999999999978
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-10-23 03:36:13.184 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999955
[aiter INFO] 2025-10-23 03:36:13.196 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 84.0            0.0            879.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             10.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:13.197 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   117.71 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:13.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_22e649eec4f10a7b726a4ae644aa2133' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_22e649eec4f10a7b726a4ae644aa2133', 'folder': 'pa_22e649eec4f10a7b726a4ae644aa2133', 'kwargs': OrderedDict({'gqa_ratio': 10, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_22e649eec4f10a7b726a4ae644aa2133(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            10,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:13.209 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include -c pa_22e649eec4f10a7b726a4ae644aa2133.cpp -o pa_22e649eec4f10a7b726a4ae644aa2133.o
In file included from pa_22e649eec4f10a7b726a4ae644aa2133.cpp:1:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/quant_utils.cuh:19:
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_22e649eec4f10a7b726a4ae644aa2133.cpp:1:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/quant_utils.cuh:19:
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_22e649eec4f10a7b726a4ae644aa2133.o -o lib.so
[aiter INFO] 2025-10-23 03:36:16.525 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_22e649eec4f10a7b726a4ae644aa2133, cost 3.31620023s
[aiter INFO] 2025-10-23 03:36:16.627 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 739.9577103038825 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 55, 950, 951, 797, 735}
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 635.121
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.319000000000074
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 643.241
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.439000000000306
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.47899999999936
[aiter INFO] 2025-10-23 03:36:16.736 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 646.2829999999994
[aiter INFO] 2025-10-23 03:36:16.755 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,792.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         62,368.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,487.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          654.9            654.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:16.756 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   654.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:16.766 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:16.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 205.01375198364258 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:16.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20}
[aiter INFO] 2025-10-23 03:36:16.931 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.91900000000001
[aiter INFO] 2025-10-23 03:36:16.931 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.759000000000015
[aiter INFO] 2025-10-23 03:36:16.950 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            983.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         11,804.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,787.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          127.9            127.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:16.950 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   127.88 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:17.136 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 429.32936549186707 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:17.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.279
[aiter INFO] 2025-10-23 03:36:17.351 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         32,164.8        CUDA            5
[avg us/iter]               NaN   NaN            0.0            321.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.377 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.48496040052707 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.411 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:17.411 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999999
[aiter INFO] 2025-10-23 03:36:17.423 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            734.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.424 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   328.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:17.472 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 197.00855415056247 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.525 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:17.525 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.76099999999997
[aiter INFO] 2025-10-23 03:36:17.538 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0          7,784.4        CUDA            5
[avg us/iter]                     NaN   NaN            0.0             77.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.564 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.42236659550431 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:17.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.198999999999984
[aiter INFO] 2025-10-23 03:36:17.611 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            739.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    85.24 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:17.656 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.0120199906944 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.709 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:36:17.709 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.959
[aiter INFO] 2025-10-23 03:36:17.709 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.839
[aiter INFO] 2025-10-23 03:36:17.709 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-10-23 03:36:17.709 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-10-23 03:36:17.728 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            929.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          7,258.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,271.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           82.7             82.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.729 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    82.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:17.732 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:17.834 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 249.01507971900526 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {546, 9, 1098, 363, 939, 1068, 1069, 1099, 563, 1044, 1045, 25, 924, 351}
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.24099999999999
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.561
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.11899999999878
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.518999999999778
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.47899999999936
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.15900000000147
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.679000000000087
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000233
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.6790000000001
[aiter INFO] 2025-10-23 03:36:17.901 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999942
[aiter INFO] 2025-10-23 03:36:17.902 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.039000000000044
[aiter INFO] 2025-10-23 03:36:17.902 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.16100000000006
[aiter INFO] 2025-10-23 03:36:17.902 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 157.31899999999996
[aiter INFO] 2025-10-23 03:36:17.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  94.0            0.0          1,464.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  94.0            0.0         14,648.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,150.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          171.5            171.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:17.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   171.41 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:18.126 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 568.151604421068 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.213 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:18.213 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 464.84299999999996
[aiter INFO] 2025-10-23 03:36:18.224 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         45,973.8        CUDA            5
[avg us/iter]               NaN   NaN            0.0            459.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.251 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.18955424221434 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.284 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:18.284 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.038999999999987
[aiter INFO] 2025-10-23 03:36:18.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            986.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.297 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   469.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:18.356 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.356910825956 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {283, 12, 1302}
[aiter INFO] 2025-10-23 03:36:18.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.5609999999997
[aiter INFO] 2025-10-23 03:36:18.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.39900000000003
[aiter INFO] 2025-10-23 03:36:18.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.24099999999999
[aiter INFO] 2025-10-23 03:36:18.425 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         13,893.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            141.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.452 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.51231704726077 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:18.485 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.998999999999995
[aiter INFO] 2025-10-23 03:36:18.498 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            992.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   151.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.001708984375
max_diff_thr=0.001676044543273747

NaN info:
{}
out_ref_md5=158f440f3e3be58142ddd9503b9b2187
triton_fp8_output_md5=f8fa3a25349848bf7123c60c7cd6d048
diff.abs.max=0.001129150390625
max_diff_thr=0.0011267090449109674

NaN info:
{}
out_ref_md5=158f440f3e3be58142ddd9503b9b2187
gluon_fp8_output_md5=266e84834d05fe6ab26f3b537d854fc4
diff.abs.max=0.0029754638671875
max_diff_thr=0.002958400407806039

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.001805271371267736

NaN info:
{}
out_ref_md5=674cccd6e09d0d16e28d386816fdab10
triton_fp8_output_md5=bf9d94972c58c042b14a0c71122b27d7
diff.abs.max=0.0012664794921875
max_diff_thr=0.0012609765399247408

NaN info:
{}
out_ref_md5=674cccd6e09d0d16e28d386816fdab10
gluon_fp8_output_md5=d78a679190e5f35e4ac067f1b94d2d52
diff.abs.max=0.003082275390625
max_diff_thr=0.0030506222974509

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.00116729736328125
max_diff_thr=0.0011653680121526122

NaN info:
{}
out_ref_md5=beadb2c8e370d6efee37a6fc4bc23ec2
gluon_fp8_output_md5=43b1a29574f505fd6dcfb78c10937347
diff.abs.max=0.0030517578125
max_diff_thr=0.003016585484147072

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.0013427734375
max_diff_thr=0.0013181546237319708

NaN info:
{}
out_ref_md5=1bcc4214288e8f3aaf12ea00c633a870
gluon_fp8_output_md5=245a2a53937e6f54a1145c9f8ad84cc7
diff.abs.max=0.00348663330078125
max_diff_thr=0.003469059243798256

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.001745410729199648

NaN info:
{}
out_ref_md5=5bb4a418187ef1ca4a9367ea2ea7f359
triton_fp8_output_md5=1fdb4581d67fe69a8a4dcbeee060c147
diff.abs.max=0.0010986328125
max_diff_thr=0.0010862350463867188

NaN info:
{}
out_ref_md5=5bb4a418187ef1ca4a9367ea2ea7f359
gluon_fp8_output_md5=8b015790e3e78d0b0d2e92c7e2dafbe6
diff.abs.max=0.0029296875
max_diff_thr=0.0029064486734569073

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017598154954612255

NaN info:
{}
out_ref_md5=a7ebf8caa50808cac7979025412408c1
triton_fp8_output_md5=1decd35236722773ca22cff43d52b6e9
diff.abs.max=0.00115966796875
max_diff_thr=0.0011554014636203647

NaN info:
{}
out_ref_md5=a7ebf8caa50808cac7979025412408c1
gluon_fp8_output_md5=4acf74124eff618075d5031e0f2f2b2b
diff.abs.max=0.00323486328125
max_diff_thr=0.003191425232216716

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.001268575550056994

NaN info:
{}
out_ref_md5=477acd8dac41f0d8269757eb03c63961
gluon_fp8_output_md5=9707492a7d19f9f284428d1119fce586
diff.abs.max=0.00311279296875
max_diff_thr=0.003078649751842022

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.00146484375
max_diff_thr=0.0014407491544261575

NaN info:
{}
out_ref_md5=33a777faa1443854ba1dc21f6f823783
gluon_fp8_output_md5=e28dfdfa8178f89e5f89feeab6ac5067
diff.abs.max=0.0032958984375
max_diff_thr=0.003233532886952162

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017514192732051015

NaN info:
{}
out_ref_md5=f7f07a381d5a01ff17cba0769c20fc46
triton_fp8_output_md5=e383997a1dd6debd0a42eafb15c2fcce
diff.abs.max=0.001220703125
max_diff_thr=0.001200336148031056

NaN info:
{}
out_ref_md5=f7f07a381d5a01ff17cba0769c20fc46
gluon_fp8_output_md5=19f540f87a1f3e199f6f4374cf19eed1
diff.abs.max=0.0029296875
max_diff_thr=0.0029045140836387873

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016894949367269874

NaN info:
{}
out_ref_md5=00e591cfa3bf40baefcbdf6cab730b24
triton_fp8_output_md5=cfa5c5d7fb533fc727d30c955bba6fef
diff.abs.max=0.001190185546875
max_diff_thr=0.0011823914246633649

NaN info:
{}
out_ref_md5=00e591cfa3bf40baefcbdf6cab730b24
gluon_fp8_output_md5=206e19180ce507590727549c80361a7d
diff.abs.max=0.003173828125
max_diff_thr=0.0031555313616991043

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.0012758589582517743

NaN info:
{}
out_ref_md5=d7f2242e05aff3afb85892ad0ddd2dc1
gluon_fp8_output_md5=2451472d14e096cdef23dfd2f84699e0
diff.abs.max=0.0031585693359375
max_diff_thr=0.0031369340140372515

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.001201629638671875
max_diff_thr=0.0011998263653367758

NaN info:
{}
out_ref_md5=c46045eede32ec1aca6040e381c4dd00
gluon_fp8_output_md5=dc838012d0eec657200ee480ee9be2f3
diff.abs.max=0.00311279296875
max_diff_thr=0.003070069942623377

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017840152140706778

NaN info:
{}
out_ref_md5=06eb9ffe5a4974a7c93494fe6a2769f7
triton_fp8_output_md5=eca1257c4c3a710fa342bdef996e3080
diff.abs.max=0.00130462646484375
max_diff_thr=0.0013013500720262527

NaN info:
{}
out_ref_md5=06eb9ffe5a4974a7c93494fe6a2769f7
gluon_fp8_output_md5=2bafddaccc575661cf4624cd5e8a3c36
diff.abs.max=0.0032958984375
max_diff_thr=0.0032465581316500902

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.001953125
max_diff_thr=0.001917545567266643

NaN info:
{}
out_ref_md5=c43a53ce78c2b460766b1ad92e04c2b1
triton_fp8_output_md5=9480f691b5914dfad87b8ea3efed5949
diff.abs.max=0.00128173828125
max_diff_thr=0.0012714173644781113[aiter INFO] 2025-10-23 03:36:18.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.09589111568906 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.615 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1060, 1061, 22}
[aiter INFO] 2025-10-23 03:36:18.615 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.75900000000001
[aiter INFO] 2025-10-23 03:36:18.615 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.91899999999987
[aiter INFO] 2025-10-23 03:36:18.615 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000233
[aiter INFO] 2025-10-23 03:36:18.615 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:36:18.635 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,541.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         14,743.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,447.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          164.5            164.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.635 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   164.49 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:18.642 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:18.753 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 324.857356819776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:18.962 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {640, 9, 30, 615}
[aiter INFO] 2025-10-23 03:36:18.962 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.639000000000124
[aiter INFO] 2025-10-23 03:36:18.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 228.71900000000002
[aiter INFO] 2025-10-23 03:36:18.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.718999999999994
[aiter INFO] 2025-10-23 03:36:18.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 227.9989999999998
[aiter INFO] 2025-10-23 03:36:18.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,128.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         22,444.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,822.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          248.2            248.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:18.983 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   248.21 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:19.163 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.2337336965127 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:19.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {347, 12, 1271}
[aiter INFO] 2025-10-23 03:36:19.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.6790000000001
[aiter INFO] 2025-10-23 03:36:19.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.92100000000002
[aiter INFO] 2025-10-23 03:36:19.218 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.15899999999965
[aiter INFO] 2025-10-23 03:36:19.229 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         14,202.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            144.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:19.256 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.39944580639943 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 76, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.7589999999999
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.118999999999971
[aiter INFO] 2025-10-23 03:36:19.289 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-10-23 03:36:19.302 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,070.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:19.303 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   156.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:19.374 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 303.24100061218337 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:19.443 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:36:19.443 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 199.56099999999998
[aiter INFO] 2025-10-23 03:36:19.443 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.63900000000001
[aiter INFO] 2025-10-23 03:36:19.462 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,147.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         19,734.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,881.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          218.8            218.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:19.463 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   218.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:19.475 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:19.591 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 373.4162975065779 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 263, 9, 234, 239, 176, 1040, 210, 1041, 152}
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.599000000000046
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.358999999999924
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 260.681
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.63899999999967
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 262.56100000000015
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.59900000000016
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 264.72100000000137
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 262.80099999999993
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.398999999997613
[aiter INFO] 2025-10-23 03:36:19.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 262.23900000000003
[aiter INFO] 2025-10-23 03:36:19.689 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          2,627.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         24,951.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       28,741.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          287.4            287.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:19.690 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   287.28 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:19.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 294.23304034931823 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:19.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:36:19.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 165.959
[aiter INFO] 2025-10-23 03:36:19.930 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 170.279
[aiter INFO] 2025-10-23 03:36:19.940 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         16,593.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            167.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:19.967 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 75.03115821002733 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.158999999999992
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.838999999999942
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.479000000000013
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.759000000000015
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.15900000000002
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000065
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.959000000000003
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.55899999999997
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119000000000028
[aiter INFO] 2025-10-23 03:36:20.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.918999999999983
[aiter INFO] 2025-10-23 03:36:20.012 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,345.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:20.013 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   182.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:20.169 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1127.2437678705346 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:20.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 98}
[aiter INFO] 2025-10-23 03:36:20.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1025.483
[aiter INFO] 2025-10-23 03:36:20.316 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.59900000000016
[aiter INFO] 2025-10-23 03:36:20.336 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,728.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0        102,003.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      104,732.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,047.3          1,047.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:20.336 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1047.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:20.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:20.421 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.03341596197373 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:20.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:36:20.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.119
[aiter INFO] 2025-10-23 03:36:20.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-10-23 03:36:20.498 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            861.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          7,789.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,651.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           86.5             86.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:20.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    86.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:21.172 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 306.2192275382505 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:21.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 731, 12, 1302}
[aiter INFO] 2025-10-23 03:36:21.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.43900000000002
[aiter INFO] 2025-10-23 03:36:21.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.39900000000034
[aiter INFO] 2025-10-23 03:36:21.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 197.639
[aiter INFO] 2025-10-23 03:36:21.234 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 193.7990000000027
[aiter INFO] 2025-10-23 03:36:21.245 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 97.0            0.0         18,874.0        CUDA            5
[avg us/iter]               NaN  NaN            0.0            194.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:21.271 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.90639603728114 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:21.305 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:21.305 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.838999999999999
[aiter INFO] 2025-10-23 03:36:21.317 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            682.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:21.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   201.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:21.799 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 169.72651487529868 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {480, 194, 12, 25, 987, 701}
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.79899999999998
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.79899999999998
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.238999999999976
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.519000000000005
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.879000000000815
[aiter INFO] 2025-10-23 03:36:21.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.95899999999983
[aiter INFO] 2025-10-23 03:36:21.867 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 95.0            0.0          4,999.2        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             52.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:21.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.15350498303329 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:21.932 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:21.932 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-10-23 03:36:21.944 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            684.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:21.945 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    59.47 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:21.951 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_9bed71fb07d6a26152f96c466daa5698' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_9bed71fb07d6a26152f96c466daa5698', 'folder': 'pa_9bed71fb07d6a26152f96c466daa5698', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_9bed71fb07d6a26152f96c466daa5698(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:21.951 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include -c pa_9bed71fb07d6a26152f96c466daa5698.cpp -o pa_9bed71fb07d6a26152f96c466daa5698.o
In file included from pa_9bed71fb07d6a26152f96c466daa5698.cpp:1:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_9bed71fb07d6a26152f96c466daa5698.cpp:1:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/quant_utils.cuh:19:
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_9bed71fb07d6a26152f96c466daa5698.o -o lib.so
[aiter INFO] 2025-10-23 03:36:25.118 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_9bed71fb07d6a26152f96c466daa5698, cost 3.16686541s
[aiter INFO] 2025-10-23 03:36:25.158 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 141.2091880741686 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:25.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 28, 16, 372, 20, 380}
[aiter INFO] 2025-10-23 03:36:25.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.31899999999996
[aiter INFO] 2025-10-23 03:36:25.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.438999999999965
[aiter INFO] 2025-10-23 03:36:25.215 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.238999999999976
[aiter INFO] 2025-10-23 03:36:25.216 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.88099999999986
[aiter INFO] 2025-10-23 03:36:25.216 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.79899999999998
[aiter INFO] 2025-10-23 03:36:25.216 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.159000000000106
[aiter INFO] 2025-10-23 03:36:25.235 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0            879.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          4,856.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,857.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           58.6             58.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:25.236 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    58.53 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:25.239 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:25.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 193.13056368638973 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:25.379 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1066, 499, 19, 509, 1055}
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.80099999999999
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999998632
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.5609999999997
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.158999999999992
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999999614
[aiter INFO] 2025-10-23 03:36:25.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 104.40099999999984
[aiter INFO] 2025-10-23 03:36:25.399 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,472.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         10,045.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,756.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          117.6            117.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:25.400 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   117.52 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:26.776 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 390.5466151709604 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:26.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:26.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 280.04099999999994
[aiter INFO] 2025-10-23 03:36:26.860 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0         27,726.2        CUDA            5
[avg us/iter]               NaN   NaN            0.0            277.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:26.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.20931705271843 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:26.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:26.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.798999999999978
[aiter INFO] 2025-10-23 03:36:26.935 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            965.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:26.936 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   286.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:27.325 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 209.87041560139988 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:27.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1273, 142}
[aiter INFO] 2025-10-23 03:36:27.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.56100000000004
[aiter INFO] 2025-10-23 03:36:27.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.79900000000004
[aiter INFO] 2025-10-23 03:36:27.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.95900000000074
[aiter INFO] 2025-10-23 03:36:27.378 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.16099999999983
[aiter INFO] 2025-10-23 03:36:27.391 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0          9,224.3        CUDA            5
[avg us/iter]                     NaN  NaN            0.0             95.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:27.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.51859408971106 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:27.455 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:27.455 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.278999999999996
[aiter INFO] 2025-10-23 03:36:27.467 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            958.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:27.468 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   104.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:27.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_3a20ad4a202bf0b89fd63a4e75bf9066' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_3a20ad4a202bf0b89fd63a4e75bf9066', 'folder': 'pa_3a20ad4a202bf0b89fd63a4e75bf9066', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_3a20ad4a202bf0b89fd63a4e75bf9066(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:27.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include -c pa_3a20ad4a202bf0b89fd63a4e75bf9066.cpp -o pa_3a20ad4a202bf0b89fd63a4e75bf9066.o
In file included from pa_3a20ad4a202bf0b89fd63a4e75bf9066.cpp:1:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/quant_utils.cuh:19:
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_3a20ad4a202bf0b89fd63a4e75bf9066.cpp:1:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/quant_utils.cuh:19:
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_3a20ad4a202bf0b89fd63a4e75bf9066.o -o lib.so
[aiter INFO] 2025-10-23 03:36:30.651 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_3a20ad4a202bf0b89fd63a4e75bf9066, cost 3.17288207s
[aiter INFO] 2025-10-23 03:36:30.698 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 205.1488220101536 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:30.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {768, 616, 9, 778, 44, 17, 626, 20, 54, 28}
[aiter INFO] 2025-10-23 03:36:30.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.83899999999994
[aiter INFO] 2025-10-23 03:36:30.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 100.5590000000002
[aiter INFO] 2025-10-23 03:36:30.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.87900000000002
[aiter INFO] 2025-10-23 03:36:30.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.118999999999687
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.279
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.839
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.91899999999987
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.79899999999998
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.44100000000003
[aiter INFO] 2025-10-23 03:36:30.887 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-10-23 03:36:30.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,727.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          9,625.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,832.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          118.3            118.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:30.907 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   118.26 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:30.916 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:31.000 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 301.4370400716763 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:31.080 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 1012, 1013}
[aiter INFO] 2025-10-23 03:36:31.080 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 206.921
[aiter INFO] 2025-10-23 03:36:31.081 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.398999999999944
[aiter INFO] 2025-10-23 03:36:31.081 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.59900000000016
[aiter INFO] 2025-10-23 03:36:31.081 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.71899999999914
[aiter INFO] 2025-10-23 03:36:31.100 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,527.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         20,077.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,835.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          228.4            228.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:31.100 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   228.34 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:31.658 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 253.06697012764388 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:31.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1033, 852, 12, 1110}
[aiter INFO] 2025-10-23 03:36:31.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.24099999999999
[aiter INFO] 2025-10-23 03:36:31.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.15900000000147
[aiter INFO] 2025-10-23 03:36:31.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.639
[aiter INFO] 2025-10-23 03:36:31.715 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.5589999999993
[aiter INFO] 2025-10-23 03:36:31.726 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         12,844.6        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            132.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:31.753 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.69528707773378 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:31.789 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 76, 83, 55, 27}
[aiter INFO] 2025-10-23 03:36:31.789 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000005
[aiter INFO] 2025-10-23 03:36:31.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000004
[aiter INFO] 2025-10-23 03:36:31.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000005
[aiter INFO] 2025-10-23 03:36:31.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-10-23 03:36:31.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.678999999999974
[aiter INFO] 2025-10-23 03:36:31.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.038999999999987
[aiter INFO] 2025-10-23 03:36:31.802 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 95.0            0.0          1,201.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:31.803 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   145.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:31.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_b60ca9af68af375860f27b250fbe43f3' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_b60ca9af68af375860f27b250fbe43f3', 'folder': 'pa_b60ca9af68af375860f27b250fbe43f3', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_b60ca9af68af375860f27b250fbe43f3(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:31.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include -c pa_b60ca9af68af375860f27b250fbe43f3.cpp -o pa_b60ca9af68af375860f27b250fbe43f3.o
In file included from pa_b60ca9af68af375860f27b250fbe43f3.cpp:1:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/quant_utils.cuh:19:
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_b60ca9af68af375860f27b250fbe43f3.cpp:1:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/quant_utils.cuh:19:
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_b60ca9af68af375860f27b250fbe43f3.o -o lib.so
[aiter INFO] 2025-10-23 03:36:35.076 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_b60ca9af68af375860f27b250fbe43f3, cost 3.25500456s
[aiter INFO] 2025-10-23 03:36:35.131 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 294.30713925031154 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:35.203 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {227, 9, 246, 25, 1082, 1083}
[aiter INFO] 2025-10-23 03:36:35.203 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.84100000000035
[aiter INFO] 2025-10-23 03:36:35.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.44099999999997
[aiter INFO] 2025-10-23 03:36:35.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.878999999999905
[aiter INFO] 2025-10-23 03:36:35.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.55899999999997
[aiter INFO] 2025-10-23 03:36:35.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.35900000000038
[aiter INFO] 2025-10-23 03:36:35.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.519000000000233
[aiter INFO] 2025-10-23 03:36:35.223 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,500.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         17,989.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,911.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          209.1            209.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:35.224 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   209.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:35.237 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:35.326 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 349.63719974650013 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 30, 1052, 1053, 1054, 1055}
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 247.279
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.960999999999956
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 246.9190000000017
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.91899999999805
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 246.15899999999965
[aiter INFO] 2025-10-23 03:36:35.408 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.75900000000183
[aiter INFO] 2025-10-23 03:36:35.428 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          3,213.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         23,926.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       27,698.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          277.0            276.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:35.428 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   276.93 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:35.994 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 287.37402139323774 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:36.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1272, 12}
[aiter INFO] 2025-10-23 03:36:36.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.59900000000016
[aiter INFO] 2025-10-23 03:36:36.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 173.03900000000002
[aiter INFO] 2025-10-23 03:36:36.063 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         16,832.1        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            170.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:36.089 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 74.00500980934294 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.758999999999958
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.198999999999955
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.038999999999987
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.11899999999997
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.679000000000002
[aiter INFO] 2025-10-23 03:36:36.124 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.399
[aiter INFO] 2025-10-23 03:36:36.125 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.31899999999996
[aiter INFO] 2025-10-23 03:36:36.125 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.999000000000024
[aiter INFO] 2025-10-23 03:36:36.125 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.038999999999987
[aiter INFO] 2025-10-23 03:36:36.125 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.99899999999991
[aiter INFO] 2025-10-23 03:36:36.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,418.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:36.138 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   185.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:36.163 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_d1a26c55dd35683a2070be5e8d9b93cf' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_d1a26c55dd35683a2070be5e8d9b93cf', 'folder': 'pa_d1a26c55dd35683a2070be5e8d9b93cf', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 64, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_d1a26c55dd35683a2070be5e8d9b93cf(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            64,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:36:36.163 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include -c pa_d1a26c55dd35683a2070be5e8d9b93cf.cpp -o pa_d1a26c55dd35683a2070be5e8d9b93cf.o
In file included from pa_d1a26c55dd35683a2070be5e8d9b93cf.cpp:1:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_d1a26c55dd35683a2070be5e8d9b93cf.cpp:1:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/quant_utils.cuh:19:
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_d1a26c55dd35683a2070be5e8d9b93cf.o -o lib.so
[aiter INFO] 2025-10-23 03:36:39.482 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_d1a26c55dd35683a2070be5e8d9b93cf, cost 3.31886776s
[aiter INFO] 2025-10-23 03:36:39.588 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 789.4220399384452 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:39.703 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {8, 64}
[aiter INFO] 2025-10-23 03:36:39.703 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 674.6030000000001
[aiter INFO] 2025-10-23 03:36:39.703 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.71899999999994
[aiter INFO] 2025-10-23 03:36:39.722 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          3,272.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         67,346.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       70,618.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          706.2            706.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:39.723 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   706.18 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:39.740 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:39.838 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 221.09381161113777 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21}
[aiter INFO] 2025-10-23 03:36:40.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.11899999999997
[aiter INFO] 2025-10-23 03:36:40.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999985
[aiter INFO] 2025-10-23 03:36:40.059 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,545.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         12,754.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,299.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          143.0            143.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.059 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   143.00 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:40.256 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 423.3946643843509 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1286, 136, 362, 12, 1101, 1294, 693, 1270, 1301, 1272, 829}
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.52100000000064
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 321.0809999999999
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.16100000000006
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.521
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.15900000000147
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.6790000000001
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.0789999999997
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.8409999999967
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.3610000000008
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.59899999999834
[aiter INFO] 2025-10-23 03:36:40.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 320.3590000000004
[aiter INFO] 2025-10-23 03:36:40.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 90.0            0.0         28,561.6        CUDA            5
[avg us/iter]               NaN  NaN            0.0            317.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.366 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.8009903867646 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.399 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {83, 6}
[aiter INFO] 2025-10-23 03:36:40.399 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.918999999999983
[aiter INFO] 2025-10-23 03:36:40.400 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.399000000000001
[aiter INFO] 2025-10-23 03:36:40.412 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            788.2        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.413 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   325.31 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:40.468 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 224.60033678182282 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.522 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {792, 753, 12, 1143}
[aiter INFO] 2025-10-23 03:36:40.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.91899999999987
[aiter INFO] 2025-10-23 03:36:40.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.88100000000031
[aiter INFO] 2025-10-23 03:36:40.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 106.47900000000001
[aiter INFO] 2025-10-23 03:36:40.523 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 103.84100000000035
[aiter INFO] 2025-10-23 03:36:40.535 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 97.0            0.0         10,175.9        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            104.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.561 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.93649457763917 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.595 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:40.595 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.158999999999992
[aiter INFO] 2025-10-23 03:36:40.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            799.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.609 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   112.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:40.658 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 181.83424773782787 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {325, 9, 240, 17, 248, 317}
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.239000000000033
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.59899999999999
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.35899999999992
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.239000000000033
[aiter INFO] 2025-10-23 03:36:40.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.35899999999992
[aiter INFO] 2025-10-23 03:36:40.732 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,540.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0          8,156.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,900.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           99.0             98.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.733 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    98.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:40.739 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:40.847 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 289.94591106282604 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1060, 1061, 9, 1006, 1007, 26}
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 188.6790000000001
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.71900000000096
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 187.92100000000002
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 188.6790000000001
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.078999999999724
[aiter INFO] 2025-10-23 03:36:40.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.038999999999987
[aiter INFO] 2025-10-23 03:36:40.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,644.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         18,235.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,310.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          213.1            213.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:40.939 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   213.06 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:41.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 2232.1386077616476 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:41.589 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:41.589 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2177.3250000000003
[aiter INFO] 2025-10-23 03:36:41.600 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                           name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_fp8 100.0            0.0        216,836.9        CUDA            5
[avg us/iter]               NaN   NaN            0.0          2,168.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:41.627 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.12063338614927 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:41.660 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:36:41.660 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:36:41.660 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-10-23 03:36:41.660 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.799000000000035
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999942
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.87899999999999
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.91900000000004
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.359000000000037
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.959000000000003
[aiter INFO] 2025-10-23 03:36:41.661 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-10-23 03:36:41.673 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,052.7        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:41.674 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:  2180.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:41.743 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 300.5974248494252 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:41.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1126, 12, 190}
[aiter INFO] 2025-10-23 03:36:41.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 187.3189999999995
[aiter INFO] 2025-10-23 03:36:41.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.919
[aiter INFO] 2025-10-23 03:36:41.804 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 190.83899999999994
[aiter INFO] 2025-10-23 03:36:41.817 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 98.0            0.0         18,520.7        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            189.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:41.844 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.9966730215762 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.558999999999969
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000028
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999976
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.239000000000033
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.718999999999937
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.598999999999933
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:36:41.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.958999999999946
[aiter INFO] 2025-10-23 03:36:41.891 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,052.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:41.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   200.95 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:41.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 264.7802968426506 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:42.020 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1096, 1097, 21, 9}
[aiter INFO] 2025-10-23 03:36:42.020 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 155.03900000000067
[aiter INFO] 2025-10-23 03:36:42.020 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.79899999999907
[aiter INFO] 2025-10-23 03:36:42.020 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.87900000000002
[aiter INFO] 2025-10-23 03:36:42.020 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 156.839
[aiter INFO] 2025-10-23 03:36:42.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,646.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         15,190.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,018.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          180.2            180.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:42.040 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   180.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:42.052 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:42.174 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 437.5147427072619 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:42.396 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {37, 9, 113, 146, 793, 761}
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.95900000000006
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 323.87899999999996
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 325.68100000000004
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.23900000000003
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.55899999999929
[aiter INFO] 2025-10-23 03:36:42.397 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 324.59900000000016
[aiter INFO] 2025-10-23 03:36:42.416 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          3,755.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         31,487.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       35,969.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          359.7            359.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:42.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   359.62 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:42.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 326.2589013222421 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:42.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:42.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 204.75900000000001
[aiter INFO] 2025-10-23 03:36:42.686 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 100.0            0.0         20,333.1        CUDA            5
[avg us/iter]                     NaN   NaN            0.0            203.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:42.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 78.56105946668305 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.799000000000035
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.038999999999987
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.119
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.359000000000037
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.319000000000017
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.158999999999992
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.11899999999997
[aiter INFO] 2025-10-23 03:36:42.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 24.71900000000005
[aiter INFO] 2025-10-23 03:36:42.759 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,952.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:42.760 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   224.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:42.851 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 413.0366338361608 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {736, 449, 35, 708, 9, 477}
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.23900000000049
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.799
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.278999999999996
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 293.91899999999987
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 295.27899999999994
[aiter INFO] 2025-10-23 03:36:42.929 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 38.319000000000415
[aiter INFO] 2025-10-23 03:36:42.948 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          3,750.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         28,634.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       33,049.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          330.5            330.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:42.949 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   330.46 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:42.968 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 64,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:43.100 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 512.4496339571358 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:43.192 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 44}
[aiter INFO] 2025-10-23 03:36:43.193 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 380.801
[aiter INFO] 2025-10-23 03:36:43.193 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.76100000000008
[aiter INFO] 2025-10-23 03:36:43.212 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          5,007.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         37,902.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       42,910.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          429.1            429.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:43.213 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   429.10 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:43.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 369.7046141813297 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:43.486 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1134}
[aiter INFO] 2025-10-23 03:36:43.486 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 270.19899999999996
[aiter INFO] 2025-10-23 03:36:43.486 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 262.28099999999904
[aiter INFO] 2025-10-23 03:36:43.497 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                 name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_fp8 99.0            0.0         26,276.5        CUDA            5
[avg us/iter]                     NaN  NaN            0.0            265.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:43.525 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 84.98362385400452 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.678999999999974
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.559
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.958999999999946
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.478999999999985
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.158999999999992
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.959
[aiter INFO] 2025-10-23 03:36:43.558 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 34.519000000000005
[aiter INFO] 2025-10-23 03:36:43.571 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,525.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:43.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   292.29 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:43.744 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1167.4750984305201 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:43.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {98, 9, 1036, 1037, 944, 945}
[aiter INFO] 2025-10-23 03:36:43.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.19900000000007
[aiter INFO] 2025-10-23 03:36:43.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1038.961
[aiter INFO] 2025-10-23 03:36:43.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1042.1630000000005
[aiter INFO] 2025-10-23 03:36:43.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.95900000000256
[aiter INFO] 2025-10-23 03:36:43.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1042.0430000000015
[aiter INFO] 2025-10-23 03:36:43.900 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.95899999999892
[aiter INFO] 2025-10-23 03:36:43.919 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          4,885.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0        101,630.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      108,700.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,087.0          1,086.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:43.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1086.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:43.948 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:44.018 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.38391122133424 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:44.074 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 17}
[aiter INFO] 2025-10-23 03:36:44.074 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.51899999999998
[aiter INFO] 2025-10-23 03:36:44.074 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:36:44.093 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            776.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0          8,485.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,261.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           92.6             92.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:44.094 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    92.62 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:44.727 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 313.81494131418737 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:44.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {75, 12}
[aiter INFO] 2025-10-23 03:36:44.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 205.19899999999996
[aiter INFO] 2025-10-23 03:36:44.923 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 206.63900000000004
[aiter INFO] 2025-10-23 03:36:44.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         20,190.0        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            203.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:44.959 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.79744553329921 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:44.994 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {160, 6, 692, 20, 503}
[aiter INFO] 2025-10-23 03:36:44.995 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.358999999999924
[aiter INFO] 2025-10-23 03:36:44.995 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.878999999999991
[aiter INFO] 2025-10-23 03:36:44.995 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.639000000000124
[aiter INFO] 2025-10-23 03:36:44.995 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.359000000000037
[aiter INFO] 2025-10-23 03:36:44.995 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.2390000000004875
[aiter INFO] 2025-10-23 03:36:45.007 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0            554.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              5.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:45.008 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   209.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:45.288 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 171.27221763724148 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:45.342 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {38, 649, 12, 493, 753}
[aiter INFO] 2025-10-23 03:36:45.342 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.478999999999985
[aiter INFO] 2025-10-23 03:36:45.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.59900000000016
[aiter INFO] 2025-10-23 03:36:45.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.43899999999999
[aiter INFO] 2025-10-23 03:36:45.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.59899999999925
[aiter INFO] 2025-10-23 03:36:45.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.47900000000027
[aiter INFO] 2025-10-23 03:36:45.355 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0          4,951.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             51.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:45.381 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.15668294453386 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:45.421 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:45.421 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 5.998999999999995
[aiter INFO] 2025-10-23 03:36:45.434 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            585.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              5.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:45.435 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    57.44 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:45.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 139.77630657724816 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:45.530 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {39, 9, 42, 16, 625, 50, 20, 633, 28, 31}
[aiter INFO] 2025-10-23 03:36:45.530 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-10-23 03:36:45.530 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.678999999999974
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.71900000000005
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.5989999999999895
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.67900000000009
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.558999999999969
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.759000000000015
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.519000000000233
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.63900000000001
[aiter INFO] 2025-10-23 03:36:45.531 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.718999999999994
[aiter INFO] 2025-10-23 03:36:45.550 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            642.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          4,823.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,700.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           57.0             56.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:45.551 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    56.94 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:45.553 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:45.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 203.49413805668897 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:45.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:36:45.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.15899999999999
[aiter INFO] 2025-10-23 03:36:45.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.481000000000051
[aiter INFO] 2025-10-23 03:36:45.710 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,056.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         11,851.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,907.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          129.1            129.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:45.711 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   129.07 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:46.665 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1441.3814768932834 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:46.844 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:46.844 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1342.083
[aiter INFO] 2025-10-23 03:36:46.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0        133,815.2        CUDA            5
[avg us/iter]                       NaN   NaN            0.0          1,338.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:46.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.14557461042216 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:46.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {132, 6}
[aiter INFO] 2025-10-23 03:36:46.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.95900000000006
[aiter INFO] 2025-10-23 03:36:46.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:36:46.931 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 99.0            0.0            668.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:46.932 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:  1344.91 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:47.208 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 174.16692001394708 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:47.260 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1195, 12}
[aiter INFO] 2025-10-23 03:36:47.260 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.318999999999505
[aiter INFO] 2025-10-23 03:36:47.260 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 54.239000000000004
[aiter INFO] 2025-10-23 03:36:47.273 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          5,254.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             53.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:47.298 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 67.65329701328042 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:47.475 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:47.476 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-10-23 03:36:47.488 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            678.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:47.489 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    59.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:47.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 185.91230635595792 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 39, 72, 9, 17, 53, 61, 31}
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.11900000000003
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.718999999999937
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.240999999999985
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 93.11900000000003
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.038999999999987
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.399
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.239000000000033
[aiter INFO] 2025-10-23 03:36:47.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.399
[aiter INFO] 2025-10-23 03:36:47.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0            999.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0          8,884.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,196.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          102.0            101.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:47.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   101.89 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:47.618 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:47.700 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 297.85525651261355 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:47.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 28, 1094, 1095}
[aiter INFO] 2025-10-23 03:36:47.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 214.72100000000003
[aiter INFO] 2025-10-23 03:36:47.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:36:47.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 211.87900000000081
[aiter INFO] 2025-10-23 03:36:47.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.71900000000096
[aiter INFO] 2025-10-23 03:36:47.796 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,364.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         20,749.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,340.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          223.4            223.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:47.797 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   223.37 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:48.195 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 201.77217860623162 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:48.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {233, 12}
[aiter INFO] 2025-10-23 03:36:48.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.7189999999996
[aiter INFO] 2025-10-23 03:36:48.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.63900000000001
[aiter INFO] 2025-10-23 03:36:48.259 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          8,121.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             82.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:48.286 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.4283665996967 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:48.323 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:48.323 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.718999999999994
[aiter INFO] 2025-10-23 03:36:48.336 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            836.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:48.337 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    90.40 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:48.398 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 271.09833637086473 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {39, 713, 9, 1110, 1111, 25, 27, 731}
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999937
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.07900000000063
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.841
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 171.03900000000067
[aiter INFO] 2025-10-23 03:36:48.460 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.47899999999936
[aiter INFO] 2025-10-23 03:36:48.461 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.67900000000003
[aiter INFO] 2025-10-23 03:36:48.461 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 172.71900000000005
[aiter INFO] 2025-10-23 03:36:48.461 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.079000000000633
[aiter INFO] 2025-10-23 03:36:48.480 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,343.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         16,627.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,528.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          185.3            185.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:48.481 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   185.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:48.486 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:48.572 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 341.5528125692122 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:48.652 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 29}
[aiter INFO] 2025-10-23 03:36:48.652 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 250.681
[aiter INFO] 2025-10-23 03:36:48.652 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.079000000000008
[aiter INFO] 2025-10-23 03:36:48.671 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,788.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         24,880.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       26,669.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          266.7            266.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:48.672 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   266.70 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]


NaN info:
{}
out_ref_md5=c43a53ce78c2b460766b1ad92e04c2b1
gluon_fp8_output_md5=3d6aed0e477c5f1c3e646c75e614e767
diff.abs.max=0.00315093994140625
max_diff_thr=0.0031376301776617765

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.0013427734375
max_diff_thr=0.0013265798334032297

NaN info:
{}
out_ref_md5=a88df53730584bb579d0dee248cf83fe
gluon_fp8_output_md5=c07163b722b88e7a0ef8a3e876adf732
diff.abs.max=0.0030517578125
max_diff_thr=0.00301841227337718

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.0012598037719726562
max_diff_thr=0.0012597545282915235

NaN info:
{}
out_ref_md5=4342585a97cd22f6ca15368629b67597
gluon_fp8_output_md5=9885e1f81e525f6af0f5912aa2eee6a9
diff.abs.max=0.00334930419921875
max_diff_thr=0.003346419194713235

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.001690514967776835

NaN info:
{}
out_ref_md5=3b72ac5afae225b0f37bceaa727fe031
triton_fp8_output_md5=2ad95f3d7a8d38e9fb4dfd5e5b3818b1
diff.abs.max=0.00140380859375
max_diff_thr=0.001392842037603259

NaN info:
{}
out_ref_md5=3b72ac5afae225b0f37bceaa727fe031
gluon_fp8_output_md5=c6d9fc737f3604b38233b4c85039efbd
diff.abs.max=0.0029144287109375
max_diff_thr=0.002903573913499713

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.00189208984375
max_diff_thr=0.001874811016023159

NaN info:
{}
out_ref_md5=78a3b43bfe8b00c82a1ed8e78e6baa8a
triton_fp8_output_md5=a47cad4d2a1f5433e914573dbca5c1cc
diff.abs.max=0.001220703125
max_diff_thr=0.0011973179643973708

NaN info:
{}
out_ref_md5=78a3b43bfe8b00c82a1ed8e78e6baa8a
gluon_fp8_output_md5=2ea8cd2f0670b6f31c812935db5f104b
diff.abs.max=0.0032958984375
max_diff_thr=0.003235082607716322

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.0012969970703125
max_diff_thr=0.0012936413986608386

NaN info:
{}
out_ref_md5=943e3240640ffea06e574b7e59dbe7dc
gluon_fp8_output_md5=8b0942b154742fe7d4c0a2fa3e9685c9
diff.abs.max=0.003448486328125
max_diff_thr=0.0034155482426285744

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([20480, 1, 4, 128, 16])
diff.abs.max=0.0013003349304199219
max_diff_thr=0.001300279749557376

NaN info:
{}
out_ref_md5=847e0d7e9d0855356490f3e9df17d000
gluon_fp8_output_md5=bbc16f7f52bd2c5d491dde1934f3f7fd
diff.abs.max=0.003173828125
max_diff_thr=0.0031402253080159426

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017861395608633757

NaN info:
{}
out_ref_md5=94489c3c698eee7be77d1d18260df2b8
triton_fp8_output_md5=eac13582a131d443005d8c773be315fd
diff.abs.max=0.00115966796875
max_diff_thr=0.0011423074174672365

NaN info:
{}
out_ref_md5=94489c3c698eee7be77d1d18260df2b8
gluon_fp8_output_md5=52485e5c25080d54625b6f3b481c36be
diff.abs.max=0.002956390380859375
max_diff_thr=0.002954035298898816

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.001953125
max_diff_thr=0.0019038553582504392

NaN info:
{}
out_ref_md5=55b5e592342d7834809ca1f385d86a45
triton_fp8_output_md5=c0930415bb959849ea9c8834f92090b4
diff.abs.max=0.001251220703125
max_diff_thr=0.001241784542798996

NaN info:
{}
out_ref_md5=55b5e592342d7834809ca1f385d86a45
gluon_fp8_output_md5=21e109fa0636d06aa26a166fdd1cfcef
diff.abs.max=0.0031585693359375
max_diff_thr=0.0031419810838997364

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.001251220703125
max_diff_thr=0.0012487774947658181

NaN info:
{}
out_ref_md5=9d0aa4459c3f036e1cc3234e8e6cb508
gluon_fp8_output_md5=ae53ffb16b05ab39b1385fb6e7481ac9
diff.abs.max=0.00341796875
max_diff_thr=0.0033818467054516077

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([32768, 1, 4, 128, 16])
diff.abs.max=0.0013427734375
max_diff_thr=0.0013399111339822412

NaN info:
{}
out_ref_md5=73c9c0c6d80b1d09a8fbdec5a4678be3
gluon_fp8_output_md5=ca3627b60de566990777ec6d481ede98
diff.abs.max=0.00334930419921875
max_diff_thr=0.0033485633321106434

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016911276616156101

NaN info:
{}
out_ref_md5=b592c14b720b0226bdf1259b7afc6566
triton_fp8_output_md5=8f3707e655c33970128686cbfb588ef2
diff.abs.max=0.001129150390625
max_diff_thr=0.0011247567599639297

NaN info:
{}
out_ref_md5=b592c14b720b0226bdf1259b7afc6566
gluon_fp8_output_md5=6141ce86af1692b253900c9231d856e3
diff.abs.max=0.0029296875
max_diff_thr=0.002901880070567131

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.00177001953125
max_diff_thr=0.0017537494422867894

NaN info:
{}
out_ref_md5=34ec31ca92d701b96058801dee997015
triton_fp8_output_md5=1a33040ac315fd5072dd4f487c8a8bd8
diff.abs.max=0.001220703125
max_diff_thr=0.001182312611490488

NaN info:
{}
out_ref_md5=34ec31ca92d701b96058801dee997015
gluon_fp8_output_md5=bdaa32f77fb397df54025bd919f37df2
diff.abs.max=0.002899169921875
max_diff_thr=0.002881145104765892

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001251220703125
max_diff_thr=0.0012453299714252353

NaN info:
{}
out_ref_md5=326e09bafa860632a7e52f50d7f6febc
gluon_fp8_output_md5=cb9cb062d92c79edeef5e5548dbaae5e
diff.abs.max=0.003143310546875
max_diff_thr=0.0031237679067999125

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])[aiter INFO] 2025-10-23 03:36:49.065 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 205.65930746569492 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:49.117 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:49.117 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.43900000000002
[aiter INFO] 2025-10-23 03:36:49.128 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 100.0            0.0          8,278.3        CUDA            5
[avg us/iter]                             NaN   NaN            0.0             82.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:49.155 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.25922804952849 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:49.190 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:49.191 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.479000000000013
[aiter INFO] 2025-10-23 03:36:49.203 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            957.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:49.204 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    92.36 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:49.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 757.0500468263531 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:49.560 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 939, 908, 63}
[aiter INFO] 2025-10-23 03:36:49.560 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 654.3209999999999
[aiter INFO] 2025-10-23 03:36:49.560 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.71899999999914
[aiter INFO] 2025-10-23 03:36:49.560 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 664.7630000000008
[aiter INFO] 2025-10-23 03:36:49.560 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.878999999999905
[aiter INFO] 2025-10-23 03:36:49.579 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,758.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         65,132.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       67,573.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          675.7            675.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:49.580 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   675.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:49.589 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:49.687 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 212.66250533632714 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:49.758 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 21}
[aiter INFO] 2025-10-23 03:36:49.758 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 134.519
[aiter INFO] 2025-10-23 03:36:49.758 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000017
[aiter INFO] 2025-10-23 03:36:49.777 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0            944.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         12,932.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,877.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          138.8            138.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:49.778 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   138.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:49.973 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 427.32651546449944 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:50.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 329.721
[aiter INFO] 2025-10-23 03:36:50.058 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         32,370.9        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            323.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.084 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.40339594194205 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.117 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:50.117 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.119
[aiter INFO] 2025-10-23 03:36:50.129 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            689.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.130 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   330.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:50.178 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 200.91949418039607 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 766}
[aiter INFO] 2025-10-23 03:36:50.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.15899999999996
[aiter INFO] 2025-10-23 03:36:50.233 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.16100000000006
[aiter INFO] 2025-10-23 03:36:50.246 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          7,849.6        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             79.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.271 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.96933699303334 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.307 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:50.307 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.919000000000011
[aiter INFO] 2025-10-23 03:36:50.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            687.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.320 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    86.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:50.364 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 166.3514254706921 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {325, 1065, 9, 1073, 17, 20, 790, 28, 317, 798}
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.878999999999905
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.91899999999987
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.12099999999998
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.958999999998923
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.959000000000003
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.47899999999998
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.4409999999998
[aiter INFO] 2025-10-23 03:36:50.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.319000000000017
[aiter INFO] 2025-10-23 03:36:50.418 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.43899999999985
[aiter INFO] 2025-10-23 03:36:50.418 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.798999999999978
[aiter INFO] 2025-10-23 03:36:50.437 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0            858.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          7,272.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,467.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           84.7             84.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.437 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    84.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:50.441 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:50.543 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 271.53671259927273 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 943, 1048, 1049, 26, 925}
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 184.479
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.198999999998705
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 182.72099999999955
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.679000000000087
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:36:50.612 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.0010000000002
[aiter INFO] 2025-10-23 03:36:50.631 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,482.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         17,798.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,680.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          196.8            196.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:50.632 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   196.75 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:51.016 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 2229.8158371802606 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:51.272 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:51.272 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 2145.525
[aiter INFO] 2025-10-23 03:36:51.283 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0        213,857.2        CUDA            5
[avg us/iter]                       NaN   NaN            0.0          2,138.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:51.309 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.24379199979329 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:51.341 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:51.341 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999997
[aiter INFO] 2025-10-23 03:36:51.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            793.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:51.354 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:  2146.50 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:51.406 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 200.4553563524001 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:51.458 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 415}
[aiter INFO] 2025-10-23 03:36:51.458 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.19900000000001
[aiter INFO] 2025-10-23 03:36:51.458 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.07900000000001
[aiter INFO] 2025-10-23 03:36:51.458 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.27900000000045
[aiter INFO] 2025-10-23 03:36:51.470 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          7,974.7        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             81.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:51.496 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.72380174268591 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:51.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:51.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.278999999999996
[aiter INFO] 2025-10-23 03:36:51.677 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            795.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:51.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    89.33 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:51.735 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 239.68199957715402 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1060, 37, 1061, 9, 942, 21, 953, 26}
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 140.11899999999878
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.03900000000067
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.59900000000002
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 141.91899999999987
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.319000000001324
[aiter INFO] 2025-10-23 03:36:51.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 142.161
[aiter INFO] 2025-10-23 03:36:51.813 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,465.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         13,688.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,624.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          156.2            156.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:51.814 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   156.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:51.820 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:51.937 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 380.9355346873255 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.013 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 30}
[aiter INFO] 2025-10-23 03:36:52.013 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 233.88100000000003
[aiter INFO] 2025-10-23 03:36:52.013 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.87900000000002
[aiter INFO] 2025-10-23 03:36:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,777.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         23,066.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       24,843.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          248.4            248.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   248.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:52.212 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 243.47684200447384 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.266 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {129, 168, 363, 12, 207, 272, 337, 116, 246, 376, 25}
[aiter INFO] 2025-10-23 03:36:52.266 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.87900000000013
[aiter INFO] 2025-10-23 03:36:52.266 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.19900000000007
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.12099999999964
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.479
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.1210000000001
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.7189999999996
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.52100000000019
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.28099999999995
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.20100000000002
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.75900000000001
[aiter INFO] 2025-10-23 03:36:52.267 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 121.87900000000002
[aiter INFO] 2025-10-23 03:36:52.278 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 90.0            0.0         11,176.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            124.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.305 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.37131690979004 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:52.340 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999984
[aiter INFO] 2025-10-23 03:36:52.352 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0          1,120.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0             11.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   135.39 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:52.415 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 290.2623668755635 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 1060, 1061}
[aiter INFO] 2025-10-23 03:36:52.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 189.83900000000003
[aiter INFO] 2025-10-23 03:36:52.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.838999999999999
[aiter INFO] 2025-10-23 03:36:52.480 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 186.75900000000001
[aiter INFO] 2025-10-23 03:36:52.480 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.638999999999214
[aiter INFO] 2025-10-23 03:36:52.499 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,750.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         18,602.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       20,557.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          205.6            205.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.500 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   205.58 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:52.508 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    8
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:52.623 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 378.7439005209668 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {35, 9, 1034, 1035, 1070, 1071}
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.079000000000065
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 274.761
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 274.4390000000021
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.638999999999214
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 270.5609999999979
[aiter INFO] 2025-10-23 03:36:52.706 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.47899999999936
[aiter INFO] 2025-10-23 03:36:52.725 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,212.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         26,704.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       29,507.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          295.1            295.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.726 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   295.08 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:52.907 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 245.524001003492 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:52.961 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 51, 12}
[aiter INFO] 2025-10-23 03:36:52.961 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.79899999999998
[aiter INFO] 2025-10-23 03:36:52.961 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.47900000000004
[aiter INFO] 2025-10-23 03:36:52.961 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.279
[aiter INFO] 2025-10-23 03:36:52.972 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         12,259.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            125.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:52.999 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.68143552423705 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6, 41, 76, 146, 83}
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.438999999999993
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.838999999999999
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:36:53.031 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:36:53.044 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 96.0            0.0          1,160.3        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:53.044 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   137.19 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:53.197 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1103.499168216592 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:53.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1050, 1051, 98}
[aiter INFO] 2025-10-23 03:36:53.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1010.5229999999999
[aiter INFO] 2025-10-23 03:36:53.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1014.7609999999986
[aiter INFO] 2025-10-23 03:36:53.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.559000000008382
[aiter INFO] 2025-10-23 03:36:53.346 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.119000000000142
[aiter INFO] 2025-10-23 03:36:53.365 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,230.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         99,512.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      102,779.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,027.8          1,027.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:53.366 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1027.70 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:53.381 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:53.448 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 162.36769297335408 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:53.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:36:53.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 86.59899999999996
[aiter INFO] 2025-10-23 03:36:53.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.63900000000001
[aiter INFO] 2025-10-23 03:36:53.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.959000000000003
[aiter INFO] 2025-10-23 03:36:53.645 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.478999999999985
[aiter INFO] 2025-10-23 03:36:53.664 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            684.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0          8,081.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,857.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           88.6             88.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:53.665 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    88.54 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:54.284 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 309.1119427492123 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1283, 12, 50, 25, 1308, 1247}
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.71899999999914
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 202.921
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.639
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.67900000000003
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.60099999999875
[aiter INFO] 2025-10-23 03:36:54.353 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 200.5609999999997
[aiter INFO] 2025-10-23 03:36:54.364 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 95.0            0.0         18,977.3        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            199.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:54.391 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.97173235262974 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:54.426 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:54.426 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.438999999999993
[aiter INFO] 2025-10-23 03:36:54.439 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            605.8        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:54.440 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   205.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:54.713 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 170.35265429185168 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 1286, 12, 51, 25}
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.47900000000004
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.759000000000015
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 52.47900000000004
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.399
[aiter INFO] 2025-10-23 03:36:54.768 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.958999999999946
[aiter INFO] 2025-10-23 03:36:54.780 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0          4,866.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             50.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:54.806 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.56494068450267 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:54.847 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:54.847 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.238999999999976
[aiter INFO] 2025-10-23 03:36:54.859 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            607.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:54.860 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    56.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1E Success
[aiter INFO] 2025-10-23 03:36:54.892 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 43.76725741837284 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:54.917 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {32, 4, 23}
[aiter INFO] 2025-10-23 03:36:54.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.238999999999976
[aiter INFO] 2025-10-23 03:36:54.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.15899999999999
[aiter INFO] 2025-10-23 03:36:54.918 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 31.518999999999977
[aiter INFO] 2025-10-23 03:36:54.933 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1  98.0            0.0          2,871.5        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        2,934.2              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           29.3             29.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:54.934 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    29.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:54.957 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 134.59491036315956 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {512, 38, 9, 42, 49, 17, 20, 53, 504, 27, 60, 31}
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.878999999999962
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.59899999999999
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.919000000000096
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999999
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 48.11899999999997
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 46.958999999999946
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.198999999999614
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.918999999999983
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 6.838999999999942
[aiter INFO] 2025-10-23 03:36:55.019 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 47.55899999999997
[aiter INFO] 2025-10-23 03:36:55.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            652.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0          4,359.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,282.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           52.8             52.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:55.039 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    52.75 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:55.041 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:55.126 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 190.00973191001628 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1100, 1101, 1104, 1105, 19}
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 109.11900000000003
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.60100000000057
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.079000000001543
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 105.64099999999962
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.559000000001106
[aiter INFO] 2025-10-23 03:36:55.180 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.999000000000024
[aiter INFO] 2025-10-23 03:36:55.200 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          1,053.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         10,167.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       11,453.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          114.5            114.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:55.200 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   114.50 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:56.025 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 385.32924622592355 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {177, 658, 12}
[aiter INFO] 2025-10-23 03:36:56.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 273.55899999999997
[aiter INFO] 2025-10-23 03:36:56.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 275.0010000000002
[aiter INFO] 2025-10-23 03:36:56.098 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 276.52099999999996
[aiter INFO] 2025-10-23 03:36:56.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 98.0            0.0         26,882.0        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            274.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.137 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.05287113225106 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.166 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:56.166 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.518999999999977
[aiter INFO] 2025-10-23 03:36:56.178 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            801.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.179 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   282.32 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:56.639 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 199.23590094146164 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {753, 12, 246}
[aiter INFO] 2025-10-23 03:36:56.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.03899999999976
[aiter INFO] 2025-10-23 03:36:56.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 82.439
[aiter INFO] 2025-10-23 03:36:56.694 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.83899999999994
[aiter INFO] 2025-10-23 03:36:56.707 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          7,817.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             79.8         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.733 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.74437630176544 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.772 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:56.772 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.35899999999998
[aiter INFO] 2025-10-23 03:36:56.784 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            800.5        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.785 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    87.77 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1E Success
[aiter INFO] 2025-10-23 03:36:56.824 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 65.04218774561835 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 35, 4, 13}
[aiter INFO] 2025-10-23 03:36:56.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.279000000000025
[aiter INFO] 2025-10-23 03:36:56.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.03899999999999
[aiter INFO] 2025-10-23 03:36:56.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.59900000000002
[aiter INFO] 2025-10-23 03:36:56.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.79899999999998
[aiter INFO] 2025-10-23 03:36:56.868 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1  97.0            0.0          4,883.8        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,035.9              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           50.4             50.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.868 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    50.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:56.899 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 183.46713852174213 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:56.962 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 764, 773, 40, 73, 42, 9, 17, 50, 20, 28, 31}
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.59900000000005
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.51900000000023
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.999000000000706
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.479000000000042
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.31899999999996
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 91.15899999999999
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.11899999999997
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.558999999999969
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.678999999999974
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.92099999999999
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.199000000000012
[aiter INFO] 2025-10-23 03:36:56.963 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 92.15899999999999
[aiter INFO] 2025-10-23 03:36:56.982 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0          1,020.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0          8,637.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,174.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          101.7            101.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:56.983 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   101.67 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:56.988 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:57.079 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 240.28237636136538 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {454, 904, 9, 108, 437, 25, 921, 91, 1054, 1055}
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.239000000000487
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 152.27900000000045
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.39900000000003
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.35899999999947
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.59899999999999
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.278999999998632
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 152.87900000000013
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 151.15899999999965
[aiter INFO] 2025-10-23 03:36:57.139 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.198999999998705
[aiter INFO] 2025-10-23 03:36:57.158 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,378.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         14,337.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,380.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          163.8            163.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:57.159 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   163.71 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:57.540 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 204.5242181508848 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:57.598 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {857, 844, 12}
[aiter INFO] 2025-10-23 03:36:57.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.35900000000038
[aiter INFO] 2025-10-23 03:36:57.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.1190000000006
[aiter INFO] 2025-10-23 03:36:57.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.87900000000002
[aiter INFO] 2025-10-23 03:36:57.611 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          8,026.2        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             81.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:57.638 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.3404356896287 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:57.668 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:57.668 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.879000000000019
[aiter INFO] 2025-10-23 03:36:57.680 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            900.3        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.0         NaN          NaN
[aiter INFO] 2025-10-23 03:36:57.681 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    90.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1E Success
[aiter INFO] 2025-10-23 03:36:57.721 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 65.75390113757389 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:57.747 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 187, 492, 4}
[aiter INFO] 2025-10-23 03:36:57.748 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.63899999999998
[aiter INFO] 2025-10-23 03:36:57.748 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 51.47899999999993
[aiter INFO] 2025-10-23 03:36:57.748 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 50.48100000000068
[aiter INFO] 2025-10-23 03:36:57.748 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 53.959
[aiter INFO] 2025-10-23 03:36:57.763 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1  97.0            0.0          4,936.9        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,090.5              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           50.9             50.9         NaN          NaN
[aiter INFO] 2025-10-23 03:36:57.764 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    50.90 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:57.802 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 222.83320748569943 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:57.866 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {19, 9, 1058, 1059}
[aiter INFO] 2025-10-23 03:36:57.866 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.63900000000001
[aiter INFO] 2025-10-23 03:36:57.866 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.75900000000001
[aiter INFO] 2025-10-23 03:36:57.866 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.5609999999997
[aiter INFO] 2025-10-23 03:36:57.866 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.238999999999578
[aiter INFO] 2025-10-23 03:36:57.885 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,420.4        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         12,197.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,754.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          137.5            137.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:57.886 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   137.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:57.893 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:57.986 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 278.18862400432624 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:58.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 458, 26, 476}
[aiter INFO] 2025-10-23 03:36:58.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 182.51899999999998
[aiter INFO] 2025-10-23 03:36:58.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 182.2390000000005
[aiter INFO] 2025-10-23 03:36:58.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.08099999999996
[aiter INFO] 2025-10-23 03:36:58.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.078999999999724
[aiter INFO] 2025-10-23 03:36:58.066 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,777.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         17,737.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       19,715.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          197.2            197.1         NaN          NaN
[aiter INFO] 2025-10-23 03:36:58.067 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   197.12 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:58.663 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 258.9169206595657 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:58.722 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:58.722 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.519
[aiter INFO] 2025-10-23 03:36:58.735 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 100.0            0.0         14,154.6        CUDA            5
[avg us/iter]                             NaN   NaN            0.0            141.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:58.762 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.59271261302553 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 104, 41, 76, 13, 111, 48, 83, 20, 118, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.999000000000024
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.199000000000012
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.119000000000028
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.279000000000053
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.238999999999919
[aiter INFO] 2025-10-23 03:36:58.792 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.879000000000019
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999915
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.198999999999955
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.99899999999991
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.839000000000055
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.759000000000015
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.038999999999987
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.99899999999991
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.079000000000008
[aiter INFO] 2025-10-23 03:36:58.793 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.839000000000055
[aiter INFO] 2025-10-23 03:36:58.805 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 84.0            0.0            880.0        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             10.5         NaN          NaN
[aiter INFO] 2025-10-23 03:36:58.806 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   152.02 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter] hipModuleLoad: /mnt/raid0/heyanguang/code/fa_triton/aiter/hsa/gfx942/pa/pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1.co GetFunction: _ZN5aiter43pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1E Success
[aiter INFO] 2025-10-23 03:36:58.852 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 81.17374209779324 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {163, 4, 364, 47, 17, 505, 31}
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.03899999999999
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 68.51899999999998
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.67899999999986
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.719
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.43900000000002
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 65.9989999999998
[aiter INFO] 2025-10-23 03:36:58.881 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 66.91899999999998
[aiter INFO] 2025-10-23 03:36:58.897 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1  94.0            0.0          6,236.8        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        6,634.6              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           66.3             66.3         NaN          NaN
[aiter INFO] 2025-10-23 03:36:58.897 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    66.35 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:58.992 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 732.4935652241849 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {64, 9, 1062, 1063}
[aiter INFO] 2025-10-23 03:36:59.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 16.239000000000033
[aiter INFO] 2025-10-23 03:36:59.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 631.601
[aiter INFO] 2025-10-23 03:36:59.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 640.1630000000005
[aiter INFO] 2025-10-23 03:36:59.111 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.39900000000489
[aiter INFO] 2025-10-23 03:36:59.130 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,801.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0         62,769.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       65,229.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          652.3            652.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.130 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   652.23 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:59.141 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:36:59.251 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 209.1115937374606 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {193, 9, 1100, 845, 1101, 177, 403, 19, 860, 413, 1086, 1087}
[aiter INFO] 2025-10-23 03:36:59.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.679000000000087
[aiter INFO] 2025-10-23 03:36:59.310 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.35900000000004
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.16100000000006
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.23899999999958
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.918999999999869
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.47899999999981
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.08100000000013
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.519000000000005
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.879000000000815
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.918999999999869
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 129.75900000000001
[aiter INFO] 2025-10-23 03:36:59.311 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.958999999998923
[aiter INFO] 2025-10-23 03:36:59.330 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            933.1        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  95.0            0.0         12,134.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       13,764.5              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          137.6            137.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.331 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   137.55 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:59.510 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 425.5040199449747 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.587 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:36:59.587 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 326.92099999999994
[aiter INFO] 2025-10-23 03:36:59.599 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         32,322.3        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            323.2         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.625 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 68.8350695637193 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.656 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:59.656 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.518999999999977
[aiter INFO] 2025-10-23 03:36:59.668 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            738.7        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   330.61 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:59.719 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 198.79237599302047 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.773 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 454, 1247}
[aiter INFO] 2025-10-23 03:36:59.773 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.399
[aiter INFO] 2025-10-23 03:36:59.773 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.47899999999998
[aiter INFO] 2025-10-23 03:36:59.773 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.67900000000009
[aiter INFO] 2025-10-23 03:36:59.773 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.27900000000045
[aiter INFO] 2025-10-23 03:36:59.785 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0          7,624.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             78.6         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.812 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.37092084872842 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:36:59.849 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.59899999999999
[aiter INFO] 2025-10-23 03:36:59.861 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            738.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.4         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.862 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    85.99 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:59.897 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.42795065605995 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:36:59.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {26, 4, 470}
[aiter INFO] 2025-10-23 03:36:59.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 57.63899999999998
[aiter INFO] 2025-10-23 03:36:59.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 61.718999999999994
[aiter INFO] 2025-10-23 03:36:59.924 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 56.439000000000306
[aiter INFO] 2025-10-23 03:36:59.940 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen1_msk1  98.0            0.0          5,457.1        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        5,571.2              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           55.7             55.7         NaN          NaN
[aiter INFO] 2025-10-23 03:36:59.940 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    55.68 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:36:59.966 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 160.44171302035303 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {39, 9, 592, 17, 20, 831, 1109, 823, 600, 1111, 28, 31}
[aiter INFO] 2025-10-23 03:37:00.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-10-23 03:37:00.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 74.719
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 69.83899999999994
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.63900000000001
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 71.75900000000001
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000233
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.95900000000074
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.39899999999943
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.15899999999965
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.638999999999214
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.278999999999996
[aiter INFO] 2025-10-23 03:37:00.024 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 70.839
[aiter INFO] 2025-10-23 03:37:00.043 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  95.0            0.0            884.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  95.0            0.0          6,636.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        7,920.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           79.2             79.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.044 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    79.17 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:00.047 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:00.163 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 255.6285858154297 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {641, 322, 229, 9, 715, 622, 339, 244, 25, 732}
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.759000000000015
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.04100000000017
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.07900000000018
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 164.799
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 162.8789999999999
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 163.07899999999972
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.519000000000233
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.678999999999633
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.038999999999987
[aiter INFO] 2025-10-23 03:37:00.221 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.679000000000087
[aiter INFO] 2025-10-23 03:37:00.240 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,498.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         15,512.5        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,725.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          177.3            177.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.241 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   177.20 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:00.435 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 555.3919885418203 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.657 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:37:00.657 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 448.72099999999995
[aiter INFO] 2025-10-23 03:37:00.670 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         44,527.0        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            445.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.697 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.22318808513113 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.727 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:00.727 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.35899999999998
[aiter INFO] 2025-10-23 03:37:00.739 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            988.9        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.740 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   455.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:00.799 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 244.41193103200138 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {389, 12, 272, 181, 285}
[aiter INFO] 2025-10-23 03:37:00.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.67900000000009
[aiter INFO] 2025-10-23 03:37:00.854 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.761
[aiter INFO] 2025-10-23 03:37:00.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.279
[aiter INFO] 2025-10-23 03:37:00.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.23900000000003
[aiter INFO] 2025-10-23 03:37:00.855 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.279
[aiter INFO] 2025-10-23 03:37:00.867 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0         11,912.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            124.1         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.893 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.13806903775375 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:00.927 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:00.927 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.87899999999999
[aiter INFO] 2025-10-23 03:37:00.940 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            992.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:00.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   134.01 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:00.984 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.00785109666315 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.017 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {24, 4, 456}
[aiter INFO] 2025-10-23 03:37:01.017 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.44100000000003
[aiter INFO] 2025-10-23 03:37:01.017 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.279
[aiter INFO] 2025-10-23 03:37:01.017 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 96.8789999999999
[aiter INFO] 2025-10-23 03:37:01.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen2_msk1  98.0            0.0          9,547.7        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        9,741.0              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           97.4             97.4         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.033 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    97.43 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.072 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 240.74932667288448 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {37, 9, 235, 1070, 1071, 25, 27, 252}
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.558999999999969
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.64100000000002
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 143.19900000000007
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.4390000000003
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.918999999999869
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.478999999999985
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 144.719
[aiter INFO] 2025-10-23 03:37:01.140 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.478999999999814
[aiter INFO] 2025-10-23 03:37:01.160 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          1,509.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         13,967.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       15,955.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          159.6            159.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.160 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   159.55 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.169 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:01.293 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 333.8692377109339 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.362 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 1072, 1073, 1010, 211, 1011, 1076, 1077, 185, 30}
[aiter INFO] 2025-10-23 03:37:01.362 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 238.23899999999998
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 238.07900000000154
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.59899999999834
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 238.19900000000052
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.518999999999778
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.519000000000233
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 237.479000000003
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.639000000002852
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 237.92099999999982
[aiter INFO] 2025-10-23 03:37:01.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.079000000000008
[aiter INFO] 2025-10-23 03:37:01.382 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          2,063.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  96.0            0.0         22,587.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       25,688.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          256.9            256.8         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.383 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   256.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.551 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 247.9552777096777 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {440, 12, 789, 38}
[aiter INFO] 2025-10-23 03:37:01.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 125.39899999999943
[aiter INFO] 2025-10-23 03:37:01.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.359
[aiter INFO] 2025-10-23 03:37:01.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 127.91899999999987
[aiter INFO] 2025-10-23 03:37:01.608 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.23900000000003
[aiter INFO] 2025-10-23 03:37:01.620 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0         12,274.9        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            126.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.648 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.12220781510419 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.677 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {97, 34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.759000000000015
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.799000000000035
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.119000000000028
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.839000000000027
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.879000000000019
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.7589999999999
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.718999999999994
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.600999999999999
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.999000000000024
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.798999999999978
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.878999999999962
[aiter INFO] 2025-10-23 03:37:01.678 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.678999999999974
[aiter INFO] 2025-10-23 03:37:01.690 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 87.0            0.0          1,009.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.691 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   138.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.739 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 111.69583180753312 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.775 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 4, 505, 414}
[aiter INFO] 2025-10-23 03:37:01.775 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.35900000000001
[aiter INFO] 2025-10-23 03:37:01.775 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 101.75900000000001
[aiter INFO] 2025-10-23 03:37:01.775 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 97.72099999999955
[aiter INFO] 2025-10-23 03:37:01.775 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 98.88099999999986
[aiter INFO] 2025-10-23 03:37:01.790 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen3_msk1  97.0            0.0          9,535.2        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0        9,829.2              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN           98.3             98.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.791 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:    98.30 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.840 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 300.1431973263769 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:01.906 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:37:01.907 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 196.319
[aiter INFO] 2025-10-23 03:37:01.907 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.599000000000046
[aiter INFO] 2025-10-23 03:37:01.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,149.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         19,475.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,625.1              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          216.3            216.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:01.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   216.25 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:01.938 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    10
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:02.067 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 389.36605783972414 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:02.272 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 35}
[aiter INFO] 2025-10-23 03:37:02.273 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 280.361
[aiter INFO] 2025-10-23 03:37:02.273 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.438999999999965
[aiter INFO] 2025-10-23 03:37:02.292 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,740.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         28,188.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       30,928.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          309.3            309.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:02.293 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   309.29 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:02.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 342.4241176926264 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:02.544 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 1289}
[aiter INFO] 2025-10-23 03:37:02.544 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 224.08100000000002
[aiter INFO] 2025-10-23 03:37:02.544 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 226.921
[aiter INFO] 2025-10-23 03:37:02.544 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 226.47899999999936
[aiter INFO] 2025-10-23 03:37:02.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         22,070.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            225.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:02.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 73.35388121923597 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.91900000000004
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.759000000000015
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.438999999999993
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.679000000000002
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.038999999999987
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.999000000000024
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.119000000000028
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.039000000000044
[aiter INFO] 2025-10-23 03:37:02.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 17.999000000000024
[aiter INFO] 2025-10-23 03:37:02.625 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,358.4        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             14.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:02.626 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   240.13 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:02.683 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 145.2745646238327 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:02.719 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {4, 29, 447}
[aiter INFO] 2025-10-23 03:37:02.719 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.35899999999998
[aiter INFO] 2025-10-23 03:37:02.719 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 128.76099999999997
[aiter INFO] 2025-10-23 03:37:02.719 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 130.5590000000002
[aiter INFO] 2025-10-23 03:37:02.735 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                             name   cnt  host_time_sum  device_time_sum device_type device_index
0              aiter::pa_bf16_pertokenFp8_gqa10_1tg_4w_qlen4_msk1  98.0            0.0         12,755.2        CUDA            5
1                                       aiter::wrapper_pa_fwd_asm 100.0       13,014.5              0.0         CPU       242313
[avg us/iter]                                                 NaN   NaN          130.1            130.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:02.735 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_asm][   Quant]:   130.16 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:02.871 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1120.5602046286706 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {100, 9, 982, 983, 984, 985}
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.439000000000078
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1015.2829999999999
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1023.2410000000018
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.35899999999674
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1009.2030000000013
[aiter INFO] 2025-10-23 03:37:03.023 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.15899999999965
[aiter INFO] 2025-10-23 03:37:03.042 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,675.2        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         99,544.6        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      104,306.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,043.1          1,043.1         NaN          NaN
[aiter INFO] 2025-10-23 03:37:03.043 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1043.06 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]

diff.abs.max=0.001220703125
max_diff_thr=0.00119331746827811

NaN info:
{}
out_ref_md5=e17b8f0bc0ba75d70c3c27b39e5e6596
gluon_fp8_output_md5=0ee43b930d16b44f747a6e4ca9b4aa5f
diff.abs.max=0.003082275390625
max_diff_thr=0.0030627406667917967

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0020751953125
max_diff_thr=0.0020173252560198307

NaN info:
{}
out_ref_md5=f9212a18350124a8552b9d2812d92896
triton_fp8_output_md5=5674cf3c3a2db01b05eab792ea0d5ed1
diff.abs.max=0.00115966796875
max_diff_thr=0.0011499818647280335

NaN info:
{}
out_ref_md5=f9212a18350124a8552b9d2812d92896
gluon_fp8_output_md5=c6bde8a03993b3c2016baaf04ad9ef0b
diff.abs.max=0.003021240234375
max_diff_thr=0.0030078385025262833

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023663038155063987

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.001953125
max_diff_thr=0.001905896351672709

NaN info:
{}
out_ref_md5=e602cd8d01da47d113257898a4dea029
triton_fp8_output_md5=8f88d56bd4153fd27a683ef16bd81b78
diff.abs.max=0.00115966796875
max_diff_thr=0.0011434670304879546

NaN info:
{}
out_ref_md5=e602cd8d01da47d113257898a4dea029
gluon_fp8_output_md5=c56f86ea7a3270ca1cc6ca07f293d0b4
diff.abs.max=0.003326416015625
max_diff_thr=0.0033101520966738462

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.001373291015625
max_diff_thr=0.001366867101751268

NaN info:
{}
out_ref_md5=ebe619c4b557b1f746c0f538f2a534e2
gluon_fp8_output_md5=6fa80b0023f28ec543463194d9e5ab3b
diff.abs.max=0.003173828125
max_diff_thr=0.0031141454819589853

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0013427734375
max_diff_thr=0.0013240249827504158

NaN info:
{}
out_ref_md5=c34299308a20e29f65bec2502b377a7b
gluon_fp8_output_md5=f7e05c76a3afe465153dbbfcb752818e
diff.abs.max=0.00323486328125
max_diff_thr=0.003207261674106121

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001953125
max_diff_thr=0.0019070322159677744

NaN info:
{}
out_ref_md5=dc40c303bdec0e88087ebc3a8715fad1
triton_fp8_output_md5=120613b29e71cc3241fe40f5dba4dcc7
diff.abs.max=0.0010986328125
max_diff_thr=0.0010928298579528928

NaN info:
{}
out_ref_md5=dc40c303bdec0e88087ebc3a8715fad1
gluon_fp8_output_md5=4db599ee78d5b2ea8c480021f0efc2ad
diff.abs.max=0.00115966796875
max_diff_thr=0.0011412781896069646

NaN info:
{}
diff.abs.max=0.0030517578125
max_diff_thr=0.002991862129420042

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016806722851470113

NaN info:
{}
out_ref_md5=34d45af77c8a4df04d40a69195051292
triton_fp8_output_md5=53dfea43fbdcd7039fbd6ef894cda0d1
diff.abs.max=0.001190185546875
max_diff_thr=0.001188716385513544

NaN info:
{}
out_ref_md5=34d45af77c8a4df04d40a69195051292
gluon_fp8_output_md5=2d2fa0847296b659fe7ef969e5b2c43a
diff.abs.max=0.001220703125
max_diff_thr=0.00121678551658988

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.0031287604942917824

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.001273205503821373

NaN info:
{}
out_ref_md5=854f28b17d55712347e83cb7daf6587b
gluon_fp8_output_md5=42ae5c39e5288752ba5111c4c6e93dfd
diff.abs.max=0.001312255859375
max_diff_thr=0.0013033067807555199

NaN info:
{}
diff.abs.max=0.00299072265625
max_diff_thr=0.002956978976726532

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.00115966796875
max_diff_thr=0.0011458898661658168

NaN info:
{}
out_ref_md5=4cfc52aacc265ce270fc70d84dc63614
gluon_fp8_output_md5=a39e48d167efa089e99007e31a322dbf
diff.abs.max=0.001251220703125
max_diff_thr=0.0012490099761635065

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0032130947802215815

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.0016784558538347483

NaN info:
{}
out_ref_md5=e50c0d03010a3329d3419b031e747dd7
triton_fp8_output_md5=23c5c12190dd6dec2a6ed1c65f1f4577
diff.abs.max=0.0011749267578125
max_diff_thr=0.0011698215967044234

NaN info:
{}
out_ref_md5=e50c0d03010a3329d3419b031e747dd7
gluon_fp8_output_md5=a61dfab182a0f648810614a3bd6799fe
diff.abs.max=0.001220703125
max_diff_thr=0.0011981787392869592

NaN info:
{}
diff.abs.max=0.00322723388671875
max_diff_thr=0.003220354439690709

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.00023668639187235385

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017959770048037171

NaN info:
{}
out_ref_md5=fece419f418c5c32c11a0a0811ad0905
triton_fp8_output_md5=153ed982a0ac5fbeed4087a8a283414e
diff.abs.max=0.001220703125
max_diff_thr=0.0012150299735367298

NaN info:
{}
out_ref_md5=fece419f418c5c32c11a0a0811ad0905
gluon_fp8_output_md5=4ab96945c394be501bb196d1a1952cab
diff.abs.max=0.001220703125
max_diff_thr=0.0012012012302875519

NaN info:
{}
diff.abs.max=0.00323486328125
max_diff_thr=0.0032318057492375374

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0012226104736328125
max_diff_thr=0.001222072052769363

NaN info:
{}
out_ref_md5=dcd5100ffe541840be8784098839a223
gluon_fp8_output_md5=4a222d253192c84cae20436b20b09aa4
diff.abs.max=0.001312255859375
max_diff_thr=0.00130848225671798

NaN info:
{}
diff.abs.max=0.003173828125
max_diff_thr=0.003116011619567871

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.00140380859375
max_diff_thr=0.0014008161379024386

NaN info:
{}
out_ref_md5=977d40c81412d91c5eaf08a59558ba9d
gluon_fp8_output_md5=20d2b139f02a4da8392b5f441f0a931d
diff.abs.max=0.0013427734375
max_diff_thr=0.001318944850936532

NaN info:
{}
diff.abs.max=0.00341796875
max_diff_thr=0.003411098150536418

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>[aiter INFO] 2025-10-23 03:37:03.053 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:03.133 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 163.80172348258517 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {864, 449, 482, 963, 644, 680, 457, 490, 9, 174, 688, 17, 1010, 182, 856, 1018, 955, 636}
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.078999999999724
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.91899999999987
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.47899999999936
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.279000000000451
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.03899999999976
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 81.48100000000068
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.319000000000415
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.15900000000056
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 89.959
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.63900000000012
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.959000000000742
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.479000000000042
[aiter INFO] 2025-10-23 03:37:03.187 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 84.83899999999994
[aiter INFO] 2025-10-23 03:37:03.188 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.718999999999824
[aiter INFO] 2025-10-23 03:37:03.188 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 80.71900000000005
[aiter INFO] 2025-10-23 03:37:03.188 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.479000000001179
[aiter INFO] 2025-10-23 03:37:03.188 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.63899999999921
[aiter INFO] 2025-10-23 03:37:03.188 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.27899999999954
[aiter INFO] 2025-10-23 03:37:03.207 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  92.0            0.0            832.6        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  92.0            0.0          7,644.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        9,215.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           92.2             92.1         NaN          NaN
[aiter INFO] 2025-10-23 03:37:03.208 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:    92.15 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:03.840 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 305.77372265334174 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:03.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1309}
[aiter INFO] 2025-10-23 03:37:03.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.35900000000004
[aiter INFO] 2025-10-23 03:37:03.908 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 195.12099999999919
[aiter INFO] 2025-10-23 03:37:03.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 99.0            0.0         19,152.2        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            193.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:03.947 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.79981182825446 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:03.979 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:03.979 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 8.438999999999993
[aiter INFO] 2025-10-23 03:37:03.992 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            681.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:37:03.993 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   200.27 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:04.266 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 166.94192086706067 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:04.319 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {857, 961, 12}
[aiter INFO] 2025-10-23 03:37:04.320 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.67900000000009
[aiter INFO] 2025-10-23 03:37:04.320 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.998999999999796
[aiter INFO] 2025-10-23 03:37:04.320 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.63900000000001
[aiter INFO] 2025-10-23 03:37:04.332 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0          4,730.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             48.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:04.358 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.03822800782648 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:04.398 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:04.398 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.718999999999994
[aiter INFO] 2025-10-23 03:37:04.410 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            681.2        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              6.8         NaN          NaN
[aiter INFO] 2025-10-23 03:37:04.411 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    55.08 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:04.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_03537b4d96aa41a92d527b427bbcb711' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_03537b4d96aa41a92d527b427bbcb711', 'folder': 'pa_03537b4d96aa41a92d527b427bbcb711', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 1, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_03537b4d96aa41a92d527b427bbcb711(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            1,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 1);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:37:04.417 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include -c pa_03537b4d96aa41a92d527b427bbcb711.cpp -o pa_03537b4d96aa41a92d527b427bbcb711.o
In file included from pa_03537b4d96aa41a92d527b427bbcb711.cpp:1:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/quant_utils.cuh:19:
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_03537b4d96aa41a92d527b427bbcb711.cpp:1:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/quant_utils.cuh:19:
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_03537b4d96aa41a92d527b427bbcb711.o -o lib.so
[aiter INFO] 2025-10-23 03:37:07.537 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_03537b4d96aa41a92d527b427bbcb711, cost 3.12031039s
[aiter INFO] 2025-10-23 03:37:07.577 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 138.68165385014942 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:07.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {16, 9, 27, 20}
[aiter INFO] 2025-10-23 03:37:07.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 7.3589999999999804
[aiter INFO] 2025-10-23 03:37:07.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.87899999999996
[aiter INFO] 2025-10-23 03:37:07.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.199000000000012
[aiter INFO] 2025-10-23 03:37:07.629 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 49.00100000000003
[aiter INFO] 2025-10-23 03:37:07.649 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0            866.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          4,661.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        5,586.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           55.9             55.8         NaN          NaN
[aiter INFO] 2025-10-23 03:37:07.649 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    55.84 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:07.654 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:07.723 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 196.23512855850825 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:07.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {19, 9, 1106, 1107}
[aiter INFO] 2025-10-23 03:37:07.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 13.118999999999971
[aiter INFO] 2025-10-23 03:37:07.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 111.59899999999999
[aiter INFO] 2025-10-23 03:37:07.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 107.95900000000074
[aiter INFO] 2025-10-23 03:37:07.926 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.718999999999141
[aiter INFO] 2025-10-23 03:37:07.946 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,486.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         10,535.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       12,146.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          121.5            121.4         NaN          NaN
[aiter INFO] 2025-10-23 03:37:07.946 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   121.44 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:09.247 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 380.27216833416776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:09.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1264, 12, 37, 62}
[aiter INFO] 2025-10-23 03:37:09.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 273.8009999999995
[aiter INFO] 2025-10-23 03:37:09.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 275.83899999999994
[aiter INFO] 2025-10-23 03:37:09.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 273.95899999999995
[aiter INFO] 2025-10-23 03:37:09.318 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 274.3209999999999
[aiter INFO] 2025-10-23 03:37:09.329 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 97.0            0.0         26,456.4        CUDA            5
[avg us/iter]                       NaN  NaN            0.0            272.7         NaN          NaN
[aiter INFO] 2025-10-23 03:37:09.356 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.42957403636214 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:09.393 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:09.393 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.398999999999972
[aiter INFO] 2025-10-23 03:37:09.405 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            962.0        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:09.406 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   282.37 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:09.726 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 201.62127705493776 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:09.782 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12, 1117}
[aiter INFO] 2025-10-23 03:37:09.782 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 83.27899999999997
[aiter INFO] 2025-10-23 03:37:09.782 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 79.8809999999994
[aiter INFO] 2025-10-23 03:37:09.794 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0          8,010.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             80.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:09.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.04104942142374 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:09.860 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:09.860 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.679000000000002
[aiter INFO] 2025-10-23 03:37:09.872 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            953.6        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              9.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:09.873 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    90.45 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:09.884 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_08b4bfcc5c4b624d44844f6f812f3de7' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_08b4bfcc5c4b624d44844f6f812f3de7', 'folder': 'pa_08b4bfcc5c4b624d44844f6f812f3de7', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 2, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_08b4bfcc5c4b624d44844f6f812f3de7(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            2,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 2);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:37:09.885 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include -c pa_08b4bfcc5c4b624d44844f6f812f3de7.cpp -o pa_08b4bfcc5c4b624d44844f6f812f3de7.o
In file included from pa_08b4bfcc5c4b624d44844f6f812f3de7.cpp:1:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/quant_utils.cuh:19:
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_08b4bfcc5c4b624d44844f6f812f3de7.cpp:1:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/quant_utils.cuh:19:
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_08b4bfcc5c4b624d44844f6f812f3de7.o -o lib.so
[aiter INFO] 2025-10-23 03:37:13.056 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_08b4bfcc5c4b624d44844f6f812f3de7, cost 3.17115812s
[aiter INFO] 2025-10-23 03:37:13.101 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 192.21133687118493 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:13.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 20, 28, 17}
[aiter INFO] 2025-10-23 03:37:13.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 94.87900000000002
[aiter INFO] 2025-10-23 03:37:13.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 95.719
[aiter INFO] 2025-10-23 03:37:13.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.35899999999998
[aiter INFO] 2025-10-23 03:37:13.161 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.478999999999985
[aiter INFO] 2025-10-23 03:37:13.181 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          1,488.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  99.0            0.0          9,222.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       10,821.8              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          108.2            108.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:13.182 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   108.19 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:13.191 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:13.268 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 250.72878200819 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:13.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26, 1036, 1037}
[aiter INFO] 2025-10-23 03:37:13.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 159.959
[aiter INFO] 2025-10-23 03:37:13.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.55899999999997
[aiter INFO] 2025-10-23 03:37:13.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 154.60099999999875
[aiter INFO] 2025-10-23 03:37:13.343 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.439000000000306
[aiter INFO] 2025-10-23 03:37:13.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          2,086.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         15,149.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       17,412.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          174.1            174.1         NaN          NaN
[aiter INFO] 2025-10-23 03:37:13.363 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   174.11 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:13.828 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 259.6000984753712 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:13.882 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 1307, 12, 1303}
[aiter INFO] 2025-10-23 03:37:13.882 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 135.87900000000002
[aiter INFO] 2025-10-23 03:37:13.882 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 138.31900000000132
[aiter INFO] 2025-10-23 03:37:13.883 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 138.479
[aiter INFO] 2025-10-23 03:37:13.883 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 138.24099999999999
[aiter INFO] 2025-10-23 03:37:13.893 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0         13,322.4        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            137.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:13.920 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.71034643673661 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27}
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119000000000028
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.59899999999999
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.359000000000009
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:37:13.955 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.158999999999992
[aiter INFO] 2025-10-23 03:37:13.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.319000000000017
[aiter INFO] 2025-10-23 03:37:13.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.238999999999919
[aiter INFO] 2025-10-23 03:37:13.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.278999999999996
[aiter INFO] 2025-10-23 03:37:13.956 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.038999999999987
[aiter INFO] 2025-10-23 03:37:13.968 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 89.0            0.0          1,087.7        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             12.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:13.969 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   149.57 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:13.983 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_8b4e44730af12774b083129c2f783993' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_8b4e44730af12774b083129c2f783993', 'folder': 'pa_8b4e44730af12774b083129c2f783993', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 3, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_8b4e44730af12774b083129c2f783993(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            3,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 3);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:37:13.983 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include -c pa_8b4e44730af12774b083129c2f783993.cpp -o pa_8b4e44730af12774b083129c2f783993.o
In file included from pa_8b4e44730af12774b083129c2f783993.cpp:1:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/quant_utils.cuh:19:
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_8b4e44730af12774b083129c2f783993.cpp:1:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/quant_utils.cuh:19:
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_8b4e44730af12774b083129c2f783993/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_8b4e44730af12774b083129c2f783993.o -o lib.so
[aiter INFO] 2025-10-23 03:37:17.229 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_8b4e44730af12774b083129c2f783993, cost 3.24583663s
[aiter INFO] 2025-10-23 03:37:17.278 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 229.49505914555917 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 49, 786, 17, 20, 59, 797, 30}
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.92099999999999
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 122.47899999999993
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 123.67900000000009
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.199000000000012
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 124.79899999999998
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.278999999999996
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.958999999999833
[aiter INFO] 2025-10-23 03:37:17.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 21.63900000000001
[aiter INFO] 2025-10-23 03:37:17.498 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  97.0            0.0          2,054.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  97.0            0.0         11,974.7        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,465.3              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          144.7            144.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:17.500 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   144.63 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:17.511 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 80,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:17.593 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 290.7800093145654 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {323, 9, 1038, 1039, 305, 26}
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.07900000000018
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 186.839
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 185.60100000000057
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 27.15899999999965
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 180.68100000000004
[aiter INFO] 2025-10-23 03:37:17.669 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.43900000000002
[aiter INFO] 2025-10-23 03:37:17.688 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,653.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         17,976.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       21,050.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          210.5            210.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:17.689 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   210.51 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:18.169 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 269.00726792835957 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:18.226 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12}
[aiter INFO] 2025-10-23 03:37:18.226 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 146.87899999999996
[aiter INFO] 2025-10-23 03:37:18.226 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 150.92100000000002
[aiter INFO] 2025-10-23 03:37:18.237 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 99.0            0.0         14,689.8        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            148.4         NaN          NaN
[aiter INFO] 2025-10-23 03:37:18.264 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 72.36024766865343 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.199000000000012
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.07899999999995
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.59899999999999
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.67900000000003
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.758999999999986
[aiter INFO] 2025-10-23 03:37:18.300 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 18.839000000000055
[aiter INFO] 2025-10-23 03:37:18.301 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.199000000000012
[aiter INFO] 2025-10-23 03:37:18.301 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.63900000000001
[aiter INFO] 2025-10-23 03:37:18.301 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.43900000000002
[aiter INFO] 2025-10-23 03:37:18.301 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 19.07899999999995
[aiter INFO] 2025-10-23 03:37:18.313 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 91.0            0.0          1,397.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             15.4         NaN          NaN
[aiter INFO] 2025-10-23 03:37:18.314 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   163.74 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:18.337 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:280 - compile_template_op
compile_template_op func_name = 'pa_60de6d7ddd7ad60789e7bc2fe2ee334c' with {'src_template': <Template memory:7f927a39f140>, 'md_name': 'pa', 'includes': ['/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.h', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_common.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/pa/pa_kernels.cuh', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include', '/mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/include/ck_tile'], 'sources': [], 'cxxflags': [], 'func_name': 'pa_60de6d7ddd7ad60789e7bc2fe2ee334c', 'folder': 'pa_60de6d7ddd7ad60789e7bc2fe2ee334c', 'kwargs': OrderedDict({'gqa_ratio': 16, 'head_size': 128, 'npar_loops': 1, 'dtype': '__hip_bfloat16', 'kv_dtype': 'uint8_t', 'fp8_kv_dtype': 'fp8', 'out_dtype': '__hip_bfloat16', 'block_size': 1024, 'alibi_enabled': 'false', 'mtp': 4, 'quant_method': 'vllm::Fp8QuantMethod::kPerHead', 'v_shuffle': True}), 'src_file': '#include "pa.cuh"\n                        \n#define FUNCTION_DEFINE                                 \\\n    void pa_60de6d7ddd7ad60789e7bc2fe2ee334c(void* out_ptr,                   \\\n                      void* exp_sums_ptr_,              \\\n                      void* max_logits_ptr_,            \\\n                      void* tmp_out_ptr_,               \\\n                      void* query_ptr,                  \\\n                      void* key_cache_ptr,              \\\n                      void* value_cache_ptr,            \\\n                      const float scale,                \\\n                      int* block_tables_ptr,            \\\n                      int* context_lens_ptr,            \\\n                      const int max_context_len,        \\\n                      const int num_seqs,               \\\n                      const int num_kv_heads,           \\\n                      const int num_heads,              \\\n                      const int max_num_blocks_per_seq, \\\n                      const int q_stride,               \\\n                      const int kv_block_stride,        \\\n                      const int kv_head_stride,         \\\n                      const float* alibi_slopes_ptr,    \\\n                      const float* q_scale_ptr,         \\\n                      const float* k_scale_ptr,         \\\n                      const float* v_scale_ptr,         \\\n                      const float* fp8_out_scale_ptr,   \\\n                      void* stream)\n\nextern "C" {\nFUNCTION_DEFINE;\n}\n                        \nFUNCTION_DEFINE\n{\n    constexpr int PARTITION_SIZE = 256;\n\n    const int max_num_partitions =\n      DIVIDE_ROUND_UP(max_context_len, PARTITION_SIZE);\n    constexpr int head_size = 128;\n    \n    assert(num_heads % num_kv_heads == 0);\n\n    float* exp_sums_ptr   = reinterpret_cast<float*>(exp_sums_ptr_);\n    float* max_logits_ptr = reinterpret_cast<float*>(max_logits_ptr_);\n    __hip_bfloat16* tmp_out_ptr =\n        reinterpret_cast<__hip_bfloat16*>(tmp_out_ptr_);\n\n    constexpr int NTHR = 256;\n    dim3 grid(num_seqs, max_num_partitions, num_kv_heads);\n    dim3 block(NTHR);\n\n    paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16,\n                                            __hip_bfloat16,                       \n                                            uint8_t,\n                                            \n                                            vllm::Fp8KVCacheDataType::kFp8E4M3,\n                                                                          \n                                            1024,              \n                                            head_size,               \n                                            NTHR,\n                                            false,                    \n                                            16,\n                                            4,\n                                            vllm::Fp8QuantMethod::kPerHead,\n                                            true>               \n    <<<grid, block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(query_ptr),                      \n                                    reinterpret_cast<uint8_t*>(key_cache_ptr),                  \n                                    reinterpret_cast<uint8_t*>(value_cache_ptr),      \n                                    scale,                          \n                                    block_tables_ptr,                  \n                                    context_lens_ptr,\n                                    nullptr,            \n                                    max_num_blocks_per_seq,          \n                                    alibi_slopes_ptr,               \n                                    q_stride,                       \n                                    kv_block_stride,                \n                                    kv_head_stride,                             \n                                    exp_sums_ptr,                   \n                                    max_logits_ptr,                 \n                                    tmp_out_ptr,\n                                    q_scale_ptr,                                               \n                                    k_scale_ptr,                    \n                                    v_scale_ptr);\n\n    dim3 reduce_grid(num_heads, num_seqs, 4);\n    dim3 reduce_block(head_size);\n    paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, head_size, head_size, PARTITION_SIZE, 1> \n    <<<reduce_grid, reduce_block, 0, reinterpret_cast<hipStream_t>(stream)>>>(reinterpret_cast<__hip_bfloat16*>(out_ptr),                                        \n                                                                              exp_sums_ptr,        \n                                                                              max_logits_ptr,                                 \n                                                                              tmp_out_ptr,                                   \n                                                                              context_lens_ptr,\n                                                                              nullptr,                                \n                                                                              max_num_partitions,                                               \n                                                                              fp8_out_scale_ptr);\n                                    \n}'}...
[aiter INFO] 2025-10-23 03:37:18.337 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:145 - main_func
start build /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c
hipcc -fPIC -Wno-undefined-func-template -mllvm -amdgpu-early-inline-all=true -std=c++20 -mllvm --amdgpu-kernarg-preload-count=16 -fno-offload-uniform-block -mllvm -amdgpu-coerce-illegal-types=1 -DUSE_ROCM -fgpu-flush-denormals-to-zero -O3 -Wno-switch-bool -DLEGACY_HIPBLAS_DIRECT -Wno-vla-cxx-extension -mllvm -amdgpu-function-calls=false -DUSE_PROF_API=1 -D__HIP_PLATFORM_HCC__=1 -Wno-unused-result -U__HIP_NO_HALF_OPERATORS__ -DENABLE_FP8 -U__HIP_NO_HALF_CONVERSIONS__ -mllvm --lsr-drop-solution=1 -D__HIP_PLATFORM_AMD__=1 --offload-arch=gfx942 -mllvm -enable-post-misched=0 -I/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include -c pa_60de6d7ddd7ad60789e7bc2fe2ee334c.cpp -o pa_60de6d7ddd7ad60789e7bc2fe2ee334c.o
In file included from pa_60de6d7ddd7ad60789e7bc2fe2ee334c.cpp:1:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/quant_utils.cuh:19:
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for gfx942.
In file included from pa_60de6d7ddd7ad60789e7bc2fe2ee334c.cpp:1:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/pa.cuh:23:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/pa_common.cuh:10:
In file included from /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/quant_utils.cuh:19:
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:80:1: warning: non-void function does not return a value [-Wreturn-type]
   80 | }
      | ^
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:89:1: warning: non-void function does not return a value [-Wreturn-type]
   89 | }
      | ^
/root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c/include/vec_convert.h:98:1: warning: non-void function does not return a value [-Wreturn-type]
   98 | }
      | ^
3 warnings generated when compiling for host.
hipcc -shared pa_60de6d7ddd7ad60789e7bc2fe2ee334c.o -o lib.so
[aiter INFO] 2025-10-23 03:37:21.659 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/csrc/cpp_itfs/utils.py:223 - final_func
finish build /root/.aiter/build/pa_60de6d7ddd7ad60789e7bc2fe2ee334c, cost 3.32168347s
[aiter INFO] 2025-10-23 03:37:21.760 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 742.1213075666144 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:21.876 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 62}
[aiter INFO] 2025-10-23 03:37:21.876 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 634.5229999999999
[aiter INFO] 2025-10-23 03:37:21.876 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.399
[aiter INFO] 2025-10-23 03:37:21.896 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          2,716.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         63,369.3        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       66,086.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          660.9            660.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:21.897 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   660.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:21.913 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 1,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:22.011 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 214.91398079560534 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.079 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 19}
[aiter INFO] 2025-10-23 03:37:22.080 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 132.519
[aiter INFO] 2025-10-23 03:37:22.080 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 11.199000000000012
[aiter INFO] 2025-10-23 03:37:22.102 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          1,317.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl... 100.0            0.0         12,938.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       14,255.6              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          142.6            142.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.103 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   142.56 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:22.295 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 421.5562865875735 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.369 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:37:22.369 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 317.681
[aiter INFO] 2025-10-23 03:37:22.380 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         31,247.6        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            312.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.406 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 71.15268338434767 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.439 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:22.439 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.519000000000005
[aiter INFO] 2025-10-23 03:37:22.452 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            793.4        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              7.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.453 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   320.41 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:22.502 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 192.2553165419267 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.555 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {1156, 38, 12, 51, 285}
[aiter INFO] 2025-10-23 03:37:22.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.23899999999958
[aiter INFO] 2025-10-23 03:37:22.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.35900000000004
[aiter INFO] 2025-10-23 03:37:22.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 75.99900000000002
[aiter INFO] 2025-10-23 03:37:22.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.279
[aiter INFO] 2025-10-23 03:37:22.556 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.39900000000034
[aiter INFO] 2025-10-23 03:37:22.568 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 96.0            0.0          6,936.5        CUDA            5
[avg us/iter]                             NaN  NaN            0.0             72.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.594 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 69.23709920432309 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.628 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {6}
[aiter INFO] 2025-10-23 03:37:22.628 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 9.918999999999983
[aiter INFO] 2025-10-23 03:37:22.641 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 100.0            0.0            802.1        CUDA            5
[avg us/iter]                                        NaN   NaN            0.0              8.0         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.642 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:    80.28 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:22.689 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 165.6678811748429 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {611, 644, 710, 9, 28, 17, 20, 603, 636, 702}
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000196
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.878999999999905
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.559000000000196
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 77.119
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 12.63900000000001
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 10.918999999999983
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.12100000000004
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.03899999999976
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.03899999999976
[aiter INFO] 2025-10-23 03:37:22.878 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 73.0009999999993
[aiter INFO] 2025-10-23 03:37:22.897 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          1,219.3        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0          6,902.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0        8,464.4              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN           84.6             84.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:22.898 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:    84.60 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:22.905 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 2,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:23.007 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 263.4883962645389 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {739, 9, 724, 1045, 1044, 26}
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.558999999999287
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 167.31900000000002
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.4409999999998
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.679000000000087
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 166.3189999999995
[aiter INFO] 2025-10-23 03:37:23.077 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.999000000000024
[aiter INFO] 2025-10-23 03:37:23.096 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,214.8        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  98.0            0.0         16,146.9        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       18,739.7              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          187.4            187.4         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.097 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   187.36 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:23.309 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 542.1115154086953 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.394 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {12}
[aiter INFO] 2025-10-23 03:37:23.394 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 446.639
[aiter INFO] 2025-10-23 03:37:23.405 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                   name   cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_big_blk_fp8 100.0            0.0         44,125.0        CUDA            5
[avg us/iter]                       NaN   NaN            0.0            441.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.432 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.83906941484696 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.63900000000001
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.399000000000001
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.678999999999974
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.758999999999986
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.479000000000042
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.519000000000005
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.798999999999978
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.466 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.467 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.918999999999983
[aiter INFO] 2025-10-23 03:37:23.479 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,047.1        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.480 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs triton_fp8][   Quant]:   453.15 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:23.544 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 248.55807851446738 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.600 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {480, 986, 90, 12}
[aiter INFO] 2025-10-23 03:37:23.601 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.51900000000023
[aiter INFO] 2025-10-23 03:37:23.601 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.83899999999994
[aiter INFO] 2025-10-23 03:37:23.601 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.87900000000013
[aiter INFO] 2025-10-23 03:37:23.601 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 126.601
[aiter INFO] 2025-10-23 03:37:23.613 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 97.0            0.0         12,143.3        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            125.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.640 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 70.74358417551116 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 69, 6, 41, 76, 13, 48, 83, 20, 55, 90, 27, 62}
[aiter INFO] 2025-10-23 03:37:23.675 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.799000000000035
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.879000000000019
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.119
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.439000000000021
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.518999999999892
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.079000000000008
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.599000000000046
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 15.039000000000101
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.758999999999958
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.799000000000092
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.759000000000015
[aiter INFO] 2025-10-23 03:37:23.676 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 14.399000000000001
[aiter INFO] 2025-10-23 03:37:23.689 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 88.0            0.0          1,043.2        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             11.9         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.689 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   137.04 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:23.754 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 252.25669366888482 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {481, 40, 9, 496, 21, 56}
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 145.07899999999972
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 147.039
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 148.879
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.59900000000016
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 20.798999999999978
[aiter INFO] 2025-10-23 03:37:23.821 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 22.718999999999937
[aiter INFO] 2025-10-23 03:37:23.841 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  98.0            0.0          2,207.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  98.0            0.0         14,319.1        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       16,864.0              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          168.6            168.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:23.841 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   168.64 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:23.853 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 3,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:23.965 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 352.3235636772496 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:24.042 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 164, 30, 143}
[aiter INFO] 2025-10-23 03:37:24.042 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 243.15899999999996
[aiter INFO] 2025-10-23 03:37:24.043 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.118999999999915
[aiter INFO] 2025-10-23 03:37:24.043 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.71900000000005
[aiter INFO] 2025-10-23 03:37:24.043 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 245.23900000000003
[aiter INFO] 2025-10-23 03:37:24.062 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          3,179.5        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         24,023.0        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       27,479.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          274.8            274.8         NaN          NaN
[aiter INFO] 2025-10-23 03:37:24.063 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   274.77 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:24.255 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 342.36233659309914 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:24.317 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {25, 12, 854}
[aiter INFO] 2025-10-23 03:37:24.317 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 216.88099999999997
[aiter INFO] 2025-10-23 03:37:24.317 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 219.87900000000002
[aiter INFO] 2025-10-23 03:37:24.317 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 219.3610000000008
[aiter INFO] 2025-10-23 03:37:24.328 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         21,425.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            218.6         NaN          NaN
[aiter INFO] 2025-10-23 03:37:24.355 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 79.92065314314154 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 55, 27, 62}
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 26.63899999999998
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.998999999999967
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.918999999999983
[aiter INFO] 2025-10-23 03:37:24.388 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.918999999999983
[aiter INFO] 2025-10-23 03:37:24.389 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.91900000000004
[aiter INFO] 2025-10-23 03:37:24.389 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.438999999999965
[aiter INFO] 2025-10-23 03:37:24.389 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 25.959000000000003
[aiter INFO] 2025-10-23 03:37:24.389 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 23.99899999999991
[aiter INFO] 2025-10-23 03:37:24.401 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 92.0            0.0          1,950.6        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             21.2         NaN          NaN
[aiter INFO] 2025-10-23 03:37:24.402 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   239.82 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:24.478 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 311.44541738056904 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:24.543 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 26}
[aiter INFO] 2025-10-23 03:37:24.543 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 196.88100000000003
[aiter INFO] 2025-10-23 03:37:24.543 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 30.278999999999996
[aiter INFO] 2025-10-23 03:37:24.562 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256... 100.0            0.0          3,203.0        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ... 100.0            0.0         19,569.2        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       22,772.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          227.7            227.7         NaN          NaN
[aiter INFO] 2025-10-23 03:37:24.563 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:   227.72 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:24.583 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:214 - log_args

calling test_pa_mtp(ctx_lens                     = 4096,
                    batch_size                   = 128,
                    num_heads                    = (
                                                    16
                                                    1
                                                   ),
                    head_size                    = 128,
                    block_size                   = 1024,
                    dtype                        = torch.bfloat16,
                    qlen                         = 4,
                    trans_v                      = True)
[aiter INFO] 2025-10-23 03:37:24.702 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 410.1293069301265 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:24.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {9, 35, 756, 727}
[aiter INFO] 2025-10-23 03:37:24.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 287.23900000000003
[aiter INFO] 2025-10-23 03:37:24.921 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 40.47900000000004
[aiter INFO] 2025-10-23 03:37:24.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 42.07899999999972
[aiter INFO] 2025-10-23 03:37:24.922 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 289.72099999999955
[aiter INFO] 2025-10-23 03:37:24.941 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  99.0            0.0          4,135.7        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, __hip_bfl...  99.0            0.0         28,366.4        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0       32,833.9              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN          328.3            328.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:24.942 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip][No Quant]:   328.30 us......[checkAllclose atol=0.01 rtol=0.01 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:25.145 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 354.5097215931014 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:25.211 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {26, 12, 1015}
[aiter INFO] 2025-10-23 03:37:25.211 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 232.96099999999996
[aiter INFO] 2025-10-23 03:37:25.211 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 235.721
[aiter INFO] 2025-10-23 03:37:25.211 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 235.4390000000003
[aiter INFO] 2025-10-23 03:37:25.222 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                         name  cnt  host_time_sum  device_time_sum device_type device_index
0              pa_decode_v2_gluon_big_blk_fp8 98.0            0.0         22,963.0        CUDA            5
[avg us/iter]                             NaN  NaN            0.0            234.3         NaN          NaN
[aiter INFO] 2025-10-23 03:37:25.249 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 83.10369350532494 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {34, 6, 41, 13, 48, 20, 27}
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.59899999999999
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.239000000000004
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.15899999999999
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 32.83899999999997
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 28.958999999999946
[aiter INFO] 2025-10-23 03:37:25.282 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.31900000000002
[aiter INFO] 2025-10-23 03:37:25.283 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 33.999000000000024
[aiter INFO] 2025-10-23 03:37:25.295 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                    name  cnt  host_time_sum  device_time_sum device_type device_index
0              _paged_attn_decode_v2_w_dot_reduce_kernel 94.0            0.0          2,494.8        CUDA            5
[avg us/iter]                                        NaN  NaN            0.0             26.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:25.296 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs gluon_fp8][   Quant]:   260.86 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:25.470 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:58 - wrapper
avg: 1138.0929710841415 us/iter from cuda.Event
[aiter INFO] 2025-10-23 03:37:25.623 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:282 - post_process_data
abnormal data indices: {98, 9, 1100, 1101, 1102, 1103, 1074, 1075, 948, 949}
[aiter INFO] 2025-10-23 03:37:25.623 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 39.999000000000024
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1023.163
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1026.4830000000075
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.719000000011874
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1029.4809999999998
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.48099999999977
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1027.0829999999987
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.75900000000547
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 1027.0429999999978
[aiter INFO] 2025-10-23 03:37:25.624 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:284 - post_process_data
abnormal data: 41.47899999999936
[aiter INFO] 2025-10-23 03:37:25.643 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:363 - get_trace_perf
                                                                                                    name   cnt  host_time_sum  device_time_sum device_type device_index
0              void paged_attention_ll4mi_reduce_kernel<__hip_bfloat16, __hip_bfloat16, 128, 128, 256...  96.0            0.0          3,988.9        CUDA            5
1              void paged_attention_ll4mi_QKV_mfma16_kernel<__hip_bfloat16, __hip_bfloat16, unsigned ...  96.0            0.0         97,912.8        CUDA            5
2                                                                            aiter::paged_attention_rocm 100.0      106,178.2              0.0         CPU       242313
[avg us/iter]                                                                                        NaN   NaN        1,061.8          1,061.5         NaN          NaN
[aiter INFO] 2025-10-23 03:37:25.644 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/aiter/aiter/test_common.py:374 - checkAllclose
[torch vs aiter_hip_fp8][   Quant]:  1061.48 us......[checkAllclose atol=0.05 rtol=0.05 [32mpassed~[0m]
[aiter INFO] 2025-10-23 03:37:25.677 - MainProcess:242313 - /mnt/raid0/heyanguang/code/fa_triton/triton_op/./test_pa_mtp.py:934 - <module>
summary:
    ctx_lens  batch_size num_heads  head_size  block_size           dtype  qlen  trans_v  us_hip_bf16  us_triton_fp8  us_gluon_fp8  err_gluon_fp8  gluon_fp8_bandwith(TB/s)  us_asm_fp8  asm_fp8_bandwith(TB/s)  us_hip_fp8 perf_fp8_gluon_vs_hip perf_fp8_gluon_vs_asm
0       4096          80    (8, 1)        128          16  torch.bfloat16     1     True         64.1          219.3          53.6              0                       1.4        39.5                     1.9        50.8                   95%                   74%
1       4096          80    (8, 1)        128          16  torch.bfloat16     2     True         92.7          300.7          56.9              0                       1.3        36.7                     2.1        98.0                  172%                   65%
2       4096          80    (8, 1)        128          16  torch.bfloat16     3     True        137.6            NaN          77.9              0                       1.0         NaN                     NaN       131.1                  168%                   NaN
3       4096          80    (8, 1)        128          16  torch.bfloat16     4     True        171.3            NaN          82.0              0                       0.9        62.9                     1.2       650.4                  794%                   77%
4       4096         128    (8, 1)        128          16  torch.bfloat16     1     True         99.5          353.0          79.6              0                       1.5        67.0                     1.8        77.3                   97%                   84%
5       4096         128    (8, 1)        128          16  torch.bfloat16     2     True        142.9          484.8          84.0              0                       1.5        70.2                     1.8       153.8                  183%                   84%
6       4096         128    (8, 1)        128          16  torch.bfloat16     3     True        214.4            NaN         118.3              0                       1.0         NaN                     NaN       205.6                  174%                   NaN
7       4096         128    (8, 1)        128          16  torch.bfloat16     4     True        269.2            NaN         123.1              0                       1.0       123.3                     1.0     1,036.8                  842%                  100%
8       4096          80   (10, 1)        128          16  torch.bfloat16     1     True         66.6          220.7          54.2              0                       1.4        36.2                     2.1        53.7                   99%                   67%
9       4096          80   (10, 1)        128          16  torch.bfloat16     2     True         95.6          302.5          74.1              0                       1.0        62.4                     1.2       102.3                  138%                   84%
10      4096          80   (10, 1)        128          16  torch.bfloat16     3     True        144.3            NaN          76.1              0                       1.0        90.2                     0.9       136.9                  180%                  118%
11      4096          80   (10, 1)        128          16  torch.bfloat16     4     True        178.1            NaN         110.6              0                       0.7       117.8                     0.7       654.2                  592%                  107%
12      4096         128   (10, 1)        128          16  torch.bfloat16     1     True        103.0          355.4          80.8              0                       1.5        61.9                     2.0        80.0                   99%                   77%
13      4096         128   (10, 1)        128          16  torch.bfloat16     2     True        146.0          488.1         112.0              0                       1.1       122.6                     1.0       159.9                  143%                  109%
14      4096         128   (10, 1)        128          16  torch.bfloat16     3     True        225.1            NaN         114.8              0                       1.1       177.5                     0.7       214.8                  187%                  155%
15      4096         128   (10, 1)        128          16  torch.bfloat16     4     True        280.7            NaN         171.6              0                       0.7       232.7                     0.5     1,045.9                  609%                  136%
16      4096          80   (16, 1)        128          16  torch.bfloat16     1     True         70.0          209.7          56.6              0                       1.4        36.2                     2.1        57.0                  101%                   64%
17      4096          80   (16, 1)        128          16  torch.bfloat16     2     True        102.9          293.9          77.2              0                       1.0        62.7                     1.2       108.5                  141%                   81%
18      4096          80   (16, 1)        128          16  torch.bfloat16     3     True        154.5            NaN         112.5              0                       0.7        90.6                     0.9       143.6                  128%                   80%
19      4096          80   (16, 1)        128          16  torch.bfloat16     4     True        191.1            NaN         132.7              0                       0.6       118.2                     0.7       664.2                  500%                   89%
20      4096         128   (16, 1)        128          16  torch.bfloat16     1     True        108.7          336.0          83.7              0                       1.5        62.1                     2.0        85.6                  102%                   74%
21      4096         128   (16, 1)        128          16  torch.bfloat16     2     True        156.8          471.8         114.5              0                       1.1       122.9                     1.0       169.1                  148%                  107%
22      4096         128   (16, 1)        128          16  torch.bfloat16     3     True        241.7            NaN         176.9              0                       0.7       178.0                     0.7       225.7                  128%                  101%
23      4096         128   (16, 1)        128          16  torch.bfloat16     4     True        298.9            NaN         209.1              0                       0.6       233.2                     0.5     1,065.0                  509%                  112%
24      4096          80    (8, 1)        128          64  torch.bfloat16     1     True         81.3          203.7          56.6              0                       1.4         NaN                     NaN        52.6                   93%                   NaN
25      4096          80    (8, 1)        128          64  torch.bfloat16     2     True        105.7          290.1          60.0              0                       1.3         NaN                     NaN       100.8                  168%                   NaN
26      4096          80    (8, 1)        128          64  torch.bfloat16     3     True        149.8            NaN         102.0              0                       0.8         NaN                     NaN       133.0                  130%                   NaN
27      4096          80    (8, 1)        128          64  torch.bfloat16     4     True        177.9            NaN         105.4              0                       0.7         NaN                     NaN       648.9                  616%                   NaN
28      4096         128    (8, 1)        128          64  torch.bfloat16     1     True        126.0          326.7          84.6              0                       1.4         NaN                     NaN        80.3                   95%                   NaN
29      4096         128    (8, 1)        128          64  torch.bfloat16     2     True        165.7          466.2          88.8              0                       1.4         NaN                     NaN       158.1                  178%                   NaN
30      4096         128    (8, 1)        128          64  torch.bfloat16     3     True        236.7            NaN         155.0              0                       0.8         NaN                     NaN       209.7                  135%                   NaN
31      4096         128    (8, 1)        128          64  torch.bfloat16     4     True        278.5            NaN         158.1              0                       0.8         NaN                     NaN     1,033.1                  653%                   NaN
32      4096          80   (10, 1)        128          64  torch.bfloat16     1     True         83.8          205.2          57.9              0                       1.3         NaN                     NaN        55.3                   96%                   NaN
33      4096          80   (10, 1)        128          64  torch.bfloat16     2     True        110.1          292.0         101.7              0                       0.8         NaN                     NaN       104.9                  103%                   NaN
34      4096          80   (10, 1)        128          64  torch.bfloat16     3     True        156.6            NaN         104.0              0                       0.7         NaN                     NaN       139.3                  134%                   NaN
35      4096          80   (10, 1)        128          64  torch.bfloat16     4     True        186.7            NaN         117.7              0                       0.7         NaN                     NaN       654.7                  556%                   NaN
36      4096         128   (10, 1)        128          64  torch.bfloat16     1     True        127.9          329.0          85.2              0                       1.4         NaN                     NaN        82.7                   97%                   NaN
37      4096         128   (10, 1)        128          64  torch.bfloat16     2     True        171.4          469.6         151.7              0                       0.8         NaN                     NaN       164.5                  108%                   NaN
38      4096         128   (10, 1)        128          64  torch.bfloat16     3     True        248.2            NaN         156.6              0                       0.8         NaN                     NaN       218.8                  140%                   NaN
39      4096         128   (10, 1)        128          64  torch.bfloat16     4     True        287.3            NaN         182.4              0                       0.7         NaN                     NaN     1,047.3                  574%                   NaN
40      4096          80   (16, 1)        128          64  torch.bfloat16     1     True         86.5          201.4          59.5              0                       1.3         NaN                     NaN        58.5                   98%                   NaN
41      4096          80   (16, 1)        128          64  torch.bfloat16     2     True        117.5          286.9         104.7              0                       0.7         NaN                     NaN       118.3                  113%                   NaN
42      4096          80   (16, 1)        128          64  torch.bfloat16     3     True        228.3            NaN         145.1              0                       0.5         NaN                     NaN       209.1                  144%                   NaN
43      4096          80   (16, 1)        128          64  torch.bfloat16     4     True        276.9            NaN         185.6              0                       0.4         NaN                     NaN       706.2                  380%                   NaN
44      4096         128   (16, 1)        128          64  torch.bfloat16     1     True        143.0          325.3         112.9              0                       1.1         NaN                     NaN        98.9                   88%                   NaN
45      4096         128   (16, 1)        128          64  torch.bfloat16     2     True        213.1        2,180.3         200.9              0                       0.6         NaN                     NaN       180.2                   90%                   NaN
46      4096         128   (16, 1)        128          64  torch.bfloat16     3     True        359.6            NaN         224.6              0                       0.5         NaN                     NaN       330.5                  147%                   NaN
47      4096         128   (16, 1)        128          64  torch.bfloat16     4     True        429.1            NaN         292.3              0                       0.4         NaN                     NaN     1,086.9                  372%                   NaN
48      4096          80    (8, 1)        128        1024  torch.bfloat16     1     True         92.6          209.7          57.4              0                       1.3         NaN                     NaN        56.9                   99%                   NaN
49      4096          80    (8, 1)        128        1024  torch.bfloat16     2     True        129.1        1,344.9          59.9              0                       1.3         NaN                     NaN       101.9                  170%                   NaN
50      4096          80    (8, 1)        128        1024  torch.bfloat16     3     True        223.4            NaN          90.4              0                       0.8         NaN                     NaN       185.3                  205%                   NaN
51      4096          80    (8, 1)        128        1024  torch.bfloat16     4     True        266.7            NaN          92.4              0                       0.8         NaN                     NaN       675.7                  732%                   NaN
52      4096         128    (8, 1)        128        1024  torch.bfloat16     1     True        138.8          330.6          86.2              0                       1.4         NaN                     NaN        84.7                   98%                   NaN
53      4096         128    (8, 1)        128        1024  torch.bfloat16     2     True        196.8        2,146.5          89.3              0                       1.4         NaN                     NaN       156.2                  175%                   NaN
54      4096         128    (8, 1)        128        1024  torch.bfloat16     3     True        248.4            NaN         135.4              0                       0.9         NaN                     NaN       205.6                  152%                   NaN
55      4096         128    (8, 1)        128        1024  torch.bfloat16     4     True        295.1            NaN         137.2              0                       0.9         NaN                     NaN     1,027.7                  749%                   NaN
56      4096          80   (10, 1)        128        1024  torch.bfloat16     1     True         88.5          205.8          56.8              0                       1.3        29.3                     2.6        52.8                   93%                   52%
57      4096          80   (10, 1)        128        1024  torch.bfloat16     2     True        114.5          282.3          87.8              0                       0.9        50.3                     1.5       101.7                  116%                   57%
58      4096          80   (10, 1)        128        1024  torch.bfloat16     3     True        163.7            NaN          90.9              0                       0.8        50.9                     1.5       137.6                  151%                   56%
59      4096          80   (10, 1)        128        1024  torch.bfloat16     4     True        197.1            NaN         152.0              0                       0.5        66.3                     1.2       652.2                  429%                   44%
60      4096         128   (10, 1)        128        1024  torch.bfloat16     1     True        137.6          330.6          86.0              0                       1.4        55.7                     2.2        79.2                   92%                   65%
61      4096         128   (10, 1)        128        1024  torch.bfloat16     2     True        177.2          455.2         134.0              0                       0.9        97.4                     1.3       159.6                  119%                   73%
62      4096         128   (10, 1)        128        1024  torch.bfloat16     3     True        256.8            NaN         138.2              0                       0.9        98.3                     1.3       216.3                  157%                   71%
63      4096         128   (10, 1)        128        1024  torch.bfloat16     4     True        309.3            NaN         240.1              0                       0.5       130.2                     1.0     1,043.1                  434%                   54%
64      4096          80   (16, 1)        128        1024  torch.bfloat16     1     True         92.1          200.3          55.1              0                       1.4         NaN                     NaN        55.8                  101%                   NaN
65      4096          80   (16, 1)        128        1024  torch.bfloat16     2     True        121.4          282.4          90.5              0                       0.9         NaN                     NaN       108.2                  120%                   NaN
66      4096          80   (16, 1)        128        1024  torch.bfloat16     3     True        174.1            NaN         149.6              0                       0.5         NaN                     NaN       144.6                   97%                   NaN
67      4096          80   (16, 1)        128        1024  torch.bfloat16     4     True        210.5            NaN         163.7              0                       0.5         NaN                     NaN       660.9                  404%                   NaN
68      4096         128   (16, 1)        128        1024  torch.bfloat16     1     True        142.6          320.4          80.3              0                       1.5         NaN                     NaN        84.6                  105%                   NaN
69      4096         128   (16, 1)        128        1024  torch.bfloat16     2     True        187.4          453.1         137.0              0                       0.9         NaN                     NaN       168.6                  123%                   NaN
70      4096         128   (16, 1)        128        1024  torch.bfloat16     3     True        274.8            NaN         239.8              0                       0.5         NaN                     NaN       227.7                   95%                   NaN
71      4096         128   (16, 1)        128        1024  torch.bfloat16     4     True        328.3            NaN         260.9              0                       0.5         NaN                     NaN     1,061.5                  407%                   NaN

triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0017976989038288593

NaN info:
{}
out_ref_md5=6f0c17a16d6e0ebdd2cab9c049fb7f21
triton_fp8_output_md5=fc27c229ed81d42b8dc41b5b02165456
diff.abs.max=0.0012969970703125
max_diff_thr=0.0012937397696077824

NaN info:
{}
out_ref_md5=6f0c17a16d6e0ebdd2cab9c049fb7f21
gluon_fp8_output_md5=86322b8b694e46b86684df1c280e71ea
diff.abs.max=0.0031890869140625
max_diff_thr=0.003168298862874508

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001708984375
max_diff_thr=0.001671442179940641

NaN info:
{}
out_ref_md5=ca25ce9acca15284c013d9c5dc22549f
triton_fp8_output_md5=744b5e3834a44210508dd51db2b61495
diff.abs.max=0.001129150390625
max_diff_thr=0.0011231862008571625

NaN info:
{}
out_ref_md5=ca25ce9acca15284c013d9c5dc22549f
gluon_fp8_output_md5=9b40a0eacf5a3e227d02776ebea67ac7
diff.abs.max=0.0030570030212402344
max_diff_thr=0.003047563135623932

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.0012146978406235576

NaN info:
{}
out_ref_md5=fcffd04fe353dca5eb1548acdea87f62
gluon_fp8_output_md5=a940220a828f5342209cd90d4e550b8b
diff.abs.max=0.00323486328125
max_diff_thr=0.0032308700028806925

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([1280, 1, 64, 128, 16])
diff.abs.max=0.001220703125
max_diff_thr=0.001215805415995419

NaN info:
{}
out_ref_md5=2831d7408192c64b41fae66fc2555d73
gluon_fp8_output_md5=31734f34a77ad0d4ef80283320311df7
diff.abs.max=0.00312042236328125
max_diff_thr=0.0031155969481915236

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0018310546875
max_diff_thr=0.0018123602494597435

NaN info:
{}
out_ref_md5=c14dcd8417a8c47cb74b681a198373fa
triton_fp8_output_md5=94b198aa073486c0dc3c6c19f1989ca5
diff.abs.max=0.001312255859375
max_diff_thr=0.0013022804632782936

NaN info:
{}
out_ref_md5=c14dcd8417a8c47cb74b681a198373fa
gluon_fp8_output_md5=4571a5250f61d0c3e79d34d742776974
diff.abs.max=0.003326416015625
max_diff_thr=0.003306437050923705

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.001953125
max_diff_thr=0.001898659043945372

NaN info:
{}
out_ref_md5=e214a3a9116962313e53ee8baecbab47
triton_fp8_output_md5=2d69c5fa3096b9f1a372696abbe1d5c6
diff.abs.max=0.0012664794921875
max_diff_thr=0.00126395293045789

NaN info:
{}
out_ref_md5=e214a3a9116962313e53ee8baecbab47
gluon_fp8_output_md5=e9f30d161217932e6ab0e3dc4719ec13
diff.abs.max=0.003173828125
max_diff_thr=0.0031476998701691628

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.0013427734375
max_diff_thr=0.0013302697334438562

NaN info:
{}
out_ref_md5=17beed7f1bc8dd30bf8bc934ea290267
gluon_fp8_output_md5=07124141e1a51886f791664ef0c34c26
diff.abs.max=0.00323486328125
max_diff_thr=0.0032151415944099426

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
diff.abs.max=0.000244140625
max_diff_thr=0.0002367424312978983

NaN info:
{}
trans v_quant_.shape=torch.Size([2048, 1, 64, 128, 16])
diff.abs.max=0.00128173828125
max_diff_thr=0.0012725344859063625

NaN info:
{}
out_ref_md5=882f85357a1f9dbba7300a183cb8d334
gluon_fp8_output_md5=10120f08b75530e5257d4d30ffe3bbfe
diff.abs.max=0.0032958984375
max_diff_thr=0.00325203244574368

NaN info:
{}
triton=<module 'triton' from '/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/__init__.py'>
triton.version=3.4.0
++ copy_recent_amdgcn_files
++ dir_name=pa_decode_v2_gluon_fp8
++ local k=200
++ local dest_dir=/mnt/raid0/heyanguang/code/fa_triton/triton_op/thread_trace/triton_gen_asm/pa_decode_v2_gluon_fp8
++ mkdir -p /mnt/raid0/heyanguang/code/fa_triton/triton_op/thread_trace/triton_gen_asm/pa_decode_v2_gluon_fp8
++ kernel_name=pa_decode_v2_gluon_
++ file_filter='*pa_decode_v2_gluon_*'
++ ls --color=auto -l --color=auto /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.source /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.source /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.source /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.source /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.source /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.source /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.hsaco /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.llir /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.source /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.ttgir /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.source /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.ttgir /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/__grp__pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.hsaco /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.llir /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.source /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  87362 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16304 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78760 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 130924 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60257 Oct 23 03:32 /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 142331 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  23144 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 148799 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140791 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65135 Oct 23 03:36 /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 109473 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18840 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 102346 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125090 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56279 Oct 23 03:33 /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 146964 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  23096 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 145862 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135456 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62042 Oct 23 03:31 /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  96903 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  17920 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 100636 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135451 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62091 Oct 23 03:31 /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 104929 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18520 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 106826 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135198 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62014 Oct 23 03:32 /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 102006 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18240 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103937 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135393 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62033 Oct 23 03:31 /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 142927 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22856 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 141305 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135514 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62100 Oct 23 03:31 /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 101977 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18224 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103805 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135390 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62032 Oct 23 03:31 /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 104964 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18536 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 106694 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135195 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62013 Oct 23 03:32 /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  81884 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15736 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75496 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140769 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63077 Oct 23 03:34 /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 105733 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18600 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 107068 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140728 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65173 Oct 23 03:36 /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 159251 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  24920 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 151715 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125211 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56346 Oct 23 03:34 /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 141766 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  23136 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 148557 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135261 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61976 Oct 23 03:32 /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  83246 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15984 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  74207 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125053 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56298 Oct 23 03:33 /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  84872 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15928 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75820 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136532 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61350 Oct 23 03:34 /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 101913 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18216 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103907 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140806 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63107 Oct 23 03:34 /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 142819 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  22976 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 139843 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125211 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56346 Oct 23 03:34 /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 108448 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18728 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 102214 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125087 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56278 Oct 23 03:33 /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  85551 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  16144 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  74445 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 120816 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  54569 Oct 23 03:33 /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  63362 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  13328 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  51664 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125143 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  57217 Oct 23 03:36 /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 147047 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  23112 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 145832 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140869 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63116 Oct 23 03:35 /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 102383 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18232 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 102650 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140832 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63135 Oct 23 03:34 /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 140682 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22968 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 152862 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135514 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62100 Oct 23 03:31 /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  84354 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16048 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  77643 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 130982 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60315 Oct 23 03:33 /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  78231 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15064 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  69052 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129431 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58945 Oct 23 03:36 /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  85381 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15960 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75861 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 131119 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60276 Oct 23 03:31 /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  85550 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  16144 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  74443 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 120802 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  54562 Oct 23 03:33 /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 102532 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18232 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 102680 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135419 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62061 Oct 23 03:31 /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 130920 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22200 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 144123 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140849 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65240 Oct 23 03:36 /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  78125 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15064 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  68938 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129428 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58944 Oct 23 03:36 /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  84871 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15928 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75818 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136518 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61343 Oct 23 03:34 /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  82583 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15872 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  73312 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 120874 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  54627 Oct 23 03:34 /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 102280 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18616 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 101016 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129552 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  59012 Oct 23 03:37 /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 107987 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18672 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 102346 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125090 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56279 Oct 23 03:33 /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  96691 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  17888 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 100606 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140864 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63165 Oct 23 03:35 /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 105768 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18608 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 106936 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140725 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65172 Oct 23 03:35 /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 104792 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18496 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 105521 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135224 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61995 Oct 23 03:32 /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 142743 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22816 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 141275 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140927 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63174 Oct 23 03:35 /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 104346 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18544 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  99218 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125148 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56337 Oct 23 03:34 /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  87770 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16376 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78996 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136454 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63416 Oct 23 03:35 /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  84699 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16064 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78446 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135161 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62033 Oct 23 03:32 /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 105511 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18568 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 105749 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140754 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65154 Oct 23 03:35 /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  62236 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  13184 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  50813 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125215 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  57233 Oct 23 03:37 /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  87769 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16376 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78994 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136440 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63409 Oct 23 03:35 /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 150764 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  23776 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 143984 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125153 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56288 Oct 23 03:33 /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  85107 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16136 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78659 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140691 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65192 Oct 23 03:35 /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  73185 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  14680 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  67196 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129489 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  59003 Oct 23 03:37 /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 137014 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22976 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 155711 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140849 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65144 Oct 23 03:36 /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 102724 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18312 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  97186 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129494 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58954 Oct 23 03:36 /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  94626 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  17664 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  94618 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129552 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  59012 Oct 23 03:37 /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  62476 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  13192 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  51378 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129394 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58915 Oct 23 03:36 /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  77407 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15008 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  68088 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129457 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58973 Oct 23 03:36 /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 107791 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18784 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 107068 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140728 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65173 Oct 23 03:36 /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 101799 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18200 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103775 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140803 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63106 Oct 23 03:34 /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 140614 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22920 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 152832 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140927 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63174 Oct 23 03:35 /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 108088 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  18664 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root 101083 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125116 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  56307 Oct 23 03:33 /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  87361 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16304 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  78758 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 130910 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60250 Oct 23 03:31 /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  84762 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  16056 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  77863 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136512 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63474 Oct 23 03:36 /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103777 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18328 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103907 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140806 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  63107 Oct 23 03:34 /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  82288 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15816 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75523 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135356 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62003 Oct 23 03:31 /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  82507 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15776 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  74714 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 131177 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60285 Oct 23 03:31 /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 130270 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22184 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 143893 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135319 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62081 Oct 23 03:33 /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 136236 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  22960 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 155481 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135319 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61985 Oct 23 03:33 /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103870 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18424 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103937 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135393 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62033 Oct 23 03:31 /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 106987 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18712 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 106826 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135198 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62014 Oct 23 03:32 /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 100071 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18304 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103446 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 135256 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  62072 Oct 23 03:33 /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 100680 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  18368 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1102 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root 103678 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 140786 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  65231 Oct 23 03:36 /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  63363 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  13328 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  51666 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 125157 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  57224 Oct 23 03:36 /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    935 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/__grp__pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  78231 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn
-rw-r--r-- 1 root root  15064 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.hsaco
-rw-r--r-- 1 root root   1109 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.json
-rw-r--r-- 1 root root  69052 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.llir
-rw-r--r-- 1 root root 129431 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.source
-rw-r--r-- 1 root root  58945 Oct 23 03:36 /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  85380 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15960 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  75859 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 131105 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  60269 Oct 23 03:31 /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.ttgir
-rw-r--r-- 1 root root    839 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/__grp__pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  82195 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.amdgcn
-rw-r--r-- 1 root root  15768 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.hsaco
-rw-r--r-- 1 root root   1101 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.json
-rw-r--r-- 1 root root  74687 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.llir
-rw-r--r-- 1 root root 136590 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.source
-rw-r--r-- 1 root root  61359 Oct 23 03:35 /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.ttgir
++ amdgcn_filter='/root/.triton/cache/*/pa_decode_v2_gluon_*.amdgcn'
++ json_filter='/root/.triton/cache/*/pa_decode_v2_gluon_*.json'
++ cat /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.json /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.json /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.json /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.json /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.json
{"hash": "d0edd88c2fa2a0b36b35cb53996a25781eb653b12dd1295ff58c2e7f97da0cfe", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "d124bd2e4ce004d17ae1db503fb32632963a48f9222f0aed5690cc41158ba545", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "d1d58fa9cecc5719b474cebe366412234218aa58fc200504b880957a953b5892", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "d31b3b1515fcd200b902c5b4e92f1d4d58efd0486aa47421a36038aaa18ec06e", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "d9a397dc86812c3a06bad4534712454ed1d83805d4048e18d472779393d6e210", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "db4db7ef0d1a78ce1ce42657e024631f25ef534d3b67e93f9b9a674744c3c199", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "de63e4a1b93629eda597a80f8be9ae0ff68b39ad26ee051739634e9ff631be53", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "e7467da60b6c52974cc304d9c2886a1a568d1a011f07a85a1025ac69a8d89e81", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "e98e6a641dcb50d9825aa572c37c388445b3cbf29a4c48411f7f85604505d312", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "ebe2a6ac592e3b9cb877f54bd61be38999ffa7c6528e1df348a12c9038fd254a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "ec41b8494d3d922c84a766937f90b04a88cc396086ca74e15bc106a6a09a61b5", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "f7a714f7a34fd49306fa5bc9db64ecb82ce10be27ceccbf3d334ed13ad58ee93", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "f5e4bb8c4787fa691403c319c616d068402133ab7a31311a652e0cadba66deec", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "f8cafa9d9583d52ee2ca4e75b6ef1d1d585fb1a3cdf0d468762ce0659a4fafd9", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "f900c8cce0609dd98d513562d8791cca0cff54506007ae94fd09e3f8b4473479", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "f99cfc19cc464fe6f757a86e54f224a8ca5fe40bcfc34f782c42f8c693c4c74c", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "fd19a78185b9576cee2deb174f6fe4beb20c367ef2bef7c3b5cb2c0714c5321e", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "036f05e3d14e065f35b797eb21ced8a52f7e1b0b1dae340bc1d5982ece83a81c", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "046e1ada31600d6a52d9d72e3b07df3b6a3695536093739f7f4a6860abab2a44", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "0ff759a29580a3feefc37038e204832d98e3acd684a60603586dc2db691f2a07", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "17d88850a49cc4d3cb5774a4da534a4ae9aed1dfe2d4e990657b071813eaeb6a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 2048, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "1321feb485dbaade8d53df79a924e976bb04ab7cef674399b2bf6444e7b6f8be", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "135d4e5a7e462bfbc00eb45803c003e0920c6320ffe18571b905048a7a6c13eb", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "19045b5b29a6a5e13d3271cfb55a9ed3411941775f62f235a03ff63e3e589f4a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "1b2084f9a27e3a26cdf3ecacef0fa8dab49898e1bbd0c3debe746518fada4fba", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "377b742eae10e22ea5e4d01ebeae470f2d156d81ceac6dfa5825c16051e76694", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "37721963e4e9ec8a978ada5564000717a0cf16b5cc4e0ad44c87dd44e816a369", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "3e146ebf506c87d0fe7bd2d81167961afc7df6279396593a6b38123cdf56539f", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "411c37ae175b5c78012613c88db4886a0ab6223ab2516da92eb648453eb50e74", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "41a8afc668ed6b632a6d1d48d033854f281cb7b5ce2dce62a741121f39e86c51", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "43695f2ddc966e0ae4d736de954b5c3e9da46542eb9bc11529ff659119138780", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "445051f06d5f8a455be5d8ee72f66f146552575358cd773c3686545e7e23a9db", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "481865d307bd62ca1fc66a4418edd60cfeec6437bb3a08982cf8226376ae51a6", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "4e56a16ea85d6476b8fe22d418c410938b8162224019f49b22f10cf0a8ca9124", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "5102515a891c4cb5a04f7c724fdb3dea86202b30fc5dc2b4e56a90a86b2fc6a6", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "51e4a24e15eb4b5592c2e6c68fd40115f60afd5455a4f5f1c35de2eee267e835", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "52a7e42bc68df3e66922ed3411f46a7253675fe17fa7a042222113593ab677f7", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "5912427eb33c69cd7e31bba424708fdfbff34838040cb34b1160561afd606350", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "5beae6b5e0232d30181f994ee8b18954e4af7ef420b86785811230422e90fd6c", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "5d6749bc01c4d90e9fce8d7132891a7070de78eac283a5d584916d7d21020f1d", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "5d93ee8cc8fd3f76b94f3da42c2ecdb0b00dc7f7c4ab84db066699b7af43fa6e", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "624935bd4333e55f8baaa25e3a8292ae3fcbf7fb892b0a53450dd518f9cdf6aa", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "62ddc00bdff5285f0aab4b55ed274223f7a24edd611b21ab74b12bc917b5cd6d", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "6f3cdd0fd4cc3dc2cddae48283ffcc25c1a9c656f7d1080b130199f2a63950ec", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 2048, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "69a55d6fe45fbeb41d7e26095a61295d6ce82747c5220143174c68d6b95f29c8", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "74129c5d3b11eb9da391f20b762fe395c9bd99d4bc50163da2afb4af22b6a775", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "75a620c57c4ff031304a43f30fa19281d16658274820bed9843be416fc068992", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "8072b190fefcb1635617afd9b9941d39c6146bbc35624a610af25272c30eba6c", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "8247f6c5f39039895f703d50d1965866dcea57d7a52d974ae6a0a4e08d39b1b0", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "83e94240c3d1149a2bc89f7e0ce5e72b6d6605673b73917353c4486b0945a24a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "8bc1b58c41c86807766541832b6a0aa7dab808dff9dccc036be1c686c39e7f9b", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "8dbccab1f67314dddf21fdf3bf58b77d42b7831a4b6b8d7da98b6ec04516bcd6", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 2048, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "921cc8e97d2b7fa40486550c9484f3f96a10d072456f70310f37d6de3ffbf16a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "937bc36576f4fdf238665b7bbd6c340017e18380480144c4463e6e3dbdf020c2", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "9b161b73fd5d6ee432d2617d089cf5998e4f5ad14dc5081d3841100705b6486c", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "9cc23362b9e3aff9d3ff75493106eaf7923f6d43825706ba7206c46230916434", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "a1a056fd7e756f071e3078a8dbfa7daaa2c422a27d1f082db06fea2775f694b2", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "aa00bd0247e2a9250ad663631c96575ee49b91c6a301d90aea0fe76f7c6e6d06", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "ac6bbdca0ccff4cb6adf975de59408badd426e35d8182e4efa0fb9fafc3c11dd", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b73ea3d7f4ebb11e47cee947a96095d1eeab469435f5833c3dd96cfb6bbdc5b5", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b2abe663e53da461a5759df9e04da5f37a89ad5e58a588d1db534ca05834cf03", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b350f5ae124785623b6ab2c059b1dd8888df9bb0f2b93ae9fbe11a5f088b649a", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b397e7463e8e97562cd88a1d40d99429324eba316237fbd1c9ae70ad421baf71", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b5446ede0b5f249f256000b2f4a9e6c341677aeb61521dc1ff573c4cdfdc40c6", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 3, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "b63e48ea52f148646a7d6667737a545cf01db7cc2d1a11268e1e986b8f41d89b", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "ba5647405a190fb58de04c53d8a8bcb7b8485ea8a7e319961ab0d78a97a4b4bd", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "be458732d4c5d69268d179793968d27dcc1a4355e8336792aa826db5d0e377e4", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "c51952a7548b4b39f47bf6e512f7cee72d10fcc874ddcf0d5847ba9f139f92c6", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 16384, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "c8f35d6784e2c226bace0663c14c3bc6e0ff67cd0ec1bc5f0b73f7219d67deda", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 2048, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "c9ccf156e4243ad7e4191b8e733f9a36c42b420b09a0802396ecf9435bc342af", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 1, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_big_blk_fp8"}{"hash": "cd171c1128d0d6771c5ae91c98e2a95c66cdf7c09525ec2077c02f75915b4737", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}{"hash": "ce11516351ae15a13063249c37afdae4e361c6fcc6e8d43ceb4fa1746cb55ce4", "target": {"backend": "hip", "arch": "gfx942", "warp_size": 64}, "num_warps": 4, "waves_per_eu": 4, "num_stages": 1, "num_ctas": 1, "extern_libs": [["ocml", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ocml.bc"], ["ockl", "/mnt/raid0/heyanguang/code/fa_triton/ali_triton/python/triton/backends/amd/lib/ockl.bc"]], "cluster_dims": [1, 1, 1], "debug": false, "sanitize_overflow": true, "arch": "gfx942", "supported_fp8_dtypes": ["fp8e4b8", "fp8e4nv", "fp8e5", "fp8e5b16"], "deprecated_fp8_dot_operand_dtypes": [], "default_dot_input_precision": "ieee", "allowed_dot_input_precisions": ["ieee", "tf32"], "enable_fp_fusion": true, "launch_cooperative_grid": false, "matrix_instr_nonkdim": 0, "kpack": 1, "allow_flush_denorm": false, "max_num_imprecise_acc_default": 0, "backend_name": "hip", "instrumentation_mode": "", "schedule_hint": "none", "warp_size": 64, "triton_version": "3.4.0", "shared": 4096, "profile_scratch_size": 0, "profile_scratch_align": 1, "name": "pa_decode_v2_gluon_fp8"}++ egrep '.sgpr_count|.sgpr_spill_count|.vgpr_count|.vgpr_spill_count'
++ cat /root/.triton/cache/2DW5RDBPUKQLG2ZVZNJZS2RFPAPLMU5RFXISSX7VRQXH7F62BT7A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/2ESL2LSM4ACNC6XB3NID7MZGGKLDUSHZEIXQV3KWSDGECFMLUVCQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/2HKY7KOOZRLRTNDUZ27DMZASENBBRKSY7QQAKBFYQCKXVFJ3LCJA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/2MNTWFIV7TJABOICYW2OSLY5JVMO7UCINKSHIINDMA4KVIMOYBXA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3GRZPXEGQEWDUBV22RJUOESFJ3I5QOAF2QCI4GGUOJ3ZHE6W4IIA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3NG3P3YNDJ4M4HHEEZL6AJDDD4S66U2NHNT6SP43TJTUORGDYGMQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/3ZR6JINZGYU63JMXVAHYX2NOB73IWONNE3XAKFZZMNHJ75RRXZJQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/45DH3JQLNRJJOTGDATM4FCDKDJLI2GQBD4D2QWQQEWWGTKGYT2AQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5GHGUZA5ZNINTAS2UVZMG7BYQRC3HS7STJGEQQI7P6CWARIF2MJA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5PRKNLCZFY5ZZODX6VF5MG7DRGM77J6GKKHB342IUEWJAOH5EVFA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/5RA3QSKNHWJCZBFHM2JX7EFQJKEMYOLAQ3FHJYK3YEDKNIE2MG2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/66TRJ55DJ7KJGBX2LPE5WZHMXAWOCC7CPTWMX46TGTWRHLKY52JQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/6XSLXDCHQ75GSFADYMM4MFWQNBACCM5LPIYTCGTFFYGK3OTG33WA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/7DFPVHMVQPKS5YWKJZ23N3Y5DVMF7MNDZXYNI2DWFTQGLGSPV7MQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/7EAMRTHAMCO5TDKRGVRNQ6I4ZIGP6VCQMAD25FH5BHR7RNCHGR4Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/7GOPYGOMIZH6N52XVBXFJ4REVDFF7ZALZ7BU66BMIL4MNE6EY5GA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/7UM2PAMFXFLWZ3RN5MLU637EX2ZAYNT66K7PPQ5VZMWAOFGFGIPA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/ANXQLY6RJYDF6NNXS7VSDTWYUUXX4GYLDWXDIC6B2WMC5TUDVAOA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ARXBVWRRMAGWUUWZ24XDWB67HNVDNFKTMCJXHH37JJUGBK5LFJCA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/B73VTIUVQCR7536DOA4OEBEDFWMOHLGWQSTAMA2YNXBNW2I7FIDQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/C7MIQUFETTCNHS2XOSSNUU2KJLU25UO74LKOTEDFPMDRQE7K5NVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/CMQ75NEF3OVN5DKT3542SJHJO25QJK3455TUHGNSX5SEJZ5W7C7A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/CNOU4WT6IYV7XQAOWRMAHQAD4CJAYYZA77QYK4NZAUCIU6TMCPVQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/DECFWWZJU2S6CPJSOHH3KWU62NARSQLXL5RPENNAH73D4PSYT5FA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/DMQIJ6NCPY5CNTPT5SWO6D5I3K2JRGHBXPIMHXV6ORSRR6W2J65A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/G55XILVOCDRC5JPE2APL5LSHB4WRK3MBZ2WG36SYEXAWAUPHM2KA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/G5ZBSY7E5HWIVF4K3JKWIAAHC6QM6FVVZRHAVVCMQ7OUJ2AWUNUQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/HYKG5P2QNSD5B7T32LMBCZ4WDL6H35RHSOLFSOTLHAJDZX2WKOPQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/IEODPLQXLNOHQAJGCPEI3NEINIFLMIR2WJIW3KJOWZEEKPVVBZ2A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/IGUK7RTI5VVWGKTNDVENAM4FJ4UBZN5VZYW44YVHIEJB6OPINRIQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/INUV6LO4SZXAVZGXG3PJKS24H2O2IZKC5ON4CFJJ75SZCGITQ6AA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/IRIFD4DNL6FEKW7F3DXHF5TPCRSVEV2TLDGXOPBWQZKF47RDVHNQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/JAMGLUYHXVRMUH6GNJCBR3OWBT7OYZBXXM5ARGBM7ARGG5VOKGTA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/JZLKC3VILVSHNOH6ELKBRRAQSOFYCYRCIAM7JGZC6EGPBKGKSESA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/KEBFCWUJDRGLLICPPRZE7WZ55KDCAKZQ7RO4FNHFNKIKQ2ZPY2TA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/KHSKETQV5NFVLEWC43DI7VABCX3AV7KUKWSPL4ODLXRO5YTH5A2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/KKT6IK6GRXZ6M2JC5U2BD5DKOJJWOX7BP6T2AQRCEEJVSOVWO73Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LEJEE7VTHRU427RRXOSCI4EP3677GSBYAQGLGSYRMBLBV7LAMNIA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LPVONNPAEMWTAGA7TFHORMMJKTSK67XUEC4GPBMBCIYEELUQ7VWA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/LVTUTPABYTMQ5H6ORVYTFCI2OBYN46HKYKB2LVMESFWX2IICB4OQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/LWJ65DGI7U7XNOKPHWSCYLWNWCYA3R7XYSVYJWYGM2M3PL2D7JXA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/MJETLPKDGPSV7C5KUJPDVAUSVY74X573REVQUU2FBXKRR6ON62VA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/MLO4AC676UUF6CVLJNK62J2CEP32ETW5MENSDK3UWEV4SF5VZVWQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/N46N2D6UZQ64FTO24SBIH76MEXA2TRSW67IQQCYTAGM7FJRZKDWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/NGSV237EL67LIHL6EYEVUYJJLVWOQJ2HYURACQYXJRUNNOK7FHEA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/OQJJYXJ3CHVZ3I4R6IFXML7DSXE33GOUXRIBMPNCV62K6IVWU52Q/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/OWTCBRL4J7YDCMCKIPZQ7IMSQHIWMWBHJAQL5WMEHPSBN7AGRGJA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/QBZLDEH67SYWGVQXV7M3TFA5HHDBI254GVREUYIK6JJHFQYOXJWA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/QJD7NRPTSA4YSX3QHVINDFSYM3OOUV6XUUWZOSXGUCSOBDJZWGYA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/QPUUEQGD2EKJUK6IT57AZZPHFNWWMBLHHNZZC42TYREGWCKFUJFA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/RPA3LDCBZBUAO5TFIGBSW2QKU7NLQCG77HOMYA3L4HDINQ46P6NQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/RW6MVMPWOMKN3XZB7XZ36WFXPVBLPAY2JNVY27NJRNXMARIWXTLA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/SIOMR2L5FN72IBEGKUGJJBHT7FVBBUDSIVXXAMIPG7LN4P736FVA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/SN54GZLW6T67EODGLN5323BUAAL6DA4AJAAUJRCGHZXD3PPQEDBA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/TMLBW475LVXOIMWSMF6QRHHVTGHE6WWRJXCQQHJYIEIAOBNWJBWA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/TTBDGYVZ4OX7TU77OVETCBXK66JD63KDQJLQNOTSA3CGEMERMQ2A/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/UGQFN7L6OVXQOHRQPCUNX6T5VKRMIIVCPUPQQLNQN7VCO5PWSSZA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/VIAL2ASH4KUSKCWWMNRRZFSXL3SJXEOGUMA5SCXKB7TW67DONUDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/VRV33SQMZ72MW2W7S5O6LFAIXLOUE3RV3AMC4TX2B647V7B4CHOQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/W47KHV7U5OYR4R6O5FD2SYEV2HXKWRUUGX2YGPB53FWPW255YW2Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WKV6MY7FHWSGDJLVTX46ATNF6N5ITLK6LCSYRUO3KNGKAWBUZ4BQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WNIPLLQSI6CWEO3KWLAFTMO5RCEN7G5Q6K4TV2P34ENF6CELMSNA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WOL6ORR6R2LVMLGYRIOUBWMUFEZE5ORRMI37XUOJVZYK2QQ3V5YQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WVCG5XQLL4SJ6JLAACZPJKPGYNAWO6XLMFJB3QP7K46EZX64IDDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/WY7ER2SS6FEGI2T5MZTXG6SULTYB3N6MFUNBCJUOD2MGXD2B3CNQ/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/XJLEOQC2DEH3LDPAJRJ5RKF4W64EQXVIU7RRTFQ2WDLYVF5EWS6Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/XZCYOMWUYXLJE2GRPF4TS2GSPXGBUQ2V5AZWPEVKQJW3LUHDO7SA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/YUMVFJ2URNFTT5D363SRF56O44WRB7GIOTO46DKYI65J6E47SLDA/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/ZDZV2Z4E4LBCNOWOAZR4CTB3Y3QP6Z6NB3A3YXYLOP3SDHLH33NA/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ZHGPCVXEEQ5NPZAZDOHHGP42G3CCWQQLBGQIAI4W5T4UGW6DIKXQ/pa_decode_v2_gluon_big_blk_fp8.amdgcn /root/.triton/cache/ZULRYEJI2DLHOHC25EOJRYVJLRTM356ASUS6YIDXYAXXLEK3I43Q/pa_decode_v2_gluon_fp8.amdgcn /root/.triton/cache/ZYIVCY2RVYK2CMDDESODPL624TRWDRX4Y3UNIPHLJ6QXI3FVLTSA/pa_decode_v2_gluon_fp8.amdgcn
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     167
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     156
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     161
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 2
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     161
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 3
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     115
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     212
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     167
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     64
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     116
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     204
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     156
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     80
    .sgpr_spill_count: 0
    .vgpr_count:     104
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     161
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 4
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 4
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     82
    .sgpr_spill_count: 0
    .vgpr_count:     136
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     115
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 4
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 3
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     82
    .sgpr_spill_count: 0
    .vgpr_count:     136
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     116
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     64
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     72
    .sgpr_spill_count: 0
    .vgpr_count:     220
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     156
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 2
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     161
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     74
    .sgpr_spill_count: 0
    .vgpr_count:     156
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     69
    .sgpr_spill_count: 0
    .vgpr_count:     96
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     66
    .sgpr_spill_count: 0
    .vgpr_count:     204
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     74
    .sgpr_spill_count: 0
    .vgpr_count:     136
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     80
    .sgpr_spill_count: 0
    .vgpr_count:     196
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     72
    .sgpr_spill_count: 0
    .vgpr_count:     196
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     69
    .sgpr_spill_count: 0
    .vgpr_count:     104
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     69
    .sgpr_spill_count: 0
    .vgpr_count:     136
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 3
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 4
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     63
    .sgpr_spill_count: 0
    .vgpr_count:     156
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     122
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     115
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     115
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 3
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     62
    .sgpr_spill_count: 0
    .vgpr_count:     168
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 20
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 21
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     128
    .vgpr_spill_count: 21
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     80
    .sgpr_spill_count: 0
    .vgpr_count:     104
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     82
    .sgpr_spill_count: 0
    .vgpr_count:     136
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     115
    .vgpr_spill_count: 0
		.amdhsa_user_sgpr_count 16
    .sgpr_count:     58
    .sgpr_spill_count: 0
    .vgpr_count:     116
    .vgpr_spill_count: 0
++ set +x
